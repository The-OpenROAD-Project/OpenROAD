namespace odb {
const char* odb_py_python_inits[] = {
"IyBUaGlzIGZpbGUgd2FzIGF1dG9tYXRpY2FsbHkgZ2VuZXJhdGVkIGJ5IFNXSUcgKGh0dHA6Ly93d3cuc3dpZy5vcmcpLgojIFZlcnNpb24gNC4wLjAKIwojIERvIG5vdCBtYWtlIGNoYW5nZXMgdG8gdGhpcyBmaWxlIHVubGVzcyB5b3Uga25vdyB3aGF0IHlvdSBhcmUgZG9pbmctLW1vZGlmeQojIHRoZSBTV0lHIGludGVyZmFjZSBmaWxlIGluc3RlYWQuCgpmcm9tIHN5cyBpbXBvcnQgdmVyc2lvbl9pbmZvIGFzIF9zd2lnX3B5dGhvbl92ZXJzaW9uX2luZm8KaWYgX3N3aWdfcHl0aG9uX3ZlcnNpb25faW5mbyA8ICgyLCA3LCAwKToKICAgIHJhaXNlIFJ1bnRpbWVFcnJvcignUHl0aG9uIDIuNyBvciBsYXRlciByZXF1aXJlZCcpCgojIEltcG9ydCB0aGUgbG93LWxldmVsIEMvQysrIG1vZHVsZQppZiBfX3BhY2thZ2VfXyBvciAnLicgaW4gX19uYW1lX186CiAgICBmcm9tIC4gaW1wb3J0IF9vZGJfcHkKZWxzZToKICAgIGltcG9ydCBfb2RiX3B5Cgp0cnk6CiAgICBpbXBvcnQgYnVpbHRpbnMgYXMgX19idWlsdGluX18KZXhjZXB0IEltcG9ydEVycm9yOgogICAgaW1wb3J0IF9fYnVpbHRpbl9fCgpkZWYgX3N3aWdfc2V0YXR0cl9ub25keW5hbWljKHNlbGYsIGNsYXNzX3R5cGUsIG5hbWUsIHZhbHVlLCBzdGF0aWM9MSk6CiAgICBpZiBuYW1lID09ICJ0aGlzb3duIjoKICAgICAgICByZXR1cm4gc2VsZi50aGlzLm93bih2YWx1ZSkKICAgIGlmIG5hbWUgPT0gInRoaXMiOgogICAgICAgIGlmIHR5cGUodmFsdWUpLl9fbmFtZV9fID09ICdTd2lnUHlPYmplY3QnOgogICAgICAgICAgICBzZWxmLl9fZGljdF9fW25hbWVdID0gdmFsdWUKICAgICAgICAgICAgcmV0dXJuCiAgICBtZXRob2QgPSBjbGFzc190eXBlLl9fc3dpZ19zZXRtZXRob2RzX18uZ2V0KG5hbWUsIE5vbmUpCiAgICBpZiBtZXRob2Q6CiAgICAgICAgcmV0dXJuIG1ldGhvZChzZWxmLCB2YWx1ZSkKICAgIGlmIG5vdCBzdGF0aWM6CiAgICAgICAgb2JqZWN0Ll9fc2V0YXR0cl9fKHNlbGYsIG5hbWUsIHZhbHVlKQogICAgZWxzZToKICAgICAgICByYWlzZSBBdHRyaWJ1dGVFcnJvcigiWW91IGNhbm5vdCBhZGQgYXR0cmlidXRlcyB0byAlcyIgJSBzZWxmKQoKCmRlZiBfc3dpZ19zZXRhdHRyKHNlbGYsIGNsYXNzX3R5cGUsIG5hbWUsIHZhbHVlKToKICAgIHJldHVybiBfc3dpZ19zZXRhdHRyX25vbmR5bmFtaWMoc2VsZiwgY2xhc3NfdHlwZSwgbmFtZSwgdmFsdWUsIDApCgoKZGVmIF9zd2lnX2dldGF0dHIoc2VsZiwgY2xhc3NfdHlwZSwgbmFtZSk6CiAgICBpZiBuYW1lID09ICJ0aGlzb3duIjoKICAgICAgICByZXR1cm4gc2VsZi50aGlzLm93bigpCiAgICBtZXRob2QgPSBjbGFzc190eXBlLl9fc3dpZ19nZXRtZXRob2RzX18uZ2V0KG5hbWUsIE5vbmUpCiAgICBpZiBtZXRob2Q6CiAgICAgICAgcmV0dXJuIG1ldGhvZChzZWxmKQogICAgcmFpc2UgQXR0cmlidXRlRXJyb3IoIiclcycgb2JqZWN0IGhhcyBubyBhdHRyaWJ1dGUgJyVzJyIgJSAoY2xhc3NfdHlwZS5fX25hbWVfXywgbmFtZSkpCgoKZGVmIF9zd2lnX3JlcHIoc2VsZik6CiAgICB0cnk6CiAgICAgICAgc3RydGhpcyA9ICJwcm94eSBvZiAiICsgc2VsZi50aGlzLl9fcmVwcl9fKCkKICAgIGV4Y2VwdCBfX2J1aWx0aW5fXy5FeGNlcHRpb246CiAgICAgICAgc3RydGhpcyA9ICIiCiAgICByZXR1cm4gIjwlcy4lczsgJXMgPiIgJSAoc2VsZi5fX2NsYXNzX18uX19tb2R1bGVfXywgc2VsZi5fX2NsYXNzX18uX19uYW1lX18sIHN0cnRoaXMsKQoKCmRlZiBfc3dpZ19zZXRhdHRyX25vbmR5bmFtaWNfaW5zdGFuY2VfdmFyaWFibGUoc2V0KToKICAgIGRlZiBzZXRfaW5zdGFuY2VfYXR0cihzZWxmLCBuYW1lLCB2YWx1ZSk6CiAgICAgICAgaWYgbmFtZSA9PSAidGhpc293biI6CiAgICAgICAgICAgIHNlbGYudGhpcy5vd24odmFsdWUpCiAgICAgICAgZWxpZiBuYW1lID09ICJ0aGlzIjoKICAgICAgICAgICAgc2V0KHNlbGYsIG5hbWUsIHZhbHVlKQogICAgICAgIGVsaWYgaGFzYXR0cihzZWxmLCBuYW1lKSBhbmQgaXNpbnN0YW5jZShnZXRhdHRyKHR5cGUoc2VsZiksIG5hbWUpLCBwcm9wZXJ0eSk6CiAgICAgICAgICAgIHNldChzZWxmLCBuYW1lLCB2YWx1ZSkKICAgICAgICBlbHNlOgogICAgICAgICAgICByYWlzZSBBdHRyaWJ1dGVFcnJvcigiWW91IGNhbm5vdCBhZGQgaW5zdGFuY2UgYXR0cmlidXRlcyB0byAlcyIgJSBzZWxmKQogICAgcmV0dXJuIHNldF9pbnN0YW5jZV9hdHRyCgoKZGVmIF9zd2lnX3NldGF0dHJfbm9uZHluYW1pY19jbGFzc192YXJpYWJsZShzZXQpOgogICAgZGVmIHNldF9jbGFzc19hdHRyKGNscywgbmFtZSwgdmFsdWUpOgogICAgICAgIGlmIGhhc2F0dHIoY2xzLCBuYW1lKSBhbmQgbm90IGlzaW5zdGFuY2UoZ2V0YXR0cihjbHMsIG5hbWUpLCBwcm9wZXJ0eSk6CiAgICAgICAgICAgIHNldChjbHMsIG5hbWUsIHZhbHVlKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHJhaXNlIEF0dHJpYnV0ZUVycm9yKCJZb3UgY2Fubm90IGFkZCBjbGFzcyBhdHRyaWJ1dGVzIHRvICVzIiAlIGNscykKICAgIHJldHVybiBzZXRfY2xhc3NfYXR0cgoKCmRlZiBfc3dpZ19hZGRfbWV0YWNsYXNzKG1ldGFjbGFzcyk6CiAgICAiIiJDbGFzcyBkZWNvcmF0b3IgZm9yIGFkZGluZyBhIG1ldGFjbGFzcyB0byBhIFNXSUcgd3JhcHBlZCBjbGFzcyAtIGEgc2xpbW1lZCBkb3duIHZlcnNpb24gb2Ygc2l4LmFkZF9tZXRhY2xhc3MiIiIKICAgIGRlZiB3cmFwcGVyKGNscyk6CiAgICAgICAgcmV0dXJuIG1ldGFjbGFzcyhjbHMuX19uYW1lX18sIGNscy5fX2Jhc2VzX18sIGNscy5fX2RpY3RfXy5jb3B5KCkpCiAgICByZXR1cm4gd3JhcHBlcgoKCmNsYXNzIF9Td2lnTm9uRHluYW1pY01ldGEodHlwZSk6CiAgICAiIiJNZXRhIGNsYXNzIHRvIGVuZm9yY2Ugbm9uZHluYW1pYyBhdHRyaWJ1dGVzIChubyBuZXcgYXR0cmlidXRlcykgZm9yIGEgY2xhc3MiIiIKICAgIF9fc2V0YXR0cl9fID0gX3N3aWdfc2V0YXR0cl9ub25keW5hbWljX2NsYXNzX3ZhcmlhYmxlKHR5cGUuX19zZXRhdHRyX18pCgoKY2xhc3MgU3dpZ1B5SXRlcmF0b3Iob2JqZWN0KToKICAgIHRoaXNvd24gPSBwcm9wZXJ0eShsYW1iZGEgeDogeC50aGlzLm93bigpLCBsYW1iZGEgeCwgdjogeC50aGlzLm93bih2KSwgZG9jPSdUaGUgbWVtYmVyc2hpcCBmbGFnJykKCiAgICBkZWYgX19pbml0X18oc2VsZiwgKmFyZ3MsICoqa3dhcmdzKToKICAgICAgICByYWlzZSBBdHRyaWJ1dGVFcnJvcigiTm8gY29uc3RydWN0b3IgZGVmaW5lZCAtIGNsYXNzIGlzIGFic3RyYWN0IikKICAgIF9fcmVwcl9fID0gX3N3aWdfcmVwcgogICAgX19zd2lnX2Rlc3Ryb3lfXyA9IF9vZGJfcHkuZGVsZXRlX1N3aWdQeUl0ZXJhdG9yCgogICAgZGVmIHZhbHVlKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LlN3aWdQeUl0ZXJhdG9yX3ZhbHVlKHNlbGYpCgogICAgZGVmIGluY3Ioc2VsZiwgbj0xKToKICAgICAgICByZXR1cm4gX29kYl9weS5Td2lnUHlJdGVyYXRvcl9pbmNyKHNlbGYsIG4pCgogICAgZGVmIGRlY3Ioc2VsZiwgbj0xKToKICAgICAgICByZXR1cm4gX29kYl9weS5Td2lnUHlJdGVyYXRvcl9kZWNyKHNlbGYsIG4pCgogICAgZGVmIGRpc3RhbmNlKHNlbGYsIHgpOgogICAgICAgIHJldHVybiBfb2RiX3B5LlN3aWdQeUl0ZXJhdG9yX2Rpc3RhbmNlKHNlbGYsIHgpCgogICAgZGVmIGVxdWFsKHNlbGYsIHgpOgogICAgICAgIHJldHVybiBfb2RiX3B5LlN3aWdQeUl0ZXJhdG9yX2VxdWFsKHNlbGYsIHgpCgogICAgZGVmIGNvcHkoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuU3dpZ1B5SXRlcmF0b3JfY29weShzZWxmKQoKICAgIGRlZiBuZXh0KHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LlN3aWdQeUl0ZXJhdG9yX25leHQoc2VsZikKCiAgICBkZWYgX19uZXh0X18oc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuU3dpZ1B5SXRlcmF0b3JfX19uZXh0X18oc2VsZikKCiAgICBkZWYgcHJldmlvdXMoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuU3dpZ1B5SXRlcmF0b3JfcHJldmlvdXMoc2VsZikKCiAgICBkZWYgYWR2YW5jZShzZWxmLCBuKToKICAgICAgICByZXR1cm4gX29kYl9weS5Td2lnUHlJdGVyYXRvcl9hZHZhbmNlKHNlbGYsIG4pCgogICAgZGVmIF9fZXFfXyhzZWxmLCB4KToKICAgICAgICByZXR1cm4gX29kYl9weS5Td2lnUHlJdGVyYXRvcl9fX2VxX18oc2VsZiwgeCkKCiAgICBkZWYgX19uZV9fKHNlbGYsIHgpOgogICAgICAgIHJldHVybiBfb2RiX3B5LlN3aWdQeUl0ZXJhdG9yX19fbmVfXyhzZWxmLCB4KQoKICAgIGRlZiBfX2lhZGRfXyhzZWxmLCBuKToKICAgICAgICByZXR1cm4gX29kYl9weS5Td2lnUHlJdGVyYXRvcl9fX2lhZGRfXyhzZWxmLCBuKQoKICAgIGRlZiBfX2lzdWJfXyhzZWxmLCBuKToKICAgICAgICByZXR1cm4gX29kYl9weS5Td2lnUHlJdGVyYXRvcl9fX2lzdWJfXyhzZWxmLCBuKQoKICAgIGRlZiBfX2FkZF9fKHNlbGYsIG4pOgogICAgICAgIHJldHVybiBfb2RiX3B5LlN3aWdQeUl0ZXJhdG9yX19fYWRkX18oc2VsZiwgbikKCiAgICBkZWYgX19zdWJfXyhzZWxmLCAqYXJncyk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuU3dpZ1B5SXRlcmF0b3JfX19zdWJfXyhzZWxmLCAqYXJncykKICAgIGRlZiBfX2l0ZXJfXyhzZWxmKToKICAgICAgICByZXR1cm4gc2VsZgoKIyBSZWdpc3RlciBTd2lnUHlJdGVyYXRvciBpbiBfb2RiX3B5Ogpfb2RiX3B5LlN3aWdQeUl0ZXJhdG9yX3N3aWdyZWdpc3RlcihTd2lnUHlJdGVyYXRvcikKCmNsYXNzIHZlY3Rvcl9zdHIob2JqZWN0KToKICAgIHRoaXNvd24gPSBwcm9wZXJ0eShsYW1iZGEgeDogeC50aGlzLm93bigpLCBsYW1iZGEgeCwgdjogeC50aGlzLm93bih2KSwgZG9jPSdUaGUgbWVtYmVyc2hpcCBmbGFnJykKICAgIF9fcmVwcl9fID0gX3N3aWdfcmVwcgoKICAgIGRlZiBpdGVyYXRvcihzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS52ZWN0b3Jfc3RyX2l0ZXJhdG9yKHNlbGYpCiAgICBkZWYgX19pdGVyX18oc2VsZik6CiAgICAgICAgcmV0dXJuIHNlbGYuaXRlcmF0b3IoKQoKICAgIGRlZiBfX25vbnplcm9fXyhzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS52ZWN0b3Jfc3RyX19fbm9uemVyb19fKHNlbGYpCgogICAgZGVmIF9fYm9vbF9fKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LnZlY3Rvcl9zdHJfX19ib29sX18oc2VsZikKCiAgICBkZWYgX19sZW5fXyhzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS52ZWN0b3Jfc3RyX19fbGVuX18oc2VsZikKCiAgICBkZWYgX19nZXRzbGljZV9fKHNlbGYsIGksIGopOgogICAgICAgIHJldHVybiBfb2RiX3B5LnZlY3Rvcl9zdHJfX19nZXRzbGljZV9fKHNlbGYsIGksIGopCgogICAgZGVmIF9fc2V0c2xpY2VfXyhzZWxmLCAqYXJncyk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkudmVjdG9yX3N0cl9fX3NldHNsaWNlX18oc2VsZiwgKmFyZ3MpCgogICAgZGVmIF9fZGVsc2xpY2VfXyhzZWxmLCBpLCBqKToKICAgICAgICByZXR1cm4gX29kYl9weS52ZWN0b3Jfc3RyX19fZGVsc2xpY2VfXyhzZWxmLCBpLCBqKQoKICAgIGRlZiBfX2RlbGl0ZW1fXyhzZWxmLCAqYXJncyk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkudmVjdG9yX3N0cl9fX2RlbGl0ZW1fXyhzZWxmLCAqYXJncykKCiAgICBkZWYgX19nZXRpdGVtX18oc2VsZiwgKmFyZ3MpOgogICAgICAgIHJldHVybiBfb2RiX3B5LnZlY3Rvcl9zdHJfX19nZXRpdGVtX18oc2VsZiwgKmFyZ3MpCgogICAgZGVmIF9fc2V0aXRlbV9fKHNlbGYsICphcmdzKToKICAgICAgICByZXR1cm4gX29kYl9weS52ZWN0b3Jfc3RyX19fc2V0aXRlbV9fKHNlbGYsICphcmdzKQoKICAgIGRlZiBwb3Aoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkudmVjdG9yX3N0cl9wb3Aoc2VsZikKCiAgICBkZWYgYXBwZW5kKHNlbGYsIHgpOgogICAgICAgIHJldHVybiBfb2RiX3B5LnZlY3Rvcl9zdHJfYXBwZW5kKHNlbGYsIHgpCgogICAgZGVmIGVtcHR5KHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LnZlY3Rvcl9zdHJfZW1wdHkoc2VsZikKCiAgICBkZWYgc2l6ZShzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS52ZWN0b3Jfc3RyX3NpemUoc2VsZikKCiAgICBkZWYgc3dhcChzZWxmLCB2KToKICAgICAgICByZXR1cm4gX29kYl9weS52ZWN0b3Jfc3RyX3N3YXAoc2VsZiwgdikKCiAgICBkZWYgYmVnaW4oc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkudmVjdG9yX3N0cl9iZWdpbihzZWxmKQoKICAgIGRlZiBlbmQoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkudmVjdG9yX3N0cl9lbmQoc2VsZikKCiAgICBkZWYgcmJlZ2luKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LnZlY3Rvcl9zdHJfcmJlZ2luKHNlbGYpCgogICAgZGVmIHJlbmQoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkudmVjdG9yX3N0cl9yZW5kKHNlbGYpCgogICAgZGVmIGNsZWFyKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LnZlY3Rvcl9zdHJfY2xlYXIoc2VsZikKCiAgICBkZWYgZ2V0X2FsbG9jYXRvcihzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS52ZWN0b3Jfc3RyX2dldF9hbGxvY2F0b3Ioc2VsZikKCiAgICBkZWYgcG9wX2JhY2soc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkudmVjdG9yX3N0cl9wb3BfYmFjayhzZWxmKQoKICAgIGRlZiBlcmFzZShzZWxmLCAqYXJncyk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkudmVjdG9yX3N0cl9lcmFzZShzZWxmLCAqYXJncykKCiAgICBkZWYgX19pbml0X18oc2VsZiwgKmFyZ3MpOgogICAgICAgIF9vZGJfcHkudmVjdG9yX3N0cl9zd2lnaW5pdChzZWxmLCBfb2RiX3B5Lm5ld192ZWN0b3Jfc3RyKCphcmdzKSkKCiAgICBkZWYgcHVzaF9iYWNrKHNlbGYsIHgpOgogICAgICAgIHJldHVybiBfb2RiX3B5LnZlY3Rvcl9zdHJfcHVzaF9iYWNrKHNlbGYsIHgpCgogICAgZGVmIGZyb250KHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LnZlY3Rvcl9zdHJfZnJvbnQoc2VsZikKCiAgICBkZWYgYmFjayhzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS52ZWN0b3Jfc3RyX2JhY2soc2VsZikKCiAgICBkZWYgYXNzaWduKHNlbGYsIG4sIHgpOgogICAgICAgIHJldHVybiBfb2RiX3B5LnZlY3Rvcl9zdHJfYXNzaWduKHNlbGYsIG4sIHgpCgogICAgZGVmIHJlc2l6ZShzZWxmLCAqYXJncyk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkudmVjdG9yX3N0cl9yZXNpemUoc2VsZiwgKmFyZ3MpCgogICAgZGVmIGluc2VydChzZWxmLCAqYXJncyk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkudmVjdG9yX3N0cl9pbnNlcnQoc2VsZiwgKmFyZ3MpCgogICAgZGVmIHJlc2VydmUoc2VsZiwgbik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkudmVjdG9yX3N0cl9yZXNlcnZlKHNlbGYsIG4pCgogICAgZGVmIGNhcGFjaXR5KHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LnZlY3Rvcl9zdHJfY2FwYWNpdHkoc2VsZikKICAgIF9fc3dpZ19kZXN0cm95X18gPSBfb2RiX3B5LmRlbGV0ZV92ZWN0b3Jfc3RyCgojIFJlZ2lzdGVyIHZlY3Rvcl9zdHIgaW4gX29kYl9weToKX29kYl9weS52ZWN0b3Jfc3RyX3N3aWdyZWdpc3Rlcih2ZWN0b3Jfc3RyKQoKY2xhc3MgUG9pbnQob2JqZWN0KToKICAgIHRoaXNvd24gPSBwcm9wZXJ0eShsYW1iZGEgeDogeC50aGlzLm93bigpLCBsYW1iZGEgeCwgdjogeC50aGlzLm93bih2KSwgZG9jPSdUaGUgbWVtYmVyc2hpcCBmbGFnJykKICAgIF9fcmVwcl9fID0gX3N3aWdfcmVwcgoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCAqYXJncyk6CiAgICAgICAgX29kYl9weS5Qb2ludF9zd2lnaW5pdChzZWxmLCBfb2RiX3B5Lm5ld19Qb2ludCgqYXJncykpCiAgICBfX3N3aWdfZGVzdHJveV9fID0gX29kYl9weS5kZWxldGVfUG9pbnQKCiAgICBkZWYgYXNzaWduKHNlbGYsIHJocyk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuUG9pbnRfYXNzaWduKHNlbGYsIHJocykKCiAgICBkZWYgX19lcV9fKHNlbGYsIHJocyk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuUG9pbnRfX19lcV9fKHNlbGYsIHJocykKCiAgICBkZWYgX19uZV9fKHNlbGYsIHJocyk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuUG9pbnRfX19uZV9fKHNlbGYsIHJocykKCiAgICBkZWYgX19sdF9fKHNlbGYsIHJocyk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuUG9pbnRfX19sdF9fKHNlbGYsIHJocykKCiAgICBkZWYgX19nZV9fKHNlbGYsIHJocyk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuUG9pbnRfX19nZV9fKHNlbGYsIHJocykKCiAgICBkZWYgZ2V0WChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5Qb2ludF9nZXRYKHNlbGYpCgogICAgZGVmIGdldFkoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuUG9pbnRfZ2V0WShzZWxmKQoKICAgIGRlZiBzZXRYKHNlbGYsIHgpOgogICAgICAgIHJldHVybiBfb2RiX3B5LlBvaW50X3NldFgoc2VsZiwgeCkKCiAgICBkZWYgc2V0WShzZWxmLCB5KToKICAgICAgICByZXR1cm4gX29kYl9weS5Qb2ludF9zZXRZKHNlbGYsIHkpCgogICAgZGVmIGFkZFgoc2VsZiwgeCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuUG9pbnRfYWRkWChzZWxmLCB4KQoKICAgIGRlZiBhZGRZKHNlbGYsIHkpOgogICAgICAgIHJldHVybiBfb2RiX3B5LlBvaW50X2FkZFkoc2VsZiwgeSkKCiAgICBkZWYgcm90YXRlOTAoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuUG9pbnRfcm90YXRlOTAoc2VsZikKCiAgICBkZWYgcm90YXRlMTgwKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LlBvaW50X3JvdGF0ZTE4MChzZWxmKQoKICAgIGRlZiByb3RhdGUyNzAoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuUG9pbnRfcm90YXRlMjcwKHNlbGYpCgogICAgZGVmIHgoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuUG9pbnRfeChzZWxmKQoKICAgIGRlZiB5KHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LlBvaW50X3koc2VsZikKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgc3F1YXJlZERpc3RhbmNlKHAwLCBwMSk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuUG9pbnRfc3F1YXJlZERpc3RhbmNlKHAwLCBwMSkKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgbWFuaGF0dGFuRGlzdGFuY2UocDAsIHAxKToKICAgICAgICByZXR1cm4gX29kYl9weS5Qb2ludF9tYW5oYXR0YW5EaXN0YW5jZShwMCwgcDEpCgojIFJlZ2lzdGVyIFBvaW50IGluIF9vZGJfcHk6Cl9vZGJfcHkuUG9pbnRfc3dpZ3JlZ2lzdGVyKFBvaW50KQoKZGVmIFBvaW50X3NxdWFyZWREaXN0YW5jZShwMCwgcDEpOgogICAgcmV0dXJuIF9vZGJfcHkuUG9pbnRfc3F1YXJlZERpc3RhbmNlKHAwLCBwMSkKCmRlZiBQb2ludF9tYW5oYXR0YW5EaXN0YW5jZShwMCwgcDEpOgogICAgcmV0dXJuIF9vZGJfcHkuUG9pbnRfbWFuaGF0dGFuRGlzdGFuY2UocDAsIHAxKQoKY2xhc3MgUG9pbnQzRChvYmplY3QpOgogICAgdGhpc293biA9IHByb3BlcnR5KGxhbWJkYSB4OiB4LnRoaXMub3duKCksIGxhbWJkYSB4LCB2OiB4LnRoaXMub3duKHYpLCBkb2M9J1RoZSBtZW1iZXJzaGlwIGZsYWcnKQogICAgX19yZXByX18gPSBfc3dpZ19yZXByCgogICAgZGVmIGFzc2lnbihzZWxmLCBhcmcyKToKICAgICAgICByZXR1cm4gX29kYl9weS5Qb2ludDNEX2Fzc2lnbihzZWxmLCBhcmcyKQoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCAqYXJncyk6CiAgICAgICAgX29kYl9weS5Qb2ludDNEX3N3aWdpbml0KHNlbGYsIF9vZGJfcHkubmV3X1BvaW50M0QoKmFyZ3MpKQoKICAgIGRlZiBfX2VxX18oc2VsZiwgcmhzKToKICAgICAgICByZXR1cm4gX29kYl9weS5Qb2ludDNEX19fZXFfXyhzZWxmLCByaHMpCgogICAgZGVmIF9fbmVfXyhzZWxmLCByaHMpOgogICAgICAgIHJldHVybiBfb2RiX3B5LlBvaW50M0RfX19uZV9fKHNlbGYsIHJocykKCiAgICBkZWYgX19sdF9fKHNlbGYsIHJocyk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuUG9pbnQzRF9fX2x0X18oc2VsZiwgcmhzKQoKICAgIGRlZiBfX2dlX18oc2VsZiwgcmhzKToKICAgICAgICByZXR1cm4gX29kYl9weS5Qb2ludDNEX19fZ2VfXyhzZWxmLCByaHMpCgogICAgZGVmIHooc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuUG9pbnQzRF96KHNlbGYpCgogICAgZGVmIHNldFooc2VsZiwgeik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuUG9pbnQzRF9zZXRaKHNlbGYsIHopCgogICAgZGVmIHgoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuUG9pbnQzRF94KHNlbGYpCgogICAgZGVmIHNldFgoc2VsZiwgeCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuUG9pbnQzRF9zZXRYKHNlbGYsIHgpCgogICAgZGVmIHkoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuUG9pbnQzRF95KHNlbGYpCgogICAgZGVmIHNldFkoc2VsZiwgeSk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuUG9pbnQzRF9zZXRZKHNlbGYsIHkpCgogICAgZGVmIHNldChzZWxmLCB4LCB5LCB6KToKICAgICAgICByZXR1cm4gX29kYl9weS5Qb2ludDNEX3NldChzZWxmLCB4LCB5LCB6KQogICAgX19zd2lnX2Rlc3Ryb3lfXyA9IF9vZGJfcHkuZGVsZXRlX1BvaW50M0QKCiMgUmVnaXN0ZXIgUG9pbnQzRCBpbiBfb2RiX3B5Ogpfb2RiX3B5LlBvaW50M0Rfc3dpZ3JlZ2lzdGVyKFBvaW50M0QpCgpjbGFzcyBPY3Qob2JqZWN0KToKICAgIHRoaXNvd24gPSBwcm9wZXJ0eShsYW1iZGEgeDogeC50aGlzLm93bigpLCBsYW1iZGEgeCwgdjogeC50aGlzLm93bih2KSwgZG9jPSdUaGUgbWVtYmVyc2hpcCBmbGFnJykKICAgIF9fcmVwcl9fID0gX3N3aWdfcmVwcgogICAgUklHSFQgPSBfb2RiX3B5Lk9jdF9SSUdIVAogICAgTEVGVCA9IF9vZGJfcHkuT2N0X0xFRlQKICAgIFVOS05PV04gPSBfb2RiX3B5Lk9jdF9VTktOT1dOCgogICAgZGVmIF9faW5pdF9fKHNlbGYsICphcmdzKToKICAgICAgICBfb2RiX3B5Lk9jdF9zd2lnaW5pdChzZWxmLCBfb2RiX3B5Lm5ld19PY3QoKmFyZ3MpKQogICAgX19zd2lnX2Rlc3Ryb3lfXyA9IF9vZGJfcHkuZGVsZXRlX09jdAoKICAgIGRlZiBhc3NpZ24oc2VsZiwgcik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuT2N0X2Fzc2lnbihzZWxmLCByKQoKICAgIGRlZiBfX2VxX18oc2VsZiwgcik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuT2N0X19fZXFfXyhzZWxmLCByKQoKICAgIGRlZiBfX25lX18oc2VsZiwgcik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuT2N0X19fbmVfXyhzZWxmLCByKQoKICAgIGRlZiBpbml0KHNlbGYsIHAxLCBwMiwgd2lkdGgpOgogICAgICAgIHJldHVybiBfb2RiX3B5Lk9jdF9pbml0KHNlbGYsIHAxLCBwMiwgd2lkdGgpCgogICAgZGVmIGdldERpcihzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5PY3RfZ2V0RGlyKHNlbGYpCgogICAgZGVmIGdldENlbnRlckhpZ2goc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuT2N0X2dldENlbnRlckhpZ2goc2VsZikKCiAgICBkZWYgZ2V0Q2VudGVyTG93KHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5Lk9jdF9nZXRDZW50ZXJMb3coc2VsZikKCiAgICBkZWYgZ2V0V2lkdGgoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuT2N0X2dldFdpZHRoKHNlbGYpCgogICAgZGVmIGR4KHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5Lk9jdF9keChzZWxmKQoKICAgIGRlZiBkeShzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5PY3RfZHkoc2VsZikKCiAgICBkZWYgeE1pbihzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5PY3RfeE1pbihzZWxmKQoKICAgIGRlZiB5TWluKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5Lk9jdF95TWluKHNlbGYpCgogICAgZGVmIHhNYXgoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuT2N0X3hNYXgoc2VsZikKCiAgICBkZWYgeU1heChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5PY3RfeU1heChzZWxmKQoKICAgIGRlZiBnZXRQb2ludHMoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuT2N0X2dldFBvaW50cyhzZWxmKQoKICAgIGRlZiBibG9hdChzZWxmLCBtYXJnaW4pOgogICAgICAgIHJldHVybiBfb2RiX3B5Lk9jdF9ibG9hdChzZWxmLCBtYXJnaW4pCgogICAgZGVmIGdldEVuY2xvc2luZ1JlY3Qoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuT2N0X2dldEVuY2xvc2luZ1JlY3Qoc2VsZikKCiMgUmVnaXN0ZXIgT2N0IGluIF9vZGJfcHk6Cl9vZGJfcHkuT2N0X3N3aWdyZWdpc3RlcihPY3QpCgpjbGFzcyBSZWN0KG9iamVjdCk6CiAgICB0aGlzb3duID0gcHJvcGVydHkobGFtYmRhIHg6IHgudGhpcy5vd24oKSwgbGFtYmRhIHgsIHY6IHgudGhpcy5vd24odiksIGRvYz0nVGhlIG1lbWJlcnNoaXAgZmxhZycpCiAgICBfX3JlcHJfXyA9IF9zd2lnX3JlcHIKCiAgICBkZWYgX19pbml0X18oc2VsZiwgKmFyZ3MpOgogICAgICAgIF9vZGJfcHkuUmVjdF9zd2lnaW5pdChzZWxmLCBfb2RiX3B5Lm5ld19SZWN0KCphcmdzKSkKCiAgICBkZWYgYXNzaWduKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LlJlY3RfYXNzaWduKHNlbGYpCgogICAgZGVmIF9fZXFfXyhzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5SZWN0X19fZXFfXyhzZWxmKQoKICAgIGRlZiBfX25lX18oc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuUmVjdF9fX25lX18oc2VsZikKCiAgICBkZWYgX19sdF9fKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LlJlY3RfX19sdF9fKHNlbGYpCgogICAgZGVmIF9fZ3RfXyhzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5SZWN0X19fZ3RfXyhzZWxmKQoKICAgIGRlZiBfX2xlX18oc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuUmVjdF9fX2xlX18oc2VsZikKCiAgICBkZWYgX19nZV9fKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LlJlY3RfX19nZV9fKHNlbGYpCgogICAgZGVmIGluaXQoc2VsZiwgeDEsIHkxLCB4MiwgeTIpOgogICAgICAgIHJldHVybiBfb2RiX3B5LlJlY3RfaW5pdChzZWxmLCB4MSwgeTEsIHgyLCB5MikKCiAgICBkZWYgcmVzZXQoc2VsZiwgeDEsIHkxLCB4MiwgeTIpOgogICAgICAgIHJldHVybiBfb2RiX3B5LlJlY3RfcmVzZXQoc2VsZiwgeDEsIHkxLCB4MiwgeTIpCgogICAgZGVmIG1vdmVUbyhzZWxmLCB4LCB5KToKICAgICAgICByZXR1cm4gX29kYl9weS5SZWN0X21vdmVUbyhzZWxmLCB4LCB5KQoKICAgIGRlZiBtb3ZlRGVsdGEoc2VsZiwgZHgsIGR5KToKICAgICAgICByZXR1cm4gX29kYl9weS5SZWN0X21vdmVEZWx0YShzZWxmLCBkeCwgZHkpCgogICAgZGVmIG1lcmdlSW5pdChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5SZWN0X21lcmdlSW5pdChzZWxmKQoKICAgIGRlZiBpc0ludmVydGVkKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LlJlY3RfaXNJbnZlcnRlZChzZWxmKQoKICAgIGRlZiBtaW5EWERZKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LlJlY3RfbWluRFhEWShzZWxmKQoKICAgIGRlZiBtYXhEWERZKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LlJlY3RfbWF4RFhEWShzZWxmKQoKICAgIGRlZiBnZXREaXIoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuUmVjdF9nZXREaXIoc2VsZikKCiAgICBkZWYgc2V0X3hsbyhzZWxmLCB4KToKICAgICAgICByZXR1cm4gX29kYl9weS5SZWN0X3NldF94bG8oc2VsZiwgeCkKCiAgICBkZWYgc2V0X3hoaShzZWxmLCB4KToKICAgICAgICByZXR1cm4gX29kYl9weS5SZWN0X3NldF94aGkoc2VsZiwgeCkKCiAgICBkZWYgc2V0X3lsbyhzZWxmLCB5KToKICAgICAgICByZXR1cm4gX29kYl9weS5SZWN0X3NldF95bG8oc2VsZiwgeSkKCiAgICBkZWYgc2V0X3loaShzZWxmLCB5KToKICAgICAgICByZXR1cm4gX29kYl9weS5SZWN0X3NldF95aGkoc2VsZiwgeSkKCiAgICBkZWYgeE1pbihzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5SZWN0X3hNaW4oc2VsZikKCiAgICBkZWYgeU1pbihzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5SZWN0X3lNaW4oc2VsZikKCiAgICBkZWYgeE1heChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5SZWN0X3hNYXgoc2VsZikKCiAgICBkZWYgeU1heChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5SZWN0X3lNYXgoc2VsZikKCiAgICBkZWYgZHgoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuUmVjdF9keChzZWxmKQoKICAgIGRlZiBkeShzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5SZWN0X2R5KHNlbGYpCgogICAgZGVmIHhDZW50ZXIoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuUmVjdF94Q2VudGVyKHNlbGYpCgogICAgZGVmIHlDZW50ZXIoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuUmVjdF95Q2VudGVyKHNlbGYpCgogICAgZGVmIGdldFBvaW50cyhzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5SZWN0X2dldFBvaW50cyhzZWxmKQoKICAgIGRlZiBsbChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5SZWN0X2xsKHNlbGYpCgogICAgZGVmIHVsKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LlJlY3RfdWwoc2VsZikKCiAgICBkZWYgdXIoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuUmVjdF91cihzZWxmKQoKICAgIGRlZiBscihzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5SZWN0X2xyKHNlbGYpCgogICAgZGVmIGNlbnRlcihzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5SZWN0X2NlbnRlcihzZWxmKQoKICAgIGRlZiBpbnRlcnNlY3RzKHNlbGYsICphcmdzKToKICAgICAgICByZXR1cm4gX29kYl9weS5SZWN0X2ludGVyc2VjdHMoc2VsZiwgKmFyZ3MpCgogICAgZGVmIG92ZXJsYXBzKHNlbGYsICphcmdzKToKICAgICAgICByZXR1cm4gX29kYl9weS5SZWN0X292ZXJsYXBzKHNlbGYsICphcmdzKQoKICAgIGRlZiBjb250YWlucyhzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5SZWN0X2NvbnRhaW5zKHNlbGYpCgogICAgZGVmIGluc2lkZShzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5SZWN0X2luc2lkZShzZWxmKQoKICAgIGRlZiBjbG9zZXN0UHRJbnNpZGUoc2VsZiwgcHQpOgogICAgICAgIHJldHVybiBfb2RiX3B5LlJlY3RfY2xvc2VzdFB0SW5zaWRlKHNlbGYsIHB0KQoKICAgIGRlZiBtZXJnZShzZWxmLCAqYXJncyk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuUmVjdF9tZXJnZShzZWxmLCAqYXJncykKCiAgICBkZWYgYmxvYXQoc2VsZiwgbWFyZ2luLCByZXN1bHQpOgogICAgICAgIHJldHVybiBfb2RiX3B5LlJlY3RfYmxvYXQoc2VsZiwgbWFyZ2luLCByZXN1bHQpCgogICAgZGVmIGludGVyc2VjdGlvbihzZWxmLCByZXN1bHQpOgogICAgICAgIHJldHVybiBfb2RiX3B5LlJlY3RfaW50ZXJzZWN0aW9uKHNlbGYsIHJlc3VsdCkKCiAgICBkZWYgaW50ZXJzZWN0KHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LlJlY3RfaW50ZXJzZWN0KHNlbGYpCgogICAgZGVmIGFyZWEoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuUmVjdF9hcmVhKHNlbGYpCgogICAgZGVmIG1hcmdpbihzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5SZWN0X21hcmdpbihzZWxmKQoKICAgIGRlZiBwcmludGYoc2VsZiwgKmFyZ3MpOgogICAgICAgIHJldHVybiBfb2RiX3B5LlJlY3RfcHJpbnRmKHNlbGYsICphcmdzKQoKICAgIGRlZiBfcHJpbnQoc2VsZiwgKmFyZ3MpOgogICAgICAgIHJldHVybiBfb2RiX3B5LlJlY3RfX3ByaW50KHNlbGYsICphcmdzKQogICAgX19zd2lnX2Rlc3Ryb3lfXyA9IF9vZGJfcHkuZGVsZXRlX1JlY3QKCiMgUmVnaXN0ZXIgUmVjdCBpbiBfb2RiX3B5Ogpfb2RiX3B5LlJlY3Rfc3dpZ3JlZ2lzdGVyKFJlY3QpCgpjbGFzcyBQb2x5Z29uKG9iamVjdCk6CiAgICB0aGlzb3duID0gcHJvcGVydHkobGFtYmRhIHg6IHgudGhpcy5vd24oKSwgbGFtYmRhIHgsIHY6IHgudGhpcy5vd24odiksIGRvYz0nVGhlIG1lbWJlcnNoaXAgZmxhZycpCiAgICBfX3JlcHJfXyA9IF9zd2lnX3JlcHIKCiAgICBkZWYgYXNzaWduKHNlbGYsIGFyZzIpOgogICAgICAgIHJldHVybiBfb2RiX3B5LlBvbHlnb25fYXNzaWduKHNlbGYsIGFyZzIpCgogICAgZGVmIF9faW5pdF9fKHNlbGYsICphcmdzKToKICAgICAgICBfb2RiX3B5LlBvbHlnb25fc3dpZ2luaXQoc2VsZiwgX29kYl9weS5uZXdfUG9seWdvbigqYXJncykpCgogICAgZGVmIGdldFBvaW50cyhzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5Qb2x5Z29uX2dldFBvaW50cyhzZWxmKQoKICAgIGRlZiBzZXRQb2ludHMoc2VsZiwgcG9pbnRzKToKICAgICAgICByZXR1cm4gX29kYl9weS5Qb2x5Z29uX3NldFBvaW50cyhzZWxmLCBwb2ludHMpCgogICAgZGVmIF9fZXFfXyhzZWxmLCBwKToKICAgICAgICByZXR1cm4gX29kYl9weS5Qb2x5Z29uX19fZXFfXyhzZWxmLCBwKQoKICAgIGRlZiBfX25lX18oc2VsZiwgcCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuUG9seWdvbl9fX25lX18oc2VsZiwgcCkKCiAgICBkZWYgX19sdF9fKHNlbGYsIHApOgogICAgICAgIHJldHVybiBfb2RiX3B5LlBvbHlnb25fX19sdF9fKHNlbGYsIHApCgogICAgZGVmIF9fZ3RfXyhzZWxmLCBwKToKICAgICAgICByZXR1cm4gX29kYl9weS5Qb2x5Z29uX19fZ3RfXyhzZWxmLCBwKQoKICAgIGRlZiBfX2xlX18oc2VsZiwgcCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuUG9seWdvbl9fX2xlX18oc2VsZiwgcCkKCiAgICBkZWYgX19nZV9fKHNlbGYsIHApOgogICAgICAgIHJldHVybiBfb2RiX3B5LlBvbHlnb25fX19nZV9fKHNlbGYsIHApCgogICAgZGVmIGlzUmVjdChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5Qb2x5Z29uX2lzUmVjdChzZWxmKQoKICAgIGRlZiBnZXRFbmNsb3NpbmdSZWN0KHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LlBvbHlnb25fZ2V0RW5jbG9zaW5nUmVjdChzZWxmKQoKICAgIGRlZiBkeChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5Qb2x5Z29uX2R4KHNlbGYpCgogICAgZGVmIGR5KHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LlBvbHlnb25fZHkoc2VsZikKCiAgICBkZWYgYmxvYXQoc2VsZiwgbWFyZ2luKToKICAgICAgICByZXR1cm4gX29kYl9weS5Qb2x5Z29uX2Jsb2F0KHNlbGYsIG1hcmdpbikKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgbWVyZ2UoKmFyZ3MpOgogICAgICAgIHJldHVybiBfb2RiX3B5LlBvbHlnb25fbWVyZ2UoKmFyZ3MpCgogICAgZGVmIGRpZmZlcmVuY2Uoc2VsZiwgYik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuUG9seWdvbl9kaWZmZXJlbmNlKHNlbGYsIGIpCiAgICBfX3N3aWdfZGVzdHJveV9fID0gX29kYl9weS5kZWxldGVfUG9seWdvbgoKIyBSZWdpc3RlciBQb2x5Z29uIGluIF9vZGJfcHk6Cl9vZGJfcHkuUG9seWdvbl9zd2lncmVnaXN0ZXIoUG9seWdvbikKCmRlZiBQb2x5Z29uX21lcmdlKCphcmdzKToKICAgIHJldHVybiBfb2RiX3B5LlBvbHlnb25fbWVyZ2UoKmFyZ3MpCgpjbGFzcyBMaW5lKG9iamVjdCk6CiAgICB0aGlzb3duID0gcHJvcGVydHkobGFtYmRhIHg6IHgudGhpcy5vd24oKSwgbGFtYmRhIHgsIHY6IHgudGhpcy5vd24odiksIGRvYz0nVGhlIG1lbWJlcnNoaXAgZmxhZycpCiAgICBfX3JlcHJfXyA9IF9zd2lnX3JlcHIKCiAgICBkZWYgX19pbml0X18oc2VsZiwgKmFyZ3MpOgogICAgICAgIF9vZGJfcHkuTGluZV9zd2lnaW5pdChzZWxmLCBfb2RiX3B5Lm5ld19MaW5lKCphcmdzKSkKCiAgICBkZWYgYXNzaWduKHNlbGYsIHIpOgogICAgICAgIHJldHVybiBfb2RiX3B5LkxpbmVfYXNzaWduKHNlbGYsIHIpCgogICAgZGVmIF9fZXFfXyhzZWxmLCByKToKICAgICAgICByZXR1cm4gX29kYl9weS5MaW5lX19fZXFfXyhzZWxmLCByKQoKICAgIGRlZiBfX25lX18oc2VsZiwgcik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuTGluZV9fX25lX18oc2VsZiwgcikKCiAgICBkZWYgX19sdF9fKHNlbGYsIHIpOgogICAgICAgIHJldHVybiBfb2RiX3B5LkxpbmVfX19sdF9fKHNlbGYsIHIpCgogICAgZGVmIF9fZ3RfXyhzZWxmLCByKToKICAgICAgICByZXR1cm4gX29kYl9weS5MaW5lX19fZ3RfXyhzZWxmLCByKQoKICAgIGRlZiBfX2xlX18oc2VsZiwgcik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuTGluZV9fX2xlX18oc2VsZiwgcikKCiAgICBkZWYgX19nZV9fKHNlbGYsIHIpOgogICAgICAgIHJldHVybiBfb2RiX3B5LkxpbmVfX19nZV9fKHNlbGYsIHIpCgogICAgZGVmIGdldFBvaW50cyhzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5MaW5lX2dldFBvaW50cyhzZWxmKQoKICAgIGRlZiBwdDAoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuTGluZV9wdDAoc2VsZikKCiAgICBkZWYgcHQxKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LkxpbmVfcHQxKHNlbGYpCgogICAgZGVmIGFkZFgoc2VsZiwgdmFsdWUpOgogICAgICAgIHJldHVybiBfb2RiX3B5LkxpbmVfYWRkWChzZWxmLCB2YWx1ZSkKCiAgICBkZWYgYWRkWShzZWxmLCB2YWx1ZSk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuTGluZV9hZGRZKHNlbGYsIHZhbHVlKQogICAgX19zd2lnX2Rlc3Ryb3lfXyA9IF9vZGJfcHkuZGVsZXRlX0xpbmUKCiMgUmVnaXN0ZXIgTGluZSBpbiBfb2RiX3B5Ogpfb2RiX3B5LkxpbmVfc3dpZ3JlZ2lzdGVyKExpbmUpCgoKZGVmIG1hbmhhdHRhbkRpc3RhbmNlKHApOgogICAgcmV0dXJuIF9vZGJfcHkubWFuaGF0dGFuRGlzdGFuY2UocCkKY2xhc3MgUG9pbnRzKG9iamVjdCk6CiAgICB0aGlzb3duID0gcHJvcGVydHkobGFtYmRhIHg6IHgudGhpcy5vd24oKSwgbGFtYmRhIHgsIHY6IHgudGhpcy5vd24odiksIGRvYz0nVGhlIG1lbWJlcnNoaXAgZmxhZycpCiAgICBfX3JlcHJfXyA9IF9zd2lnX3JlcHIKCiAgICBkZWYgaXRlcmF0b3Ioc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuUG9pbnRzX2l0ZXJhdG9yKHNlbGYpCiAgICBkZWYgX19pdGVyX18oc2VsZik6CiAgICAgICAgcmV0dXJuIHNlbGYuaXRlcmF0b3IoKQoKICAgIGRlZiBfX25vbnplcm9fXyhzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5Qb2ludHNfX19ub256ZXJvX18oc2VsZikKCiAgICBkZWYgX19ib29sX18oc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuUG9pbnRzX19fYm9vbF9fKHNlbGYpCgogICAgZGVmIF9fbGVuX18oc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuUG9pbnRzX19fbGVuX18oc2VsZikKCiAgICBkZWYgX19nZXRzbGljZV9fKHNlbGYsIGksIGopOgogICAgICAgIHJldHVybiBfb2RiX3B5LlBvaW50c19fX2dldHNsaWNlX18oc2VsZiwgaSwgaikKCiAgICBkZWYgX19zZXRzbGljZV9fKHNlbGYsICphcmdzKToKICAgICAgICByZXR1cm4gX29kYl9weS5Qb2ludHNfX19zZXRzbGljZV9fKHNlbGYsICphcmdzKQoKICAgIGRlZiBfX2RlbHNsaWNlX18oc2VsZiwgaSwgaik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuUG9pbnRzX19fZGVsc2xpY2VfXyhzZWxmLCBpLCBqKQoKICAgIGRlZiBfX2RlbGl0ZW1fXyhzZWxmLCAqYXJncyk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuUG9pbnRzX19fZGVsaXRlbV9fKHNlbGYsICphcmdzKQoKICAgIGRlZiBfX2dldGl0ZW1fXyhzZWxmLCAqYXJncyk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuUG9pbnRzX19fZ2V0aXRlbV9fKHNlbGYsICphcmdzKQoKICAgIGRlZiBfX3NldGl0ZW1fXyhzZWxmLCAqYXJncyk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuUG9pbnRzX19fc2V0aXRlbV9fKHNlbGYsICphcmdzKQoKICAgIGRlZiBwb3Aoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuUG9pbnRzX3BvcChzZWxmKQoKICAgIGRlZiBhcHBlbmQoc2VsZiwgeCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuUG9pbnRzX2FwcGVuZChzZWxmLCB4KQoKICAgIGRlZiBlbXB0eShzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5Qb2ludHNfZW1wdHkoc2VsZikKCiAgICBkZWYgc2l6ZShzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5Qb2ludHNfc2l6ZShzZWxmKQoKICAgIGRlZiBzd2FwKHNlbGYsIHYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LlBvaW50c19zd2FwKHNlbGYsIHYpCgogICAgZGVmIGJlZ2luKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LlBvaW50c19iZWdpbihzZWxmKQoKICAgIGRlZiBlbmQoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuUG9pbnRzX2VuZChzZWxmKQoKICAgIGRlZiByYmVnaW4oc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuUG9pbnRzX3JiZWdpbihzZWxmKQoKICAgIGRlZiByZW5kKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LlBvaW50c19yZW5kKHNlbGYpCgogICAgZGVmIGNsZWFyKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LlBvaW50c19jbGVhcihzZWxmKQoKICAgIGRlZiBnZXRfYWxsb2NhdG9yKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LlBvaW50c19nZXRfYWxsb2NhdG9yKHNlbGYpCgogICAgZGVmIHBvcF9iYWNrKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LlBvaW50c19wb3BfYmFjayhzZWxmKQoKICAgIGRlZiBlcmFzZShzZWxmLCAqYXJncyk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuUG9pbnRzX2VyYXNlKHNlbGYsICphcmdzKQoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCAqYXJncyk6CiAgICAgICAgX29kYl9weS5Qb2ludHNfc3dpZ2luaXQoc2VsZiwgX29kYl9weS5uZXdfUG9pbnRzKCphcmdzKSkKCiAgICBkZWYgcHVzaF9iYWNrKHNlbGYsIHgpOgogICAgICAgIHJldHVybiBfb2RiX3B5LlBvaW50c19wdXNoX2JhY2soc2VsZiwgeCkKCiAgICBkZWYgZnJvbnQoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuUG9pbnRzX2Zyb250KHNlbGYpCgogICAgZGVmIGJhY2soc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuUG9pbnRzX2JhY2soc2VsZikKCiAgICBkZWYgYXNzaWduKHNlbGYsIG4sIHgpOgogICAgICAgIHJldHVybiBfb2RiX3B5LlBvaW50c19hc3NpZ24oc2VsZiwgbiwgeCkKCiAgICBkZWYgcmVzaXplKHNlbGYsICphcmdzKToKICAgICAgICByZXR1cm4gX29kYl9weS5Qb2ludHNfcmVzaXplKHNlbGYsICphcmdzKQoKICAgIGRlZiBpbnNlcnQoc2VsZiwgKmFyZ3MpOgogICAgICAgIHJldHVybiBfb2RiX3B5LlBvaW50c19pbnNlcnQoc2VsZiwgKmFyZ3MpCgogICAgZGVmIHJlc2VydmUoc2VsZiwgbik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuUG9pbnRzX3Jlc2VydmUoc2VsZiwgbikKCiAgICBkZWYgY2FwYWNpdHkoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuUG9pbnRzX2NhcGFjaXR5KHNlbGYpCiAgICBfX3N3aWdfZGVzdHJveV9fID0gX29kYl9weS5kZWxldGVfUG9pbnRzCgojIFJlZ2lzdGVyIFBvaW50cyBpbiBfb2RiX3B5Ogpfb2RiX3B5LlBvaW50c19zd2lncmVnaXN0ZXIoUG9pbnRzKQoKY2xhc3MgUmVjdHMob2JqZWN0KToKICAgIHRoaXNvd24gPSBwcm9wZXJ0eShsYW1iZGEgeDogeC50aGlzLm93bigpLCBsYW1iZGEgeCwgdjogeC50aGlzLm93bih2KSwgZG9jPSdUaGUgbWVtYmVyc2hpcCBmbGFnJykKICAgIF9fcmVwcl9fID0gX3N3aWdfcmVwcgoKICAgIGRlZiBpdGVyYXRvcihzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5SZWN0c19pdGVyYXRvcihzZWxmKQogICAgZGVmIF9faXRlcl9fKHNlbGYpOgogICAgICAgIHJldHVybiBzZWxmLml0ZXJhdG9yKCkKCiAgICBkZWYgX19ub256ZXJvX18oc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuUmVjdHNfX19ub256ZXJvX18oc2VsZikKCiAgICBkZWYgX19ib29sX18oc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuUmVjdHNfX19ib29sX18oc2VsZikKCiAgICBkZWYgX19sZW5fXyhzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5SZWN0c19fX2xlbl9fKHNlbGYpCgogICAgZGVmIF9fZ2V0c2xpY2VfXyhzZWxmLCBpLCBqKToKICAgICAgICByZXR1cm4gX29kYl9weS5SZWN0c19fX2dldHNsaWNlX18oc2VsZiwgaSwgaikKCiAgICBkZWYgX19zZXRzbGljZV9fKHNlbGYsICphcmdzKToKICAgICAgICByZXR1cm4gX29kYl9weS5SZWN0c19fX3NldHNsaWNlX18oc2VsZiwgKmFyZ3MpCgogICAgZGVmIF9fZGVsc2xpY2VfXyhzZWxmLCBpLCBqKToKICAgICAgICByZXR1cm4gX29kYl9weS5SZWN0c19fX2RlbHNsaWNlX18oc2VsZiwgaSwgaikKCiAgICBkZWYgX19kZWxpdGVtX18oc2VsZiwgKmFyZ3MpOgogICAgICAgIHJldHVybiBfb2RiX3B5LlJlY3RzX19fZGVsaXRlbV9fKHNlbGYsICphcmdzKQoKICAgIGRlZiBfX2dldGl0ZW1fXyhzZWxmLCAqYXJncyk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuUmVjdHNfX19nZXRpdGVtX18oc2VsZiwgKmFyZ3MpCgogICAgZGVmIF9fc2V0aXRlbV9fKHNlbGYsICphcmdzKToKICAgICAgICByZXR1cm4gX29kYl9weS5SZWN0c19fX3NldGl0ZW1fXyhzZWxmLCAqYXJncykKCiAgICBkZWYgcG9wKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LlJlY3RzX3BvcChzZWxmKQoKICAgIGRlZiBhcHBlbmQoc2VsZiwgeCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuUmVjdHNfYXBwZW5kKHNlbGYsIHgpCgogICAgZGVmIGVtcHR5KHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LlJlY3RzX2VtcHR5KHNlbGYpCgogICAgZGVmIHNpemUoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuUmVjdHNfc2l6ZShzZWxmKQoKICAgIGRlZiBzd2FwKHNlbGYsIHYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LlJlY3RzX3N3YXAoc2VsZiwgdikKCiAgICBkZWYgYmVnaW4oc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuUmVjdHNfYmVnaW4oc2VsZikKCiAgICBkZWYgZW5kKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LlJlY3RzX2VuZChzZWxmKQoKICAgIGRlZiByYmVnaW4oc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuUmVjdHNfcmJlZ2luKHNlbGYpCgogICAgZGVmIHJlbmQoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuUmVjdHNfcmVuZChzZWxmKQoKICAgIGRlZiBjbGVhcihzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5SZWN0c19jbGVhcihzZWxmKQoKICAgIGRlZiBnZXRfYWxsb2NhdG9yKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LlJlY3RzX2dldF9hbGxvY2F0b3Ioc2VsZikKCiAgICBkZWYgcG9wX2JhY2soc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuUmVjdHNfcG9wX2JhY2soc2VsZikKCiAgICBkZWYgZXJhc2Uoc2VsZiwgKmFyZ3MpOgogICAgICAgIHJldHVybiBfb2RiX3B5LlJlY3RzX2VyYXNlKHNlbGYsICphcmdzKQoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCAqYXJncyk6CiAgICAgICAgX29kYl9weS5SZWN0c19zd2lnaW5pdChzZWxmLCBfb2RiX3B5Lm5ld19SZWN0cygqYXJncykpCgogICAgZGVmIHB1c2hfYmFjayhzZWxmLCB4KToKICAgICAgICByZXR1cm4gX29kYl9weS5SZWN0c19wdXNoX2JhY2soc2VsZiwgeCkKCiAgICBkZWYgZnJvbnQoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuUmVjdHNfZnJvbnQoc2VsZikKCiAgICBkZWYgYmFjayhzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5SZWN0c19iYWNrKHNlbGYpCgogICAgZGVmIGFzc2lnbihzZWxmLCBuLCB4KToKICAgICAgICByZXR1cm4gX29kYl9weS5SZWN0c19hc3NpZ24oc2VsZiwgbiwgeCkKCiAgICBkZWYgcmVzaXplKHNlbGYsICphcmdzKToKICAgICAgICByZXR1cm4gX29kYl9weS5SZWN0c19yZXNpemUoc2VsZiwgKmFyZ3MpCgogICAgZGVmIGluc2VydChzZWxmLCAqYXJncyk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuUmVjdHNfaW5zZXJ0KHNlbGYsICphcmdzKQoKICAgIGRlZiByZXNlcnZlKHNlbGYsIG4pOgogICAgICAgIHJldHVybiBfb2RiX3B5LlJlY3RzX3Jlc2VydmUoc2VsZiwgbikKCiAgICBkZWYgY2FwYWNpdHkoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuUmVjdHNfY2FwYWNpdHkoc2VsZikKICAgIF9fc3dpZ19kZXN0cm95X18gPSBfb2RiX3B5LmRlbGV0ZV9SZWN0cwoKIyBSZWdpc3RlciBSZWN0cyBpbiBfb2RiX3B5Ogpfb2RiX3B5LlJlY3RzX3N3aWdyZWdpc3RlcihSZWN0cykKCmNsYXNzIFBvbHlnb245MFNldChvYmplY3QpOgogICAgdGhpc293biA9IHByb3BlcnR5KGxhbWJkYSB4OiB4LnRoaXMub3duKCksIGxhbWJkYSB4LCB2OiB4LnRoaXMub3duKHYpLCBkb2M9J1RoZSBtZW1iZXJzaGlwIGZsYWcnKQogICAgX19yZXByX18gPSBfc3dpZ19yZXByCgogICAgZGVmIGl0ZXJhdG9yKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LlBvbHlnb245MFNldF9pdGVyYXRvcihzZWxmKQogICAgZGVmIF9faXRlcl9fKHNlbGYpOgogICAgICAgIHJldHVybiBzZWxmLml0ZXJhdG9yKCkKCiAgICBkZWYgX19ub256ZXJvX18oc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuUG9seWdvbjkwU2V0X19fbm9uemVyb19fKHNlbGYpCgogICAgZGVmIF9fYm9vbF9fKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LlBvbHlnb245MFNldF9fX2Jvb2xfXyhzZWxmKQoKICAgIGRlZiBfX2xlbl9fKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LlBvbHlnb245MFNldF9fX2xlbl9fKHNlbGYpCgogICAgZGVmIF9fZ2V0c2xpY2VfXyhzZWxmLCBpLCBqKToKICAgICAgICByZXR1cm4gX29kYl9weS5Qb2x5Z29uOTBTZXRfX19nZXRzbGljZV9fKHNlbGYsIGksIGopCgogICAgZGVmIF9fc2V0c2xpY2VfXyhzZWxmLCAqYXJncyk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuUG9seWdvbjkwU2V0X19fc2V0c2xpY2VfXyhzZWxmLCAqYXJncykKCiAgICBkZWYgX19kZWxzbGljZV9fKHNlbGYsIGksIGopOgogICAgICAgIHJldHVybiBfb2RiX3B5LlBvbHlnb245MFNldF9fX2RlbHNsaWNlX18oc2VsZiwgaSwgaikKCiAgICBkZWYgX19kZWxpdGVtX18oc2VsZiwgKmFyZ3MpOgogICAgICAgIHJldHVybiBfb2RiX3B5LlBvbHlnb245MFNldF9fX2RlbGl0ZW1fXyhzZWxmLCAqYXJncykKCiAgICBkZWYgX19nZXRpdGVtX18oc2VsZiwgKmFyZ3MpOgogICAgICAgIHJldHVybiBfb2RiX3B5LlBvbHlnb245MFNldF9fX2dldGl0ZW1fXyhzZWxmLCAqYXJncykKCiAgICBkZWYgX19zZXRpdGVtX18oc2VsZiwgKmFyZ3MpOgogICAgICAgIHJldHVybiBfb2RiX3B5LlBvbHlnb245MFNldF9fX3NldGl0ZW1fXyhzZWxmLCAqYXJncykKCiAgICBkZWYgcG9wKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LlBvbHlnb245MFNldF9wb3Aoc2VsZikKCiAgICBkZWYgYXBwZW5kKHNlbGYsIHgpOgogICAgICAgIHJldHVybiBfb2RiX3B5LlBvbHlnb245MFNldF9hcHBlbmQoc2VsZiwgeCkKCiAgICBkZWYgZW1wdHkoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuUG9seWdvbjkwU2V0X2VtcHR5KHNlbGYpCgogICAgZGVmIHNpemUoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuUG9seWdvbjkwU2V0X3NpemUoc2VsZikKCiAgICBkZWYgc3dhcChzZWxmLCB2KToKICAgICAgICByZXR1cm4gX29kYl9weS5Qb2x5Z29uOTBTZXRfc3dhcChzZWxmLCB2KQoKICAgIGRlZiBiZWdpbihzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5Qb2x5Z29uOTBTZXRfYmVnaW4oc2VsZikKCiAgICBkZWYgZW5kKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LlBvbHlnb245MFNldF9lbmQoc2VsZikKCiAgICBkZWYgcmJlZ2luKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LlBvbHlnb245MFNldF9yYmVnaW4oc2VsZikKCiAgICBkZWYgcmVuZChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5Qb2x5Z29uOTBTZXRfcmVuZChzZWxmKQoKICAgIGRlZiBjbGVhcihzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5Qb2x5Z29uOTBTZXRfY2xlYXIoc2VsZikKCiAgICBkZWYgZ2V0X2FsbG9jYXRvcihzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5Qb2x5Z29uOTBTZXRfZ2V0X2FsbG9jYXRvcihzZWxmKQoKICAgIGRlZiBwb3BfYmFjayhzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5Qb2x5Z29uOTBTZXRfcG9wX2JhY2soc2VsZikKCiAgICBkZWYgZXJhc2Uoc2VsZiwgKmFyZ3MpOgogICAgICAgIHJldHVybiBfb2RiX3B5LlBvbHlnb245MFNldF9lcmFzZShzZWxmLCAqYXJncykKCiAgICBkZWYgX19pbml0X18oc2VsZiwgKmFyZ3MpOgogICAgICAgIF9vZGJfcHkuUG9seWdvbjkwU2V0X3N3aWdpbml0KHNlbGYsIF9vZGJfcHkubmV3X1BvbHlnb245MFNldCgqYXJncykpCgogICAgZGVmIHB1c2hfYmFjayhzZWxmLCB4KToKICAgICAgICByZXR1cm4gX29kYl9weS5Qb2x5Z29uOTBTZXRfcHVzaF9iYWNrKHNlbGYsIHgpCgogICAgZGVmIGZyb250KHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LlBvbHlnb245MFNldF9mcm9udChzZWxmKQoKICAgIGRlZiBiYWNrKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LlBvbHlnb245MFNldF9iYWNrKHNlbGYpCgogICAgZGVmIGFzc2lnbihzZWxmLCBuLCB4KToKICAgICAgICByZXR1cm4gX29kYl9weS5Qb2x5Z29uOTBTZXRfYXNzaWduKHNlbGYsIG4sIHgpCgogICAgZGVmIHJlc2l6ZShzZWxmLCAqYXJncyk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuUG9seWdvbjkwU2V0X3Jlc2l6ZShzZWxmLCAqYXJncykKCiAgICBkZWYgaW5zZXJ0KHNlbGYsICphcmdzKToKICAgICAgICByZXR1cm4gX29kYl9weS5Qb2x5Z29uOTBTZXRfaW5zZXJ0KHNlbGYsICphcmdzKQoKICAgIGRlZiByZXNlcnZlKHNlbGYsIG4pOgogICAgICAgIHJldHVybiBfb2RiX3B5LlBvbHlnb245MFNldF9yZXNlcnZlKHNlbGYsIG4pCgogICAgZGVmIGNhcGFjaXR5KHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LlBvbHlnb245MFNldF9jYXBhY2l0eShzZWxmKQogICAgX19zd2lnX2Rlc3Ryb3lfXyA9IF9vZGJfcHkuZGVsZXRlX1BvbHlnb245MFNldAoKIyBSZWdpc3RlciBQb2x5Z29uOTBTZXQgaW4gX29kYl9weToKX29kYl9weS5Qb2x5Z29uOTBTZXRfc3dpZ3JlZ2lzdGVyKFBvbHlnb245MFNldCkKCmNsYXNzIFBvbHlnb245MFNldHMob2JqZWN0KToKICAgIHRoaXNvd24gPSBwcm9wZXJ0eShsYW1iZGEgeDogeC50aGlzLm93bigpLCBsYW1iZGEgeCwgdjogeC50aGlzLm93bih2KSwgZG9jPSdUaGUgbWVtYmVyc2hpcCBmbGFnJykKICAgIF9fcmVwcl9fID0gX3N3aWdfcmVwcgoKICAgIGRlZiBpdGVyYXRvcihzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5Qb2x5Z29uOTBTZXRzX2l0ZXJhdG9yKHNlbGYpCiAgICBkZWYgX19pdGVyX18oc2VsZik6CiAgICAgICAgcmV0dXJuIHNlbGYuaXRlcmF0b3IoKQoKICAgIGRlZiBfX25vbnplcm9fXyhzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5Qb2x5Z29uOTBTZXRzX19fbm9uemVyb19fKHNlbGYpCgogICAgZGVmIF9fYm9vbF9fKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LlBvbHlnb245MFNldHNfX19ib29sX18oc2VsZikKCiAgICBkZWYgX19sZW5fXyhzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5Qb2x5Z29uOTBTZXRzX19fbGVuX18oc2VsZikKCiAgICBkZWYgX19nZXRzbGljZV9fKHNlbGYsIGksIGopOgogICAgICAgIHJldHVybiBfb2RiX3B5LlBvbHlnb245MFNldHNfX19nZXRzbGljZV9fKHNlbGYsIGksIGopCgogICAgZGVmIF9fc2V0c2xpY2VfXyhzZWxmLCAqYXJncyk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuUG9seWdvbjkwU2V0c19fX3NldHNsaWNlX18oc2VsZiwgKmFyZ3MpCgogICAgZGVmIF9fZGVsc2xpY2VfXyhzZWxmLCBpLCBqKToKICAgICAgICByZXR1cm4gX29kYl9weS5Qb2x5Z29uOTBTZXRzX19fZGVsc2xpY2VfXyhzZWxmLCBpLCBqKQoKICAgIGRlZiBfX2RlbGl0ZW1fXyhzZWxmLCAqYXJncyk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuUG9seWdvbjkwU2V0c19fX2RlbGl0ZW1fXyhzZWxmLCAqYXJncykKCiAgICBkZWYgX19nZXRpdGVtX18oc2VsZiwgKmFyZ3MpOgogICAgICAgIHJldHVybiBfb2RiX3B5LlBvbHlnb245MFNldHNfX19nZXRpdGVtX18oc2VsZiwgKmFyZ3MpCgogICAgZGVmIF9fc2V0aXRlbV9fKHNlbGYsICphcmdzKToKICAgICAgICByZXR1cm4gX29kYl9weS5Qb2x5Z29uOTBTZXRzX19fc2V0aXRlbV9fKHNlbGYsICphcmdzKQoKICAgIGRlZiBwb3Aoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuUG9seWdvbjkwU2V0c19wb3Aoc2VsZikKCiAgICBkZWYgYXBwZW5kKHNlbGYsIHgpOgogICAgICAgIHJldHVybiBfb2RiX3B5LlBvbHlnb245MFNldHNfYXBwZW5kKHNlbGYsIHgpCgogICAgZGVmIGVtcHR5KHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LlBvbHlnb245MFNldHNfZW1wdHkoc2VsZikKCiAgICBkZWYgc2l6ZShzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5Qb2x5Z29uOTBTZXRzX3NpemUoc2VsZikKCiAgICBkZWYgc3dhcChzZWxmLCB2KToKICAgICAgICByZXR1cm4gX29kYl9weS5Qb2x5Z29uOTBTZXRzX3N3YXAoc2VsZiwgdikKCiAgICBkZWYgYmVnaW4oc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuUG9seWdvbjkwU2V0c19iZWdpbihzZWxmKQoKICAgIGRlZiBlbmQoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuUG9seWdvbjkwU2V0c19lbmQoc2VsZikKCiAgICBkZWYgcmJlZ2luKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LlBvbHlnb245MFNldHNfcmJlZ2luKHNlbGYpCgogICAgZGVmIHJlbmQoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuUG9seWdvbjkwU2V0c19yZW5kKHNlbGYpCgogICAgZGVmIGNsZWFyKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LlBvbHlnb245MFNldHNfY2xlYXIoc2VsZikKCiAgICBkZWYgZ2V0X2FsbG9jYXRvcihzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5Qb2x5Z29uOTBTZXRzX2dldF9hbGxvY2F0b3Ioc2VsZikKCiAgICBkZWYgcG9wX2JhY2soc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuUG9seWdvbjkwU2V0c19wb3BfYmFjayhzZWxmKQoKICAgIGRlZiBlcmFzZShzZWxmLCAqYXJncyk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuUG9seWdvbjkwU2V0c19lcmFzZShzZWxmLCAqYXJncykKCiAgICBkZWYgX19pbml0X18oc2VsZiwgKmFyZ3MpOgogICAgICAgIF9vZGJfcHkuUG9seWdvbjkwU2V0c19zd2lnaW5pdChzZWxmLCBfb2RiX3B5Lm5ld19Qb2x5Z29uOTBTZXRzKCphcmdzKSkKCiAgICBkZWYgcHVzaF9iYWNrKHNlbGYsIHgpOgogICAgICAgIHJldHVybiBfb2RiX3B5LlBvbHlnb245MFNldHNfcHVzaF9iYWNrKHNlbGYsIHgpCgogICAgZGVmIGZyb250KHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LlBvbHlnb245MFNldHNfZnJvbnQoc2VsZikKCiAgICBkZWYgYmFjayhzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5Qb2x5Z29uOTBTZXRzX2JhY2soc2VsZikKCiAgICBkZWYgYXNzaWduKHNlbGYsIG4sIHgpOgogICAgICAgIHJldHVybiBfb2RiX3B5LlBvbHlnb245MFNldHNfYXNzaWduKHNlbGYsIG4sIHgpCgogICAgZGVmIHJlc2l6ZShzZWxmLCAqYXJncyk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuUG9seWdvbjkwU2V0c19yZXNpemUoc2VsZiwgKmFyZ3MpCgogICAgZGVmIGluc2VydChzZWxmLCAqYXJncyk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuUG9seWdvbjkwU2V0c19pbnNlcnQoc2VsZiwgKmFyZ3MpCgogICAgZGVmIHJlc2VydmUoc2VsZiwgbik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuUG9seWdvbjkwU2V0c19yZXNlcnZlKHNlbGYsIG4pCgogICAgZGVmIGNhcGFjaXR5KHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LlBvbHlnb245MFNldHNfY2FwYWNpdHkoc2VsZikKICAgIF9fc3dpZ19kZXN0cm95X18gPSBfb2RiX3B5LmRlbGV0ZV9Qb2x5Z29uOTBTZXRzCgojIFJlZ2lzdGVyIFBvbHlnb245MFNldHMgaW4gX29kYl9weToKX29kYl9weS5Qb2x5Z29uOTBTZXRzX3N3aWdyZWdpc3RlcihQb2x5Z29uOTBTZXRzKQoKCmRlZiBuZXdTZXRGcm9tUmVjdCh4TG8sIHlMbywgeEhpLCB5SGkpOgogICAgcmV0dXJuIF9vZGJfcHkubmV3U2V0RnJvbVJlY3QoeExvLCB5TG8sIHhIaSwgeUhpKQoKZGVmIGdldFBvaW50cyhwb2x5Z29uKToKICAgIHJldHVybiBfb2RiX3B5LmdldFBvaW50cyhwb2x5Z29uKQoKZGVmIGdldFBvbHlnb25zKHNldCk6CiAgICByZXR1cm4gX29kYl9weS5nZXRQb2x5Z29ucyhzZXQpCgpkZWYgZ2V0UmVjdGFuZ2xlcyhzZXQpOgogICAgcmV0dXJuIF9vZGJfcHkuZ2V0UmVjdGFuZ2xlcyhzZXQpCgpkZWYgYmxvYXRTZXQoKmFyZ3MpOgogICAgcmV0dXJuIF9vZGJfcHkuYmxvYXRTZXQoKmFyZ3MpCgpkZWYgc2hyaW5rU2V0KCphcmdzKToKICAgIHJldHVybiBfb2RiX3B5LnNocmlua1NldCgqYXJncykKCmRlZiBhbmRTZXQoc2V0MSwgc2V0Mik6CiAgICByZXR1cm4gX29kYl9weS5hbmRTZXQoc2V0MSwgc2V0MikKCmRlZiBvclNldChzZXQxLCBzZXQyKToKICAgIHJldHVybiBfb2RiX3B5Lm9yU2V0KHNldDEsIHNldDIpCgpkZWYgb3JTZXRzKHNldHMpOgogICAgcmV0dXJuIF9vZGJfcHkub3JTZXRzKHNldHMpCgpkZWYgc3VidHJhY3RTZXQoc2V0MSwgc2V0Mik6CiAgICByZXR1cm4gX29kYl9weS5zdWJ0cmFjdFNldChzZXQxLCBzZXQyKQoKZGVmIGRlc3Ryb3lTZXQoc2V0KToKICAgIHJldHVybiBfb2RiX3B5LmRlc3Ryb3lTZXQoc2V0KQoKZGVmIGRlc3Ryb3lQb2x5Z29uKHBvbHlnb24pOgogICAgcmV0dXJuIF9vZGJfcHkuZGVzdHJveVBvbHlnb24ocG9seWdvbikKY2xhc3MgZGJCb3gob2JqZWN0KToKICAgIHRoaXNvd24gPSBwcm9wZXJ0eShsYW1iZGEgeDogeC50aGlzLm93bigpLCBsYW1iZGEgeCwgdjogeC50aGlzLm93bih2KSwgZG9jPSdUaGUgbWVtYmVyc2hpcCBmbGFnJykKICAgIF9fcmVwcl9fID0gX3N3aWdfcmVwcgoKICAgIGRlZiB4TWluKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQm94X3hNaW4oc2VsZikKCiAgICBkZWYgeU1pbihzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkJveF95TWluKHNlbGYpCgogICAgZGVmIHhNYXgoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJCb3hfeE1heChzZWxmKQoKICAgIGRlZiB5TWF4KHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQm94X3lNYXgoc2VsZikKCiAgICBkZWYgaXNWaWEoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJCb3hfaXNWaWEoc2VsZikKCiAgICBkZWYgZ2V0VGVjaFZpYShzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkJveF9nZXRUZWNoVmlhKHNlbGYpCgogICAgZGVmIGdldEJsb2NrVmlhKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQm94X2dldEJsb2NrVmlhKHNlbGYpCgogICAgZGVmIGdldFZpYVhZKHNlbGYsICphcmdzKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkJveF9nZXRWaWFYWShzZWxmLCAqYXJncykKCiAgICBkZWYgZ2V0VmlhQm94ZXMoc2VsZiwgc2hhcGVzKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkJveF9nZXRWaWFCb3hlcyhzZWxmLCBzaGFwZXMpCgogICAgZGVmIGdldFZpYUxheWVyQm94ZXMoc2VsZiwgbGF5ZXIsIHNoYXBlcyk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJCb3hfZ2V0VmlhTGF5ZXJCb3hlcyhzZWxmLCBsYXllciwgc2hhcGVzKQoKICAgIGRlZiBnZXREaXIoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJCb3hfZ2V0RGlyKHNlbGYpCgogICAgZGVmIGdldERYKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQm94X2dldERYKHNlbGYpCgogICAgZGVmIGdldERlc2lnblJ1bGVXaWR0aChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkJveF9nZXREZXNpZ25SdWxlV2lkdGgoc2VsZikKCiAgICBkZWYgc2V0RGVzaWduUnVsZVdpZHRoKHNlbGYsIGFyZzIpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQm94X3NldERlc2lnblJ1bGVXaWR0aChzZWxmLCBhcmcyKQoKICAgIGRlZiBnZXREWShzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkJveF9nZXREWShzZWxmKQoKICAgIGRlZiBnZXRXaWR0aChzZWxmLCBkaXI9MSk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJCb3hfZ2V0V2lkdGgoc2VsZiwgZGlyKQoKICAgIGRlZiBnZXRMZW5ndGgoc2VsZiwgZGlyPTEpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQm94X2dldExlbmd0aChzZWxmLCBkaXIpCgogICAgZGVmIHNldFZpc2l0ZWQoc2VsZiwgdmFsdWUpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQm94X3NldFZpc2l0ZWQoc2VsZiwgdmFsdWUpCgogICAgZGVmIGlzVmlzaXRlZChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkJveF9pc1Zpc2l0ZWQoc2VsZikKCiAgICBkZWYgZ2V0Qm94T3duZXIoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJCb3hfZ2V0Qm94T3duZXIoc2VsZikKCiAgICBkZWYgZ2V0T3duZXJUeXBlKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQm94X2dldE93bmVyVHlwZShzZWxmKQoKICAgIGRlZiBnZXRUZWNoTGF5ZXIoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJCb3hfZ2V0VGVjaExheWVyKHNlbGYpCgogICAgZGVmIGdldExheWVyTWFzayhzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkJveF9nZXRMYXllck1hc2soc2VsZikKCiAgICBkZWYgc2V0TGF5ZXJNYXNrKHNlbGYsIG1hc2spOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQm94X3NldExheWVyTWFzayhzZWxmLCBtYXNrKQoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBjcmVhdGUoKmFyZ3MpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQm94X2NyZWF0ZSgqYXJncykKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgZGVzdHJveShib3gpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQm94X2Rlc3Ryb3koYm94KQoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBnZXRCb3goKmFyZ3MpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQm94X2dldEJveCgqYXJncykKCiAgICBkZWYgX19pbml0X18oc2VsZik6CiAgICAgICAgX29kYl9weS5kYkJveF9zd2lnaW5pdChzZWxmLCBfb2RiX3B5Lm5ld19kYkJveCgpKQogICAgX19zd2lnX2Rlc3Ryb3lfXyA9IF9vZGJfcHkuZGVsZXRlX2RiQm94CgojIFJlZ2lzdGVyIGRiQm94IGluIF9vZGJfcHk6Cl9vZGJfcHkuZGJCb3hfc3dpZ3JlZ2lzdGVyKGRiQm94KQpjdmFyID0gX29kYl9weS5jdmFyCkFEU19NQVhfQ09STkVSID0gY3Zhci5BRFNfTUFYX0NPUk5FUgoKZGVmIGRiQm94X2NyZWF0ZSgqYXJncyk6CiAgICByZXR1cm4gX29kYl9weS5kYkJveF9jcmVhdGUoKmFyZ3MpCgpkZWYgZGJCb3hfZGVzdHJveShib3gpOgogICAgcmV0dXJuIF9vZGJfcHkuZGJCb3hfZGVzdHJveShib3gpCgpkZWYgZGJCb3hfZ2V0Qm94KCphcmdzKToKICAgIHJldHVybiBfb2RiX3B5LmRiQm94X2dldEJveCgqYXJncykKCmNsYXNzIGRiU0JveChkYkJveCk6CiAgICB0aGlzb3duID0gcHJvcGVydHkobGFtYmRhIHg6IHgudGhpcy5vd24oKSwgbGFtYmRhIHgsIHY6IHgudGhpcy5vd24odiksIGRvYz0nVGhlIG1lbWJlcnNoaXAgZmxhZycpCiAgICBfX3JlcHJfXyA9IF9zd2lnX3JlcHIKICAgIFVOREVGSU5FRCA9IF9vZGJfcHkuZGJTQm94X1VOREVGSU5FRAogICAgSE9SSVpPTlRBTCA9IF9vZGJfcHkuZGJTQm94X0hPUklaT05UQUwKICAgIFZFUlRJQ0FMID0gX29kYl9weS5kYlNCb3hfVkVSVElDQUwKICAgIE9DVElMSU5FQVIgPSBfb2RiX3B5LmRiU0JveF9PQ1RJTElORUFSCgogICAgZGVmIGdldFdpcmVTaGFwZVR5cGUoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJTQm94X2dldFdpcmVTaGFwZVR5cGUoc2VsZikKCiAgICBkZWYgZ2V0RGlyZWN0aW9uKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiU0JveF9nZXREaXJlY3Rpb24oc2VsZikKCiAgICBkZWYgZ2V0U1dpcmUoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJTQm94X2dldFNXaXJlKHNlbGYpCgogICAgZGVmIGdldE9jdChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlNCb3hfZ2V0T2N0KHNlbGYpCgogICAgZGVmIGdldFZpYUJvdHRvbUxheWVyTWFzayhzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlNCb3hfZ2V0VmlhQm90dG9tTGF5ZXJNYXNrKHNlbGYpCgogICAgZGVmIGdldFZpYUN1dExheWVyTWFzayhzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlNCb3hfZ2V0VmlhQ3V0TGF5ZXJNYXNrKHNlbGYpCgogICAgZGVmIGdldFZpYVRvcExheWVyTWFzayhzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlNCb3hfZ2V0VmlhVG9wTGF5ZXJNYXNrKHNlbGYpCgogICAgZGVmIHNldFZpYUxheWVyTWFzayhzZWxmLCBib3R0b20sIGN1dCwgdG9wKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlNCb3hfc2V0VmlhTGF5ZXJNYXNrKHNlbGYsIGJvdHRvbSwgY3V0LCB0b3ApCgogICAgZGVmIGhhc1ZpYUxheWVyTWFza3Moc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJTQm94X2hhc1ZpYUxheWVyTWFza3Moc2VsZikKCiAgICBkZWYgc21hc2hWaWEoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJTQm94X3NtYXNoVmlhKHNlbGYpCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIGNyZWF0ZSgqYXJncyk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJTQm94X2NyZWF0ZSgqYXJncykKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgZ2V0U0JveChibG9jaywgb2lkKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlNCb3hfZ2V0U0JveChibG9jaywgb2lkKQoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBkZXN0cm95KGJveCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJTQm94X2Rlc3Ryb3koYm94KQoKICAgIGRlZiBfX2luaXRfXyhzZWxmKToKICAgICAgICBfb2RiX3B5LmRiU0JveF9zd2lnaW5pdChzZWxmLCBfb2RiX3B5Lm5ld19kYlNCb3goKSkKICAgIF9fc3dpZ19kZXN0cm95X18gPSBfb2RiX3B5LmRlbGV0ZV9kYlNCb3gKCiMgUmVnaXN0ZXIgZGJTQm94IGluIF9vZGJfcHk6Cl9vZGJfcHkuZGJTQm94X3N3aWdyZWdpc3RlcihkYlNCb3gpCgpkZWYgZGJTQm94X2NyZWF0ZSgqYXJncyk6CiAgICByZXR1cm4gX29kYl9weS5kYlNCb3hfY3JlYXRlKCphcmdzKQoKZGVmIGRiU0JveF9nZXRTQm94KGJsb2NrLCBvaWQpOgogICAgcmV0dXJuIF9vZGJfcHkuZGJTQm94X2dldFNCb3goYmxvY2ssIG9pZCkKCmRlZiBkYlNCb3hfZGVzdHJveShib3gpOgogICAgcmV0dXJuIF9vZGJfcHkuZGJTQm94X2Rlc3Ryb3koYm94KQoKY2xhc3MgZGJCbG9jayhvYmplY3QpOgogICAgdGhpc293biA9IHByb3BlcnR5KGxhbWJkYSB4OiB4LnRoaXMub3duKCksIGxhbWJkYSB4LCB2OiB4LnRoaXMub3duKHYpLCBkb2M9J1RoZSBtZW1iZXJzaGlwIGZsYWcnKQogICAgX19yZXByX18gPSBfc3dpZ19yZXByCgogICAgZGVmIGdldE5hbWUoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJCbG9ja19nZXROYW1lKHNlbGYpCgogICAgZGVmIGdldENvbnN0TmFtZShzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkJsb2NrX2dldENvbnN0TmFtZShzZWxmKQoKICAgIGRlZiBnZXRCQm94KHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQmxvY2tfZ2V0QkJveChzZWxmKQoKICAgIGRlZiBnZXRDaGlwKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQmxvY2tfZ2V0Q2hpcChzZWxmKQoKICAgIGRlZiBnZXREYXRhQmFzZShzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkJsb2NrX2dldERhdGFCYXNlKHNlbGYpCgogICAgZGVmIGdldFRlY2goc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJCbG9ja19nZXRUZWNoKHNlbGYpCgogICAgZGVmIGdldFBhcmVudChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkJsb2NrX2dldFBhcmVudChzZWxmKQoKICAgIGRlZiBnZXRQYXJlbnRJbnN0KHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQmxvY2tfZ2V0UGFyZW50SW5zdChzZWxmKQoKICAgIGRlZiBnZXRUb3BNb2R1bGUoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJCbG9ja19nZXRUb3BNb2R1bGUoc2VsZikKCiAgICBkZWYgZ2V0Q2hpbGRyZW4oc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJCbG9ja19nZXRDaGlsZHJlbihzZWxmKQoKICAgIGRlZiBmaW5kQ2hpbGQoc2VsZiwgbmFtZSk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJCbG9ja19maW5kQ2hpbGQoc2VsZiwgbmFtZSkKCiAgICBkZWYgZ2V0QlRlcm1zKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQmxvY2tfZ2V0QlRlcm1zKHNlbGYpCgogICAgZGVmIGZpbmRCVGVybShzZWxmLCBuYW1lKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkJsb2NrX2ZpbmRCVGVybShzZWxmLCBuYW1lKQoKICAgIGRlZiBnZXRCVGVybUdyb3VwcyhzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkJsb2NrX2dldEJUZXJtR3JvdXBzKHNlbGYpCgogICAgZGVmIGFkZEJUZXJtR3JvdXAoc2VsZiwgYnRlcm1zLCBvcmRlcik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJCbG9ja19hZGRCVGVybUdyb3VwKHNlbGYsIGJ0ZXJtcywgb3JkZXIpCgogICAgZGVmIHNldEJUZXJtVG9wTGF5ZXJHcmlkKHNlbGYsIHRvcF9sYXllcl9ncmlkKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkJsb2NrX3NldEJUZXJtVG9wTGF5ZXJHcmlkKHNlbGYsIHRvcF9sYXllcl9ncmlkKQoKICAgIGRlZiBnZXRCVGVybVRvcExheWVyR3JpZChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkJsb2NrX2dldEJUZXJtVG9wTGF5ZXJHcmlkKHNlbGYpCgogICAgZGVmIGdldEJUZXJtVG9wTGF5ZXJHcmlkUmVnaW9uKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQmxvY2tfZ2V0QlRlcm1Ub3BMYXllckdyaWRSZWdpb24oc2VsZikKCiAgICBkZWYgZmluZENvbnN0cmFpbnRSZWdpb24oc2VsZiwgZWRnZSwgYmVnaW4sIGVuZCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJCbG9ja19maW5kQ29uc3RyYWludFJlZ2lvbihzZWxmLCBlZGdlLCBiZWdpbiwgZW5kKQoKICAgIGRlZiBhZGRCVGVybUNvbnN0cmFpbnRCeURpcmVjdGlvbihzZWxmLCBkaXJlY3Rpb24sIGNvbnN0cmFpbnRfcmVnaW9uKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkJsb2NrX2FkZEJUZXJtQ29uc3RyYWludEJ5RGlyZWN0aW9uKHNlbGYsIGRpcmVjdGlvbiwgY29uc3RyYWludF9yZWdpb24pCgogICAgZGVmIGFkZEJUZXJtc1RvQ29uc3RyYWludChzZWxmLCBidGVybXMsIGNvbnN0cmFpbnRfcmVnaW9uKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkJsb2NrX2FkZEJUZXJtc1RvQ29uc3RyYWludChzZWxmLCBidGVybXMsIGNvbnN0cmFpbnRfcmVnaW9uKQoKICAgIGRlZiBnZXRJVGVybXMoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJCbG9ja19nZXRJVGVybXMoc2VsZikKCiAgICBkZWYgZ2V0SW5zdHMoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJCbG9ja19nZXRJbnN0cyhzZWxmKQoKICAgIGRlZiBnZXRNb2R1bGVzKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQmxvY2tfZ2V0TW9kdWxlcyhzZWxmKQoKICAgIGRlZiBnZXRNb2RJbnN0cyhzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkJsb2NrX2dldE1vZEluc3RzKHNlbGYpCgogICAgZGVmIGdldE1vZE5ldHMoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJCbG9ja19nZXRNb2ROZXRzKHNlbGYpCgogICAgZGVmIGdldE1vZEJUZXJtcyhzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkJsb2NrX2dldE1vZEJUZXJtcyhzZWxmKQoKICAgIGRlZiBnZXRNb2RJVGVybXMoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJCbG9ja19nZXRNb2RJVGVybXMoc2VsZikKCiAgICBkZWYgZ2V0UG93ZXJEb21haW5zKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQmxvY2tfZ2V0UG93ZXJEb21haW5zKHNlbGYpCgogICAgZGVmIGdldExvZ2ljUG9ydHMoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJCbG9ja19nZXRMb2dpY1BvcnRzKHNlbGYpCgogICAgZGVmIGdldFBvd2VyU3dpdGNoZXMoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJCbG9ja19nZXRQb3dlclN3aXRjaGVzKHNlbGYpCgogICAgZGVmIGdldElzb2xhdGlvbnMoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJCbG9ja19nZXRJc29sYXRpb25zKHNlbGYpCgogICAgZGVmIGdldExldmVsU2hpZnRlcnMoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJCbG9ja19nZXRMZXZlbFNoaWZ0ZXJzKHNlbGYpCgogICAgZGVmIGdldEdyb3VwcyhzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkJsb2NrX2dldEdyb3VwcyhzZWxmKQoKICAgIGRlZiBnZXRBY2Nlc3NQb2ludHMoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJCbG9ja19nZXRBY2Nlc3NQb2ludHMoc2VsZikKCiAgICBkZWYgZ2V0R2xvYmFsQ29ubmVjdHMoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJCbG9ja19nZXRHbG9iYWxDb25uZWN0cyhzZWxmKQoKICAgIGRlZiBnbG9iYWxDb25uZWN0KHNlbGYsICphcmdzKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkJsb2NrX2dsb2JhbENvbm5lY3Qoc2VsZiwgKmFyZ3MpCgogICAgZGVmIGFkZEdsb2JhbENvbm5lY3Qoc2VsZiwgcmVnaW9uLCBpbnN0UGF0dGVybiwgcGluUGF0dGVybiwgbmV0LCBkb19jb25uZWN0KToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkJsb2NrX2FkZEdsb2JhbENvbm5lY3Qoc2VsZiwgcmVnaW9uLCBpbnN0UGF0dGVybiwgcGluUGF0dGVybiwgbmV0LCBkb19jb25uZWN0KQoKICAgIGRlZiByZXBvcnRHbG9iYWxDb25uZWN0KHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQmxvY2tfcmVwb3J0R2xvYmFsQ29ubmVjdChzZWxmKQoKICAgIGRlZiBjbGVhckdsb2JhbENvbm5lY3Qoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJCbG9ja19jbGVhckdsb2JhbENvbm5lY3Qoc2VsZikKCiAgICBkZWYgZ2V0Q29tcG9uZW50TWFza1NoaWZ0KHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQmxvY2tfZ2V0Q29tcG9uZW50TWFza1NoaWZ0KHNlbGYpCgogICAgZGVmIHNldENvbXBvbmVudE1hc2tTaGlmdChzZWxmLCBsYXllcnMpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQmxvY2tfc2V0Q29tcG9uZW50TWFza1NoaWZ0KHNlbGYsIGxheWVycykKCiAgICBkZWYgZmluZEluc3Qoc2VsZiwgbmFtZSk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJCbG9ja19maW5kSW5zdChzZWxmLCBuYW1lKQoKICAgIGRlZiBmaW5kTW9kdWxlKHNlbGYsIG5hbWUpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQmxvY2tfZmluZE1vZHVsZShzZWxmLCBuYW1lKQoKICAgIGRlZiBmaW5kTW9kSW5zdChzZWxmLCBwYXRoKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkJsb2NrX2ZpbmRNb2RJbnN0KHNlbGYsIHBhdGgpCgogICAgZGVmIGZpbmRQb3dlckRvbWFpbihzZWxmLCBuYW1lKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkJsb2NrX2ZpbmRQb3dlckRvbWFpbihzZWxmLCBuYW1lKQoKICAgIGRlZiBmaW5kTG9naWNQb3J0KHNlbGYsIG5hbWUpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQmxvY2tfZmluZExvZ2ljUG9ydChzZWxmLCBuYW1lKQoKICAgIGRlZiBmaW5kUG93ZXJTd2l0Y2goc2VsZiwgbmFtZSk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJCbG9ja19maW5kUG93ZXJTd2l0Y2goc2VsZiwgbmFtZSkKCiAgICBkZWYgZmluZElzb2xhdGlvbihzZWxmLCBuYW1lKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkJsb2NrX2ZpbmRJc29sYXRpb24oc2VsZiwgbmFtZSkKCiAgICBkZWYgZmluZExldmVsU2hpZnRlcihzZWxmLCBuYW1lKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkJsb2NrX2ZpbmRMZXZlbFNoaWZ0ZXIoc2VsZiwgbmFtZSkKCiAgICBkZWYgZmluZEdyb3VwKHNlbGYsIG5hbWUpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQmxvY2tfZmluZEdyb3VwKHNlbGYsIG5hbWUpCgogICAgZGVmIGZpbmRJVGVybShzZWxmLCBuYW1lKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkJsb2NrX2ZpbmRJVGVybShzZWxmLCBuYW1lKQoKICAgIGRlZiBnZXRPYnN0cnVjdGlvbnMoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJCbG9ja19nZXRPYnN0cnVjdGlvbnMoc2VsZikKCiAgICBkZWYgZ2V0QmxvY2thZ2VzKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQmxvY2tfZ2V0QmxvY2thZ2VzKHNlbGYpCgogICAgZGVmIGdldE5ldHMoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJCbG9ja19nZXROZXRzKHNlbGYpCgogICAgZGVmIGdldENhcE5vZGVzKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQmxvY2tfZ2V0Q2FwTm9kZXMoc2VsZikKCiAgICBkZWYgZ2V0UlNlZ3Moc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJCbG9ja19nZXRSU2VncyhzZWxmKQoKICAgIGRlZiBmaW5kTmV0KHNlbGYsIG5hbWUpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQmxvY2tfZmluZE5ldChzZWxmLCBuYW1lKQoKICAgIGRlZiB3cml0ZURiKHNlbGYsIGZpbGVuYW1lLCBhbGxOb2RlPTApOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQmxvY2tfd3JpdGVEYihzZWxmLCBmaWxlbmFtZSwgYWxsTm9kZSkKCiAgICBkZWYgd3JpdGVHdWlkZXMoc2VsZiwgZmlsZW5hbWUpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQmxvY2tfd3JpdGVHdWlkZXMoc2VsZiwgZmlsZW5hbWUpCgogICAgZGVmIGZpbmRWaWEoc2VsZiwgbmFtZSk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJCbG9ja19maW5kVmlhKHNlbGYsIG5hbWUpCgogICAgZGVmIGdldFZpYXMoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJCbG9ja19nZXRWaWFzKHNlbGYpCgogICAgZGVmIGdldEdDZWxsR3JpZChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkJsb2NrX2dldEdDZWxsR3JpZChzZWxmKQoKICAgIGRlZiBnZXREZWZVbml0cyhzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkJsb2NrX2dldERlZlVuaXRzKHNlbGYpCgogICAgZGVmIHNldERlZlVuaXRzKHNlbGYsIHVuaXRzKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkJsb2NrX3NldERlZlVuaXRzKHNlbGYsIHVuaXRzKQoKICAgIGRlZiBnZXREYlVuaXRzUGVyTWljcm9uKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQmxvY2tfZ2V0RGJVbml0c1Blck1pY3JvbihzZWxmKQoKICAgIGRlZiBkYnVUb01pY3JvbnMoc2VsZiwgKmFyZ3MpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQmxvY2tfZGJ1VG9NaWNyb25zKHNlbGYsICphcmdzKQoKICAgIGRlZiBkYnVBcmVhVG9NaWNyb25zKHNlbGYsIGRidV9hcmVhKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkJsb2NrX2RidUFyZWFUb01pY3JvbnMoc2VsZiwgZGJ1X2FyZWEpCgogICAgZGVmIG1pY3JvbnNUb0RidShzZWxmLCBtaWNyb25zKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkJsb2NrX21pY3JvbnNUb0RidShzZWxmLCBtaWNyb25zKQoKICAgIGRlZiBtaWNyb25zQXJlYVRvRGJ1KHNlbGYsIG1pY3JvbnNBcmVhKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkJsb2NrX21pY3JvbnNBcmVhVG9EYnUoc2VsZiwgbWljcm9uc0FyZWEpCgogICAgZGVmIGdldEhpZXJhcmNoeURlbGltaXRlcihzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkJsb2NrX2dldEhpZXJhcmNoeURlbGltaXRlcihzZWxmKQoKICAgIGRlZiBzZXRCdXNEZWxpbWl0ZXJzKHNlbGYsIGxlZnQsIHJpZ2h0KToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkJsb2NrX3NldEJ1c0RlbGltaXRlcnMoc2VsZiwgbGVmdCwgcmlnaHQpCgogICAgZGVmIGdldEJ1c0RlbGltaXRlcnMoc2VsZiwgbGVmdCwgcmlnaHQpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQmxvY2tfZ2V0QnVzRGVsaW1pdGVycyhzZWxmLCBsZWZ0LCByaWdodCkKCiAgICBkZWYgZ2V0RXh0Q291bnQoc2VsZiwgbnVtT2ZOZXQsIG51bU9mUlNlZywgbnVtT2ZDYXBOb2RlLCBudW1PZkNDU2VnKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkJsb2NrX2dldEV4dENvdW50KHNlbGYsIG51bU9mTmV0LCBudW1PZlJTZWcsIG51bU9mQ2FwTm9kZSwgbnVtT2ZDQ1NlZykKCiAgICBkZWYgY29weUV4dERiKHNlbGYsIGZyLCB0bywgZXh0RGJDbnQsIHJlc0ZhY3RvciwgY2NGYWN0b3IsIGduZGNGYWN0b3IpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQmxvY2tfY29weUV4dERiKHNlbGYsIGZyLCB0bywgZXh0RGJDbnQsIHJlc0ZhY3RvciwgY2NGYWN0b3IsIGduZGNGYWN0b3IpCgogICAgZGVmIGFkanVzdFJDKHNlbGYsIHJlc0ZhY3RvciwgY2NGYWN0b3IsIGduZGNGYWN0b3IpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQmxvY2tfYWRqdXN0UkMoc2VsZiwgcmVzRmFjdG9yLCBjY0ZhY3RvciwgZ25kY0ZhY3RvcikKCiAgICBkZWYgZ3JvdW5kQ0Moc2VsZiwgZ25kRmFjdG9yKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkJsb2NrX2dyb3VuZENDKHNlbGYsIGduZEZhY3RvcikKCiAgICBkZWYgYWRqdXN0Q0Moc2VsZiwgYWRqRmFjdG9yLCBjY1RocmVzaEhvbGQsIG5ldHMsIGhhbG9uZXRzKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkJsb2NrX2FkanVzdENDKHNlbGYsIGFkakZhY3RvciwgY2NUaHJlc2hIb2xkLCBuZXRzLCBoYWxvbmV0cykKCiAgICBkZWYgdW5kb0FkanVzdGVkQ0Moc2VsZiwgbmV0cywgaGFsb25ldHMpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQmxvY2tfdW5kb0FkanVzdGVkQ0Moc2VsZiwgbmV0cywgaGFsb25ldHMpCgogICAgZGVmIGdldENvcm5lckNvdW50KHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQmxvY2tfZ2V0Q29ybmVyQ291bnQoc2VsZikKCiAgICBkZWYgZXh0Q29ybmVyc0FyZUluZGVwZW5kZW50KHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQmxvY2tfZXh0Q29ybmVyc0FyZUluZGVwZW5kZW50KHNlbGYpCgogICAgZGVmIGdldENvcm5lcnNQZXJCbG9jayhzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkJsb2NrX2dldENvcm5lcnNQZXJCbG9jayhzZWxmKQoKICAgIGRlZiBnZXRFeHREYkNvdW50KHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQmxvY2tfZ2V0RXh0RGJDb3VudChzZWxmKQoKICAgIGRlZiBnZXRFeHRDb3JuZXJOYW1lKHNlbGYsIGNvcm5lciwgY05hbWUpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQmxvY2tfZ2V0RXh0Q29ybmVyTmFtZShzZWxmLCBjb3JuZXIsIGNOYW1lKQoKICAgIGRlZiBnZXRFeHRDb3JuZXJJbmRleChzZWxmLCBjb3JuZXJOYW1lKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkJsb2NrX2dldEV4dENvcm5lckluZGV4KHNlbGYsIGNvcm5lck5hbWUpCgogICAgZGVmIHNldENvcm5lck5hbWVMaXN0KHNlbGYsIG5hbWVfbGlzdCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJCbG9ja19zZXRDb3JuZXJOYW1lTGlzdChzZWxmLCBuYW1lX2xpc3QpCgogICAgZGVmIGdldENvcm5lck5hbWVMaXN0KHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQmxvY2tfZ2V0Q29ybmVyTmFtZUxpc3Qoc2VsZikKCiAgICBkZWYgc2V0Q29ybmVyQ291bnQoc2VsZiwgKmFyZ3MpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQmxvY2tfc2V0Q29ybmVyQ291bnQoc2VsZiwgKmFyZ3MpCgogICAgZGVmIHNldENvcm5lcnNQZXJCbG9jayhzZWxmLCBjb3JuZXJzUGVyQmxvY2spOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQmxvY2tfc2V0Q29ybmVyc1BlckJsb2NrKHNlbGYsIGNvcm5lcnNQZXJCbG9jaykKCiAgICBkZWYgaW5pdFBhcmFzaXRpY3NWYWx1ZVRhYmxlcyhzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkJsb2NrX2luaXRQYXJhc2l0aWNzVmFsdWVUYWJsZXMoc2VsZikKCiAgICBkZWYgY3JlYXRlRXh0Q29ybmVyQmxvY2soc2VsZiwgY29ybmVyKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkJsb2NrX2NyZWF0ZUV4dENvcm5lckJsb2NrKHNlbGYsIGNvcm5lcikKCiAgICBkZWYgZmluZEV4dENvcm5lckJsb2NrKHNlbGYsIGNvcm5lcik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJCbG9ja19maW5kRXh0Q29ybmVyQmxvY2soc2VsZiwgY29ybmVyKQoKICAgIGRlZiBnZXRFeHRDb3JuZXJCbG9jayhzZWxmLCBjb3JuZXIpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQmxvY2tfZ2V0RXh0Q29ybmVyQmxvY2soc2VsZiwgY29ybmVyKQoKICAgIGRlZiBnZXRUcmFja0dyaWRzKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQmxvY2tfZ2V0VHJhY2tHcmlkcyhzZWxmKQoKICAgIGRlZiBmaW5kVHJhY2tHcmlkKHNlbGYsIGxheWVyKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkJsb2NrX2ZpbmRUcmFja0dyaWQoc2VsZiwgbGF5ZXIpCgogICAgZGVmIGdldFJvd3Moc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJCbG9ja19nZXRSb3dzKHNlbGYpCgogICAgZGVmIGdldEZpbGxzKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQmxvY2tfZ2V0RmlsbHMoc2VsZikKCiAgICBkZWYgZ2V0TWFzdGVycyhzZWxmLCBtYXN0ZXJzKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkJsb2NrX2dldE1hc3RlcnMoc2VsZiwgbWFzdGVycykKCiAgICBkZWYgc2V0RGllQXJlYShzZWxmLCAqYXJncyk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJCbG9ja19zZXREaWVBcmVhKHNlbGYsICphcmdzKQoKICAgIGRlZiBnZXREaWVBcmVhKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQmxvY2tfZ2V0RGllQXJlYShzZWxmKQoKICAgIGRlZiBnZXREaWVBcmVhUG9seWdvbihzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkJsb2NrX2dldERpZUFyZWFQb2x5Z29uKHNlbGYpCgogICAgZGVmIGNvbXB1dGVDb3JlQXJlYShzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkJsb2NrX2NvbXB1dGVDb3JlQXJlYShzZWxmKQoKICAgIGRlZiBzZXRDb3JlQXJlYShzZWxmLCAqYXJncyk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJCbG9ja19zZXRDb3JlQXJlYShzZWxmLCAqYXJncykKCiAgICBkZWYgZ2V0Q29yZUFyZWEoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJCbG9ja19nZXRDb3JlQXJlYShzZWxmKQoKICAgIGRlZiBnZXRDb3JlQXJlYVBvbHlnb24oc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJCbG9ja19nZXRDb3JlQXJlYVBvbHlnb24oc2VsZikKCiAgICBkZWYgYWRkQmxvY2tlZFJlZ2lvbkZvclBpbnMoc2VsZiwgcmVnaW9uKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkJsb2NrX2FkZEJsb2NrZWRSZWdpb25Gb3JQaW5zKHNlbGYsIHJlZ2lvbikKCiAgICBkZWYgZ2V0QmxvY2tlZFJlZ2lvbnNGb3JQaW5zKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQmxvY2tfZ2V0QmxvY2tlZFJlZ2lvbnNGb3JQaW5zKHNlbGYpCgogICAgZGVmIHNldEV4dG1pKHNlbGYsIGV4dCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJCbG9ja19zZXRFeHRtaShzZWxmLCBleHQpCgogICAgZGVmIGdldEV4dG1pKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQmxvY2tfZ2V0RXh0bWkoc2VsZikKCiAgICBkZWYgZ2V0RXh0Q29udHJvbChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkJsb2NrX2dldEV4dENvbnRyb2woc2VsZikKCiAgICBkZWYgZ2V0RGZ0KHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQmxvY2tfZ2V0RGZ0KHNlbGYpCgogICAgZGVmIGdldE1pblJvdXRpbmdMYXllcihzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkJsb2NrX2dldE1pblJvdXRpbmdMYXllcihzZWxmKQoKICAgIGRlZiBzZXRNaW5Sb3V0aW5nTGF5ZXIoc2VsZiwgbWluX3JvdXRpbmdfbGF5ZXIpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQmxvY2tfc2V0TWluUm91dGluZ0xheWVyKHNlbGYsIG1pbl9yb3V0aW5nX2xheWVyKQoKICAgIGRlZiBnZXRNYXhSb3V0aW5nTGF5ZXIoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJCbG9ja19nZXRNYXhSb3V0aW5nTGF5ZXIoc2VsZikKCiAgICBkZWYgc2V0TWF4Um91dGluZ0xheWVyKHNlbGYsIG1heF9yb3V0aW5nX2xheWVyKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkJsb2NrX3NldE1heFJvdXRpbmdMYXllcihzZWxmLCBtYXhfcm91dGluZ19sYXllcikKCiAgICBkZWYgZ2V0TWluTGF5ZXJGb3JDbG9jayhzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkJsb2NrX2dldE1pbkxheWVyRm9yQ2xvY2soc2VsZikKCiAgICBkZWYgc2V0TWluTGF5ZXJGb3JDbG9jayhzZWxmLCBtaW5fbGF5ZXJfZm9yX2Nsb2NrKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkJsb2NrX3NldE1pbkxheWVyRm9yQ2xvY2soc2VsZiwgbWluX2xheWVyX2Zvcl9jbG9jaykKCiAgICBkZWYgZ2V0TWF4TGF5ZXJGb3JDbG9jayhzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkJsb2NrX2dldE1heExheWVyRm9yQ2xvY2soc2VsZikKCiAgICBkZWYgc2V0TWF4TGF5ZXJGb3JDbG9jayhzZWxmLCBtYXhfbGF5ZXJfZm9yX2Nsb2NrKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkJsb2NrX3NldE1heExheWVyRm9yQ2xvY2soc2VsZiwgbWF4X2xheWVyX2Zvcl9jbG9jaykKCiAgICBkZWYgZ2V0R0NlbGxUaWxlU2l6ZShzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkJsb2NrX2dldEdDZWxsVGlsZVNpemUoc2VsZikKCiAgICBkZWYgZ2V0RXh0Q29ybmVyTmFtZXMoc2VsZiwgZWNsKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkJsb2NrX2dldEV4dENvcm5lck5hbWVzKHNlbGYsIGVjbCkKCiAgICBkZWYgZ2V0Q0NTZWdzKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQmxvY2tfZ2V0Q0NTZWdzKHNlbGYpCgogICAgZGVmIGdldFNlYXJjaERiKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQmxvY2tfZ2V0U2VhcmNoRGIoc2VsZikKCiAgICBkZWYgZGVzdHJveUNDcyhzZWxmLCBuZXRzKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkJsb2NrX2Rlc3Ryb3lDQ3Moc2VsZiwgbmV0cykKCiAgICBkZWYgZGVzdHJveVJTZWdzKHNlbGYsIG5ldHMpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQmxvY2tfZGVzdHJveVJTZWdzKHNlbGYsIG5ldHMpCgogICAgZGVmIGRlc3Ryb3lDTnMoc2VsZiwgbmV0cywgY2xlYW5FeHRpZCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJCbG9ja19kZXN0cm95Q05zKHNlbGYsIG5ldHMsIGNsZWFuRXh0aWQpCgogICAgZGVmIGRlc3Ryb3lQYXJhc2l0aWNzKHNlbGYsIG5ldHMpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQmxvY2tfZGVzdHJveVBhcmFzaXRpY3Moc2VsZiwgbmV0cykKCiAgICBkZWYgZGVzdHJveUNvcm5lclBhcmFzaXRpY3Moc2VsZiwgbmV0cyk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJCbG9ja19kZXN0cm95Q29ybmVyUGFyYXNpdGljcyhzZWxmLCBuZXRzKQoKICAgIGRlZiBnZXRDY0hhbG9OZXRzKHNlbGYsIGNoYW5nZWROZXRzLCBjY0hhbG9OZXRzKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkJsb2NrX2dldENjSGFsb05ldHMoc2VsZiwgY2hhbmdlZE5ldHMsIGNjSGFsb05ldHMpCgogICAgZGVmIHByZUV4dHRyZWVNZXJnZVJDKHNlbGYsIG1heF9jYXAsIGNvcm5lcik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJCbG9ja19wcmVFeHR0cmVlTWVyZ2VSQyhzZWxmLCBtYXhfY2FwLCBjb3JuZXIpCgogICAgZGVmIGRlc2lnbklzUm91dGVkKHNlbGYsIHZlcmJvc2UpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQmxvY2tfZGVzaWduSXNSb3V0ZWQoc2VsZiwgdmVyYm9zZSkKCiAgICBkZWYgZGVzdHJveU5ldFdpcmVzKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQmxvY2tfZGVzdHJveU5ldFdpcmVzKHNlbGYpCgogICAgZGVmIGNsZWFyKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQmxvY2tfY2xlYXIoc2VsZikKCiAgICBkZWYgZ2V0V2lyZVVwZGF0ZWROZXRzKHNlbGYsIG5ldHMpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQmxvY2tfZ2V0V2lyZVVwZGF0ZWROZXRzKHNlbGYsIG5ldHMpCgogICAgZGVmIG1ha2VOZXdOZXROYW1lKHNlbGYsICphcmdzKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkJsb2NrX21ha2VOZXdOZXROYW1lKHNlbGYsICphcmdzKQoKICAgIGRlZiBtYWtlTmV3SW5zdE5hbWUoc2VsZiwgKmFyZ3MpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQmxvY2tfbWFrZU5ld0luc3ROYW1lKHNlbGYsICphcmdzKQoKICAgIGRlZiBnZXRCYXNlTmFtZShzZWxmLCBmdWxsX25hbWUpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQmxvY2tfZ2V0QmFzZU5hbWUoc2VsZiwgZnVsbF9uYW1lKQoKICAgIGRlZiBnZXRSZWdpb25zKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQmxvY2tfZ2V0UmVnaW9ucyhzZWxmKQoKICAgIGRlZiBmaW5kUmVnaW9uKHNlbGYsIG5hbWUpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQmxvY2tfZmluZFJlZ2lvbihzZWxmLCBuYW1lKQoKICAgIGRlZiBmaW5kTm9uRGVmYXVsdFJ1bGUoc2VsZiwgbmFtZSk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJCbG9ja19maW5kTm9uRGVmYXVsdFJ1bGUoc2VsZiwgbmFtZSkKCiAgICBkZWYgZ2V0Tm9uRGVmYXVsdFJ1bGVzKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQmxvY2tfZ2V0Tm9uRGVmYXVsdFJ1bGVzKHNlbGYpCgogICAgZGVmIGdldE1hcmtlckNhdGVnb3JpZXMoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJCbG9ja19nZXRNYXJrZXJDYXRlZ29yaWVzKHNlbGYpCgogICAgZGVmIGZpbmRNYXJrZXJDYXRlZ29yeShzZWxmLCBuYW1lKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkJsb2NrX2ZpbmRNYXJrZXJDYXRlZ29yeShzZWxmLCBuYW1lKQoKICAgIGRlZiB3cml0ZU1hcmtlckNhdGVnb3JpZXMoc2VsZiwgKmFyZ3MpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQmxvY2tfd3JpdGVNYXJrZXJDYXRlZ29yaWVzKHNlbGYsICphcmdzKQoKICAgIGRlZiBz",
"ZXREcml2aW5nSXRlcm1zZm9yTmV0cyhzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkJsb2NrX3NldERyaXZpbmdJdGVybXNmb3JOZXRzKHNlbGYpCgogICAgZGVmIGNsZWFyVXNlckluc3RGbGFncyhzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkJsb2NrX2NsZWFyVXNlckluc3RGbGFncyhzZWxmKQoKICAgIGRlZiBnZXREZWZhdWx0VmlhcyhzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkJsb2NrX2dldERlZmF1bHRWaWFzKHNlbGYpCgogICAgZGVmIGRlc3Ryb3lSb3V0ZXMoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJCbG9ja19kZXN0cm95Um91dGVzKHNlbGYpCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIGNyZWF0ZSgqYXJncyk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJCbG9ja19jcmVhdGUoKmFyZ3MpCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIGdldEJsb2NrKCphcmdzKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkJsb2NrX2dldEJsb2NrKCphcmdzKQoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBkZXN0cm95KCphcmdzKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkJsb2NrX2Rlc3Ryb3koKmFyZ3MpCgogICAgZGVmIGRlYnVnUHJpbnRDb250ZW50KHNlbGYsICphcmdzKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkJsb2NrX2RlYnVnUHJpbnRDb250ZW50KHNlbGYsICphcmdzKQoKICAgIGRlZiBfX2luaXRfXyhzZWxmKToKICAgICAgICBfb2RiX3B5LmRiQmxvY2tfc3dpZ2luaXQoc2VsZiwgX29kYl9weS5uZXdfZGJCbG9jaygpKQogICAgX19zd2lnX2Rlc3Ryb3lfXyA9IF9vZGJfcHkuZGVsZXRlX2RiQmxvY2sKCiMgUmVnaXN0ZXIgZGJCbG9jayBpbiBfb2RiX3B5Ogpfb2RiX3B5LmRiQmxvY2tfc3dpZ3JlZ2lzdGVyKGRiQmxvY2spCgpkZWYgZGJCbG9ja19jcmVhdGUoKmFyZ3MpOgogICAgcmV0dXJuIF9vZGJfcHkuZGJCbG9ja19jcmVhdGUoKmFyZ3MpCgpkZWYgZGJCbG9ja19nZXRCbG9jaygqYXJncyk6CiAgICByZXR1cm4gX29kYl9weS5kYkJsb2NrX2dldEJsb2NrKCphcmdzKQoKZGVmIGRiQmxvY2tfZGVzdHJveSgqYXJncyk6CiAgICByZXR1cm4gX29kYl9weS5kYkJsb2NrX2Rlc3Ryb3koKmFyZ3MpCgpjbGFzcyBkYkJUZXJtKG9iamVjdCk6CiAgICB0aGlzb3duID0gcHJvcGVydHkobGFtYmRhIHg6IHgudGhpcy5vd24oKSwgbGFtYmRhIHgsIHY6IHgudGhpcy5vd24odiksIGRvYz0nVGhlIG1lbWJlcnNoaXAgZmxhZycpCiAgICBfX3JlcHJfXyA9IF9zd2lnX3JlcHIKCiAgICBkZWYgZ2V0TmFtZShzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkJUZXJtX2dldE5hbWUoc2VsZikKCiAgICBkZWYgZ2V0Q29uc3ROYW1lKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQlRlcm1fZ2V0Q29uc3ROYW1lKHNlbGYpCgogICAgZGVmIHJlbmFtZShzZWxmLCBuYW1lKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkJUZXJtX3JlbmFtZShzZWxmLCBuYW1lKQoKICAgIGRlZiBnZXRCQm94KHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQlRlcm1fZ2V0QkJveChzZWxmKQoKICAgIGRlZiBzZXRTaWdUeXBlKHNlbGYsIHR5cGUpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQlRlcm1fc2V0U2lnVHlwZShzZWxmLCB0eXBlKQoKICAgIGRlZiBnZXRTaWdUeXBlKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQlRlcm1fZ2V0U2lnVHlwZShzZWxmKQoKICAgIGRlZiBzZXRJb1R5cGUoc2VsZiwgdHlwZSk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJCVGVybV9zZXRJb1R5cGUoc2VsZiwgdHlwZSkKCiAgICBkZWYgZ2V0SW9UeXBlKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQlRlcm1fZ2V0SW9UeXBlKHNlbGYpCgogICAgZGVmIHNldFNwZWZNYXJrKHNlbGYsIHYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQlRlcm1fc2V0U3BlZk1hcmsoc2VsZiwgdikKCiAgICBkZWYgaXNTZXRTcGVmTWFyayhzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkJUZXJtX2lzU2V0U3BlZk1hcmsoc2VsZikKCiAgICBkZWYgc2V0TWFyayhzZWxmLCB2KToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkJUZXJtX3NldE1hcmsoc2VsZiwgdikKCiAgICBkZWYgaXNTZXRNYXJrKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQlRlcm1faXNTZXRNYXJrKHNlbGYpCgogICAgZGVmIHNldEV4dElkKHNlbGYsIHYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQlRlcm1fc2V0RXh0SWQoc2VsZiwgdikKCiAgICBkZWYgZ2V0RXh0SWQoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJCVGVybV9nZXRFeHRJZChzZWxmKQoKICAgIGRlZiBpc1NwZWNpYWwoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJCVGVybV9pc1NwZWNpYWwoc2VsZikKCiAgICBkZWYgc2V0U3BlY2lhbChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkJUZXJtX3NldFNwZWNpYWwoc2VsZikKCiAgICBkZWYgZ2V0TmV0KHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQlRlcm1fZ2V0TmV0KHNlbGYpCgogICAgZGVmIGdldE1vZE5ldChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkJUZXJtX2dldE1vZE5ldChzZWxmKQoKICAgIGRlZiBkaXNjb25uZWN0KHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQlRlcm1fZGlzY29ubmVjdChzZWxmKQoKICAgIGRlZiBkaXNjb25uZWN0RGJOZXQoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJCVGVybV9kaXNjb25uZWN0RGJOZXQoc2VsZikKCiAgICBkZWYgZGlzY29ubmVjdERiTW9kTmV0KHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQlRlcm1fZGlzY29ubmVjdERiTW9kTmV0KHNlbGYpCgogICAgZGVmIGNvbm5lY3Qoc2VsZiwgKmFyZ3MpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQlRlcm1fY29ubmVjdChzZWxmLCAqYXJncykKCiAgICBkZWYgZ2V0QmxvY2soc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJCVGVybV9nZXRCbG9jayhzZWxmKQoKICAgIGRlZiBnZXRJVGVybShzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkJUZXJtX2dldElUZXJtKHNlbGYpCgogICAgZGVmIGdldEJQaW5zKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQlRlcm1fZ2V0QlBpbnMoc2VsZikKCiAgICBkZWYgZ2V0Rmlyc3RQaW4oc2VsZiwgc2hhcGUpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQlRlcm1fZ2V0Rmlyc3RQaW4oc2VsZiwgc2hhcGUpCgogICAgZGVmIGdldEZpcnN0UGluTG9jYXRpb24oc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJCVGVybV9nZXRGaXJzdFBpbkxvY2F0aW9uKHNlbGYpCgogICAgZGVmIGdldEZpcnN0UGluUGxhY2VtZW50U3RhdHVzKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQlRlcm1fZ2V0Rmlyc3RQaW5QbGFjZW1lbnRTdGF0dXMoc2VsZikKCiAgICBkZWYgZ2V0R3JvdW5kUGluKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQlRlcm1fZ2V0R3JvdW5kUGluKHNlbGYpCgogICAgZGVmIHNldEdyb3VuZFBpbihzZWxmLCBwaW4pOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQlRlcm1fc2V0R3JvdW5kUGluKHNlbGYsIHBpbikKCiAgICBkZWYgZ2V0U3VwcGx5UGluKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQlRlcm1fZ2V0U3VwcGx5UGluKHNlbGYpCgogICAgZGVmIHNldFN1cHBseVBpbihzZWxmLCBwaW4pOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQlRlcm1fc2V0U3VwcGx5UGluKHNlbGYsIHBpbikKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgY3JlYXRlKG5ldCwgbmFtZSk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJCVGVybV9jcmVhdGUobmV0LCBuYW1lKQoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBkZXN0cm95KCphcmdzKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkJUZXJtX2Rlc3Ryb3koKmFyZ3MpCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIGdldEJUZXJtKGJsb2NrLCBvaWQpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQlRlcm1fZ2V0QlRlcm0oYmxvY2ssIG9pZCkKCiAgICBkZWYgc3RhVmVydGV4SWQoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJCVGVybV9zdGFWZXJ0ZXhJZChzZWxmKQoKICAgIGRlZiBzdGFTZXRWZXJ0ZXhJZChzZWxmLCBpZCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJCVGVybV9zdGFTZXRWZXJ0ZXhJZChzZWxmLCBpZCkKCiAgICBkZWYgc2V0Q29uc3RyYWludFJlZ2lvbihzZWxmLCBjb25zdHJhaW50X3JlZ2lvbik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJCVGVybV9zZXRDb25zdHJhaW50UmVnaW9uKHNlbGYsIGNvbnN0cmFpbnRfcmVnaW9uKQoKICAgIGRlZiBnZXRDb25zdHJhaW50UmVnaW9uKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQlRlcm1fZ2V0Q29uc3RyYWludFJlZ2lvbihzZWxmKQoKICAgIGRlZiByZXNldENvbnN0cmFpbnRSZWdpb24oc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJCVGVybV9yZXNldENvbnN0cmFpbnRSZWdpb24oc2VsZikKCiAgICBkZWYgc2V0TWlycm9yZWRCVGVybShzZWxmLCBtaXJyb3JlZF9idGVybSk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJCVGVybV9zZXRNaXJyb3JlZEJUZXJtKHNlbGYsIG1pcnJvcmVkX2J0ZXJtKQoKICAgIGRlZiBnZXRNaXJyb3JlZEJUZXJtKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQlRlcm1fZ2V0TWlycm9yZWRCVGVybShzZWxmKQoKICAgIGRlZiBoYXNNaXJyb3JlZEJUZXJtKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQlRlcm1faGFzTWlycm9yZWRCVGVybShzZWxmKQoKICAgIGRlZiBpc01pcnJvcmVkKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQlRlcm1faXNNaXJyb3JlZChzZWxmKQoKICAgIGRlZiBfX2luaXRfXyhzZWxmKToKICAgICAgICBfb2RiX3B5LmRiQlRlcm1fc3dpZ2luaXQoc2VsZiwgX29kYl9weS5uZXdfZGJCVGVybSgpKQogICAgX19zd2lnX2Rlc3Ryb3lfXyA9IF9vZGJfcHkuZGVsZXRlX2RiQlRlcm0KCiMgUmVnaXN0ZXIgZGJCVGVybSBpbiBfb2RiX3B5Ogpfb2RiX3B5LmRiQlRlcm1fc3dpZ3JlZ2lzdGVyKGRiQlRlcm0pCgpkZWYgZGJCVGVybV9jcmVhdGUobmV0LCBuYW1lKToKICAgIHJldHVybiBfb2RiX3B5LmRiQlRlcm1fY3JlYXRlKG5ldCwgbmFtZSkKCmRlZiBkYkJUZXJtX2Rlc3Ryb3koKmFyZ3MpOgogICAgcmV0dXJuIF9vZGJfcHkuZGJCVGVybV9kZXN0cm95KCphcmdzKQoKZGVmIGRiQlRlcm1fZ2V0QlRlcm0oYmxvY2ssIG9pZCk6CiAgICByZXR1cm4gX29kYl9weS5kYkJUZXJtX2dldEJUZXJtKGJsb2NrLCBvaWQpCgpjbGFzcyBkYkJQaW4ob2JqZWN0KToKICAgIHRoaXNvd24gPSBwcm9wZXJ0eShsYW1iZGEgeDogeC50aGlzLm93bigpLCBsYW1iZGEgeCwgdjogeC50aGlzLm93bih2KSwgZG9jPSdUaGUgbWVtYmVyc2hpcCBmbGFnJykKICAgIF9fcmVwcl9fID0gX3N3aWdfcmVwcgoKICAgIGRlZiBnZXRQbGFjZW1lbnRTdGF0dXMoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJCUGluX2dldFBsYWNlbWVudFN0YXR1cyhzZWxmKQoKICAgIGRlZiBzZXRQbGFjZW1lbnRTdGF0dXMoc2VsZiwgc3RhdHVzKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkJQaW5fc2V0UGxhY2VtZW50U3RhdHVzKHNlbGYsIHN0YXR1cykKCiAgICBkZWYgZ2V0QlRlcm0oc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJCUGluX2dldEJUZXJtKHNlbGYpCgogICAgZGVmIGdldEJveGVzKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQlBpbl9nZXRCb3hlcyhzZWxmKQoKICAgIGRlZiBnZXRCQm94KHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQlBpbl9nZXRCQm94KHNlbGYpCgogICAgZGVmIGhhc0VmZmVjdGl2ZVdpZHRoKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQlBpbl9oYXNFZmZlY3RpdmVXaWR0aChzZWxmKQoKICAgIGRlZiBzZXRFZmZlY3RpdmVXaWR0aChzZWxmLCB3KToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkJQaW5fc2V0RWZmZWN0aXZlV2lkdGgoc2VsZiwgdykKCiAgICBkZWYgZ2V0RWZmZWN0aXZlV2lkdGgoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJCUGluX2dldEVmZmVjdGl2ZVdpZHRoKHNlbGYpCgogICAgZGVmIGhhc01pblNwYWNpbmcoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJCUGluX2hhc01pblNwYWNpbmcoc2VsZikKCiAgICBkZWYgc2V0TWluU3BhY2luZyhzZWxmLCB3KToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkJQaW5fc2V0TWluU3BhY2luZyhzZWxmLCB3KQoKICAgIGRlZiBnZXRNaW5TcGFjaW5nKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQlBpbl9nZXRNaW5TcGFjaW5nKHNlbGYpCgogICAgZGVmIGdldEFjY2Vzc1BvaW50cyhzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkJQaW5fZ2V0QWNjZXNzUG9pbnRzKHNlbGYpCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIGNyZWF0ZShidGVybSk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJCUGluX2NyZWF0ZShidGVybSkKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgZGVzdHJveSgqYXJncyk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJCUGluX2Rlc3Ryb3koKmFyZ3MpCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIGdldEJQaW4oYmxvY2ssIG9pZCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJCUGluX2dldEJQaW4oYmxvY2ssIG9pZCkKCiAgICBkZWYgX19pbml0X18oc2VsZik6CiAgICAgICAgX29kYl9weS5kYkJQaW5fc3dpZ2luaXQoc2VsZiwgX29kYl9weS5uZXdfZGJCUGluKCkpCiAgICBfX3N3aWdfZGVzdHJveV9fID0gX29kYl9weS5kZWxldGVfZGJCUGluCgojIFJlZ2lzdGVyIGRiQlBpbiBpbiBfb2RiX3B5Ogpfb2RiX3B5LmRiQlBpbl9zd2lncmVnaXN0ZXIoZGJCUGluKQoKZGVmIGRiQlBpbl9jcmVhdGUoYnRlcm0pOgogICAgcmV0dXJuIF9vZGJfcHkuZGJCUGluX2NyZWF0ZShidGVybSkKCmRlZiBkYkJQaW5fZGVzdHJveSgqYXJncyk6CiAgICByZXR1cm4gX29kYl9weS5kYkJQaW5fZGVzdHJveSgqYXJncykKCmRlZiBkYkJQaW5fZ2V0QlBpbihibG9jaywgb2lkKToKICAgIHJldHVybiBfb2RiX3B5LmRiQlBpbl9nZXRCUGluKGJsb2NrLCBvaWQpCgpjbGFzcyBkYk5ldChvYmplY3QpOgogICAgdGhpc293biA9IHByb3BlcnR5KGxhbWJkYSB4OiB4LnRoaXMub3duKCksIGxhbWJkYSB4LCB2OiB4LnRoaXMub3duKHYpLCBkb2M9J1RoZSBtZW1iZXJzaGlwIGZsYWcnKQogICAgX19yZXByX18gPSBfc3dpZ19yZXByCgogICAgZGVmIGdldE5hbWUoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJOZXRfZ2V0TmFtZShzZWxmKQoKICAgIGRlZiBnZXRDb25zdE5hbWUoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJOZXRfZ2V0Q29uc3ROYW1lKHNlbGYpCgogICAgZGVmIHByaW50TmV0TmFtZShzZWxmLCBmcCwgaWRGbGFnPVRydWUsIG5ld0xpbmU9VHJ1ZSk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJOZXRfcHJpbnROZXROYW1lKHNlbGYsIGZwLCBpZEZsYWcsIG5ld0xpbmUpCgogICAgZGVmIHJlbmFtZShzZWxmLCBuYW1lKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk5ldF9yZW5hbWUoc2VsZiwgbmFtZSkKCiAgICBkZWYgc3dhcE5ldE5hbWVzKHNlbGYsIHNvdXJjZSwgam91cm5hbD1UcnVlKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk5ldF9zd2FwTmV0TmFtZXMoc2VsZiwgc291cmNlLCBqb3VybmFsKQoKICAgIGRlZiBpc1JDRGlzY29ubmVjdGVkKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTmV0X2lzUkNEaXNjb25uZWN0ZWQoc2VsZikKCiAgICBkZWYgc2V0UkNEaXNjb25uZWN0ZWQoc2VsZiwgdmFsdWUpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTmV0X3NldFJDRGlzY29ubmVjdGVkKHNlbGYsIHZhbHVlKQoKICAgIGRlZiBnZXRXZWlnaHQoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJOZXRfZ2V0V2VpZ2h0KHNlbGYpCgogICAgZGVmIHNldFdlaWdodChzZWxmLCB3ZWlnaHQpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTmV0X3NldFdlaWdodChzZWxmLCB3ZWlnaHQpCgogICAgZGVmIGdldFNvdXJjZVR5cGUoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJOZXRfZ2V0U291cmNlVHlwZShzZWxmKQoKICAgIGRlZiBzZXRTb3VyY2VUeXBlKHNlbGYsIHR5cGUpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTmV0X3NldFNvdXJjZVR5cGUoc2VsZiwgdHlwZSkKCiAgICBkZWYgZ2V0WFRhbGtDbGFzcyhzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk5ldF9nZXRYVGFsa0NsYXNzKHNlbGYpCgogICAgZGVmIHNldFhUYWxrQ2xhc3Moc2VsZiwgdmFsdWUpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTmV0X3NldFhUYWxrQ2xhc3Moc2VsZiwgdmFsdWUpCgogICAgZGVmIHNldERyaXZpbmdJVGVybShzZWxmLCBpZCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJOZXRfc2V0RHJpdmluZ0lUZXJtKHNlbGYsIGlkKQoKICAgIGRlZiBnZXREcml2aW5nSVRlcm0oc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJOZXRfZ2V0RHJpdmluZ0lUZXJtKHNlbGYpCgogICAgZGVmIGhhc0ZpeGVkQnVtcChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk5ldF9oYXNGaXhlZEJ1bXAoc2VsZikKCiAgICBkZWYgc2V0Rml4ZWRCdW1wKHNlbGYsIHZhbHVlKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk5ldF9zZXRGaXhlZEJ1bXAoc2VsZiwgdmFsdWUpCgogICAgZGVmIGdldFdpcmVUeXBlKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTmV0X2dldFdpcmVUeXBlKHNlbGYpCgogICAgZGVmIHNldFdpcmVUeXBlKHNlbGYsIHdpcmVfdHlwZSk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJOZXRfc2V0V2lyZVR5cGUoc2VsZiwgd2lyZV90eXBlKQoKICAgIGRlZiBnZXRTaWdUeXBlKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTmV0X2dldFNpZ1R5cGUoc2VsZikKCiAgICBkZWYgc2V0U2lnVHlwZShzZWxmLCBzaWdfdHlwZSk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJOZXRfc2V0U2lnVHlwZShzZWxmLCBzaWdfdHlwZSkKCiAgICBkZWYgaXNFbmNsb3NlZChzZWxmLCBiYm94KToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk5ldF9pc0VuY2xvc2VkKHNlbGYsIGJib3gpCgogICAgZGVmIGlzTWFya2VkKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTmV0X2lzTWFya2VkKHNlbGYpCgogICAgZGVmIGlzTWFya18xZWQoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJOZXRfaXNNYXJrXzFlZChzZWxmKQoKICAgIGRlZiBzZXRNYXJrKHNlbGYsIHZhbHVlKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk5ldF9zZXRNYXJrKHNlbGYsIHZhbHVlKQoKICAgIGRlZiBzZXRNYXJrXzEoc2VsZiwgdmFsdWUpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTmV0X3NldE1hcmtfMShzZWxmLCB2YWx1ZSkKCiAgICBkZWYgaXNTZWxlY3Qoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJOZXRfaXNTZWxlY3Qoc2VsZikKCiAgICBkZWYgc2V0U2VsZWN0KHNlbGYsIHZhbHVlKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk5ldF9zZXRTZWxlY3Qoc2VsZiwgdmFsdWUpCgogICAgZGVmIGlzV2lyZU9yZGVyZWQoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJOZXRfaXNXaXJlT3JkZXJlZChzZWxmKQoKICAgIGRlZiBzZXRXaXJlT3JkZXJlZChzZWxmLCB2YWx1ZSk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJOZXRfc2V0V2lyZU9yZGVyZWQoc2VsZiwgdmFsdWUpCgogICAgZGVmIGlzRGlzY29ubmVjdGVkKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTmV0X2lzRGlzY29ubmVjdGVkKHNlbGYpCgogICAgZGVmIHNldERpc2Nvbm5lY3RlZChzZWxmLCB2YWx1ZSk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJOZXRfc2V0RGlzY29ubmVjdGVkKHNlbGYsIHZhbHVlKQoKICAgIGRlZiBzZXRXaXJlQWx0ZXJlZChzZWxmLCB2YWx1ZSk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJOZXRfc2V0V2lyZUFsdGVyZWQoc2VsZiwgdmFsdWUpCgogICAgZGVmIGlzV2lyZUFsdGVyZWQoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJOZXRfaXNXaXJlQWx0ZXJlZChzZWxmKQoKICAgIGRlZiBzZXRSQ2dyYXBoKHNlbGYsIHZhbHVlKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk5ldF9zZXRSQ2dyYXBoKHNlbGYsIHZhbHVlKQoKICAgIGRlZiBpc1JDZ3JhcGgoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJOZXRfaXNSQ2dyYXBoKHNlbGYpCgogICAgZGVmIHNldEV4dHJhY3RlZChzZWxmLCB2YWx1ZSk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJOZXRfc2V0RXh0cmFjdGVkKHNlbGYsIHZhbHVlKQoKICAgIGRlZiBpc0V4dHJhY3RlZChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk5ldF9pc0V4dHJhY3RlZChzZWxmKQoKICAgIGRlZiBzZXRTcGVmKHNlbGYsIHZhbHVlKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk5ldF9zZXRTcGVmKHNlbGYsIHZhbHVlKQoKICAgIGRlZiBpc1NwZWYoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJOZXRfaXNTcGVmKHNlbGYpCgogICAgZGVmIHNldERvTm90VG91Y2goc2VsZiwgdik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJOZXRfc2V0RG9Ob3RUb3VjaChzZWxmLCB2KQoKICAgIGRlZiBpc0RvTm90VG91Y2goc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJOZXRfaXNEb05vdFRvdWNoKHNlbGYpCgogICAgZGVmIGdldEJsb2NrKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTmV0X2dldEJsb2NrKHNlbGYpCgogICAgZGVmIGdldElUZXJtcyhzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk5ldF9nZXRJVGVybXMoc2VsZikKCiAgICBkZWYgZ2V0MXN0SVRlcm0oc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJOZXRfZ2V0MXN0SVRlcm0oc2VsZikKCiAgICBkZWYgZ2V0MXN0U2lnbmFsSW5wdXQoc2VsZiwgaW8pOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTmV0X2dldDFzdFNpZ25hbElucHV0KHNlbGYsIGlvKQoKICAgIGRlZiBnZXRGaXJzdE91dHB1dChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk5ldF9nZXRGaXJzdE91dHB1dChzZWxmKQoKICAgIGRlZiBnZXRCVGVybXMoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJOZXRfZ2V0QlRlcm1zKHNlbGYpCgogICAgZGVmIGdldDFzdEJUZXJtKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTmV0X2dldDFzdEJUZXJtKHNlbGYpCgogICAgZGVmIGdldFNXaXJlcyhzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk5ldF9nZXRTV2lyZXMoc2VsZikKCiAgICBkZWYgZ2V0V2lyZShzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk5ldF9nZXRXaXJlKHNlbGYpCgogICAgZGVmIGdldEZpcnN0U1dpcmUoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJOZXRfZ2V0Rmlyc3RTV2lyZShzZWxmKQoKICAgIGRlZiBnZXRHbG9iYWxXaXJlKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTmV0X2dldEdsb2JhbFdpcmUoc2VsZikKCiAgICBkZWYgaXNTcGVjaWFsKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTmV0X2lzU3BlY2lhbChzZWxmKQoKICAgIGRlZiBzZXRTcGVjaWFsKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTmV0X3NldFNwZWNpYWwoc2VsZikKCiAgICBkZWYgY2xlYXJTcGVjaWFsKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTmV0X2NsZWFyU3BlY2lhbChzZWxmKQoKICAgIGRlZiBpc0Nvbm5lY3RlZEJ5QWJ1dG1lbnQoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJOZXRfaXNDb25uZWN0ZWRCeUFidXRtZW50KHNlbGYpCgogICAgZGVmIHNldElPZmxhZyhzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk5ldF9zZXRJT2ZsYWcoc2VsZikKCiAgICBkZWYgaXNJTyhzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk5ldF9pc0lPKHNlbGYpCgogICAgZGVmIGlzV2lsZENvbm5lY3RlZChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk5ldF9pc1dpbGRDb25uZWN0ZWQoc2VsZikKCiAgICBkZWYgc2V0V2lsZENvbm5lY3RlZChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk5ldF9zZXRXaWxkQ29ubmVjdGVkKHNlbGYpCgogICAgZGVmIGNsZWFyV2lsZENvbm5lY3RlZChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk5ldF9jbGVhcldpbGRDb25uZWN0ZWQoc2VsZikKCiAgICBkZWYgZ2V0R25kY0NhbGliRmFjdG9yKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTmV0X2dldEduZGNDYWxpYkZhY3RvcihzZWxmKQoKICAgIGRlZiBzZXRHbmRjQ2FsaWJGYWN0b3Ioc2VsZiwgZ25kY0NhbGliKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk5ldF9zZXRHbmRjQ2FsaWJGYWN0b3Ioc2VsZiwgZ25kY0NhbGliKQoKICAgIGRlZiBjYWxpYnJhdGVDYXBhY2l0YW5jZShzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk5ldF9jYWxpYnJhdGVDYXBhY2l0YW5jZShzZWxmKQoKICAgIGRlZiBjYWxpYnJhdGVHbmRDYXAoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJOZXRfY2FsaWJyYXRlR25kQ2FwKHNlbGYpCgogICAgZGVmIGNhbGlicmF0ZUNvdXBsaW5nQ2FwKHNlbGYsICphcmdzKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk5ldF9jYWxpYnJhdGVDb3VwbGluZ0NhcChzZWxmLCAqYXJncykKCiAgICBkZWYgZ2V0Q2NDYWxpYkZhY3RvcihzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk5ldF9nZXRDY0NhbGliRmFjdG9yKHNlbGYpCgogICAgZGVmIHNldENjQ2FsaWJGYWN0b3Ioc2VsZiwgY2NDYWxpYik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJOZXRfc2V0Q2NDYWxpYkZhY3RvcihzZWxmLCBjY0NhbGliKQoKICAgIGRlZiBhZGp1c3ROZXRSZXMoc2VsZiwgKmFyZ3MpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTmV0X2FkanVzdE5ldFJlcyhzZWxmLCAqYXJncykKCiAgICBkZWYgYWRqdXN0TmV0R25kQ2FwKHNlbGYsICphcmdzKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk5ldF9hZGp1c3ROZXRHbmRDYXAoc2VsZiwgKmFyZ3MpCgogICAgZGVmIGdldENjQWRqdXN0RmFjdG9yKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTmV0X2dldENjQWRqdXN0RmFjdG9yKHNlbGYpCgogICAgZGVmIHNldENjQWRqdXN0RmFjdG9yKHNlbGYsIGZhY3Rvcik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJOZXRfc2V0Q2NBZGp1c3RGYWN0b3Ioc2VsZiwgZmFjdG9yKQoKICAgIGRlZiBnZXRDY0FkanVzdE9yZGVyKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTmV0X2dldENjQWRqdXN0T3JkZXIoc2VsZikKCiAgICBkZWYgc2V0Q2NBZGp1c3RPcmRlcihzZWxmLCBvcmRlcik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJOZXRfc2V0Q2NBZGp1c3RPcmRlcihzZWxmLCBvcmRlcikKCiAgICBkZWYgYWRqdXN0Q0Moc2VsZiwgYWRqT3JkZXIsIGFkakZhY3RvciwgY2NUaHJlc2hIb2xkLCBhZGp1c3RlZENDLCBoYWxvbmV0cyk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJOZXRfYWRqdXN0Q0Moc2VsZiwgYWRqT3JkZXIsIGFkakZhY3RvciwgY2NUaHJlc2hIb2xkLCBhZGp1c3RlZENDLCBoYWxvbmV0cykKCiAgICBkZWYgdW5kb0FkanVzdGVkQ0Moc2VsZiwgYWRqdXN0ZWRDQywgaGFsb25ldHMpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTmV0X3VuZG9BZGp1c3RlZENDKHNlbGYsIGFkanVzdGVkQ0MsIGhhbG9uZXRzKQoKICAgIGRlZiBncm91bmRDQyhzZWxmLCBnbmRGYWN0b3IpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTmV0X2dyb3VuZENDKHNlbGYsIGduZEZhY3RvcikKCiAgICBkZWYgYWRkRGJDYyhzZWxmLCBjYXApOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTmV0X2FkZERiQ2Moc2VsZiwgY2FwKQoKICAgIGRlZiBnZXREYkNjKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTmV0X2dldERiQ2Moc2VsZikKCiAgICBkZWYgc2V0RGJDYyhzZWxmLCBjYXApOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTmV0X3NldERiQ2Moc2VsZiwgY2FwKQoKICAgIGRlZiBnZXRSZWZDYyhzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk5ldF9nZXRSZWZDYyhzZWxmKQoKICAgIGRlZiBzZXRSZWZDYyhzZWxmLCBjYXApOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTmV0X3NldFJlZkNjKHNlbGYsIGNhcCkKCiAgICBkZWYgZ2V0Q2NNYXRjaFJhdGlvKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTmV0X2dldENjTWF0Y2hSYXRpbyhzZWxmKQoKICAgIGRlZiBzZXRDY01hdGNoUmF0aW8oc2VsZiwgcmF0aW8pOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTmV0X3NldENjTWF0Y2hSYXRpbyhzZWxmLCByYXRpbykKCiAgICBkZWYgZ2V0R25kVG90YWxDYXAoc2VsZiwgZ25kY2FwLCB0b3RhbGNhcCwgTWlsbGVyTXVsdCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJOZXRfZ2V0R25kVG90YWxDYXAoc2VsZiwgZ25kY2FwLCB0b3RhbGNhcCwgTWlsbGVyTXVsdCkKCiAgICBkZWYgcHJlRXh0dHJlZU1lcmdlUkMoc2VsZiwgbWF4X2NhcCwgY29ybmVyKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk5ldF9wcmVFeHR0cmVlTWVyZ2VSQyhzZWxmLCBtYXhfY2FwLCBjb3JuZXIpCgogICAgZGVmIGZpbmRDYXBOb2RlKHNlbGYsIG5vZGVJZCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJOZXRfZmluZENhcE5vZGUoc2VsZiwgbm9kZUlkKQoKICAgIGRlZiBnZXRDYXBOb2RlcyhzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk5ldF9nZXRDYXBOb2RlcyhzZWxmKQoKICAgIGRlZiBkZXN0cm95Q2FwTm9kZXMoc2VsZiwgY2xlYW5FeHRpZCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJOZXRfZGVzdHJveUNhcE5vZGVzKHNlbGYsIGNsZWFuRXh0aWQpCgogICAgZGVmIHJldmVyc2VSU2VncyhzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk5ldF9yZXZlcnNlUlNlZ3Moc2VsZikKCiAgICBkZWYgc2V0MXN0UlNlZ0lkKHNlbGYsIHJzZWdfaWQpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTmV0X3NldDFzdFJTZWdJZChzZWxmLCByc2VnX2lkKQoKICAgIGRlZiBnZXRaZXJvUlNlZyhzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk5ldF9nZXRaZXJvUlNlZyhzZWxmKQoKICAgIGRlZiBnZXQxc3RSU2VnSWQoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJOZXRfZ2V0MXN0UlNlZ0lkKHNlbGYpCgogICAgZGVmIGZpbmRSU2VnKHNlbGYsIHNyY24sIHRndG4pOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTmV0X2ZpbmRSU2VnKHNlbGYsIHNyY24sIHRndG4pCgogICAgZGVmIHNldDFzdENhcE5vZGVJZChzZWxmLCBjYXBuX2lkKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk5ldF9zZXQxc3RDYXBOb2RlSWQoc2VsZiwgY2Fwbl9pZCkKCiAgICBkZWYgZ2V0MXN0Q2FwTm9kZUlkKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTmV0X2dldDFzdENhcE5vZGVJZChzZWxmKQoKICAgIGRlZiBzZXRUZXJtRXh0SWRzKHNlbGYsIGNhcElkKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk5ldF9zZXRUZXJtRXh0SWRzKHNlbGYsIGNhcElkKQoKICAgIGRlZiBnZXRSU2VnQ291bnQoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJOZXRfZ2V0UlNlZ0NvdW50KHNlbGYpCgogICAgZGVmIGdldFJTZWdzKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTmV0X2dldFJTZWdzKHNlbGYpCgogICAgZGVmIGNvbGxhcHNlSW50ZXJuYWxDYXBOdW0oc2VsZiwgY2FwTm9kZU1hcCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJOZXRfY29sbGFwc2VJbnRlcm5hbENhcE51bShzZWxmLCBjYXBOb2RlTWFwKQoKICAgIGRlZiBtYXhJbnRlcm5hbENhcE51bShzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk5ldF9tYXhJbnRlcm5hbENhcE51bShzZWxmKQoKICAgIGRlZiBnZXRDYXBOb2RlQ291bnQoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJOZXRfZ2V0Q2FwTm9kZUNvdW50KHNlbGYpCgogICAgZGVmIGdldENjQ291bnQoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJOZXRfZ2V0Q2NDb3VudChzZWxmKQoKICAgIGRlZiBkZXN0cm95UlNlZ3Moc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJOZXRfZGVzdHJveVJTZWdzKHNlbGYpCgogICAgZGVmIHJldmVyc2VDQ1NlZ3Moc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJOZXRfcmV2ZXJzZUNDU2VncyhzZWxmKQoKICAgIGRlZiBnZXRTcmNDQ1NlZ3Moc2VsZiwgc2Vncyk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJOZXRfZ2V0U3JjQ0NTZWdzKHNlbGYsIHNlZ3MpCgogICAgZGVmIGdldFRndENDU2VncyhzZWxmLCBzZWdzKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk5ldF9nZXRUZ3RDQ1NlZ3Moc2VsZiwgc2VncykKCiAgICBkZWYgZ2V0Q291cGxpbmdOZXRzKHNlbGYsIGNvcm5lciwgY2NUaHJlc2hvbGQsIGNuZXRzKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk5ldF9nZXRDb3VwbGluZ05ldHMoc2VsZiwgY29ybmVyLCBjY1RocmVzaG9sZCwgY25ldHMpCgogICAgZGVmIGRlc3Ryb3lDQ1NlZ3Moc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJOZXRfZGVzdHJveUNDU2VncyhzZWxmKQoKICAgIGRlZiBkZXN0cm95UGFyYXNpdGljcyhzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk5ldF9kZXN0cm95UGFyYXNpdGljcyhzZWxmKQoKICAgIGRlZiBnZXRUb3RhbENhcGFjaXRhbmNlKHNlbGYsIGNvcm5lcj0wLCBjYz1GYWxzZSk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJOZXRfZ2V0VG90YWxDYXBhY2l0YW5jZShzZWxmLCBjb3JuZXIsIGNjKQoKICAgIGRlZiBnZXRUb3RhbENvdXBsaW5nQ2FwKHNlbGYsIGNvcm5lcj0wKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk5ldF9nZXRUb3RhbENvdXBsaW5nQ2FwKHNlbGYsIGNvcm5lcikKCiAgICBkZWYgZ2V0VG90YWxSZXNpc3RhbmNlKHNlbGYsIGNvcm5lcj0wKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk5ldF9nZXRUb3RhbFJlc2lzdGFuY2Uoc2VsZiwgY29ybmVyKQoKICAgIGRlZiBzZXROb25EZWZhdWx0UnVsZShzZWxmLCBydWxlKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk5ldF9zZXROb25EZWZhdWx0UnVsZShzZWxmLCBydWxlKQoKICAgIGRlZiBnZXROb25EZWZhdWx0UnVsZShzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk5ldF9nZXROb25EZWZhdWx0UnVsZShzZWxmKQoKICAgIGRlZiBnZXROZXRTdGF0cyhzZWxmLCB3aXJlQ250LCB2aWFDbnQsIGxlbiwgbGF5ZXJDbnQsIGxldmVsVGFibGUpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTmV0X2dldE5ldFN0YXRzKHNlbGYsIHdpcmVDbnQsIHZpYUNudCwgbGVuLCBsYXllckNudCwgbGV2ZWxUYWJsZSkKCiAgICBkZWYgZ2V0V2lyZUNvdW50KHNlbGYsIHdpcmVDbnQsIHZpYUNudCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJOZXRfZ2V0V2lyZUNvdW50KHNlbGYsIHdpcmVDbnQsIHZpYUNudCkKCiAgICBkZWYgZ2V0U2lnbmFsV2lyZUNvdW50KHNlbGYsIHdpcmVDbnQsIHZpYUNudCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJOZXRfZ2V0U2lnbmFsV2lyZUNvdW50KHNlbGYsIHdpcmVDbnQsIHZpYUNudCkKCiAgICBkZWYgZ2V0UG93ZXJXaXJlQ291bnQoc2VsZiwgd2lyZUNudCwgdmlhQ250KToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk5ldF9nZXRQb3dlcldpcmVDb3VudChzZWxmLCB3aXJlQ250LCB2aWFDbnQpCgogICAgZGVmIGdldFRlcm1Db3VudChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk5ldF9nZXRUZXJtQ291bnQoc2VsZikKCiAgICBkZWYgZ2V0SVRlcm1Db3VudChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk5ldF9nZXRJVGVybUNvdW50KHNlbGYpCgogICAgZGVmIGdldEJUZXJtQ291bnQoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJOZXRfZ2V0QlRlcm1Db3VudChzZWxmKQoKICAgIGRlZiBnZXRUZXJtQkJveChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk5ldF9nZXRUZXJtQkJveChzZWxmKQoKICAgIGRlZiBkZXN0cm95U1dpcmVzKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTmV0X2Rlc3Ryb3lTV2lyZXMoc2VsZikKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgY3JlYXRlKGJsb2NrLCBuYW1lLCBza2lwRXhpc3RpbmdDaGVjaz1GYWxzZSk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJOZXRfY3JlYXRlKGJsb2NrLCBuYW1lLCBza2lwRXhpc3RpbmdDaGVjaykKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgbWFya05ldHMobmV0cywgYmxvY2ssIG1rKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk5ldF9tYXJrTmV0cyhuZXRzLCBibG9jaywgbWspCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIGRlc3Ryb3koKmFyZ3MpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTmV0X2Rlc3Ryb3koKmFyZ3MpCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIGdldE5ldChibG9jaywgb2lkKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk5ldF9nZXROZXQoYmxvY2ssIG9pZCkKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgZ2V0VmFsaWROZXQoYmxvY2ssIG9pZCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJOZXRfZ2V0VmFsaWROZXQoYmxvY2ssIG9pZCkKCiAgICBkZWYgY2FuTWVyZ2VOZXQoc2VsZiwgaW5fbmV0KToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk5ldF9jYW5NZXJnZU5ldChzZWxmLCBpbl9uZXQpCgogICAgZGVmIG1lcmdlTmV0KHNlbGYsIGluX25ldCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJOZXRfbWVyZ2VOZXQoc2VsZiwgaW5fbmV0KQoKICAgIGRlZiBmaW5kTWFpblBhcmVudE1vZEluc3Qoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJOZXRfZmluZE1haW5QYXJlbnRNb2RJbnN0KHNlbGYpCgogICAgZGVmIGZpbmRNYWluUGFyZW50TW9kdWxlKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTmV0X2ZpbmRNYWluUGFyZW50TW9kdWxlKHNlbGYpCgogICAgZGVmIGdldEd1aWRlcyhzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk5ldF9nZXRHdWlkZXMoc2VsZikKCiAgICBkZWYgY2xlYXJHdWlkZXMoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJOZXRfY2xlYXJHdWlkZXMoc2VsZikKCiAgICBkZWYgZ2V0VHJhY2tzKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTmV0X2dldFRyYWNrcyhzZWxmKQoKICAgIGRlZiBjbGVhclRyYWNrcyhzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk5ldF9jbGVhclRyYWNrcyhzZWxmKQoKICAgIGRlZiBoYXNKdW1wZXJzKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTmV0X2hhc0p1bXBlcnMoc2VsZikKCiAgICBkZWYgc2V0SnVtcGVycyhzZWxmLCBoYXNfanVtcGVycyk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJOZXRfc2V0SnVtcGVycyhzZWxmLCBoYXNfanVtcGVycykKCiAgICBkZWYgaXNEZWVwZXJUaGFuKHNlbGYsIG5ldCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJOZXRfaXNEZWVwZXJUaGFuKHNlbGYsIG5ldCkKCiAgICBkZWYgZmluZFJlbGF0ZWRNb2ROZXRzKHNlbGYsIG1vZG5ldF9zZXQpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTmV0X2ZpbmRSZWxhdGVkTW9kTmV0cyhzZWxmLCBtb2RuZXRfc2V0KQoKICAgIGRlZiBmaW5kTW9kTmV0SW5IaWdoZXN0SGllcihzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk5ldF9maW5kTW9kTmV0SW5IaWdoZXN0SGllcihzZWxmKQoKICAgIGRlZiByZW5hbWVXaXRoTW9kTmV0SW5IaWdoZXN0SGllcihzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk5ldF9yZW5hbWVXaXRoTW9kTmV0SW5IaWdoZXN0SGllcihzZWxmKQoKICAgIGRlZiBjaGVja1Nhbml0eShzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk5ldF9jaGVja1Nhbml0eShzZWxmKQoKICAgIGRlZiBkdW1wKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTmV0X2R1bXAoc2VsZikKCiAgICBkZWYgX19pbml0X18oc2VsZik6CiAgICAgICAgX29kYl9weS5kYk5ldF9zd2lnaW5pdChzZWxmLCBfb2RiX3B5Lm5ld19kYk5ldCgpKQogICAgX19zd2lnX2Rlc3Ryb3lfXyA9IF9vZGJfcHkuZGVsZXRlX2RiTmV0CgojIFJlZ2lzdGVyIGRiTmV0IGluIF9vZGJfcHk6Cl9vZGJfcHkuZGJOZXRfc3dpZ3JlZ2lzdGVyKGRiTmV0KQoKZGVmIGRiTmV0X2NyZWF0ZShibG9jaywgbmFtZSwgc2tpcEV4aXN0aW5nQ2hlY2s9RmFsc2UpOgogICAgcmV0dXJuIF9vZGJfcHkuZGJOZXRfY3JlYXRlKGJsb2NrLCBuYW1lLCBza2lwRXhpc3RpbmdDaGVjaykKCmRlZiBkYk5ldF9tYXJrTmV0cyhuZXRzLCBibG9jaywgbWspOgogICAgcmV0dXJuIF9vZGJfcHkuZGJOZXRfbWFya05ldHMobmV0cywgYmxvY2ssIG1rKQoKZGVmIGRiTmV0X2Rlc3Ryb3koKmFyZ3MpOgogICAgcmV0dXJuIF9vZGJfcHkuZGJOZXRfZGVzdHJveSgqYXJncykKCmRlZiBkYk5ldF9nZXROZXQoYmxvY2ssIG9pZCk6CiAgICByZXR1cm4gX29kYl9weS5kYk5ldF9nZXROZXQoYmxvY2ssIG9pZCkKCmRlZiBkYk5ldF9nZXRWYWxpZE5ldChibG9jaywgb2lkKToKICAgIHJldHVybiBfb2RiX3B5LmRiTmV0X2dldFZhbGlkTmV0KGJsb2NrLCBvaWQpCgpjbGFzcyBkYkluc3Qob2JqZWN0KToKICAgIHRoaXNvd24gPSBwcm9wZXJ0eShsYW1iZGEgeDogeC50aGlzLm93bigpLCBsYW1iZGEgeCwgdjogeC50aGlzLm93bih2KSwgZG9jPSdUaGUgbWVtYmVyc2hpcCBmbGFnJykKICAgIF9fcmVwcl9fID0gX3N3aWdfcmVwcgoKICAgIGRlZiBnZXROYW1lKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiSW5zdF9nZXROYW1lKHNlbGYpCgogICAgZGVmIGdldENvbnN0TmFtZShzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkluc3RfZ2V0Q29uc3ROYW1lKHNlbGYpCgogICAgZGVmIGlzTmFtZWQoc2VsZiwgbmFtZSk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJJbnN0X2lzTmFtZWQoc2VsZiwgbmFtZSkKCiAgICBkZWYgcmVuYW1lKHNlbGYsIG5hbWUpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiSW5zdF9yZW5hbWUoc2VsZiwgbmFtZSkKCiAgICBkZWYgZ2V0T3JpZ2luKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiSW5zdF9nZXRPcmlnaW4oc2VsZikKCiAgICBkZWYgc2V0T3JpZ2luKHNlbGYsIHgsIHkpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiSW5zdF9zZXRPcmlnaW4oc2VsZiwgeCwgeSkKCiAgICBkZWYgZ2V0T3JpZW50KHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiSW5zdF9nZXRPcmllbnQoc2VsZikKCiAgICBkZWYgc2V0T3JpZW50KHNlbGYsIG9yaWVudCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJJbnN0X3NldE9yaWVudChzZWxmLCBvcmllbnQpCgogICAgZGVmIGdldExvY2F0aW9uKHNlbGYsICphcmdzKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkluc3RfZ2V0TG9jYXRpb24oc2VsZiwgKmFyZ3MpCgogICAgZGVmIHNldExvY2F0aW9uKHNlbGYsIHgsIHkpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiSW5zdF9zZXRMb2NhdGlvbihzZWxmLCB4LCB5KQoKICAgIGRlZiBzZXRMb2NhdGlvbk9yaWVudChzZWxmLCBvcmllbnQpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiSW5zdF9zZXRMb2NhdGlvbk9yaWVudChzZWxmLCBvcmllbnQpCgogICAgZGVmIGdldFRyYW5zZm9ybShzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkluc3RfZ2V0VHJhbnNmb3JtKHNlbGYpCgogICAgZGVmIHNldFRyYW5zZm9ybShzZWxmLCB0KToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkluc3Rfc2V0VHJhbnNmb3JtKHNlbGYsIHQpCgogICAgZGVmIGdldEhpZXJUcmFuc2Zvcm0oc2VsZiwgdCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJJbnN0X2dldEhpZXJUcmFuc2Zvcm0oc2VsZiwgdCkKCiAgICBkZWYgZ2V0QkJveChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkluc3RfZ2V0QkJveChzZWxmKQoKICAgIGRlZiBnZXRQbGFjZW1lbnRTdGF0dXMoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJJbnN0X2dldFBsYWNlbWVudFN0YXR1cyhzZWxmKQoKICAgIGRlZiBpc0ZpeGVkKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiSW5zdF9pc0ZpeGVkKHNlbGYpCgogICAgZGVmIGlzUGxhY2VkKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiSW5zdF9pc1BsYWNlZChzZWxmKQoKICAgIGRlZiBzZXRQbGFjZW1lbnRTdGF0dXMoc2VsZiwgc3RhdHVzKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkluc3Rfc2V0UGxhY2VtZW50U3RhdHVzKHNlbGYsIHN0YXR1cykKCiAgICBkZWYgZ2V0RWNvQ3JlYXRlKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiSW5zdF9nZXRFY29DcmVhdGUoc2VsZikKCiAgICBkZWYgZ2V0RWNvRGVzdHJveShzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkluc3RfZ2V0RWNvRGVzdHJveShzZWxmKQoKICAgIGRlZiBnZXRFY29Nb2RpZnkoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJJbnN0X2dldEVjb01vZGlmeShzZWxmKQoKICAgIGRlZiBzZXRFY29DcmVhdGUoc2VsZiwgdik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJJbnN0X3NldEVjb0NyZWF0ZShzZWxmLCB2KQoKICAgIGRlZiBzZXRFY29EZXN0cm95KHNlbGYsIHYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiSW5zdF9zZXRFY29EZXN0cm95KHNlbGYsIHYpCgogICAgZGVmIHNldEVjb01vZGlmeShzZWxmLCB2KToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkluc3Rfc2V0RWNvTW9kaWZ5KHNlbGYsIHYpCgogICAgZGVmIGdldFVzZXJGbGFnMShzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkluc3RfZ2V0VXNlckZsYWcxKHNlbGYpCgogICAgZGVmIHNldFVzZXJGbGFnMShzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkluc3Rfc2V0VXNlckZsYWcxKHNlbGYpCgogICAgZGVmIGNsZWFyVXNlckZsYWcxKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiSW5zdF9jbGVhclVzZXJGbGFnMShzZWxmKQoKICAgIGRlZiBnZXRVc2VyRmxhZzIoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJJbnN0X2dldFVzZXJGbGFnMihzZWxmKQoKICAgIGRlZiBzZXRVc2VyRmxhZzIoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJJbnN0X3NldFVzZXJGbGFnMihzZWxmKQoKICAgIGRlZiBjbGVhclVzZXJGbGFnMihzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkluc3RfY2xlYXJVc2VyRmxhZzIoc2VsZikKCiAgICBkZWYgZ2V0VXNlckZsYWczKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiSW5zdF9nZXRVc2VyRmxhZzMoc2VsZikKCiAgICBkZWYgc2V0VXNlckZsYWczKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiSW5zdF9zZXRVc2VyRmxhZzMoc2VsZikKCiAgICBkZWYgY2xlYXJVc2VyRmxhZzMoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJJbnN0X2NsZWFyVXNlckZsYWczKHNlbGYpCgogICAgZGVmIHNldERvTm90VG91Y2goc2VsZiwgdik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJJbnN0X3NldERvTm90VG91Y2goc2VsZiwgdikKCiAgICBkZWYgaXNEb05vdFRvdWNoKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiSW5zdF9pc0RvTm90VG91Y2goc2VsZikKCiAgICBkZWYgZ2V0QmxvY2soc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJJbnN0X2dldEJsb2NrKHNlbGYpCgogICAgZGVmIGdldE1hc3RlcihzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkluc3RfZ2V0TWFzdGVyKHNlbGYpCgogICAgZGVmIGdldEdyb3VwKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiSW5zdF9nZXRHcm91cChzZWxmKQoKICAgIGRlZiBnZXRJVGVybXMoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJJbnN0X2dldElUZXJtcyhzZWxmKQoKICAgIGRlZiBnZXRGaXJzdE91dHB1dChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkluc3RfZ2V0Rmlyc3RPdXRwdXQoc2VsZikKCiAgICBkZWYgZ2V0UmVnaW9uKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiSW5zdF9nZXRSZWdpb24oc2VsZikKCiAgICBkZWYgZ2V0TW9kdWxlKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiSW5zdF9nZXRNb2R1bGUoc2VsZikKCiAgICBkZWYgZmluZElUZXJtKHNlbGYsIHRlcm1pbmFsX25hbWUpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiSW5zdF9maW5kSVRlcm0oc2VsZiwgdGVybWluYWxfbmFtZSkKCiAgICBkZWYgZ2V0Q29ubmVjdGl2aXR5KHNlbGYsICphcmdzKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkluc3RfZ2V0Q29ubmVjdGl2aXR5KHNlbGYsICphcmdzKQoKICAgIGRlZiBiaW5kQmxvY2soc2VsZiwgYmxvY2ssIGZvcmNlPUZhbHNlKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkluc3RfYmluZEJsb2NrKHNlbGYsIGJsb2NrLCBmb3JjZSkKCiAgICBkZWYgdW5iaW5kQmxvY2soc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJJbnN0X3VuYmluZEJsb2NrKHNlbGYpCgogICAgZGVmIHJlc2V0SGllcmFyY2h5KHNlbGYsIHZlcmJvc2UpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiSW5zdF9yZXNldEhpZXJhcmNoeShzZWxmLCB2ZXJib3NlKQoKICAgIGRlZiBnZXRDaGlsZChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkluc3RfZ2V0Q2hpbGQoc2VsZikKCiAgICBkZWYgZ2V0UGFyZW50KHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiSW5zdF9nZXRQYXJlbnQoc2VsZikKCiAgICBkZWYgZ2V0Q2hpbGRyZW4oc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJJbnN0X2dldENoaWxkcmVuKHNlbGYpCgogICAgZGVmIGlzSGllcmFyY2hpY2FsKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiSW5zdF9pc0hpZXJhcmNoaWNhbChzZWxmKQoKICAgIGRlZiBpc1BoeXNpY2FsT25seShzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkluc3RfaXNQaHlzaWNhbE9ubHkoc2VsZikKCiAgICBkZWYgZ2V0SGFsbyhzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkluc3RfZ2V0SGFsbyhzZWxmKQoKICAgIGRlZiBnZXRXZWlnaHQoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJJbnN0X2dldFdlaWdodChzZWxmKQoKICAgIGRlZiBzZXRXZWlnaHQoc2VsZiwgd2VpZ2h0KToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkluc3Rfc2V0V2VpZ2h0KHNlbGYsIHdlaWdodCkKCiAgICBkZWYgZ2V0U291cmNlVHlwZShzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkluc3RfZ2V0U291cmNlVHlwZShzZWxmKQoKICAgIGRlZiBzZXRTb3VyY2VUeXBlKHNlbGYsIHR5cGUpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiSW5zdF9zZXRTb3VyY2VUeXBlKHNlbGYsIHR5cGUpCgogICAgZGVmIGdldElUZXJtKHNlbGYsICphcmdzKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkluc3RfZ2V0SVRlcm0oc2VsZiwgKmFyZ3MpCgogICAgZGVmIHN3YXBNYXN0ZXIoc2VsZiwgbWFzdGVyKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkluc3Rfc3dhcE1hc3RlcihzZWxmLCBtYXN0ZXIpCgogICAgZGVmIGlzQmxvY2soc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJJbnN0X2lzQmxvY2soc2VsZikKCiAgICBkZWYgaXNDb3JlKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiSW5zdF9pc0NvcmUoc2VsZikKCiAgICBkZWYgaXNQYWQoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJJbnN0X2lzUGFkKHNlbGYpCgogICAgZGVmIGlzRW5kQ2FwKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiSW5zdF9pc0VuZENhcChzZWxmKQoKICAgIGRlZiBnZXRTY2FuSW5zdChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkluc3RfZ2V0U2Nhbkluc3Qoc2VsZikKCiAgICBkZWYgc2V0UGluQWNjZXNzSWR4KHNlbGYsIGlkeCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJJbnN0X3NldFBpbkFjY2Vzc0lkeChzZWxmLCBpZHgpCgogICAgZGVmIGdldFBpbkFjY2Vzc0lkeChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkluc3RfZ2V0UGluQWNjZXNzSWR4KHNlbGYpCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIG1ha2VVbmlxdWVEYkluc3QoYmxvY2ssIG1hc3RlciwgbmFtZSwgcGh5c2ljYWxfb25seSwgdGFyZ2V0X21vZHVsZSk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJJbnN0X21ha2VVbmlxdWVEYkluc3QoYmxvY2ssIG1hc3RlciwgbmFtZSwgcGh5c2ljYWxfb25seSwgdGFyZ2V0X21vZHVsZSkKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgY3JlYXRlKCphcmdzKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkluc3RfY3JlYXRlKCphcmdzKQoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBkZXN0cm95KCphcmdzKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkluc3RfZGVzdHJveSgqYXJncykKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgZ2V0SW5zdChibG9jaywgb2lkKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkluc3RfZ2V0SW5zdChibG9jaywgb2lkKQoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBnZXRWYWxpZEluc3QoYmxvY2ssIG9pZCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJJbnN0X2dldFZhbGlkSW5zdChibG9jaywgb2lkKQoKICAgIGRlZiBfX2luaXRfXyhzZWxmKToKICAgICAgICBfb2RiX3B5LmRiSW5zdF9zd2lnaW5pdChzZWxmLCBfb2RiX3B5Lm5ld19kYkluc3QoKSkKICAgIF9fc3dpZ19kZXN0cm95X18gPSBfb2RiX3B5LmRlbGV0ZV9kYkluc3QKCiMgUmVnaXN0ZXIgZGJJbnN0IGluIF9vZGJfcHk6Cl9vZGJfcHkuZGJJbnN0X3N3aWdyZWdpc3RlcihkYkluc3QpCgpkZWYgZGJJbnN0X21ha2VVbmlxdWVEYkluc3QoYmxvY2ssIG1hc3RlciwgbmFtZSwgcGh5c2ljYWxfb25seSwgdGFyZ2V0X21vZHVsZSk6CiAgICByZXR1cm4gX29kYl9weS5kYkluc3RfbWFrZVVuaXF1ZURiSW5zdChibG9jaywgbWFzdGVyLCBuYW1lLCBwaHlzaWNhbF9vbmx5LCB0YXJnZXRfbW9kdWxlKQoKZGVmIGRiSW5zdF9jcmVhdGUoKmFyZ3MpOgogICAgcmV0dXJuIF9vZGJfcHkuZGJJbnN0X2NyZWF0ZSgqYXJncykKCmRlZiBkYkluc3RfZGVzdHJveSgqYXJncyk6CiAgICByZXR1cm4gX29kYl9weS5kYkluc3RfZGVzdHJveSgqYXJncykKCmRlZiBkYkluc3RfZ2V0SW5zdChibG9jaywgb2lkKToKICAgIHJldHVybiBfb2RiX3B5LmRiSW5zdF9nZXRJbnN0KGJsb2NrLCBvaWQpCgpkZWYgZGJJbnN0X2dldFZhbGlkSW5zdChibG9jaywgb2lkKToKICAgIHJldHVybiBfb2RiX3B5LmRiSW5zdF9nZXRWYWxpZEluc3QoYmxvY2ssIG9pZCkKCmNsYXNzIGRiSVRlcm0ob2JqZWN0KToKICAgIHRoaXNvd24gPSBwcm9wZXJ0eShsYW1iZGEgeDogeC50aGlzLm93bigpLCBsYW1iZGEgeCwgdjogeC50aGlzLm93bih2KSwgZG9jPSdUaGUgbWVtYmVyc2hpcCBmbGFnJykKICAgIF9fcmVwcl9fID0gX3N3aWdfcmVwcgoKICAgIGRlZiBnZXRJbnN0KHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiSVRlcm1fZ2V0SW5zdChzZWxmKQoKICAgIGRlZiBnZXROZXQoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJJVGVybV9nZXROZXQoc2VsZikKCiAgICBkZWYgZ2V0TW9kTmV0KHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiSVRlcm1fZ2V0TW9kTmV0KHNlbGYpCgogICAgZGVmIGdldE1UZXJtKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiSVRlcm1fZ2V0TVRlcm0oc2VsZikKCiAgICBkZWYgZ2V0TmFtZShzZWxmLCAqYXJncyk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJJVGVybV9nZXROYW1lKHNlbGYsICphcmdzKQoKICAgIGRlZiBnZXRCQm94KHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiSVRlcm1fZ2V0QkJveChzZWxmKQoKICAgIGRlZiBnZXRCbG9jayhzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYklUZXJtX2dldEJsb2NrKHNlbGYpCgogICAgZGVmIGdldFNpZ1R5cGUoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJJVGVybV9nZXRTaWdUeXBlKHNlbGYpCgogICAgZGVmIGdldElvVHlwZShzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYklUZXJtX2dldElvVHlwZShzZWxmKQoKICAgIGRlZiBpc0lucHV0U2lnbmFsKHNlbGYsIGlvPVRydWUpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiSVRlcm1faXNJbnB1dFNpZ25hbChzZWxmLCBpbykKCiAgICBkZWYgaXNPdXRwdXRTaWduYWwoc2VsZiwgaW89VHJ1ZSk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJJVGVybV9pc091dHB1dFNpZ25hbChzZWxmLCBpbykKCiAgICBkZWYgc2V0U3BlZihzZWxmLCB2KToKICAgICAgICByZXR1cm4gX29kYl9weS5kYklUZXJtX3NldFNwZWYoc2VsZiwgdikKCiAgICBkZWYgaXNTcGVmKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiSVRlcm1faXNTcGVmKHNlbGYpCgogICAgZGVmIHNldEV4dElkKHNlbGYsIHYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiSVRlcm1fc2V0RXh0SWQoc2VsZiwgdikKCiAgICBkZWYgZ2V0RXh0SWQoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJJVGVybV9nZXRFeHRJZChzZWxmKQoKICAgIGRlZiBpc1NwZWNpYWwoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJJVGVybV9pc1NwZWNpYWwoc2VsZikKCiAgICBkZWYgc2V0U3BlY2lhbChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYklUZXJtX3NldFNwZWNpYWwoc2VsZikKCiAgICBkZWYgY2xlYXJTcGVjaWFsKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiSVRlcm1fY2xlYXJTcGVjaWFsKHNlbGYpCgogICAgZGVmIHNldENsb2NrZWQoc2VsZiwgdik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJJVGVybV9zZXRDbG9ja2VkKHNlbGYsIHYpCgogICAgZGVmIGlzQ2xvY2tlZChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYklUZXJtX2lzQ2xvY2tlZChzZWxmKQoKICAgIGRlZiBzZXRNYXJrKHNlbGYsIHYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiSVRlcm1fc2V0TWFyayhzZWxmLCB2KQoKICAgIGRlZiBpc1NldE1hcmsoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJJVGVybV9pc1NldE1hcmsoc2VsZikKCiAgICBkZWYgaXNDb25uZWN0ZWQoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJJVGVybV9pc0Nvbm5lY3RlZChzZWxmKQoKICAgIGRlZiBzZXRDb25uZWN0ZWQoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJJVGVybV9zZXRDb25uZWN0ZWQoc2VsZikKCiAgICBkZWYgY2xlYXJDb25uZWN0ZWQoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJJVGVybV9jbGVhckNvbm5lY3RlZChzZWxmKQoKICAgIGRlZiBnZXRCVGVybShzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYklUZXJtX2dldEJUZXJtKHNlbGYpCgogICAgZGVmIGNvbm5lY3Qoc2VsZiwgKmFyZ3MpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiSVRlcm1fY29ubmVjdChzZWxmLCAqYXJncykKCiAgICBkZWYgZGlzY29ubmVjdChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYklUZXJtX2Rpc2Nvbm5lY3Qoc2VsZikKCiAgICBkZWYgZGlzY29ubmVjdERiTmV0KHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiSVRlcm1fZGlzY29ubmVjdERiTmV0KHNlbGYpCgogICAgZGVmIGRpc2Nvbm5lY3REYk1vZE5ldChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYklUZXJtX2Rpc2Nvbm5lY3REYk1vZE5ldChzZWxmKQoKICAgIGRlZiBnZXRBdmdYWShzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYklUZXJtX2dldEF2Z1hZKHNlbGYpCgogICAgZGVmIGdldEdlb21ldHJpZXMoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJJVGVybV9nZXRHZW9tZXRyaWVzKHNlbGYpCgogICAgZGVmIHNldEFjY2Vzc1BvaW50KHNlbGYsIHBpbiwgYXApOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiSVRlcm1fc2V0QWNjZXNzUG9pbnQoc2VsZiwgcGluLCBhcCkKCiAgICBkZWYgZ2V0UHJlZkFjY2Vzc1BvaW50cyhzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYklUZXJtX2dldFByZWZBY2Nlc3NQb2ludHMoc2VsZikKCiAgICBkZWYgZ2V0QWNjZXNzUG9pbnRzKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiSVRlcm1fZ2V0QWNjZXNzUG9pbnRzKHNlbGYpCgogICAgZGVmIGNsZWFyUHJlZkFjY2Vzc1BvaW50cyhzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYklUZXJtX2NsZWFyUHJlZkFjY2Vzc1BvaW50cyhzZWxmKQoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBnZXRJVGVybShibG9jaywgb2lkKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYklUZXJtX2dldElUZXJtKGJsb2NrLCBvaWQpCgogICAgZGVmIHN0YVZlcnRleElkKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiSVRlcm1fc3RhVmVydGV4SWQoc2VsZikKCiAgICBkZWYgc3RhU2V0VmVydGV4SWQoc2VsZiwgaWQpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiSVRlcm1fc3RhU2V0VmVydGV4SWQoc2VsZiwgaWQpCgogICAgZGVmIF9faW5pdF9fKHNlbGYpOgogICAgICAgIF9vZGJfcHkuZGJJVGVybV9zd2lnaW5pdChzZWxmLCBfb2RiX3B5Lm5ld19kYklUZXJtKCkpCiAgICBfX3N3aWdfZGVzdHJveV9fID0gX29kYl9weS5kZWxldGVfZGJJVGVybQoKIyBSZWdpc3RlciBkYklUZXJtIGluIF9vZGJfcHk6Cl9vZGJfcHkuZGJJVGVybV9zd2lncmVnaXN0ZXIoZGJJVGVybSkKCmRlZiBkYklUZXJtX2dldElUZXJtKGJsb2NrLCBvaWQpOgogICAgcmV0dXJuIF9vZGJfcHkuZGJJVGVybV9nZXRJVGVybShibG9jaywgb2lkKQoKY2xhc3MgZGJWaWEob2JqZWN0KToKICAgIHRoaXNvd24gPSBwcm9wZXJ0eShsYW1iZGEgeDogeC50aGlzLm93bigpLCBsYW1iZGEgeCwgdjogeC50aGlzLm93bih2KSwgZG9jPSdUaGUgbWVtYmVyc2hpcCBmbGFnJykKICAgIF9fcmVwcl9fID0gX3N3aWdfcmVwcgoKICAgIGRlZiBnZXROYW1lKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVmlhX2dldE5hbWUoc2VsZikKCiAgICBkZWYgZ2V0Q29uc3ROYW1lKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVmlhX2dldENvbnN0TmFtZShzZWxmKQoKICAgIGRlZiBnZXRQYXR0ZXJuKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVmlhX2dldFBhdHRlcm4oc2VsZikKCiAgICBkZWYgc2V0UGF0dGVybihzZWxmLCBwYXR0ZXJuKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlZpYV9zZXRQYXR0ZXJuKHNlbGYsIHBhdHRlcm4pCgogICAgZGVmIHNldFZpYUdlbmVyYXRlUnVsZShzZWxmLCBydWxlKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlZpYV9zZXRWaWFHZW5lcmF0ZVJ1bGUoc2VsZiwgcnVsZSkKCiAgICBkZWYgZ2V0VmlhR2VuZXJhdGVSdWxlKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVmlhX2dldFZpYUdlbmVyYXRlUnVsZShzZWxmKQoKICAgIGRlZiBoYXNQYXJhbXMoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJWaWFfaGFzUGFyYW1zKHNlbGYpCgogICAgZGVmIHNldFZpYVBhcmFtcyhzZWxmLCBwYXJhbXMpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVmlhX3NldFZpYVBhcmFtcyhzZWxmLCBwYXJhbXMpCgogICAgZGVmIGdldFZpYVBhcmFtcyhzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlZpYV9nZXRWaWFQYXJhbXMoc2VsZikKCiAgICBkZWYgZ2V0QmxvY2soc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJWaWFfZ2V0QmxvY2soc2VsZikKCiAgICBkZWYgZ2V0QkJveChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlZpYV9nZXRCQm94KHNlbGYpCgogICAgZGVmIGdldEJveGVzKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVmlhX2dldEJveGVzKHNlbGYpCgogICAgZGVmIGdldFRvcExheWVyKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVmlhX2dldFRvcExheWVyKHNlbGYpCgogICAgZGVmIGdldEJvdHRvbUxheWVyKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVmlhX2dldEJvdHRvbUxheWVyKHNlbGYpCgogICAgZGVmIGlzVmlhUm90YXRlZChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlZpYV9pc1ZpYVJvdGF0ZWQoc2VsZikKCiAgICBkZWYgZ2V0T3JpZW50KHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVmlhX2dldE9yaWVudChzZWxmKQoKICAgIGRlZiBnZXRUZWNoVmlhKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVmlhX2dldFRlY2hWaWEoc2VsZikKCiAgICBkZWYgZ2V0QmxvY2tWaWEoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJWaWFfZ2V0QmxvY2tWaWEoc2VsZikKCiAgICBkZWYgc2V0RGVmYXVsdChzZWxmLCBhcmcyKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlZpYV9zZXREZWZhdWx0KHNlbGYsIGFyZzIpCgogICAgZGVmIGlzRGVmYXVsdChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlZpYV9pc0RlZmF1bHQoc2VsZikKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgY3JlYXRlKCphcmdzKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlZpYV9jcmVhdGUoKmFyZ3MpCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIGNvcHkoKmFyZ3MpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVmlhX2NvcHkoKmFyZ3MpCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIGdldFZpYShibG9jaywgb2lkKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlZpYV9nZXRWaWEoYmxvY2ssIG9pZCkKCiAgICBkZWYgX19pbml0X18oc2VsZik6CiAgICAgICAgX29kYl9weS5kYlZpYV9zd2lnaW5pdChzZWxmLCBfb2RiX3B5Lm5ld19kYlZpYSgpKQogICAgX19zd2lnX2Rlc3Ryb3lfXyA9IF9vZGJfcHkuZGVsZXRlX2RiVmlhCgojIFJlZ2lzdGVyIGRiVmlhIGluIF9vZGJfcHk6Cl9vZGJfcHkuZGJWaWFfc3dpZ3JlZ2lzdGVyKGRiVmlhKQoKZGVmIGRiVmlhX2NyZWF0ZSgqYXJncyk6CiAgICByZXR1cm4gX29kYl9weS5kYlZpYV9jcmVhdGUoKmFyZ3MpCgpkZWYgZGJWaWFfY29weSgqYXJncyk6CiAgICByZXR1cm4gX29kYl9weS5kYlZpYV9jb3B5KCphcmdzKQoKZGVmIGRiVmlhX2dldFZpYShibG9jaywgb2lkKToKICAgIHJldHVybiBfb2RiX3B5LmRiVmlhX2dldFZpYShibG9jaywgb2lkKQoKY2xhc3MgZGJXaXJlKG9iamVjdCk6CiAgICB0aGlzb3duID0gcHJvcGVydHkobGFtYmRhIHg6IHgudGhpcy5vd24oKSwgbGFtYmRhIHgsIHY6IHgudGhpcy5vd24odiksIGRvYz0nVGhlIG1lbWJlcnNoaXAgZmxhZycpCiAgICBfX3JlcHJfXyA9IF9zd2lnX3JlcHIKCiAgICBkZWYgZ2V0QmxvY2soc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJXaXJlX2dldEJsb2NrKHNlbGYpCgogICAgZGVmIGdldE5ldChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYldpcmVfZ2V0TmV0KHNlbGYpCgogICAgZGVmIGFwcGVuZChzZWxmLCB3aXJlLCBzaW5nbGVTZWdtZW50V2lyZT1GYWxzZSk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJXaXJlX2FwcGVuZChzZWxmLCB3aXJlLCBzaW5nbGVTZWdtZW50V2lyZSkKCiAgICBkZWYgZ2V0VGVybUppZChzZWxmLCB0ZXJtaWQpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiV2lyZV9nZXRUZXJtSmlkKHNlbGYsIHRlcm1pZCkKCiAgICBkZWYgZ2V0U2hhcGUoc2VsZiwgc2hhcGVfaWQsIHNoYXBlKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYldpcmVfZ2V0U2hhcGUoc2VsZiwgc2hhcGVfaWQsIHNoYXBlKQoKICAgIGRlZiBnZXRTZWdtZW50KHNlbGYsICphcmdzKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYldpcmVfZ2V0U2VnbWVudChzZWxmLCAqYXJncykKCiAgICBkZWYgZ2V0UHJldlZpYShzZWxmLCBzaGFwZV9pZCwgc2hhcGUpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiV2lyZV9nZXRQcmV2VmlhKHNlbGYsIHNoYXBlX2lkLCBzaGFwZSkKCiAgICBkZWYgZ2V0TmV4dFZpYShzZWxmLCBzaGFwZV9pZCwgc2hhcGUpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiV2lyZV9nZXROZXh0VmlhKHNlbGYsIHNoYXBlX2lkLCBzaGFwZSkKCiAgICBkZWYgZ2V0VmlhQm94ZXMoc2VsZiwgdmlhX3NoYXBlX2lkLCBzaGFwZXMpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiV2lyZV9nZXRWaWFCb3hlcyhzZWxmLCB2aWFfc2hhcGVfaWQsIHNoYXBlcykKCiAgICBkZWYgaXNHbG9iYWxXaXJlKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiV2lyZV9pc0dsb2JhbFdpcmUoc2VsZikKCiAgICBkZWYgZ2V0QkJveChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYldpcmVfZ2V0QkJveChzZWxmKQoKICAgIGRlZiBnZXRMZW5ndGgoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJXaXJlX2dldExlbmd0aChzZWxmKQoKICAgIGRlZiBsZW5ndGgoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJXaXJlX2xlbmd0aChzZWxmKQoKICAgIGRlZiBjb3VudChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYldpcmVfY291bnQoc2VsZikKCiAgICBkZWYgZ2V0Q29vcmQoc2VsZiwgamlkKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYldpcmVfZ2V0Q29vcmQoc2VsZiwgamlkKQoKICAgIGRlZiBnZXRQcm9wZXJ0eShzZWxmLCBqaWQsIHByb3BlcnR5KToKICAgICAgICByZXR1cm4gX29kYl9weS5kYldpcmVfZ2V0UHJvcGVydHkoc2VsZiwgamlkLCBwcm9wZXJ0eSkKCiAgICBkZWYgc2V0UHJvcGVydHkoc2VsZiwgamlkLCBwcm9wZXJ0eSk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJXaXJlX3NldFByb3BlcnR5KHNlbGYsIGppZCwgcHJvcGVydHkpCgogICAgZGVmIGdldERhdGEoc2VsZiwgbik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJXaXJlX2dldERhdGEoc2VsZiwgbikKCiAgICBkZWYgZ2V0T3Bjb2RlKHNlbGYsIG4pOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiV2lyZV9nZXRPcGNvZGUoc2VsZiwgbikKCiAgICBkZWYgYXR0YWNoKHNlbGYsIG5ldCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJXaXJlX2F0dGFjaChzZWxmLCBuZXQpCgogICAgZGVmIGRldGFjaChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYldpcmVfZGV0YWNoKHNlbGYpCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIGNyZWF0ZSgqYXJncyk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJXaXJlX2NyZWF0ZSgqYXJncykKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgZ2V0V2lyZShibG9jaywgb2lkKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYldpcmVfZ2V0V2lyZShibG9jaywgb2lkKQoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBkZXN0cm95KHdpcmUpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiV2lyZV9kZXN0cm95KHdpcmUpCgogICAgZGVmIF9faW5pdF9fKHNlbGYpOgogICAgICAgIF9vZGJfcHkuZGJXaXJlX3N3aWdpbml0KHNlbGYsIF9vZGJfcHkubmV3X2RiV2lyZSgpKQogICAgX19zd2lnX2Rlc3Ryb3lfXyA9IF9vZGJfcHkuZGVsZXRlX2RiV2lyZQoKIyBSZWdpc3RlciBkYldpcmUgaW4gX29kYl9weToKX29kYl9weS5kYldpcmVfc3dpZ3JlZ2lzdGVyKGRiV2lyZSkKCmRlZiBkYldpcmVfY3JlYXRlKCphcmdzKToKICAgIHJldHVybiBfb2RiX3B5LmRiV2lyZV9jcmVhdGUoKmFyZ3MpCgpkZWYgZGJXaXJlX2dldFdpcmUoYmxvY2ssIG9pZCk6CiAgICByZXR1cm4gX29kYl9weS5kYldpcmVfZ2V0V2lyZShibG9jaywgb2lkKQoKZGVmIGRiV2lyZV9kZXN0cm95KHdpcmUpOgogICAgcmV0dXJuIF9vZGJfcHkuZGJXaXJlX2Rlc3Ryb3kod2lyZSkKCmNsYXNzIGRiU1dpcmUob2JqZWN0KToKICAgIHRoaXNvd24gPSBwcm9wZXJ0eShsYW1iZGEgeDogeC50aGlzLm93bigpLCBsYW1iZGEgeCwgdjogeC50aGlzLm93bih2KSwgZG9jPSdUaGUgbWVtYmVyc2hpcCBmbGFnJykKICAgIF9fcmVwcl9fID0gX3N3aWdfcmVwcgoKICAgIGRlZiBnZXRCbG9jayhzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlNXaXJlX2dldEJsb2NrKHNlbGYpCgogICAgZGVmIGdldE5ldChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlNXaXJlX2dldE5ldChzZWxmKQoKICAgIGRlZiBnZXRXaXJlVHlwZShzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlNXaXJlX2dldFdpcmVUeXBlKHNlbGYpCgogICAgZGVmIGdldFNoaWVsZChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlNXaXJlX2dldFNoaWVsZChzZWxmKQoKICAgIGRlZiBnZXRXaXJlcyhzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlNXaXJlX2dldFdpcmVzKHNlbGYpCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIGNyZWF0ZShuZXQsIHR5cGUsIHNoaWVsZD1Ob25lKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlNXaXJlX2NyZWF0ZShuZXQsIHR5cGUsIHNoaWVsZCkKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgZGVzdHJveSgqYXJncyk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJTV2lyZV9kZXN0cm95KCphcmdzKQoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBnZXRTV2lyZShibG9jaywgb2lkKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlNXaXJlX2dldFNXaXJlKGJsb2NrLCBvaWQpCgogICAgZGVmIF9faW5pdF9fKHNlbGYpOgogICAgICAgIF9vZGJfcHkuZGJTV2lyZV9zd2lnaW5pdChzZWxmLCBfb2RiX3B5Lm5ld19kYlNXaXJlKCkpCiAgICBfX3N3aWdfZGVzdHJveV9fID0gX29kYl9weS5kZWxldGVfZGJTV2lyZQoKIyBSZWdpc3RlciBkYlNXaXJlIGluIF9vZGJfcHk6Cl9vZGJfcHkuZGJTV2lyZV9zd2lncmVnaXN0ZXIoZGJTV2lyZSkKCmRlZiBkYlNXaXJlX2NyZWF0ZShuZXQsIHR5cGUsIHNoaWVsZD1Ob25lKToKICAgIHJldHVybiBfb2RiX3B5LmRiU1dpcmVfY3JlYXRlKG5ldCwgdHlwZSwgc2hpZWxkKQoKZGVmIGRiU1dpcmVfZGVzdHJveSgqYXJncyk6CiAgICByZXR1cm4gX29kYl9weS5kYlNXaXJlX2Rlc3Ryb3koKmFyZ3MpCgpkZWYgZGJTV2lyZV9nZXRTV2lyZShibG9jaywgb2lkKToKICAgIHJldHVybiBfb2RiX3B5LmRiU1dpcmVfZ2V0U1dpcmUoYmxvY2ssIG9pZCkKCmNsYXNzIGRiVHJhY2tHcmlkKG9iamVjdCk6CiAgICB0aGlzb3duID0gcHJvcGVydHkobGFtYmRhIHg6IHgudGhpcy5vd24oKSwgbGFtYmRhIHgsIHY6IHgudGhpcy5vd24odiksIGRvYz0nVGhlIG1lbWJlcnNoaXAgZmxhZycpCiAgICBfX3JlcHJfXyA9IF9zd2lnX3JlcHIKCiAgICBkZWYgZ2V0VGVjaExheWVyKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVHJhY2tHcmlkX2dldFRlY2hMYXllcihzZWxmKQoKICAgIGRlZiBnZXRHcmlkWChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRyYWNrR3JpZF9nZXRHcmlkWChzZWxmKQoKICAgIGRlZiBnZXRHcmlkWShzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRyYWNrR3JpZF9nZXRHcmlkWShzZWxmKQoKICAgIGRlZiBnZXRCbG9jayhzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRyYWNrR3JpZF9nZXRCbG9jayhzZWxmKQoKICAgIGRlZiBhZGRHcmlkUGF0dGVyblgoc2VsZiwgb3JpZ2luX3gsIGxpbmVfY291bnQsIHN0ZXAsIGZpcnN0X21hc2s9MCwgc2FtZW1hc2s9RmFsc2UpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVHJhY2tHcmlkX2FkZEdyaWRQYXR0ZXJuWChzZWxmLCBvcmlnaW5feCwgbGluZV9jb3VudCwgc3RlcCwgZmlyc3RfbWFzaywgc2FtZW1hc2spCgogICAgZGVmIGFkZEdyaWRQYXR0ZXJuWShzZWxmLCBvcmlnaW5feSwgbGluZV9jb3VudCwgc3RlcCwgZmlyc3RfbWFzaz0wLCBzYW1lbWFzaz1GYWxzZSk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUcmFja0dyaWRfYWRkR3JpZFBhdHRlcm5ZKHNlbGYsIG9yaWdpbl95LCBsaW5lX2NvdW50LCBzdGVwLCBmaXJzdF9tYXNrLCBzYW1lbWFzaykKCiAgICBkZWYgZ2V0TnVtR3JpZFBhdHRlcm5zWChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRyYWNrR3JpZF9nZXROdW1HcmlkUGF0dGVybnNYKHNlbGYpCgogICAgZGVmIGdldE51bUdyaWRQYXR0ZXJuc1koc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUcmFja0dyaWRfZ2V0TnVtR3JpZFBhdHRlcm5zWShzZWxmKQoKICAgIGRlZiBnZXRHcmlkUGF0dGVyblgoc2VsZiwgKmFyZ3MpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVHJhY2tHcmlkX2dldEdyaWRQYXR0ZXJuWChzZWxmLCAqYXJncykKCiAgICBkZWYgZ2V0R3JpZFBhdHRlcm5ZKHNlbGYsICphcmdzKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRyYWNrR3JpZF9nZXRHcmlkUGF0dGVyblkoc2VsZiwgKmFyZ3MpCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIGNyZWF0ZShibG9jaywgbGF5ZXIpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVHJhY2tHcmlkX2NyZWF0ZShibG9jaywgbGF5ZXIpCgogICAgZGVmIGdldEF2ZXJhZ2VUcmFja1NwYWNpbmcoc2VsZiwgdHJhY2tfc3RlcCwgdHJhY2tfaW5pdCwgbnVtX3RyYWNrcyk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUcmFja0dyaWRfZ2V0QXZlcmFnZVRyYWNrU3BhY2luZyhzZWxmLCB0cmFja19zdGVwLCB0cmFja19pbml0LCBudW1fdHJhY2tzKQoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBnZXRUcmFja0dyaWQoYmxvY2ssIG9pZCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUcmFja0dyaWRfZ2V0VHJhY2tHcmlkKGJsb2NrLCBvaWQpCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIGRlc3Ryb3koZ3JpZF8pOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVHJhY2tHcmlkX2Rlc3Ryb3koZ3JpZF8pCgogICAgZGVmIF9faW5pdF9fKHNlbGYpOgogICAgICAgIF9vZGJfcHkuZGJUcmFja0dyaWRfc3dpZ2luaXQoc2VsZiwgX29kYl9weS5uZXdfZGJUcmFja0dyaWQoKSkKICAgIF9fc3dpZ19kZXN0cm95X18gPSBfb2RiX3B5LmRlbGV0ZV9kYlRyYWNrR3JpZAoKIyBSZWdpc3RlciBkYlRyYWNrR3JpZCBpbiBfb2RiX3B5Ogpfb2RiX3B5LmRiVHJhY2tHcmlkX3N3aWdyZWdpc3RlcihkYlRyYWNrR3JpZCkKCmRlZiBkYlRyYWNrR3JpZF9jcmVhdGUoYmxvY2ssIGxheWVyKToKICAgIHJldHVybiBfb2RiX3B5LmRiVHJhY2tHcmlkX2NyZWF0ZShibG9jaywgbGF5ZXIpCgpkZWYgZGJUcmFja0dyaWRfZ2V0VHJhY2tHcmlkKGJsb2NrLCBvaWQpOgogICAgcmV0dXJuIF9vZGJfcHkuZGJUcmFja0dyaWRfZ2V0VHJhY2tHcmlkKGJsb2NrLCBvaWQpCgpkZWYgZGJUcmFja0dyaWRfZGVzdHJveShncmlkXyk6CiAgICByZXR1cm4gX29kYl9weS5kYlRyYWNrR3JpZF9kZXN0cm95KGdyaWRfKQoKY2xhc3MgZGJPYnN0cnVjdGlvbihvYmplY3QpOgogICAgdGhpc293biA9IHByb3BlcnR5KGxhbWJkYSB4OiB4LnRoaXMub3duKCksIGxhbWJkYSB4LCB2OiB4LnRoaXMub3duKHYpLCBkb2M9J1RoZSBtZW1iZXJzaGlwIGZsYWcnKQogICAgX19yZXByX18gPSBfc3dpZ19yZXByCgogICAgZGVmIGdldEJCb3goc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJPYnN0cnVjdGlvbl9nZXRCQm94KHNlbGYpCgogICAgZGVmIGdldEluc3RhbmNlKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiT2JzdHJ1Y3Rpb25fZ2V0SW5zdGFuY2Uoc2VsZikKCiAgICBkZWYgc2V0U2xvdE9ic3RydWN0aW9uKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiT2JzdHJ1Y3Rpb25fc2V0U2xvdE9ic3RydWN0aW9uKHNlbGYpCgogICAgZGVmIGlzU2xvdE9ic3RydWN0aW9uKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiT2JzdHJ1Y3Rpb25faXNTbG90T2JzdHJ1Y3Rpb24oc2VsZikKCiAgICBkZWYgc2V0RmlsbE9ic3RydWN0aW9uKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiT2JzdHJ1Y3Rpb25fc2V0RmlsbE9ic3RydWN0aW9uKHNlbGYpCgogICAgZGVmIGlzRmlsbE9ic3RydWN0aW9uKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiT2JzdHJ1Y3Rpb25faXNGaWxsT2JzdHJ1Y3Rpb24oc2VsZikKCiAgICBkZWYgc2V0RXhjZXB0UEdOZXRzT2JzdHJ1Y3Rpb24oc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJPYnN0cnVjdGlvbl9zZXRFeGNlcHRQR05ldHNPYnN0cnVjdGlvbihzZWxmKQoKICAgIGRlZiBpc0V4Y2VwdFBHTmV0c09ic3RydWN0aW9uKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiT2JzdHJ1Y3Rpb25faXNFeGNlcHRQR05ldHNPYnN0cnVjdGlvbihzZWxmKQoKICAgIGRlZiBzZXRQdXNoZWREb3duKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiT2JzdHJ1Y3Rpb25fc2V0UHVzaGVkRG93bihzZWxmKQoKICAgIGRlZiBpc1B1c2hlZERvd24oc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJPYnN0cnVjdGlvbl9pc1B1c2hlZERvd24oc2VsZikKCiAgICBkZWYgaGFzRWZmZWN0aXZlV2lkdGgoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJPYnN0cnVjdGlvbl9oYXNFZmZlY3RpdmVXaWR0aChzZWxmKQoKICAgIGRlZiBzZXRFZmZlY3RpdmVXaWR0aChzZWxmLCB3KToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk9ic3RydWN0aW9uX3NldEVmZmVjdGl2ZVdpZHRoKHNlbGYsIHcpCgogICAgZGVmIGdldEVmZmVjdGl2ZVdpZHRoKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiT2JzdHJ1Y3Rpb25fZ2V0RWZmZWN0aXZlV2lkdGgoc2VsZikKCiAgICBkZWYgaGFzTWluU3BhY2luZyhzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk9ic3RydWN0aW9uX2hhc01pblNwYWNpbmcoc2VsZikKCiAgICBkZWYgc2V0TWluU3BhY2luZyhzZWxmLCB3KToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk9ic3RydWN0aW9uX3NldE1pblNwYWNpbmcoc2VsZiwgdykKCiAgICBkZWYgZ2V0TWluU3BhY2luZyhzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk9ic3RydWN0aW9uX2dldE1pblNwYWNpbmcoc2VsZikKCiAgICBkZWYgZ2V0QmxvY2soc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJPYnN0cnVjdGlvbl9nZXRCbG9jayhzZWxmKQoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBkZXN0cm95KCphcmdzKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk9ic3RydWN0aW9uX2Rlc3Ryb3koKmFyZ3MpCgogICAgZGVmIGlzU3lzdGVtUmVzZXJ2ZWQoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJPYnN0cnVjdGlvbl9pc1N5c3RlbVJlc2VydmVkKHNlbGYpCgogICAgZGVmIHNldElzU3lzdGVtUmVzZXJ2ZWQoc2VsZiwgaXNfc3lzdGVtX3Jlc2VydmVkKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk9ic3RydWN0aW9uX3NldElzU3lzdGVtUmVzZXJ2ZWQoc2VsZiwgaXNfc3lzdGVtX3Jlc2VydmVkKQoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBjcmVhdGUoYmxvY2ssIGxheWVyLCB4MSwgeTEsIHgyLCB5MiwgaW5zdD1Ob25lKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk9ic3RydWN0aW9uX2NyZWF0ZShibG9jaywgbGF5ZXIsIHgxLCB5MSwgeDIsIHkyLCBpbnN0KQoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBnZXRPYnN0cnVjdGlvbihibG9jaywgb2lkKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk9ic3RydWN0aW9uX2dldE9ic3RydWN0aW9uKGJsb2NrLCBvaWQpCgogICAgZGVmIF9faW5pdF9fKHNlbGYpOgogICAgICAgIF9vZGJfcHkuZGJPYnN0cnVjdGlvbl9zd2lnaW5pdChzZWxmLCBfb2RiX3B5Lm5ld19kYk9ic3RydWN0aW9uKCkpCiAgICBfX3N3aWdfZGVzdHJveV9fID0gX29kYl9weS5kZWxldGVfZGJPYnN0cnVjdGlvbgoKIyBSZWdpc3RlciBkYk9ic3RydWN0aW9uIGluIF9vZGJfcHk6Cl9vZGJfcHkuZGJPYnN0cnVjdGlvbl9zd2lncmVnaXN0ZXIoZGJPYnN0cnVjdGlvbikKCmRlZiBkYk9ic3RydWN0aW9uX2Rlc3Ryb3koKmFyZ3MpOgogICAgcmV0dXJuIF9vZGJfcHkuZGJPYnN0cnVjdGlvbl9kZXN0cm95KCphcmdzKQoKZGVmIGRiT2JzdHJ1Y3Rpb25fY3JlYXRlKGJsb2NrLCBsYXllciwgeDEsIHkxLCB4MiwgeTIsIGluc3Q9Tm9uZSk6CiAgICByZXR1cm4gX29kYl9weS5kYk9ic3RydWN0aW9uX2NyZWF0ZShibG9jaywgbGF5ZXIsIHgxLCB5MSwgeDIsIHkyLCBpbnN0KQoKZGVmIGRiT2JzdHJ1Y3Rpb25fZ2V0T2JzdHJ1Y3Rpb24oYmxvY2ssIG9pZCk6CiAgICByZXR1cm4gX29kYl9weS5kYk9ic3RydWN0aW9uX2dldE9ic3RydWN0aW9uKGJsb2NrLCBvaWQpCgpjbGFzcyBkYkJsb2NrYWdlKG9iamVjdCk6CiAgICB0aGlzb3duID0gcHJvcGVydHkobGFtYmRhIHg6IHgudGhpcy5vd24oKSwgbGFtYmRhIHgsIHY6IHgudGhpcy5vd24odiksIGRvYz0nVGhlIG1lbWJlcnNoaXAgZmxhZycpCiAgICBfX3JlcHJfXyA9IF9zd2lnX3JlcHIKCiAgICBkZWYgZ2V0QkJveChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkJsb2NrYWdlX2dldEJCb3goc2VsZikKCiAgICBkZWYgZ2V0SW5zdGFuY2Uoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJCbG9ja2FnZV9nZXRJbnN0YW5jZShzZWxmKQoKICAgIGRlZiBzZXRQdXNoZWREb3duKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQmxvY2thZ2Vfc2V0UHVzaGVkRG93bihzZWxmKQoKICAgIGRlZiBpc1B1c2hlZERvd24oc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJCbG9ja2FnZV9pc1B1c2hlZERvd24oc2VsZikKCiAgICBkZWYgc2V0U29mdChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkJsb2NrYWdlX3NldFNvZnQoc2VsZikKCiAgICBkZWYgaXNTb2Z0KHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQmxvY2thZ2VfaXNTb2Z0KHNlbGYpCgogICAgZGVmIGlzU3lzdGVtUmVzZXJ2ZWQoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJCbG9ja2FnZV9pc1N5c3RlbVJlc2VydmVkKHNlbGYpCgogICAgZGVmIHNldElzU3lzdGVtUmVzZXJ2ZWQoc2VsZiwgaXNfc3lzdGVtX3Jlc2VydmVkKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkJsb2NrYWdlX3NldElzU3lzdGVtUmVzZXJ2ZWQoc2VsZiwgaXNfc3lzdGVtX3Jlc2VydmVkKQoKICAgIGRlZiBzZXRNYXhEZW5zaXR5KHNlbGYsIG1heF9kZW5zaXR5KToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkJsb2NrYWdlX3NldE1heERlbnNpdHkoc2VsZiwgbWF4X2RlbnNpdHkpCgogICAgZGVmIGdldE1heERlbnNpdHkoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJCbG9ja2FnZV9nZXRNYXhEZW5zaXR5KHNlbGYpCgogICAgZGVmIGdldEJsb2NrKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQmxvY2thZ2VfZ2V0QmxvY2soc2VsZikKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgY3JlYXRlKGJsb2NrLCB4MSwgeTEsIHgyLCB5MiwgaW5zdD1Ob25lKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkJsb2NrYWdlX2NyZWF0ZShibG9jaywgeDEsIHkxLCB4MiwgeTIsIGluc3QpCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIGRlc3Ryb3koKmFyZ3MpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQmxvY2thZ2VfZGVzdHJveSgqYXJncykKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgZ2V0QmxvY2thZ2UoYmxvY2ssIG9pZCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJCbG9ja2FnZV9nZXRCbG9ja2FnZShibG9jaywgb2lkKQoKICAgIGRlZiBfX2luaXRfXyhzZWxmKToKICAgICAgICBfb2RiX3B5LmRiQmxvY2thZ2Vfc3dpZ2luaXQoc2VsZiwgX29kYl9weS5uZXdfZGJCbG9ja2FnZSgpKQogICAgX19zd2lnX2Rlc3Ryb3lfXyA9IF9vZGJfcHkuZGVsZXRlX2RiQmxvY2thZ2UKCiMgUmVnaXN0ZXIgZGJCbG9ja2FnZSBpbiBfb2RiX3B5Ogpfb2RiX3B5LmRiQmxvY2thZ2Vfc3dpZ3JlZ2lzdGVyKGRiQmxvY2thZ2UpCgpkZWYgZGJCbG9ja2FnZV9jcmVhdGUoYmxvY2ssIHgxLCB5MSwgeDIsIHkyLCBpbnN0PU5vbmUpOgogICAgcmV0dXJuIF9vZGJfcHkuZGJCbG9ja2FnZV9jcmVhdGUoYmxvY2ssIHgxLCB5MSwgeDIsIHkyLCBpbnN0KQoKZGVmIGRiQmxvY2thZ2VfZGVzdHJveSgqYXJncyk6CiAgICByZXR1cm4gX29kYl9weS5kYkJsb2NrYWdlX2Rlc3Ryb3koKmFyZ3MpCgpkZWYgZGJCbG9ja2FnZV9nZXRCbG9ja2FnZShibG9jaywgb2lkKToKICAgIHJldHVybiBfb2RiX3B5LmRiQmxvY2thZ2VfZ2V0QmxvY2thZ2UoYmxvY2ssIG9pZCkKCmNsYXNzIGRiQ2FwTm9kZShvYmplY3QpOgogICAgdGhpc293biA9IHByb3BlcnR5KGxhbWJkYSB4OiB4LnRoaXMub3duKCksIGxhbWJkYSB4LCB2OiB4LnRoaXMub3duKHYpLCBkb2M9J1RoZSBtZW1iZXJzaGlwIGZsYWcnKQogICAgX19yZXByX18gPSBfc3dpZ19yZXByCgogICAgZGVmIGFkZENhcG5DYXBhY2l0YW5jZShzZWxmLCBvdGhlcik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJDYXBOb2RlX2FkZENhcG5DYXBhY2l0YW5jZShzZWxmLCBvdGhlcikKCiAgICBkZWYgYWRkR25kQ2FwKHNlbGYsIGduZGNhcCwgdG90YWxjYXApOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQ2FwTm9kZV9hZGRHbmRDYXAoc2VsZiwgZ25kY2FwLCB0b3RhbGNhcCkKCiAgICBkZWYgYWRkR25kVG90YWxDYXAoc2VsZiwgZ25kY2FwLCB0b3RhbGNhcCwgTWlsbGVyTXVsdCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJDYXBOb2RlX2FkZEduZFRvdGFsQ2FwKHNlbGYsIGduZGNhcCwgdG90YWxjYXAsIE1pbGxlck11bHQpCgogICAgZGVmIGdldEduZENhcChzZWxmLCBnbmRjYXAsIHRvdGFsY2FwKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkNhcE5vZGVfZ2V0R25kQ2FwKHNlbGYsIGduZGNhcCwgdG90YWxjYXApCgogICAgZGVmIGdldEduZFRvdGFsQ2FwKHNlbGYsIGduZGNhcCwgdG90YWxjYXAsIE1pbGxlck11bHQpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQ2FwTm9kZV9nZXRHbmRUb3RhbENhcChzZWxmLCBnbmRjYXAsIHRvdGFsY2FwLCBNaWxsZXJNdWx0KQoKICAgIGRlZiBhY2NBbGxDY0NhcChzZWxmLCB0b3RhbGNhcCwgTWlsbGVyTXVsdCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJDYXBOb2RlX2FjY0FsbENjQ2FwKHNlbGYsIHRvdGFsY2FwLCBNaWxsZXJNdWx0KQoKICAgIGRlZiBzZXRDYXBhY2l0YW5jZShzZWxmLCBjYXAsIGNvcm5lcj0wKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkNhcE5vZGVfc2V0Q2FwYWNpdGFuY2Uoc2VsZiwgY2FwLCBjb3JuZXIpCgogICAgZGVmIGFkZENhcGFjaXRhbmNlKHNlbGYsIGNhcCwgY29ybmVyPTApOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQ2FwTm9kZV9hZGRDYXBhY2l0YW5jZShzZWxmLCBjYXAsIGNvcm5lcikKCiAgICBkZWYgZ3JvdW5kQ0Moc2VsZiwgZ25kRmFjdG9yKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkNhcE5vZGVfZ3JvdW5kQ0Moc2VsZiwgZ25kRmFjdG9yKQoKICAgIGRlZiBhZGp1c3RDYXBhY2l0YW5jZShzZWxmLCAqYXJncyk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJDYXBOb2RlX2FkanVzdENhcGFjaXRhbmNlKHNlbGYsICphcmdzKQoKICAgIGRlZiBuZWVkQWRqdXN0Q0Moc2VsZiwgY2NUaHJlc2hIb2xkKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkNhcE5vZGVfbmVlZEFkanVzdENDKHNlbGYsIGNjVGhyZXNoSG9sZCkKCiAgICBkZWYgYWRqdXN0Q0Moc2VsZiwgYWRqT3JkZXIsIGFkakZhY3RvciwgYWRqdXN0ZWRDQywgaGFsb25ldHMpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQ2FwTm9kZV9hZGp1c3RDQyhzZWxmLCBhZGpPcmRlciwgYWRqRmFjdG9yLCBhZGp1c3RlZENDLCBoYWxvbmV0cykKCiAgICBkZWYgZ2V0Q2FwYWNpdGFuY2Uoc2VsZiwgY29ybmVyPTApOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQ2FwTm9kZV9nZXRDYXBhY2l0YW5jZShzZWxmLCBjb3JuZXIpCgogICAgZGVmIGdldE5vZGUoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJDYXBOb2RlX2dldE5vZGUoc2VsZikKCiAgICBkZWYgZ2V0U2hhcGVJZChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkNhcE5vZGVfZ2V0U2hhcGVJZChzZWxmKQoKICAgIGRlZiBzZXROb2RlKHNlbGYsIG5vZGVpZCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJDYXBOb2RlX3NldE5vZGUoc2VsZiwgbm9kZWlkKQoKICAgIGRlZiBpc05hbWUoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJDYXBOb2RlX2lzTmFtZShzZWxmKQoKICAgIGRlZiBpc0lUZXJtKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQ2FwTm9kZV9pc0lUZXJtKHNlbGYpCgogICAgZGVmIGlzQlRlcm0oc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJDYXBOb2RlX2lzQlRlcm0oc2VsZikKCiAgICBkZWYgaXNJbnRlcm5hbChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkNhcE5vZGVfaXNJbnRlcm5hbChzZWxmKQoKICAgIGRlZiBpc0JyYW5jaChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkNhcE5vZGVfaXNCcmFuY2goc2VsZikKCiAgICBkZWYgaXNEYW5nbGluZyhzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkNhcE5vZGVfaXNEYW5nbGluZyhzZWxmKQoKICAgIGRlZiBpc0ZvcmVpZ24oc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJDYXBOb2RlX2lzRm9yZWlnbihzZWxmKQoKICAgIGRlZiBpc1RyZWVOb2RlKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQ2FwTm9kZV9pc1RyZWVOb2RlKHNlbGYpCgogICAgZGVmIGlzU291cmNlVGVybShzZWxmLCBtYmxvY2s9Tm9uZSk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJDYXBOb2RlX2lzU291cmNlVGVybShzZWxmLCBtYmxvY2spCgogICAgZGVmIGlzSW5vdXRUZXJtKHNlbGYsIG1ibG9jaz1Ob25lKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkNhcE5vZGVfaXNJbm91dFRlcm0oc2VsZiwgbWJsb2NrKQoKICAgIGRlZiBpc1NlbGVjdChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkNhcE5vZGVfaXNTZWxlY3Qoc2VsZikKCiAgICBkZWYgc2V0U2VsZWN0KHNlbGYsIHZhbHVlKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkNhcE5vZGVfc2V0U2VsZWN0KHNlbGYsIHZhbHVlKQoKICAgIGRlZiBpbmNyQ2hpbGRyZW5DbnQoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJDYXBOb2RlX2luY3JDaGlsZHJlbkNudChzZWxmKQoKICAgIGRlZiBnZXRDaGlsZHJlbkNudChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkNhcE5vZGVfZ2V0Q2hpbGRyZW5DbnQoc2VsZikKCiAgICBkZWYgc2V0Q2hpbGRyZW5DbnQoc2VsZiwgY250KToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkNhcE5vZGVfc2V0Q2hpbGRyZW5DbnQoc2VsZiwgY250KQoKICAgIGRlZiBzZXROYW1lRmxhZyhzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkNhcE5vZGVfc2V0TmFtZUZsYWcoc2VsZikKCiAgICBkZWYgc2V0QlRlcm1GbGFnKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQ2FwTm9kZV9zZXRCVGVybUZsYWcoc2VsZikKCiAgICBkZWYgc2V0SVRlcm1GbGFnKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQ2FwTm9kZV9zZXRJVGVybUZsYWcoc2VsZikKCiAgICBkZWYgc2V0SW50ZXJuYWxGbGFnKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQ2FwTm9kZV9zZXRJbnRlcm5hbEZsYWcoc2VsZikKCiAgICBkZWYgc2V0QnJhbmNoRmxhZyhzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkNhcE5vZGVfc2V0QnJhbmNoRmxhZyhzZWxmKQoKICAgIGRlZiBzZXRGb3JlaWduRmxhZyhzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkNhcE5vZGVfc2V0Rm9yZWlnbkZsYWcoc2VsZikKCiAgICBkZWYgcmVzZXROYW1lRmxhZyhzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkNhcE5vZGVfcmVzZXROYW1lRmxhZyhzZWxmKQoKICAgIGRlZiByZXNldEJUZXJtRmxhZyhzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkNhcE5vZGVfcmVzZXRCVGVybUZsYWcoc2VsZikKCiAgICBkZWYgcmVzZXRJVGVybUZsYWcoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJDYXBOb2RlX3Jlc2V0SVRlcm1GbGFnKHNlbGYpCgogICAgZGVmIHJlc2V0SW50ZXJuYWxGbGFnKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQ2FwTm9kZV9yZXNldEludGVybmFsRmxhZyhzZWxmKQoKICAgIGRlZiByZXNldEJyYW5jaEZsYWcoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJDYXBOb2RlX3Jlc2V0QnJhbmNoRmxhZyhzZWxmKQoKICAgIGRlZiByZXNldEZvcmVpZ25GbGFnKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQ2FwTm9kZV9yZXNldEZvcmVpZ25GbGFnKHNlbGYpCgogICAgZGVmIGdldFNvcnRJbmRleChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkNhcE5vZGVfZ2V0U29ydEluZGV4KHNlbGYpCgogICAgZGVmIHNldFNvcnRJbmRleChzZWxmLCBpZHgpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQ2FwTm9kZV9zZXRTb3J0SW5kZXgoc2VsZiwgaWR4KQoKICAgIGRlZiBnZXRUZXJtQ29vcmRzKHNlbGYsIG1ibG9jaz1Ob25lKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkNhcE5vZGVfZ2V0VGVybUNvb3JkcyhzZWxmLCBtYmxvY2spCgog",
"ICAgZGVmIGdldElUZXJtKHNlbGYsIG1ibG9jaz1Ob25lKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkNhcE5vZGVfZ2V0SVRlcm0oc2VsZiwgbWJsb2NrKQoKICAgIGRlZiBnZXRCVGVybShzZWxmLCBtYmxvY2s9Tm9uZSk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJDYXBOb2RlX2dldEJUZXJtKHNlbGYsIG1ibG9jaykKCiAgICBkZWYgcHJpbnRDQyhzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkNhcE5vZGVfcHJpbnRDQyhzZWxmKQoKICAgIGRlZiBjaGVja0NDKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQ2FwTm9kZV9jaGVja0NDKHNlbGYpCgogICAgZGVmIGdldENDU2VncyhzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkNhcE5vZGVfZ2V0Q0NTZWdzKHNlbGYpCgogICAgZGVmIGdldE5ldChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkNhcE5vZGVfZ2V0TmV0KHNlbGYpCgogICAgZGVmIHNldE5ldChzZWxmLCBuZXRpZCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJDYXBOb2RlX3NldE5ldChzZWxmLCBuZXRpZCkKCiAgICBkZWYgc2V0TmV4dChzZWxmLCBuZXh0aWQpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQ2FwTm9kZV9zZXROZXh0KHNlbGYsIG5leHRpZCkKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgY3JlYXRlKG5ldCwgbm9kZSwgZm9yZWlnbik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJDYXBOb2RlX2NyZWF0ZShuZXQsIG5vZGUsIGZvcmVpZ24pCgogICAgZGVmIGFkZFRvTmV0KHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQ2FwTm9kZV9hZGRUb05ldChzZWxmKQoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBkZXN0cm95KCphcmdzKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkNhcE5vZGVfZGVzdHJveSgqYXJncykKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgZ2V0Q2FwTm9kZShibG9jaywgb2lkKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkNhcE5vZGVfZ2V0Q2FwTm9kZShibG9jaywgb2lkKQoKICAgIGRlZiBfX2luaXRfXyhzZWxmKToKICAgICAgICBfb2RiX3B5LmRiQ2FwTm9kZV9zd2lnaW5pdChzZWxmLCBfb2RiX3B5Lm5ld19kYkNhcE5vZGUoKSkKICAgIF9fc3dpZ19kZXN0cm95X18gPSBfb2RiX3B5LmRlbGV0ZV9kYkNhcE5vZGUKCiMgUmVnaXN0ZXIgZGJDYXBOb2RlIGluIF9vZGJfcHk6Cl9vZGJfcHkuZGJDYXBOb2RlX3N3aWdyZWdpc3RlcihkYkNhcE5vZGUpCgpkZWYgZGJDYXBOb2RlX2NyZWF0ZShuZXQsIG5vZGUsIGZvcmVpZ24pOgogICAgcmV0dXJuIF9vZGJfcHkuZGJDYXBOb2RlX2NyZWF0ZShuZXQsIG5vZGUsIGZvcmVpZ24pCgpkZWYgZGJDYXBOb2RlX2Rlc3Ryb3koKmFyZ3MpOgogICAgcmV0dXJuIF9vZGJfcHkuZGJDYXBOb2RlX2Rlc3Ryb3koKmFyZ3MpCgpkZWYgZGJDYXBOb2RlX2dldENhcE5vZGUoYmxvY2ssIG9pZCk6CiAgICByZXR1cm4gX29kYl9weS5kYkNhcE5vZGVfZ2V0Q2FwTm9kZShibG9jaywgb2lkKQoKY2xhc3MgZGJSU2VnKG9iamVjdCk6CiAgICB0aGlzb3duID0gcHJvcGVydHkobGFtYmRhIHg6IHgudGhpcy5vd24oKSwgbGFtYmRhIHgsIHY6IHgudGhpcy5vd24odiksIGRvYz0nVGhlIG1lbWJlcnNoaXAgZmxhZycpCiAgICBfX3JlcHJfXyA9IF9zd2lnX3JlcHIKCiAgICBkZWYgYWRkUlNlZ1Jlc2lzdGFuY2Uoc2VsZiwgb3RoZXIpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiUlNlZ19hZGRSU2VnUmVzaXN0YW5jZShzZWxmLCBvdGhlcikKCiAgICBkZWYgYWRkUlNlZ0NhcGFjaXRhbmNlKHNlbGYsIG90aGVyKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlJTZWdfYWRkUlNlZ0NhcGFjaXRhbmNlKHNlbGYsIG90aGVyKQoKICAgIGRlZiBnZXRSZXNpc3RhbmNlKHNlbGYsIGNvcm5lcj0wKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlJTZWdfZ2V0UmVzaXN0YW5jZShzZWxmLCBjb3JuZXIpCgogICAgZGVmIGdldEFsbFJlcyhzZWxmLCByZXMpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiUlNlZ19nZXRBbGxSZXMoc2VsZiwgcmVzKQoKICAgIGRlZiBhZGRBbGxSZXMoc2VsZiwgcmVzKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlJTZWdfYWRkQWxsUmVzKHNlbGYsIHJlcykKCiAgICBkZWYgZ2V0R25kQ2FwKHNlbGYsIGduZGNhcCwgdG90YWxjYXApOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiUlNlZ19nZXRHbmRDYXAoc2VsZiwgZ25kY2FwLCB0b3RhbGNhcCkKCiAgICBkZWYgYWRkR25kQ2FwKHNlbGYsIGduZGNhcCwgdG90YWxjYXApOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiUlNlZ19hZGRHbmRDYXAoc2VsZiwgZ25kY2FwLCB0b3RhbGNhcCkKCiAgICBkZWYgZ2V0R25kVG90YWxDYXAoc2VsZiwgZ25kY2FwLCB0b3RhbGNhcCwgTWlsbGVyTXVsdCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJSU2VnX2dldEduZFRvdGFsQ2FwKHNlbGYsIGduZGNhcCwgdG90YWxjYXAsIE1pbGxlck11bHQpCgogICAgZGVmIGFkZEduZFRvdGFsQ2FwKHNlbGYsIGduZGNhcCwgdG90YWxjYXAsIE1pbGxlck11bHQpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiUlNlZ19hZGRHbmRUb3RhbENhcChzZWxmLCBnbmRjYXAsIHRvdGFsY2FwLCBNaWxsZXJNdWx0KQoKICAgIGRlZiBtZXJnZVJDcyhzZWxmLCBtcnNlZ3MpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiUlNlZ19tZXJnZVJDcyhzZWxmLCBtcnNlZ3MpCgogICAgZGVmIGFkanVzdFNvdXJjZUNhcGFjaXRhbmNlKHNlbGYsIGZhY3RvciwgY29ybmVyKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlJTZWdfYWRqdXN0U291cmNlQ2FwYWNpdGFuY2Uoc2VsZiwgZmFjdG9yLCBjb3JuZXIpCgogICAgZGVmIGFkanVzdENhcGFjaXRhbmNlKHNlbGYsICphcmdzKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlJTZWdfYWRqdXN0Q2FwYWNpdGFuY2Uoc2VsZiwgKmFyZ3MpCgogICAgZGVmIHNldENhcGFjaXRhbmNlKHNlbGYsIGNhcCwgY29ybmVyPTApOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiUlNlZ19zZXRDYXBhY2l0YW5jZShzZWxmLCBjYXAsIGNvcm5lcikKCiAgICBkZWYgdXBkYXRlZENhcChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlJTZWdfdXBkYXRlZENhcChzZWxmKQoKICAgIGRlZiBnZXRTb3VyY2VDYXBhY2l0YW5jZShzZWxmLCBjb3JuZXI9MCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJSU2VnX2dldFNvdXJjZUNhcGFjaXRhbmNlKHNlbGYsIGNvcm5lcikKCiAgICBkZWYgZ2V0Q2FwYWNpdGFuY2Uoc2VsZiwgKmFyZ3MpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiUlNlZ19nZXRDYXBhY2l0YW5jZShzZWxmLCAqYXJncykKCiAgICBkZWYgZ2V0Q2NTZWdzKHNlbGYsIGNjc2Vncyk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJSU2VnX2dldENjU2VncyhzZWxmLCBjY3NlZ3MpCgogICAgZGVmIHByaW50Q2NTZWdzKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiUlNlZ19wcmludENjU2VncyhzZWxmKQoKICAgIGRlZiBwcmludENDKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiUlNlZ19wcmludENDKHNlbGYpCgogICAgZGVmIGNoZWNrQ0Moc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJSU2VnX2NoZWNrQ0Moc2VsZikKCiAgICBkZWYgZ2V0Q2FwVGFibGUoc2VsZiwgY2FwKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlJTZWdfZ2V0Q2FwVGFibGUoc2VsZiwgY2FwKQoKICAgIGRlZiBzZXRSZXNpc3RhbmNlKHNlbGYsIHJlcywgY29ybmVyPTApOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiUlNlZ19zZXRSZXNpc3RhbmNlKHNlbGYsIHJlcywgY29ybmVyKQoKICAgIGRlZiBhZGp1c3RSZXNpc3RhbmNlKHNlbGYsICphcmdzKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlJTZWdfYWRqdXN0UmVzaXN0YW5jZShzZWxmLCAqYXJncykKCiAgICBkZWYgc2V0TmV4dChzZWxmLCBuZXh0X2lkKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlJTZWdfc2V0TmV4dChzZWxmLCBuZXh0X2lkKQoKICAgIGRlZiBnZXRTb3VyY2VOb2RlKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiUlNlZ19nZXRTb3VyY2VOb2RlKHNlbGYpCgogICAgZGVmIGdldFNvdXJjZUNhcE5vZGUoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJSU2VnX2dldFNvdXJjZUNhcE5vZGUoc2VsZikKCiAgICBkZWYgc2V0U291cmNlTm9kZShzZWxmLCBub2RlaWQpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiUlNlZ19zZXRTb3VyY2VOb2RlKHNlbGYsIG5vZGVpZCkKCiAgICBkZWYgZ2V0VGFyZ2V0Tm9kZShzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlJTZWdfZ2V0VGFyZ2V0Tm9kZShzZWxmKQoKICAgIGRlZiBnZXRUYXJnZXRDYXBOb2RlKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiUlNlZ19nZXRUYXJnZXRDYXBOb2RlKHNlbGYpCgogICAgZGVmIHNldFRhcmdldE5vZGUoc2VsZiwgbm9kZWlkKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlJTZWdfc2V0VGFyZ2V0Tm9kZShzZWxmLCBub2RlaWQpCgogICAgZGVmIGdldFNoYXBlSWQoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJSU2VnX2dldFNoYXBlSWQoc2VsZikKCiAgICBkZWYgc2V0Q29vcmRzKHNlbGYsIHgsIHkpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiUlNlZ19zZXRDb29yZHMoc2VsZiwgeCwgeSkKCiAgICBkZWYgZ2V0Q29vcmRzKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiUlNlZ19nZXRDb29yZHMoc2VsZikKCiAgICBkZWYgdXBkYXRlU2hhcGVJZChzZWxmLCBuc2lkKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlJTZWdfdXBkYXRlU2hhcGVJZChzZWxmLCBuc2lkKQoKICAgIGRlZiBwYXRoTG93VG9IaWdoKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiUlNlZ19wYXRoTG93VG9IaWdoKHNlbGYpCgogICAgZGVmIGFsbG9jYXRlZENhcChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlJTZWdfYWxsb2NhdGVkQ2FwKHNlbGYpCgogICAgZGVmIGdldExlbmd0aFdpZHRoKHNlbGYsIHcpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiUlNlZ19nZXRMZW5ndGhXaWR0aChzZWxmLCB3KQoKICAgIGRlZiBhZGRUb05ldChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlJTZWdfYWRkVG9OZXQoc2VsZikKCiAgICBkZWYgZ2V0TmV0KHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiUlNlZ19nZXROZXQoc2VsZikKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgY3JlYXRlKG5ldCwgeCwgeSwgcGF0aF9kaXIsIGFsbG9jYXRlX2NhcCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJSU2VnX2NyZWF0ZShuZXQsIHgsIHksIHBhdGhfZGlyLCBhbGxvY2F0ZV9jYXApCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIGRlc3Ryb3lTKHNlZyk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJSU2VnX2Rlc3Ryb3lTKHNlZykKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgZGVzdHJveSgqYXJncyk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJSU2VnX2Rlc3Ryb3koKmFyZ3MpCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIGdldFJTZWcoYmxvY2ssIG9pZCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJSU2VnX2dldFJTZWcoYmxvY2ssIG9pZCkKCiAgICBkZWYgX19pbml0X18oc2VsZik6CiAgICAgICAgX29kYl9weS5kYlJTZWdfc3dpZ2luaXQoc2VsZiwgX29kYl9weS5uZXdfZGJSU2VnKCkpCiAgICBfX3N3aWdfZGVzdHJveV9fID0gX29kYl9weS5kZWxldGVfZGJSU2VnCgojIFJlZ2lzdGVyIGRiUlNlZyBpbiBfb2RiX3B5Ogpfb2RiX3B5LmRiUlNlZ19zd2lncmVnaXN0ZXIoZGJSU2VnKQoKZGVmIGRiUlNlZ19jcmVhdGUobmV0LCB4LCB5LCBwYXRoX2RpciwgYWxsb2NhdGVfY2FwKToKICAgIHJldHVybiBfb2RiX3B5LmRiUlNlZ19jcmVhdGUobmV0LCB4LCB5LCBwYXRoX2RpciwgYWxsb2NhdGVfY2FwKQoKZGVmIGRiUlNlZ19kZXN0cm95UyhzZWcpOgogICAgcmV0dXJuIF9vZGJfcHkuZGJSU2VnX2Rlc3Ryb3lTKHNlZykKCmRlZiBkYlJTZWdfZGVzdHJveSgqYXJncyk6CiAgICByZXR1cm4gX29kYl9weS5kYlJTZWdfZGVzdHJveSgqYXJncykKCmRlZiBkYlJTZWdfZ2V0UlNlZyhibG9jaywgb2lkKToKICAgIHJldHVybiBfb2RiX3B5LmRiUlNlZ19nZXRSU2VnKGJsb2NrLCBvaWQpCgpjbGFzcyBkYkNDU2VnKG9iamVjdCk6CiAgICB0aGlzb3duID0gcHJvcGVydHkobGFtYmRhIHg6IHgudGhpcy5vd24oKSwgbGFtYmRhIHgsIHY6IHgudGhpcy5vd24odiksIGRvYz0nVGhlIG1lbWJlcnNoaXAgZmxhZycpCiAgICBfX3JlcHJfXyA9IF9zd2lnX3JlcHIKCiAgICBkZWYgYWRqdXN0Q2FwYWNpdGFuY2Uoc2VsZiwgKmFyZ3MpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQ0NTZWdfYWRqdXN0Q2FwYWNpdGFuY2Uoc2VsZiwgKmFyZ3MpCgogICAgZGVmIGdldENhcGFjaXRhbmNlKHNlbGYsIGNvcm5lcj0wKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkNDU2VnX2dldENhcGFjaXRhbmNlKHNlbGYsIGNvcm5lcikKCiAgICBkZWYgc2V0Q2FwYWNpdGFuY2Uoc2VsZiwgY2FwLCBjb3JuZXI9MCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJDQ1NlZ19zZXRDYXBhY2l0YW5jZShzZWxmLCBjYXAsIGNvcm5lcikKCiAgICBkZWYgYWRkQ2FwYWNpdGFuY2Uoc2VsZiwgY2FwLCBjb3JuZXI9MCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJDQ1NlZ19hZGRDYXBhY2l0YW5jZShzZWxmLCBjYXAsIGNvcm5lcikKCiAgICBkZWYgYWNjQWxsQ2NDYXAoc2VsZiwgdHRjYXAsIE1pbGxlck11bHQpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQ0NTZWdfYWNjQWxsQ2NDYXAoc2VsZiwgdHRjYXAsIE1pbGxlck11bHQpCgogICAgZGVmIGdldEFsbENjQ2FwKHNlbGYsIHR0Y2FwKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkNDU2VnX2dldEFsbENjQ2FwKHNlbGYsIHR0Y2FwKQoKICAgIGRlZiBzZXRBbGxDY0NhcChzZWxmLCB0dGNhcCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJDQ1NlZ19zZXRBbGxDY0NhcChzZWxmLCB0dGNhcCkKCiAgICBkZWYgZ2V0U291cmNlQ2FwTm9kZShzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkNDU2VnX2dldFNvdXJjZUNhcE5vZGUoc2VsZikKCiAgICBkZWYgZ2V0VGFyZ2V0Q2FwTm9kZShzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkNDU2VnX2dldFRhcmdldENhcE5vZGUoc2VsZikKCiAgICBkZWYgYWRkQ2NDYXBhY2l0YW5jZShzZWxmLCBvdGhlcik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJDQ1NlZ19hZGRDY0NhcGFjaXRhbmNlKHNlbGYsIG90aGVyKQoKICAgIGRlZiBzd2FwQ2Fwbm9kZShzZWxmLCBvcmlnLCBuZXduKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkNDU2VnX3N3YXBDYXBub2RlKHNlbGYsIG9yaWcsIG5ld24pCgogICAgZGVmIGdldFRoZU90aGVyQ2FwbihzZWxmLCBvbmVDYXAsIGNpZCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJDQ1NlZ19nZXRUaGVPdGhlckNhcG4oc2VsZiwgb25lQ2FwLCBjaWQpCgogICAgZGVmIGdldFNvdXJjZU5vZGVOdW0oc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJDQ1NlZ19nZXRTb3VyY2VOb2RlTnVtKHNlbGYpCgogICAgZGVmIGdldFRhcmdldE5vZGVOdW0oc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJDQ1NlZ19nZXRUYXJnZXROb2RlTnVtKHNlbGYpCgogICAgZGVmIGdldFNvdXJjZU5ldChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkNDU2VnX2dldFNvdXJjZU5ldChzZWxmKQoKICAgIGRlZiBnZXRUYXJnZXROZXQoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJDQ1NlZ19nZXRUYXJnZXROZXQoc2VsZikKCiAgICBkZWYgZ2V0SW5maWxlQ250KHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQ0NTZWdfZ2V0SW5maWxlQ250KHNlbGYpCgogICAgZGVmIGluY3JJbmZpbGVDbnQoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJDQ1NlZ19pbmNySW5maWxlQ250KHNlbGYpCgogICAgZGVmIGlzTWFya2VkKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQ0NTZWdfaXNNYXJrZWQoc2VsZikKCiAgICBkZWYgc2V0TWFyayhzZWxmLCB2YWx1ZSk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJDQ1NlZ19zZXRNYXJrKHNlbGYsIHZhbHVlKQoKICAgIGRlZiBwcmludENhcG5DQyhzZWxmLCBjYXBuKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkNDU2VnX3ByaW50Q2FwbkNDKHNlbGYsIGNhcG4pCgogICAgZGVmIGNoZWNrQ2FwbkNDKHNlbGYsIGNhcG4pOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQ0NTZWdfY2hlY2tDYXBuQ0Moc2VsZiwgY2FwbikKCiAgICBkZWYgdW5MaW5rX2NjX3NlZyhzZWxmLCBjYXBuKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkNDU2VnX3VuTGlua19jY19zZWcoc2VsZiwgY2FwbikKCiAgICBkZWYgTGlua19jY19zZWcoc2VsZiwgY2FwbiwgY3NlcSk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJDQ1NlZ19MaW5rX2NjX3NlZyhzZWxmLCBjYXBuLCBjc2VxKQoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBmaW5kQ0Mobm9kZUEsIG5vZGVCKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkNDU2VnX2ZpbmRDQyhub2RlQSwgbm9kZUIpCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIGNyZWF0ZShub2RlQSwgbm9kZUIsIG1lcmdlUGFyYWxsZWw9RmFsc2UpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQ0NTZWdfY3JlYXRlKG5vZGVBLCBub2RlQiwgbWVyZ2VQYXJhbGxlbCkKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgZGVzdHJveVMoc2VnKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkNDU2VnX2Rlc3Ryb3lTKHNlZykKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgZGVzdHJveSgqYXJncyk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJDQ1NlZ19kZXN0cm95KCphcmdzKQoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBnZXRDQ1NlZyhibG9jaywgb2lkKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkNDU2VnX2dldENDU2VnKGJsb2NrLCBvaWQpCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIGRpc2Nvbm5lY3QodGNjXyk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJDQ1NlZ19kaXNjb25uZWN0KHRjY18pCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIGNvbm5lY3QodGNjXyk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJDQ1NlZ19jb25uZWN0KHRjY18pCgogICAgZGVmIF9faW5pdF9fKHNlbGYpOgogICAgICAgIF9vZGJfcHkuZGJDQ1NlZ19zd2lnaW5pdChzZWxmLCBfb2RiX3B5Lm5ld19kYkNDU2VnKCkpCiAgICBfX3N3aWdfZGVzdHJveV9fID0gX29kYl9weS5kZWxldGVfZGJDQ1NlZwoKIyBSZWdpc3RlciBkYkNDU2VnIGluIF9vZGJfcHk6Cl9vZGJfcHkuZGJDQ1NlZ19zd2lncmVnaXN0ZXIoZGJDQ1NlZykKCmRlZiBkYkNDU2VnX2ZpbmRDQyhub2RlQSwgbm9kZUIpOgogICAgcmV0dXJuIF9vZGJfcHkuZGJDQ1NlZ19maW5kQ0Mobm9kZUEsIG5vZGVCKQoKZGVmIGRiQ0NTZWdfY3JlYXRlKG5vZGVBLCBub2RlQiwgbWVyZ2VQYXJhbGxlbD1GYWxzZSk6CiAgICByZXR1cm4gX29kYl9weS5kYkNDU2VnX2NyZWF0ZShub2RlQSwgbm9kZUIsIG1lcmdlUGFyYWxsZWwpCgpkZWYgZGJDQ1NlZ19kZXN0cm95UyhzZWcpOgogICAgcmV0dXJuIF9vZGJfcHkuZGJDQ1NlZ19kZXN0cm95UyhzZWcpCgpkZWYgZGJDQ1NlZ19kZXN0cm95KCphcmdzKToKICAgIHJldHVybiBfb2RiX3B5LmRiQ0NTZWdfZGVzdHJveSgqYXJncykKCmRlZiBkYkNDU2VnX2dldENDU2VnKGJsb2NrLCBvaWQpOgogICAgcmV0dXJuIF9vZGJfcHkuZGJDQ1NlZ19nZXRDQ1NlZyhibG9jaywgb2lkKQoKZGVmIGRiQ0NTZWdfZGlzY29ubmVjdCh0Y2NfKToKICAgIHJldHVybiBfb2RiX3B5LmRiQ0NTZWdfZGlzY29ubmVjdCh0Y2NfKQoKZGVmIGRiQ0NTZWdfY29ubmVjdCh0Y2NfKToKICAgIHJldHVybiBfb2RiX3B5LmRiQ0NTZWdfY29ubmVjdCh0Y2NfKQoKY2xhc3MgZGJSb3cob2JqZWN0KToKICAgIHRoaXNvd24gPSBwcm9wZXJ0eShsYW1iZGEgeDogeC50aGlzLm93bigpLCBsYW1iZGEgeCwgdjogeC50aGlzLm93bih2KSwgZG9jPSdUaGUgbWVtYmVyc2hpcCBmbGFnJykKICAgIF9fcmVwcl9fID0gX3N3aWdfcmVwcgoKICAgIGRlZiBnZXROYW1lKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiUm93X2dldE5hbWUoc2VsZikKCiAgICBkZWYgZ2V0Q29uc3ROYW1lKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiUm93X2dldENvbnN0TmFtZShzZWxmKQoKICAgIGRlZiBnZXRTaXRlKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiUm93X2dldFNpdGUoc2VsZikKCiAgICBkZWYgZ2V0T3JpZ2luKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiUm93X2dldE9yaWdpbihzZWxmKQoKICAgIGRlZiBnZXRPcmllbnQoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJSb3dfZ2V0T3JpZW50KHNlbGYpCgogICAgZGVmIGdldERpcmVjdGlvbihzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlJvd19nZXREaXJlY3Rpb24oc2VsZikKCiAgICBkZWYgZ2V0U2l0ZUNvdW50KHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiUm93X2dldFNpdGVDb3VudChzZWxmKQoKICAgIGRlZiBnZXRTcGFjaW5nKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiUm93X2dldFNwYWNpbmcoc2VsZikKCiAgICBkZWYgZ2V0QkJveChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlJvd19nZXRCQm94KHNlbGYpCgogICAgZGVmIGdldEJsb2NrKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiUm93X2dldEJsb2NrKHNlbGYpCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIGNyZWF0ZShibG9jaywgbmFtZSwgc2l0ZSwgb3JpZ2luX3gsIG9yaWdpbl95LCBvcmllbnQsIGRpcmVjdGlvbiwgbnVtX3NpdGVzLCBzcGFjaW5nKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlJvd19jcmVhdGUoYmxvY2ssIG5hbWUsIHNpdGUsIG9yaWdpbl94LCBvcmlnaW5feSwgb3JpZW50LCBkaXJlY3Rpb24sIG51bV9zaXRlcywgc3BhY2luZykKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgZGVzdHJveSgqYXJncyk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJSb3dfZGVzdHJveSgqYXJncykKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgZ2V0Um93KGJsb2NrLCBvaWQpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiUm93X2dldFJvdyhibG9jaywgb2lkKQoKICAgIGRlZiBfX2luaXRfXyhzZWxmKToKICAgICAgICBfb2RiX3B5LmRiUm93X3N3aWdpbml0KHNlbGYsIF9vZGJfcHkubmV3X2RiUm93KCkpCiAgICBfX3N3aWdfZGVzdHJveV9fID0gX29kYl9weS5kZWxldGVfZGJSb3cKCiMgUmVnaXN0ZXIgZGJSb3cgaW4gX29kYl9weToKX29kYl9weS5kYlJvd19zd2lncmVnaXN0ZXIoZGJSb3cpCgpkZWYgZGJSb3dfY3JlYXRlKGJsb2NrLCBuYW1lLCBzaXRlLCBvcmlnaW5feCwgb3JpZ2luX3ksIG9yaWVudCwgZGlyZWN0aW9uLCBudW1fc2l0ZXMsIHNwYWNpbmcpOgogICAgcmV0dXJuIF9vZGJfcHkuZGJSb3dfY3JlYXRlKGJsb2NrLCBuYW1lLCBzaXRlLCBvcmlnaW5feCwgb3JpZ2luX3ksIG9yaWVudCwgZGlyZWN0aW9uLCBudW1fc2l0ZXMsIHNwYWNpbmcpCgpkZWYgZGJSb3dfZGVzdHJveSgqYXJncyk6CiAgICByZXR1cm4gX29kYl9weS5kYlJvd19kZXN0cm95KCphcmdzKQoKZGVmIGRiUm93X2dldFJvdyhibG9jaywgb2lkKToKICAgIHJldHVybiBfb2RiX3B5LmRiUm93X2dldFJvdyhibG9jaywgb2lkKQoKY2xhc3MgZGJGaWxsKG9iamVjdCk6CiAgICB0aGlzb3duID0gcHJvcGVydHkobGFtYmRhIHg6IHgudGhpcy5vd24oKSwgbGFtYmRhIHgsIHY6IHgudGhpcy5vd24odiksIGRvYz0nVGhlIG1lbWJlcnNoaXAgZmxhZycpCiAgICBfX3JlcHJfXyA9IF9zd2lnX3JlcHIKCiAgICBkZWYgZ2V0UmVjdChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkZpbGxfZ2V0UmVjdChzZWxmKQoKICAgIGRlZiBuZWVkc09QQyhzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkZpbGxfbmVlZHNPUEMoc2VsZikKCiAgICBkZWYgbWFza051bWJlcihzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkZpbGxfbWFza051bWJlcihzZWxmKQoKICAgIGRlZiBnZXRUZWNoTGF5ZXIoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJGaWxsX2dldFRlY2hMYXllcihzZWxmKQoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBjcmVhdGUoYmxvY2ssIG5lZWRzX29wYywgbWFza19udW1iZXIsIGxheWVyLCB4MSwgeTEsIHgyLCB5Mik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJGaWxsX2NyZWF0ZShibG9jaywgbmVlZHNfb3BjLCBtYXNrX251bWJlciwgbGF5ZXIsIHgxLCB5MSwgeDIsIHkyKQoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBkZXN0cm95KCphcmdzKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkZpbGxfZGVzdHJveSgqYXJncykKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgZ2V0RmlsbChibG9jaywgb2lkKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkZpbGxfZ2V0RmlsbChibG9jaywgb2lkKQoKICAgIGRlZiBfX2luaXRfXyhzZWxmKToKICAgICAgICBfb2RiX3B5LmRiRmlsbF9zd2lnaW5pdChzZWxmLCBfb2RiX3B5Lm5ld19kYkZpbGwoKSkKICAgIF9fc3dpZ19kZXN0cm95X18gPSBfb2RiX3B5LmRlbGV0ZV9kYkZpbGwKCiMgUmVnaXN0ZXIgZGJGaWxsIGluIF9vZGJfcHk6Cl9vZGJfcHkuZGJGaWxsX3N3aWdyZWdpc3RlcihkYkZpbGwpCgpkZWYgZGJGaWxsX2NyZWF0ZShibG9jaywgbmVlZHNfb3BjLCBtYXNrX251bWJlciwgbGF5ZXIsIHgxLCB5MSwgeDIsIHkyKToKICAgIHJldHVybiBfb2RiX3B5LmRiRmlsbF9jcmVhdGUoYmxvY2ssIG5lZWRzX29wYywgbWFza19udW1iZXIsIGxheWVyLCB4MSwgeTEsIHgyLCB5MikKCmRlZiBkYkZpbGxfZGVzdHJveSgqYXJncyk6CiAgICByZXR1cm4gX29kYl9weS5kYkZpbGxfZGVzdHJveSgqYXJncykKCmRlZiBkYkZpbGxfZ2V0RmlsbChibG9jaywgb2lkKToKICAgIHJldHVybiBfb2RiX3B5LmRiRmlsbF9nZXRGaWxsKGJsb2NrLCBvaWQpCgpjbGFzcyBkYlJlZ2lvbihvYmplY3QpOgogICAgdGhpc293biA9IHByb3BlcnR5KGxhbWJkYSB4OiB4LnRoaXMub3duKCksIGxhbWJkYSB4LCB2OiB4LnRoaXMub3duKHYpLCBkb2M9J1RoZSBtZW1iZXJzaGlwIGZsYWcnKQogICAgX19yZXByX18gPSBfc3dpZ19yZXByCgogICAgZGVmIGdldE5hbWUoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJSZWdpb25fZ2V0TmFtZShzZWxmKQoKICAgIGRlZiBnZXRSZWdpb25UeXBlKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiUmVnaW9uX2dldFJlZ2lvblR5cGUoc2VsZikKCiAgICBkZWYgc2V0UmVnaW9uVHlwZShzZWxmLCB0eXBlKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlJlZ2lvbl9zZXRSZWdpb25UeXBlKHNlbGYsIHR5cGUpCgogICAgZGVmIGdldFJlZ2lvbkluc3RzKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiUmVnaW9uX2dldFJlZ2lvbkluc3RzKHNlbGYpCgogICAgZGVmIHNldEludmFsaWQoc2VsZiwgdik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJSZWdpb25fc2V0SW52YWxpZChzZWxmLCB2KQoKICAgIGRlZiBpc0ludmFsaWQoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJSZWdpb25faXNJbnZhbGlkKHNlbGYpCgogICAgZGVmIGdldEJvdW5kYXJpZXMoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJSZWdpb25fZ2V0Qm91bmRhcmllcyhzZWxmKQoKICAgIGRlZiBhZGRJbnN0KHNlbGYsIGluc3QpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiUmVnaW9uX2FkZEluc3Qoc2VsZiwgaW5zdCkKCiAgICBkZWYgcmVtb3ZlSW5zdChzZWxmLCBpbnN0KToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlJlZ2lvbl9yZW1vdmVJbnN0KHNlbGYsIGluc3QpCgogICAgZGVmIHJlbW92ZUdyb3VwKHNlbGYsIGdyb3VwKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlJlZ2lvbl9yZW1vdmVHcm91cChzZWxmLCBncm91cCkKCiAgICBkZWYgYWRkR3JvdXAoc2VsZiwgZ3JvdXApOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiUmVnaW9uX2FkZEdyb3VwKHNlbGYsIGdyb3VwKQoKICAgIGRlZiBnZXRHcm91cHMoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJSZWdpb25fZ2V0R3JvdXBzKHNlbGYpCgogICAgZGVmIGdldEJsb2NrKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiUmVnaW9uX2dldEJsb2NrKHNlbGYpCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIGNyZWF0ZShibG9jaywgbmFtZSk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJSZWdpb25fY3JlYXRlKGJsb2NrLCBuYW1lKQoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBkZXN0cm95KCphcmdzKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlJlZ2lvbl9kZXN0cm95KCphcmdzKQoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBnZXRSZWdpb24oYmxvY2ssIG9pZCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJSZWdpb25fZ2V0UmVnaW9uKGJsb2NrLCBvaWQpCgogICAgZGVmIF9faW5pdF9fKHNlbGYpOgogICAgICAgIF9vZGJfcHkuZGJSZWdpb25fc3dpZ2luaXQoc2VsZiwgX29kYl9weS5uZXdfZGJSZWdpb24oKSkKICAgIF9fc3dpZ19kZXN0cm95X18gPSBfb2RiX3B5LmRlbGV0ZV9kYlJlZ2lvbgoKIyBSZWdpc3RlciBkYlJlZ2lvbiBpbiBfb2RiX3B5Ogpfb2RiX3B5LmRiUmVnaW9uX3N3aWdyZWdpc3RlcihkYlJlZ2lvbikKCmRlZiBkYlJlZ2lvbl9jcmVhdGUoYmxvY2ssIG5hbWUpOgogICAgcmV0dXJuIF9vZGJfcHkuZGJSZWdpb25fY3JlYXRlKGJsb2NrLCBuYW1lKQoKZGVmIGRiUmVnaW9uX2Rlc3Ryb3koKmFyZ3MpOgogICAgcmV0dXJuIF9vZGJfcHkuZGJSZWdpb25fZGVzdHJveSgqYXJncykKCmRlZiBkYlJlZ2lvbl9nZXRSZWdpb24oYmxvY2ssIG9pZCk6CiAgICByZXR1cm4gX29kYl9weS5kYlJlZ2lvbl9nZXRSZWdpb24oYmxvY2ssIG9pZCkKCmNsYXNzIGRiTGliKG9iamVjdCk6CiAgICB0aGlzb3duID0gcHJvcGVydHkobGFtYmRhIHg6IHgudGhpcy5vd24oKSwgbGFtYmRhIHgsIHY6IHgudGhpcy5vd24odiksIGRvYz0nVGhlIG1lbWJlcnNoaXAgZmxhZycpCiAgICBfX3JlcHJfXyA9IF9zd2lnX3JlcHIKCiAgICBkZWYgZ2V0TmFtZShzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkxpYl9nZXROYW1lKHNlbGYpCgogICAgZGVmIGdldENvbnN0TmFtZShzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkxpYl9nZXRDb25zdE5hbWUoc2VsZikKCiAgICBkZWYgZ2V0RGJVbml0c1Blck1pY3JvbihzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkxpYl9nZXREYlVuaXRzUGVyTWljcm9uKHNlbGYpCgogICAgZGVmIGdldFRlY2goc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJMaWJfZ2V0VGVjaChzZWxmKQoKICAgIGRlZiBnZXRNYXN0ZXJzKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTGliX2dldE1hc3RlcnMoc2VsZikKCiAgICBkZWYgZmluZE1hc3RlcihzZWxmLCBuYW1lKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkxpYl9maW5kTWFzdGVyKHNlbGYsIG5hbWUpCgogICAgZGVmIGdldFNpdGVzKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTGliX2dldFNpdGVzKHNlbGYpCgogICAgZGVmIGZpbmRTaXRlKHNlbGYsIG5hbWUpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTGliX2ZpbmRTaXRlKHNlbGYsIG5hbWUpCgogICAgZGVmIGdldExlZlVuaXRzKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTGliX2dldExlZlVuaXRzKHNlbGYpCgogICAgZGVmIHNldExlZlVuaXRzKHNlbGYsIHVuaXRzKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkxpYl9zZXRMZWZVbml0cyhzZWxmLCB1bml0cykKCiAgICBkZWYgZ2V0SGllcmFyY2h5RGVsaW1pdGVyKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTGliX2dldEhpZXJhcmNoeURlbGltaXRlcihzZWxmKQoKICAgIGRlZiBzZXRCdXNEZWxpbWl0ZXJzKHNlbGYsIGxlZnQsIHJpZ2h0KToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkxpYl9zZXRCdXNEZWxpbWl0ZXJzKHNlbGYsIGxlZnQsIHJpZ2h0KQoKICAgIGRlZiBnZXRCdXNEZWxpbWl0ZXJzKHNlbGYsIGxlZnQsIHJpZ2h0KToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkxpYl9nZXRCdXNEZWxpbWl0ZXJzKHNlbGYsIGxlZnQsIHJpZ2h0KQoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBjcmVhdGUoKmFyZ3MpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTGliX2NyZWF0ZSgqYXJncykKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgZ2V0TGliKGRiLCBvaWQpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTGliX2dldExpYihkYiwgb2lkKQoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBkZXN0cm95KGxpYik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJMaWJfZGVzdHJveShsaWIpCgogICAgZGVmIF9faW5pdF9fKHNlbGYpOgogICAgICAgIF9vZGJfcHkuZGJMaWJfc3dpZ2luaXQoc2VsZiwgX29kYl9weS5uZXdfZGJMaWIoKSkKICAgIF9fc3dpZ19kZXN0cm95X18gPSBfb2RiX3B5LmRlbGV0ZV9kYkxpYgoKIyBSZWdpc3RlciBkYkxpYiBpbiBfb2RiX3B5Ogpfb2RiX3B5LmRiTGliX3N3aWdyZWdpc3RlcihkYkxpYikKCmRlZiBkYkxpYl9jcmVhdGUoKmFyZ3MpOgogICAgcmV0dXJuIF9vZGJfcHkuZGJMaWJfY3JlYXRlKCphcmdzKQoKZGVmIGRiTGliX2dldExpYihkYiwgb2lkKToKICAgIHJldHVybiBfb2RiX3B5LmRiTGliX2dldExpYihkYiwgb2lkKQoKZGVmIGRiTGliX2Rlc3Ryb3kobGliKToKICAgIHJldHVybiBfb2RiX3B5LmRiTGliX2Rlc3Ryb3kobGliKQoKY2xhc3MgZGJTaXRlKG9iamVjdCk6CiAgICB0aGlzb3duID0gcHJvcGVydHkobGFtYmRhIHg6IHgudGhpcy5vd24oKSwgbGFtYmRhIHgsIHY6IHgudGhpcy5vd24odiksIGRvYz0nVGhlIG1lbWJlcnNoaXAgZmxhZycpCiAgICBfX3JlcHJfXyA9IF9zd2lnX3JlcHIKCiAgICBkZWYgZ2V0TmFtZShzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlNpdGVfZ2V0TmFtZShzZWxmKQoKICAgIGRlZiBnZXRDb25zdE5hbWUoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJTaXRlX2dldENvbnN0TmFtZShzZWxmKQoKICAgIGRlZiBnZXRXaWR0aChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlNpdGVfZ2V0V2lkdGgoc2VsZikKCiAgICBkZWYgc2V0V2lkdGgoc2VsZiwgd2lkdGgpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiU2l0ZV9zZXRXaWR0aChzZWxmLCB3aWR0aCkKCiAgICBkZWYgZ2V0SGVpZ2h0KHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiU2l0ZV9nZXRIZWlnaHQoc2VsZikKCiAgICBkZWYgc2V0SGVpZ2h0KHNlbGYsIGhlaWdodCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJTaXRlX3NldEhlaWdodChzZWxmLCBoZWlnaHQpCgogICAgZGVmIGdldENsYXNzKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiU2l0ZV9nZXRDbGFzcyhzZWxmKQoKICAgIGRlZiBzZXRDbGFzcyhzZWxmLCBzaXRlX2NsYXNzKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlNpdGVfc2V0Q2xhc3Moc2VsZiwgc2l0ZV9jbGFzcykKCiAgICBkZWYgc2V0U3ltbWV0cnlYKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiU2l0ZV9zZXRTeW1tZXRyeVgoc2VsZikKCiAgICBkZWYgZ2V0U3ltbWV0cnlYKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiU2l0ZV9nZXRTeW1tZXRyeVgoc2VsZikKCiAgICBkZWYgc2V0U3ltbWV0cnlZKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiU2l0ZV9zZXRTeW1tZXRyeVkoc2VsZikKCiAgICBkZWYgZ2V0U3ltbWV0cnlZKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiU2l0ZV9nZXRTeW1tZXRyeVkoc2VsZikKCiAgICBkZWYgc2V0U3ltbWV0cnlSOTAoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJTaXRlX3NldFN5bW1ldHJ5UjkwKHNlbGYpCgogICAgZGVmIGdldFN5bW1ldHJ5UjkwKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiU2l0ZV9nZXRTeW1tZXRyeVI5MChzZWxmKQoKICAgIGRlZiBzZXRSb3dQYXR0ZXJuKHNlbGYsIHJvd19wYXR0ZXJuKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlNpdGVfc2V0Um93UGF0dGVybihzZWxmLCByb3dfcGF0dGVybikKCiAgICBkZWYgaGFzUm93UGF0dGVybihzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlNpdGVfaGFzUm93UGF0dGVybihzZWxmKQoKICAgIGRlZiBpc0h5YnJpZChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlNpdGVfaXNIeWJyaWQoc2VsZikKCiAgICBkZWYgZ2V0Um93UGF0dGVybihzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlNpdGVfZ2V0Um93UGF0dGVybihzZWxmKQoKICAgIGRlZiBnZXRMaWIoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJTaXRlX2dldExpYihzZWxmKQoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBjcmVhdGUobGliLCBuYW1lKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlNpdGVfY3JlYXRlKGxpYiwgbmFtZSkKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgZ2V0U2l0ZShsaWIsIG9pZCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJTaXRlX2dldFNpdGUobGliLCBvaWQpCgogICAgZGVmIF9faW5pdF9fKHNlbGYpOgogICAgICAgIF9vZGJfcHkuZGJTaXRlX3N3aWdpbml0KHNlbGYsIF9vZGJfcHkubmV3X2RiU2l0ZSgpKQogICAgX19zd2lnX2Rlc3Ryb3lfXyA9IF9vZGJfcHkuZGVsZXRlX2RiU2l0ZQoKIyBSZWdpc3RlciBkYlNpdGUgaW4gX29kYl9weToKX29kYl9weS5kYlNpdGVfc3dpZ3JlZ2lzdGVyKGRiU2l0ZSkKCmRlZiBkYlNpdGVfY3JlYXRlKGxpYiwgbmFtZSk6CiAgICByZXR1cm4gX29kYl9weS5kYlNpdGVfY3JlYXRlKGxpYiwgbmFtZSkKCmRlZiBkYlNpdGVfZ2V0U2l0ZShsaWIsIG9pZCk6CiAgICByZXR1cm4gX29kYl9weS5kYlNpdGVfZ2V0U2l0ZShsaWIsIG9pZCkKCmNsYXNzIGRiTWFzdGVyKG9iamVjdCk6CiAgICB0aGlzb3duID0gcHJvcGVydHkobGFtYmRhIHg6IHgudGhpcy5vd24oKSwgbGFtYmRhIHgsIHY6IHgudGhpcy5vd24odiksIGRvYz0nVGhlIG1lbWJlcnNoaXAgZmxhZycpCiAgICBfX3JlcHJfXyA9IF9zd2lnX3JlcHIKCiAgICBkZWYgZ2V0TmFtZShzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk1hc3Rlcl9nZXROYW1lKHNlbGYpCgogICAgZGVmIGdldENvbnN0TmFtZShzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk1hc3Rlcl9nZXRDb25zdE5hbWUoc2VsZikKCiAgICBkZWYgZ2V0T3JpZ2luKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTWFzdGVyX2dldE9yaWdpbihzZWxmKQoKICAgIGRlZiBzZXRPcmlnaW4oc2VsZiwgeCwgeSk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJNYXN0ZXJfc2V0T3JpZ2luKHNlbGYsIHgsIHkpCgogICAgZGVmIGdldFdpZHRoKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTWFzdGVyX2dldFdpZHRoKHNlbGYpCgogICAgZGVmIHNldFdpZHRoKHNlbGYsIHdpZHRoKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk1hc3Rlcl9zZXRXaWR0aChzZWxmLCB3aWR0aCkKCiAgICBkZWYgZ2V0SGVpZ2h0KHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTWFzdGVyX2dldEhlaWdodChzZWxmKQoKICAgIGRlZiBzZXRIZWlnaHQoc2VsZiwgaGVpZ2h0KToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk1hc3Rlcl9zZXRIZWlnaHQoc2VsZiwgaGVpZ2h0KQoKICAgIGRlZiBnZXRBcmVhKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTWFzdGVyX2dldEFyZWEoc2VsZikKCiAgICBkZWYgaXNGaWxsZXIoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJNYXN0ZXJfaXNGaWxsZXIoc2VsZikKCiAgICBkZWYgZ2V0VHlwZShzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk1hc3Rlcl9nZXRUeXBlKHNlbGYpCgogICAgZGVmIGlzQmxvY2soc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJNYXN0ZXJfaXNCbG9jayhzZWxmKQoKICAgIGRlZiBpc0NvcmUoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJNYXN0ZXJfaXNDb3JlKHNlbGYpCgogICAgZGVmIGlzUGFkKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTWFzdGVyX2lzUGFkKHNlbGYpCgogICAgZGVmIGlzRW5kQ2FwKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTWFzdGVyX2lzRW5kQ2FwKHNlbGYpCgogICAgZGVmIGlzQ292ZXIoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJNYXN0ZXJfaXNDb3ZlcihzZWxmKQoKICAgIGRlZiBpc0NvcmVBdXRvUGxhY2VhYmxlKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTWFzdGVyX2lzQ29yZUF1dG9QbGFjZWFibGUoc2VsZikKCiAgICBkZWYgc2V0VHlwZShzZWxmLCB0eXBlKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk1hc3Rlcl9zZXRUeXBlKHNlbGYsIHR5cGUpCgogICAgZGVmIGdldExFUShzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk1hc3Rlcl9nZXRMRVEoc2VsZikKCiAgICBkZWYgc2V0TEVRKHNlbGYsIG1hc3Rlcik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJNYXN0ZXJfc2V0TEVRKHNlbGYsIG1hc3RlcikKCiAgICBkZWYgZ2V0RUVRKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTWFzdGVyX2dldEVFUShzZWxmKQoKICAgIGRlZiBzZXRFRVEoc2VsZiwgbWFzdGVyKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk1hc3Rlcl9zZXRFRVEoc2VsZiwgbWFzdGVyKQoKICAgIGRlZiBzZXRTeW1tZXRyeVgoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJNYXN0ZXJfc2V0U3ltbWV0cnlYKHNlbGYpCgogICAgZGVmIGdldFN5bW1ldHJ5WChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk1hc3Rlcl9nZXRTeW1tZXRyeVgoc2VsZikKCiAgICBkZWYgc2V0U3ltbWV0cnlZKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTWFzdGVyX3NldFN5bW1ldHJ5WShzZWxmKQoKICAgIGRlZiBnZXRTeW1tZXRyeVkoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJNYXN0ZXJfZ2V0U3ltbWV0cnlZKHNlbGYpCgogICAgZGVmIHNldFN5bW1ldHJ5UjkwKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTWFzdGVyX3NldFN5bW1ldHJ5UjkwKHNlbGYpCgogICAgZGVmIGdldFN5bW1ldHJ5UjkwKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTWFzdGVyX2dldFN5bW1ldHJ5UjkwKHNlbGYpCgogICAgZGVmIGdldE1UZXJtcyhzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk1hc3Rlcl9nZXRNVGVybXMoc2VsZikKCiAgICBkZWYgZ2V0RWRnZVR5cGVzKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTWFzdGVyX2dldEVkZ2VUeXBlcyhzZWxmKQoKICAgIGRlZiBmaW5kTVRlcm0oc2VsZiwgKmFyZ3MpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTWFzdGVyX2ZpbmRNVGVybShzZWxmLCAqYXJncykKCiAgICBkZWYgZ2V0TGliKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTWFzdGVyX2dldExpYihzZWxmKQoKICAgIGRlZiBnZXRPYnN0cnVjdGlvbnMoc2VsZiwgaW5jbHVkZV9kZWNvbXBvc2VkX3BvbHlnb25zPVRydWUpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTWFzdGVyX2dldE9ic3RydWN0aW9ucyhzZWxmLCBpbmNsdWRlX2RlY29tcG9zZWRfcG9seWdvbnMpCgogICAgZGVmIGdldFBvbHlnb25PYnN0cnVjdGlvbnMoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJNYXN0ZXJfZ2V0UG9seWdvbk9ic3RydWN0aW9ucyhzZWxmKQoKICAgIGRlZiBnZXRQbGFjZW1lbnRCb3VuZGFyeShzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk1hc3Rlcl9nZXRQbGFjZW1lbnRCb3VuZGFyeShzZWxmKQoKICAgIGRlZiB0cmFuc2Zvcm0oc2VsZiwgdCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJNYXN0ZXJfdHJhbnNmb3JtKHNlbGYsIHQpCgogICAgZGVmIHNldEZyb3plbihzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk1hc3Rlcl9zZXRGcm96ZW4oc2VsZikKCiAgICBkZWYgaXNGcm96ZW4oc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJNYXN0ZXJfaXNGcm96ZW4oc2VsZikKCiAgICBkZWYgc2V0U2VxdWVudGlhbChzZWxmLCB2KToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk1hc3Rlcl9zZXRTZXF1ZW50aWFsKHNlbGYsIHYpCgogICAgZGVmIGlzU2VxdWVudGlhbChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk1hc3Rlcl9pc1NlcXVlbnRpYWwoc2VsZikKCiAgICBkZWYgc2V0TWFyayhzZWxmLCBtYXJrKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk1hc3Rlcl9zZXRNYXJrKHNlbGYsIG1hcmspCgogICAgZGVmIGlzTWFya2VkKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTWFzdGVyX2lzTWFya2VkKHNlbGYpCgogICAgZGVmIGlzU3BlY2lhbFBvd2VyKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTWFzdGVyX2lzU3BlY2lhbFBvd2VyKHNlbGYpCgogICAgZGVmIHNldFNwZWNpYWxQb3dlcihzZWxmLCB2KToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk1hc3Rlcl9zZXRTcGVjaWFsUG93ZXIoc2VsZiwgdikKCiAgICBkZWYgZ2V0TVRlcm1Db3VudChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk1hc3Rlcl9nZXRNVGVybUNvdW50KHNlbGYpCgogICAgZGVmIHNldFNpdGUoc2VsZiwgc2l0ZSk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJNYXN0ZXJfc2V0U2l0ZShzZWxmLCBzaXRlKQoKICAgIGRlZiBnZXRTaXRlKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTWFzdGVyX2dldFNpdGUoc2VsZikKCiAgICBkZWYgZ2V0TWFzdGVySWQoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJNYXN0ZXJfZ2V0TWFzdGVySWQoc2VsZikKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgY3JlYXRlKGxpYiwgbmFtZSk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJNYXN0ZXJfY3JlYXRlKGxpYiwgbmFtZSkKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgZGVzdHJveShtYXN0ZXIpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTWFzdGVyX2Rlc3Ryb3kobWFzdGVyKQoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBnZXRNYXN0ZXIobGliLCBvaWQpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTWFzdGVyX2dldE1hc3RlcihsaWIsIG9pZCkKCiAgICBkZWYgc3RhQ2VsbChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk1hc3Rlcl9zdGFDZWxsKHNlbGYpCgogICAgZGVmIHN0YVNldENlbGwoc2VsZiwgY2VsbCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJNYXN0ZXJfc3RhU2V0Q2VsbChzZWxmLCBjZWxsKQoKICAgIGRlZiBfX2luaXRfXyhzZWxmKToKICAgICAgICBfb2RiX3B5LmRiTWFzdGVyX3N3aWdpbml0KHNlbGYsIF9vZGJfcHkubmV3X2RiTWFzdGVyKCkpCiAgICBfX3N3aWdfZGVzdHJveV9fID0gX29kYl9weS5kZWxldGVfZGJNYXN0ZXIKCiMgUmVnaXN0ZXIgZGJNYXN0ZXIgaW4gX29kYl9weToKX29kYl9weS5kYk1hc3Rlcl9zd2lncmVnaXN0ZXIoZGJNYXN0ZXIpCgpkZWYgZGJNYXN0ZXJfY3JlYXRlKGxpYiwgbmFtZSk6CiAgICByZXR1cm4gX29kYl9weS5kYk1hc3Rlcl9jcmVhdGUobGliLCBuYW1lKQoKZGVmIGRiTWFzdGVyX2Rlc3Ryb3kobWFzdGVyKToKICAgIHJldHVybiBfb2RiX3B5LmRiTWFzdGVyX2Rlc3Ryb3kobWFzdGVyKQoKZGVmIGRiTWFzdGVyX2dldE1hc3RlcihsaWIsIG9pZCk6CiAgICByZXR1cm4gX29kYl9weS5kYk1hc3Rlcl9nZXRNYXN0ZXIobGliLCBvaWQpCgpjbGFzcyBkYkdEU0xpYihvYmplY3QpOgogICAgdGhpc293biA9IHByb3BlcnR5KGxhbWJkYSB4OiB4LnRoaXMub3duKCksIGxhbWJkYSB4LCB2OiB4LnRoaXMub3duKHYpLCBkb2M9J1RoZSBtZW1iZXJzaGlwIGZsYWcnKQogICAgX19yZXByX18gPSBfc3dpZ19yZXByCgogICAgZGVmIHNldExpYm5hbWUoc2VsZiwgbGlibmFtZSk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJHRFNMaWJfc2V0TGlibmFtZShzZWxmLCBsaWJuYW1lKQoKICAgIGRlZiBnZXRMaWJuYW1lKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiR0RTTGliX2dldExpYm5hbWUoc2VsZikKCiAgICBkZWYgc2V0VW5pdHMoc2VsZiwgdXVfcGVyX2RidSwgZGJ1X3Blcl9tZXRlcik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJHRFNMaWJfc2V0VW5pdHMoc2VsZiwgdXVfcGVyX2RidSwgZGJ1X3Blcl9tZXRlcikKCiAgICBkZWYgZ2V0VW5pdHMoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJHRFNMaWJfZ2V0VW5pdHMoc2VsZikKCiAgICBkZWYgZmluZEdEU1N0cnVjdHVyZShzZWxmLCBuYW1lKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkdEU0xpYl9maW5kR0RTU3RydWN0dXJlKHNlbGYsIG5hbWUpCgogICAgZGVmIGdldEdEU1N0cnVjdHVyZXMoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJHRFNMaWJfZ2V0R0RTU3RydWN0dXJlcyhzZWxmKQoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBjcmVhdGUoZGIsIG5hbWUpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiR0RTTGliX2NyZWF0ZShkYiwgbmFtZSkKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgZGVzdHJveShsaWIpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiR0RTTGliX2Rlc3Ryb3kobGliKQoKICAgIGRlZiBfX2luaXRfXyhzZWxmKToKICAgICAgICBfb2RiX3B5LmRiR0RTTGliX3N3aWdpbml0KHNlbGYsIF9vZGJfcHkubmV3X2RiR0RTTGliKCkpCiAgICBfX3N3aWdfZGVzdHJveV9fID0gX29kYl9weS5kZWxldGVfZGJHRFNMaWIKCiMgUmVnaXN0ZXIgZGJHRFNMaWIgaW4gX29kYl9weToKX29kYl9weS5kYkdEU0xpYl9zd2lncmVnaXN0ZXIoZGJHRFNMaWIpCgpkZWYgZGJHRFNMaWJfY3JlYXRlKGRiLCBuYW1lKToKICAgIHJldHVybiBfb2RiX3B5LmRiR0RTTGliX2NyZWF0ZShkYiwgbmFtZSkKCmRlZiBkYkdEU0xpYl9kZXN0cm95KGxpYik6CiAgICByZXR1cm4gX29kYl9weS5kYkdEU0xpYl9kZXN0cm95KGxpYikKCmNsYXNzIGRiTVRlcm0ob2JqZWN0KToKICAgIHRoaXNvd24gPSBwcm9wZXJ0eShsYW1iZGEgeDogeC50aGlzLm93bigpLCBsYW1iZGEgeCwgdjogeC50aGlzLm93bih2KSwgZG9jPSdUaGUgbWVtYmVyc2hpcCBmbGFnJykKICAgIF9fcmVwcl9fID0gX3N3aWdfcmVwcgoKICAgIGRlZiBnZXRDb25zdE5hbWUoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJNVGVybV9nZXRDb25zdE5hbWUoc2VsZikKCiAgICBkZWYgZ2V0TmFtZShzZWxmLCAqYXJncyk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJNVGVybV9nZXROYW1lKHNlbGYsICphcmdzKQoKICAgIGRlZiBnZXRTaWdUeXBlKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTVRlcm1fZ2V0U2lnVHlwZShzZWxmKQoKICAgIGRlZiBzZXRTaWdUeXBlKHNlbGYsIHR5cGUpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTVRlcm1fc2V0U2lnVHlwZShzZWxmLCB0eXBlKQoKICAgIGRlZiBnZXRJb1R5cGUoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJNVGVybV9nZXRJb1R5cGUoc2VsZikKCiAgICBkZWYgZ2V0U2hhcGUoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJNVGVybV9nZXRTaGFwZShzZWxmKQoKICAgIGRlZiBzZXRNYXJrKHNlbGYsIHYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTVRlcm1fc2V0TWFyayhzZWxmLCB2KQoKICAgIGRlZiBpc1NldE1hcmsoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJNVGVybV9pc1NldE1hcmsoc2VsZikKCiAgICBkZWYgZ2V0TWFzdGVyKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTVRlcm1fZ2V0TWFzdGVyKHNlbGYpCgogICAgZGVmIGdldE1QaW5zKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTVRlcm1fZ2V0TVBpbnMoc2VsZikKCiAgICBkZWYgZ2V0QkJveChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk1UZXJtX2dldEJCb3goc2VsZikKCiAgICBkZWYgYWRkUGFydGlhbE1ldGFsQXJlYUVudHJ5KHNlbGYsIGludmFsLCByZWZseT1Ob25lKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk1UZXJtX2FkZFBhcnRpYWxNZXRhbEFyZWFFbnRyeShzZWxmLCBpbnZhbCwgcmVmbHkpCgogICAgZGVmIGFkZFBhcnRpYWxNZXRhbFNpZGVBcmVhRW50cnkoc2VsZiwgaW52YWwsIHJlZmx5PU5vbmUpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTVRlcm1fYWRkUGFydGlhbE1ldGFsU2lkZUFyZWFFbnRyeShzZWxmLCBpbnZhbCwgcmVmbHkpCgogICAgZGVmIGFkZFBhcnRpYWxDdXRBcmVhRW50cnkoc2VsZiwgaW52YWwsIHJlZmx5PU5vbmUpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTVRlcm1fYWRkUGFydGlhbEN1dEFyZWFFbnRyeShzZWxmLCBpbnZhbCwgcmVmbHkpCgogICAgZGVmIGFkZERpZmZBcmVhRW50cnkoc2VsZiwgaW52YWwsIHJlZmx5PU5vbmUpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTVRlcm1fYWRkRGlmZkFyZWFFbnRyeShzZWxmLCBpbnZhbCwgcmVmbHkpCgogICAgZGVmIGNyZWF0ZURlZmF1bHRBbnRlbm5hTW9kZWwoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJNVGVybV9jcmVhdGVEZWZhdWx0QW50ZW5uYU1vZGVsKHNlbGYpCgogICAgZGVmIGNyZWF0ZU94aWRlMkFudGVubmFNb2RlbChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk1UZXJtX2NyZWF0ZU94aWRlMkFudGVubmFNb2RlbChzZWxmKQoKICAgIGRlZiBoYXNEZWZhdWx0QW50ZW5uYU1vZGVsKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTVRlcm1faGFzRGVmYXVsdEFudGVubmFNb2RlbChzZWxmKQoKICAgIGRlZiBoYXNPeGlkZTJBbnRlbm5hTW9kZWwoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJNVGVybV9oYXNPeGlkZTJBbnRlbm5hTW9kZWwoc2VsZikKCiAgICBkZWYgZ2V0RGVmYXVsdEFudGVubmFNb2RlbChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk1UZXJtX2dldERlZmF1bHRBbnRlbm5hTW9kZWwoc2VsZikKCiAgICBkZWYgZ2V0T3hpZGUyQW50ZW5uYU1vZGVsKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTVRlcm1fZ2V0T3hpZGUyQW50ZW5uYU1vZGVsKHNlbGYpCgogICAgZGVmIHdyaXRlQW50ZW5uYUxlZihzZWxmLCB3cml0ZXIpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTVRlcm1fd3JpdGVBbnRlbm5hTGVmKHNlbGYsIHdyaXRlcikKCiAgICBkZWYgZ2V0RGlmZkFyZWEoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJNVGVybV9nZXREaWZmQXJlYShzZWxmKQoKICAgIGRlZiBzdGFQb3J0KHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTVRlcm1fc3RhUG9ydChzZWxmKQoKICAgIGRlZiBzdGFTZXRQb3J0KHNlbGYsIHBvcnQpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTVRlcm1fc3RhU2V0UG9ydChzZWxmLCBwb3J0KQoKICAgIGRlZiBnZXRJbmRleChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk1UZXJtX2dldEluZGV4KHNlbGYpCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIGNyZWF0ZSgqYXJncyk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJNVGVybV9jcmVhdGUoKmFyZ3MpCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIGdldE1UZXJtKG1hc3Rlciwgb2lkKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk1UZXJtX2dldE1UZXJtKG1hc3Rlciwgb2lkKQoKICAgIGRlZiBfX2luaXRfXyhzZWxmKToKICAgICAgICBfb2RiX3B5LmRiTVRlcm1fc3dpZ2luaXQoc2VsZiwgX29kYl9weS5uZXdfZGJNVGVybSgpKQogICAgX19zd2lnX2Rlc3Ryb3lfXyA9IF9vZGJfcHkuZGVsZXRlX2RiTVRlcm0KCiMgUmVnaXN0ZXIgZGJNVGVybSBpbiBfb2RiX3B5Ogpfb2RiX3B5LmRiTVRlcm1fc3dpZ3JlZ2lzdGVyKGRiTVRlcm0pCgpkZWYgZGJNVGVybV9jcmVhdGUoKmFyZ3MpOgogICAgcmV0dXJuIF9vZGJfcHkuZGJNVGVybV9jcmVhdGUoKmFyZ3MpCgpkZWYgZGJNVGVybV9nZXRNVGVybShtYXN0ZXIsIG9pZCk6CiAgICByZXR1cm4gX29kYl9weS5kYk1UZXJtX2dldE1UZXJtKG1hc3Rlciwgb2lkKQoKY2xhc3MgZGJNUGluKG9iamVjdCk6CiAgICB0aGlzb3duID0gcHJvcGVydHkobGFtYmRhIHg6IHgudGhpcy5vd24oKSwgbGFtYmRhIHgsIHY6IHgudGhpcy5vd24odiksIGRvYz0nVGhlIG1lbWJlcnNoaXAgZmxhZycpCiAgICBfX3JlcHJfXyA9IF9zd2lnX3JlcHIKCiAgICBkZWYgZ2V0TVRlcm0oc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJNUGluX2dldE1UZXJtKHNlbGYpCgogICAgZGVmIGdldE1hc3RlcihzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk1QaW5fZ2V0TWFzdGVyKHNlbGYpCgogICAgZGVmIGdldEdlb21ldHJ5KHNlbGYsIGluY2x1ZGVfZGVjb21wb3NlZF9wb2x5Z29ucz1UcnVlKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk1QaW5fZ2V0R2VvbWV0cnkoc2VsZiwgaW5jbHVkZV9kZWNvbXBvc2VkX3BvbHlnb25zKQoKICAgIGRlZiBnZXRQb2x5Z29uR2VvbWV0cnkoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJNUGluX2dldFBvbHlnb25HZW9tZXRyeShzZWxmKQoKICAgIGRlZiBnZXRCQm94KHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTVBpbl9nZXRCQm94KHNlbGYpCgogICAgZGVmIGdldFBpbkFjY2VzcyhzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk1QaW5fZ2V0UGluQWNjZXNzKHNlbGYpCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIGNyZWF0ZShtdGVybSk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJNUGluX2NyZWF0ZShtdGVybSkKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgZ2V0TVBpbihtYXN0ZXIsIG9pZCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJNUGluX2dldE1QaW4obWFzdGVyLCBvaWQpCgogICAgZGVmIF9faW5pdF9fKHNlbGYpOgogICAgICAgIF9vZGJfcHkuZGJNUGluX3N3aWdpbml0KHNlbGYsIF9vZGJfcHkubmV3X2RiTVBpbigpKQogICAgX19zd2lnX2Rlc3Ryb3lfXyA9IF9vZGJfcHkuZGVsZXRlX2RiTVBpbgoKIyBSZWdpc3RlciBkYk1QaW4gaW4gX29kYl9weToKX29kYl9weS5kYk1QaW5fc3dpZ3JlZ2lzdGVyKGRiTVBpbikKCmRlZiBkYk1QaW5fY3JlYXRlKG10ZXJtKToKICAgIHJldHVybiBfb2RiX3B5LmRiTVBpbl9jcmVhdGUobXRlcm0pCgpkZWYgZGJNUGluX2dldE1QaW4obWFzdGVyLCBvaWQpOgogICAgcmV0dXJuIF9vZGJfcHkuZGJNUGluX2dldE1QaW4obWFzdGVyLCBvaWQpCgpjbGFzcyBkYlRlY2gob2JqZWN0KToKICAgIHRoaXNvd24gPSBwcm9wZXJ0eShsYW1iZGEgeDogeC50aGlzLm93bigpLCBsYW1iZGEgeCwgdjogeC50aGlzLm93bih2KSwgZG9jPSdUaGUgbWVtYmVyc2hpcCBmbGFnJykKICAgIF9fcmVwcl9fID0gX3N3aWdfcmVwcgoKICAgIGRlZiBnZXROYW1lKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaF9nZXROYW1lKHNlbGYpCgogICAgZGVmIHNldERiVW5pdHNQZXJNaWNyb24oc2VsZiwgdmFsdWUpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaF9zZXREYlVuaXRzUGVyTWljcm9uKHNlbGYsIHZhbHVlKQoKICAgIGRlZiBnZXREYlVuaXRzUGVyTWljcm9uKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaF9nZXREYlVuaXRzUGVyTWljcm9uKHNlbGYpCgogICAgZGVmIGdldExheWVycyhzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hfZ2V0TGF5ZXJzKHNlbGYpCgogICAgZGVmIGZpbmRMYXllcihzZWxmLCAqYXJncyk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoX2ZpbmRMYXllcihzZWxmLCAqYXJncykKCiAgICBkZWYgZmluZFJvdXRpbmdMYXllcihzZWxmLCBsZXZlbF9udW1iZXIpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaF9maW5kUm91dGluZ0xheWVyKHNlbGYsIGxldmVsX251bWJlcikKCiAgICBkZWYgZ2V0VmlhcyhzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hfZ2V0VmlhcyhzZWxmKQoKICAgIGRlZiBmaW5kVmlhKHNlbGYsIG5hbWUpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaF9maW5kVmlhKHNlbGYsIG5hbWUpCgogICAgZGVmIGdldExlZlVuaXRzKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaF9nZXRMZWZVbml0cyhzZWxmKQoKICAgIGRlZiBzZXRMZWZVbml0cyhzZWxmLCB1bml0cyk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoX3NldExlZlVuaXRzKHNlbGYsIHVuaXRzKQoKICAgIGRlZiBnZXRMZWZWZXJzaW9uKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaF9nZXRMZWZWZXJzaW9uKHNlbGYpCgogICAgZGVmIGdldExlZlZlcnNpb25TdHIoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoX2dldExlZlZlcnNpb25TdHIoc2VsZikKCiAgICBkZWYgc2V0TGVmVmVyc2lvbihzZWxmLCBpbnZlcik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoX3NldExlZlZlcnNpb24oc2VsZiwgaW52ZXIpCgogICAgZGVmIGhhc05vV2lyZUV4dEF0UGluKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaF9oYXNOb1dpcmVFeHRBdFBpbihzZWxmKQoKICAgIGRlZiBnZXROb1dpcmVFeHRBdFBpbihzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hfZ2V0Tm9XaXJlRXh0QXRQaW4oc2VsZikKCiAgICBkZWYgc2V0Tm9XaXJlRXh0QXRQaW4oc2VsZiwgaW50eXApOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaF9zZXROb1dpcmVFeHRBdFBpbihzZWxmLCBpbnR5cCkKCiAgICBkZWYgZ2V0TmFtZXNDYXNlU2Vuc2l0aXZlKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaF9nZXROYW1lc0Nhc2VTZW5zaXRpdmUoc2VsZikKCiAgICBkZWYgc2V0TmFtZXNDYXNlU2Vuc2l0aXZlKHNlbGYsIGludHlwKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hfc2V0TmFtZXNDYXNlU2Vuc2l0aXZlKHNlbGYsIGludHlwKQoKICAgIGRlZiBoYXNDbGVhcmFuY2VNZWFzdXJlKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaF9oYXNDbGVhcmFuY2VNZWFzdXJlKHNlbGYpCgogICAgZGVmIGdldENsZWFyYW5jZU1lYXN1cmUoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoX2dldENsZWFyYW5jZU1lYXN1cmUoc2VsZikKCiAgICBkZWYgc2V0Q2xlYXJhbmNlTWVhc3VyZShzZWxmLCBpbm1lYXMpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaF9zZXRDbGVhcmFuY2VNZWFzdXJlKHNlbGYsIGlubWVhcykKCiAgICBkZWYgaGFzVXNlTWluU3BhY2luZ09icyhzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hfaGFzVXNlTWluU3BhY2luZ09icyhzZWxmKQoKICAgIGRlZiBnZXRVc2VNaW5TcGFjaW5nT2JzKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaF9nZXRVc2VNaW5TcGFjaW5nT2JzKHNlbGYpCgogICAgZGVmIHNldFVzZU1pblNwYWNpbmdPYnMoc2VsZiwgaW52YWwpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaF9zZXRVc2VNaW5TcGFjaW5nT2JzKHNlbGYsIGludmFsKQoKICAgIGRlZiBoYXNVc2VNaW5TcGFjaW5nUGluKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaF9oYXNVc2VNaW5TcGFjaW5nUGluKHNlbGYpCgogICAgZGVmIGdldFVzZU1pblNwYWNpbmdQaW4oc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoX2dldFVzZU1pblNwYWNpbmdQaW4oc2VsZikKCiAgICBkZWYgc2V0VXNlTWluU3BhY2luZ1BpbihzZWxmLCBpbnZhbCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoX3NldFVzZU1pblNwYWNpbmdQaW4oc2VsZiwgaW52YWwpCgogICAgZGVmIGhhc01hbnVmYWN0dXJpbmdHcmlkKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaF9oYXNNYW51ZmFjdHVyaW5nR3JpZChzZWxmKQoKICAgIGRlZiBnZXRNYW51ZmFjdHVyaW5nR3JpZChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hfZ2V0TWFudWZhY3R1cmluZ0dyaWQoc2VsZikKCiAgICBkZWYgc2V0TWFudWZhY3R1cmluZ0dyaWQoc2VsZiwgaW5ncmQpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaF9zZXRNYW51ZmFjdHVyaW5nR3JpZChzZWxmLCBpbmdyZCkKCiAgICBkZWYgZ2V0TGF5ZXJDb3VudChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hfZ2V0TGF5ZXJDb3VudChzZWxmKQoKICAgIGRlZiBnZXRSb3V0aW5nTGF5ZXJDb3VudChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hfZ2V0Um91dGluZ0xheWVyQ291bnQoc2VsZikKCiAgICBkZWYgZ2V0VmlhQ291bnQoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoX2dldFZpYUNvdW50KHNlbGYpCgogICAgZGVmIGdldE5vbkRlZmF1bHRSdWxlcyhzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hfZ2V0Tm9uRGVmYXVsdFJ1bGVzKHNlbGYpCgogICAgZGVmIGZpbmROb25EZWZhdWx0UnVsZShzZWxmLCBydWxlbmFtZSk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoX2ZpbmROb25EZWZhdWx0UnVsZShzZWxmLCBydWxlbmFtZSkKCiAgICBkZWYgZmluZFNhbWVOZXRSdWxlKHNlbGYsIGwxLCBsMik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoX2ZpbmRTYW1lTmV0UnVsZShzZWxmLCBsMSwgbDIpCgogICAgZGVmIGdldFNhbWVOZXRSdWxlcyhzZWxmLCBydWxlcyk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoX2dldFNhbWVOZXRSdWxlcyhzZWxmLCBydWxlcykKCiAgICBkZWYgZ2V0VmlhUnVsZXMoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoX2dldFZpYVJ1bGVzKHNlbGYpCgogICAgZGVmIGdldFZpYUdlbmVyYXRlUnVsZXMoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoX2dldFZpYUdlbmVyYXRlUnVsZXMoc2VsZikKCiAgICBkZWYgZ2V0TWV0YWxXaWR0aFZpYU1hcChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hfZ2V0TWV0YWxXaWR0aFZpYU1hcChzZWxmKQoKICAgIGRlZiBnZXRDZWxsRWRnZVNwYWNpbmdUYWJsZShzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hfZ2V0Q2VsbEVkZ2VTcGFjaW5nVGFibGUoc2VsZikKCiAgICBkZWYgZmluZFZpYVJ1bGUoc2VsZiwgbmFtZSk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoX2ZpbmRWaWFSdWxlKHNlbGYsIG5hbWUpCgogICAgZGVmIGZpbmRWaWFHZW5lcmF0ZVJ1bGUoc2VsZiwgbmFtZSk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoX2ZpbmRWaWFHZW5lcmF0ZVJ1bGUoc2VsZiwgbmFtZSkKCiAgICBkZWYgY2hlY2tMYXllcihzZWxmLCB0eXBlQ2hrLCB3aWR0aENoaywgcGl0Y2hDaGssIHNwYWNpbmdDaGspOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaF9jaGVja0xheWVyKHNlbGYsIHR5cGVDaGssIHdpZHRoQ2hrLCBwaXRjaENoaywgc3BhY2luZ0NoaykKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgY3JlYXRlKGRiLCBuYW1lLCBkYnVfcGVyX21pY3Jvbj0xMDAwKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hfY3JlYXRlKGRiLCBuYW1lLCBkYnVfcGVyX21pY3JvbikKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgZ2V0VGVjaChkYiwgb2lkKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hfZ2V0VGVjaChkYiwgb2lkKQoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBkZXN0cm95KHRlY2gpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaF9kZXN0cm95KHRlY2gpCgogICAgZGVmIF9faW5pdF9fKHNlbGYpOgogICAgICAgIF9vZGJfcHkuZGJUZWNoX3N3aWdpbml0KHNlbGYsIF9vZGJfcHkubmV3X2RiVGVjaCgpKQogICAgX19zd2lnX2Rlc3Ryb3lfXyA9IF9vZGJfcHkuZGVsZXRlX2RiVGVjaAoKIyBSZWdpc3RlciBkYlRlY2ggaW4gX29kYl9weToKX29kYl9weS5kYlRlY2hfc3dpZ3JlZ2lzdGVyKGRiVGVjaCkKCmRlZiBkYlRlY2hfY3JlYXRlKGRiLCBuYW1lLCBkYnVfcGVyX21pY3Jvbj0xMDAwKToKICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaF9jcmVhdGUoZGIsIG5hbWUsIGRidV9wZXJfbWljcm9uKQoKZGVmIGRiVGVjaF9nZXRUZWNoKGRiLCBvaWQpOgogICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoX2dldFRlY2goZGIsIG9pZCkKCmRlZiBkYlRlY2hfZGVzdHJveSh0ZWNoKToKICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaF9kZXN0cm95KHRlY2gpCgpjbGFzcyBkYlRlY2hWaWEob2JqZWN0KToKICAgIHRoaXNvd24gPSBwcm9wZXJ0eShsYW1iZGEgeDogeC50aGlzLm93bigpLCBsYW1iZGEgeCwgdjogeC50aGlzLm93bih2KSwgZG9jPSdUaGUgbWVtYmVyc2hpcCBmbGFnJykKICAgIF9fcmVwcl9fID0gX3N3aWdfcmVwcgoKICAgIGRlZiBnZXROYW1lKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaFZpYV9nZXROYW1lKHNlbGYpCgogICAgZGVmIGdldENvbnN0TmFtZShzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hWaWFfZ2V0Q29uc3ROYW1lKHNlbGYpCgogICAgZGVmIGlzRGVmYXVsdChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hWaWFfaXNEZWZhdWx0KHNlbGYpCgogICAgZGVmIHNldERlZmF1bHQoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoVmlhX3NldERlZmF1bHQoc2VsZikKCiAgICBkZWYgaXNUb3BPZlN0YWNrKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaFZpYV9pc1RvcE9mU3RhY2soc2VsZikKCiAgICBkZWYgc2V0VG9wT2ZTdGFjayhzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hWaWFfc2V0VG9wT2ZTdGFjayhzZWxmKQoKICAgIGRlZiBnZXRSZXNpc3RhbmNlKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaFZpYV9nZXRSZXNpc3RhbmNlKHNlbGYpCgogICAgZGVmIHNldFJlc2lzdGFuY2Uoc2VsZiwgcmVzKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hWaWFfc2V0UmVzaXN0YW5jZShzZWxmLCByZXMpCgogICAgZGVmIHNldFBhdHRlcm4oc2VsZiwgcGF0dGVybik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoVmlhX3NldFBhdHRlcm4oc2VsZiwgcGF0dGVybikKCiAgICBkZWYgZ2V0UGF0dGVybihzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hWaWFfZ2V0UGF0dGVybihzZWxmKQoKICAgIGRlZiBzZXRWaWFHZW5lcmF0ZVJ1bGUoc2VsZiwgcnVsZSk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoVmlhX3NldFZpYUdlbmVyYXRlUnVsZShzZWxmLCBydWxlKQoKICAgIGRlZiBnZXRWaWFHZW5lcmF0ZVJ1bGUoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoVmlhX2dldFZpYUdlbmVyYXRlUnVsZShzZWxmKQoKICAgIGRlZiBoYXNQYXJhbXMoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoVmlhX2hhc1BhcmFtcyhzZWxmKQoKICAgIGRlZiBzZXRWaWFQYXJhbXMoc2VsZiwgcGFyYW1zKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hWaWFfc2V0VmlhUGFyYW1zKHNlbGYsIHBhcmFtcykKCiAgICBkZWYgZ2V0VmlhUGFyYW1zKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaFZpYV9nZXRWaWFQYXJhbXMoc2VsZikKCiAgICBkZWYgZ2V0VGVjaChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hWaWFfZ2V0VGVjaChzZWxmKQoKICAgIGRlZiBnZXRCQm94KHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaFZpYV9nZXRCQm94KHNlbGYpCgogICAgZGVmIGdldEJveGVzKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaFZpYV9nZXRCb3hlcyhzZWxmKQoKICAgIGRlZiBnZXRUb3BMYXllcihzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hWaWFfZ2V0VG9wTGF5ZXIoc2VsZikKCiAgICBkZWYgZ2V0Qm90dG9tTGF5ZXIoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoVmlhX2dldEJvdHRvbUxheWVyKHNlbGYpCgogICAgZGVmIGdldE5vbkRlZmF1bHRSdWxlKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaFZpYV9nZXROb25EZWZhdWx0UnVsZShzZWxmKQoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBjcmVhdGUoKmFyZ3MpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaFZpYV9jcmVhdGUoKmFyZ3MpCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIGNsb25lKHJ1bGUsIGludmlhXywgbmV3X25hbWUpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaFZpYV9jbG9uZShydWxlLCBpbnZpYV8sIG5ld19uYW1lKQoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBnZXRUZWNoVmlhKHRlY2gsIG9pZCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoVmlhX2dldFRlY2hWaWEodGVjaCwgb2lkKQoKICAgIGRlZiBfX2luaXRfXyhzZWxmKToKICAgICAgICBfb2RiX3B5LmRiVGVjaFZpYV9zd2lnaW5pdChzZWxmLCBfb2RiX3B5Lm5ld19kYlRlY2hWaWEoKSkKICAgIF9fc3dpZ19kZXN0cm95X18gPSBfb2RiX3B5LmRlbGV0ZV9kYlRlY2hWaWEKCiMgUmVnaXN0ZXIgZGJUZWNoVmlhIGluIF9vZGJfcHk6Cl9vZGJfcHkuZGJUZWNoVmlhX3N3aWdyZWdpc3RlcihkYlRlY2hWaWEpCgpkZWYgZGJUZWNoVmlhX2NyZWF0ZSgqYXJncyk6CiAgICByZXR1cm4gX29kYl9weS5kYlRlY2hWaWFfY3JlYXRlKCphcmdzKQoKZGVmIGRiVGVjaFZpYV9jbG9uZShydWxlLCBpbnZpYV8sIG5ld19uYW1lKToKICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaFZpYV9jbG9uZShydWxlLCBpbnZpYV8sIG5ld19uYW1lKQoKZGVmIGRiVGVjaFZpYV9nZXRUZWNoVmlhKHRlY2gsIG9pZCk6CiAgICByZXR1cm4gX29kYl9weS5kYlRlY2hWaWFfZ2V0VGVjaFZpYSh0ZWNoLCBvaWQpCgpjbGFzcyBkYlRlY2hWaWFSdWxlKG9iamVjdCk6CiAgICB0aGlzb3duID0gcHJvcGVydHkobGFtYmRhIHg6IHgudGhpcy5vd24oKSwgbGFtYmRhIHgsIHY6IHgudGhpcy5vd24odiksIGRvYz0nVGhlIG1lbWJlcnNoaXAgZmxhZycpCiAgICBfX3JlcHJfXyA9IF9zd2lnX3JlcHIKCiAgICBkZWYgZ2V0TmFtZShzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hWaWFSdWxlX2dldE5hbWUoc2VsZikKCiAgICBkZWYgYWRkVmlhKHNlbGYsIHZpYSk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoVmlhUnVsZV9hZGRWaWEoc2VsZiwgdmlhKQoKICAgIGRlZiBnZXRWaWFDb3VudChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hWaWFSdWxlX2dldFZpYUNvdW50KHNlbGYpCgogICAgZGVmIGdldFZpYShzZWxmLCBpbmR4KToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hWaWFSdWxlX2dldFZpYShzZWxmLCBpbmR4KQoKICAgIGRlZiBnZXRWaWFMYXllclJ1bGVDb3VudChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hWaWFSdWxlX2dldFZpYUxheWVyUnVsZUNvdW50KHNlbGYpCgogICAgZGVmIGdldFZpYUxheWVyUnVsZShzZWxmLCBpbmR4KToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hWaWFSdWxlX2dldFZpYUxheWVyUnVsZShzZWxmLCBpbmR4KQoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBjcmVhdGUodGVjaCwgbmFtZSk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoVmlhUnVsZV9jcmVhdGUodGVjaCwgbmFtZSkKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgZ2V0VGVjaFZpYVJ1bGUodGVjaCwgb2lkKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hWaWFSdWxlX2dldFRlY2hWaWFSdWxlKHRlY2gsIG9pZCkKCiAgICBkZWYgX19pbml0X18oc2VsZik6CiAgICAgICAgX29kYl9weS5kYlRlY2hWaWFSdWxlX3N3aWdpbml0KHNlbGYsIF9vZGJfcHkubmV3X2RiVGVjaFZpYVJ1bGUoKSkKICAgIF9fc3dpZ19kZXN0cm95X18gPSBfb2RiX3B5LmRlbGV0ZV9kYlRlY2hWaWFSdWxlCgojIFJlZ2lzdGVyIGRiVGVjaFZpYVJ1bGUgaW4gX29kYl9weToKX29kYl9weS5kYlRlY2hWaWFSdWxlX3N3aWdyZWdpc3RlcihkYlRlY2hWaWFSdWxlKQoKZGVmIGRiVGVjaFZpYVJ1bGVfY3JlYXRlKHRlY2gsIG5hbWUpOgogICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoVmlhUnVsZV9jcmVhdGUodGVjaCwgbmFtZSkKCmRlZiBkYlRlY2hWaWFSdWxlX2dldFRlY2hWaWFSdWxlKHRlY2gsIG9pZCk6CiAgICByZXR1cm4gX29kYl9weS5kYlRlY2hWaWFSdWxlX2dldFRlY2hWaWFSdWxlKHRlY2gsIG9pZCkKCmNsYXNzIGRiVGVjaFZpYUxheWVyUnVsZShvYmplY3QpOgogICAgdGhpc293biA9IHByb3BlcnR5KGxhbWJkYSB4OiB4LnRoaXMub3duKCksIGxhbWJkYSB4LCB2OiB4LnRoaXMub3duKHYpLCBkb2M9J1RoZSBtZW1iZXJzaGlwIGZsYWcnKQogICAgX19yZXByX18gPSBfc3dpZ19yZXByCgogICAgZGVmIGdldExheWVyKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaFZpYUxheWVyUnVsZV9nZXRMYXllcihzZWxmKQoKICAgIGRlZiBnZXREaXJlY3Rpb24oc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoVmlhTGF5ZXJSdWxlX2dldERpcmVjdGlvbihzZWxmKQoKICAgIGRlZiBzZXREaXJlY3Rpb24oc2VsZiwgZGlyKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hWaWFMYXllclJ1bGVfc2V0RGlyZWN0aW9uKHNlbGYsIGRpcikKCiAgICBkZWYgaGFzV2lkdGgoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoVmlhTGF5ZXJSdWxlX2hhc1dpZHRoKHNlbGYpCgogICAgZGVmIGdldFdpZHRoKHNlbGYsIG1pbldpZHRoLCBtYXhXaWR0aCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoVmlhTGF5ZXJSdWxlX2dldFdpZHRoKHNlbGYsIG1pbldpZHRoLCBtYXhXaWR0aCkKCiAgICBkZWYgc2V0V2lkdGgoc2VsZiwgbWluV2lkdGgsIG1heFdpZHRoKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hWaWFMYXllclJ1bGVfc2V0V2lkdGgoc2VsZiwgbWluV2lkdGgsIG1heFdpZHRoKQoKICAgIGRlZiBoYXNFbmNsb3N1cmUoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoVmlhTGF5ZXJSdWxlX2hhc0VuY2xvc3VyZShzZWxmKQoKICAgIGRlZiBnZXRFbmNsb3N1cmUoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoVmlhTGF5ZXJSdWxlX2dldEVuY2xvc3VyZShzZWxmKQoKICAgIGRlZiBzZXRFbmNsb3N1cmUoc2VsZiwgb3ZlcmhhbmcxLCBvdmVyaGFuZzIpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaFZpYUxheWVyUnVsZV9zZXRFbmNsb3N1cmUoc2VsZiwgb3ZlcmhhbmcxLCBvdmVyaGFuZzIpCgogICAgZGVmIGhhc092ZXJoYW5nKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaFZpYUxheWVyUnVsZV9oYXNPdmVyaGFuZyhzZWxmKQoKICAgIGRlZiBnZXRPdmVyaGFuZyhzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hWaWFMYXllclJ1bGVfZ2V0T3Zlcmhhbmcoc2VsZikKCiAgICBkZWYgc2V0T3Zlcmhhbmcoc2VsZiwgb3ZlcmhhbmcpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaFZpYUxheWVyUnVsZV9zZXRPdmVyaGFuZyhzZWxmLCBvdmVyaGFuZykKCiAgICBkZWYgaGFzTWV0YWxPdmVyaGFuZyhzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hWaWFMYXllclJ1bGVfaGFzTWV0YWxPdmVyaGFuZyhzZWxmKQoKICAgIGRlZiBnZXRNZXRhbE92ZXJoYW5nKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaFZpYUxheWVyUnVsZV9nZXRNZXRhbE92ZXJoYW5nKHNlbGYpCgogICAgZGVmIHNldE1ldGFsT3Zlcmhhbmcoc2VsZiwgb3ZlcmhhbmcpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaFZpYUxheWVyUnVsZV9zZXRNZXRhbE92ZXJoYW5nKHNlbGYsIG92ZXJoYW5nKQoKICAgIGRlZiBoYXNSZWN0KHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaFZpYUxheWVyUnVsZV9oYXNSZWN0KHNlbGYpCgogICAgZGVmIGdldFJlY3Qoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoVmlhTGF5ZXJSdWxlX2dldFJlY3Qoc2VsZikKCiAgICBkZWYgc2V0UmVjdChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hWaWFMYXllclJ1bGVfc2V0UmVjdChzZWxmKQoKICAgIGRlZiBoYXNTcGFjaW5nKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaFZpYUxheWVyUnVsZV9oYXNTcGFjaW5nKHNlbGYpCgogICAgZGVmIGdldFNwYWNpbmcoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoVmlhTGF5ZXJSdWxlX2dldFNwYWNpbmcoc2VsZikKCiAgICBkZWYgc2V0U3BhY2luZyhzZWxmLCB4X3NwYWNpbmcsIHlfc3BhY2luZyk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoVmlhTGF5ZXJSdWxlX3NldFNwYWNpbmcoc2VsZiwgeF9zcGFjaW5nLCB5X3NwYWNpbmcpCgogICAgZGVmIGhhc1Jlc2lzdGFuY2Uoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoVmlhTGF5ZXJSdWxlX2hhc1Jlc2lzdGFuY2Uoc2VsZikKCiAgICBkZWYgc2V0UmVzaXN0YW5jZShzZWxmLCByKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hWaWFMYXllclJ1bGVfc2V0UmVzaXN0YW5jZShzZWxmLCByKQoKICAgIGRlZiBnZXRSZXNpc3RhbmNlKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaFZpYUxheWVyUnVsZV9nZXRSZXNpc3RhbmNlKHNlbGYpCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIGNyZWF0ZSgqYXJncyk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoVmlhTGF5ZXJSdWxlX2NyZWF0ZSgqYXJncykKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgZ2V0VGVjaFZpYUxheWVyUnVsZSh0ZWNoLCBvaWQpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaFZpYUxheWVyUnVsZV9nZXRUZWNoVmlhTGF5ZXJSdWxlKHRlY2gsIG9pZCkKCiAgICBkZWYgX19pbml0X18oc2VsZik6CiAgICAgICAgX29kYl9weS5kYlRlY2hWaWFMYXllclJ1bGVfc3dpZ2luaXQoc2VsZiwgX29kYl9weS5uZXdfZGJUZWNoVmlhTGF5ZXJSdWxlKCkpCiAgICBfX3N3aWdfZGVzdHJveV9fID0gX29kYl9weS5kZWxldGVfZGJUZWNoVmlhTGF5ZXJSdWxlCgojIFJlZ2lzdGVyIGRiVGVjaFZpYUxheWVyUnVsZSBpbiBfb2RiX3B5Ogpfb2RiX3B5LmRiVGVjaFZpYUxheWVyUnVsZV9zd2lncmVnaXN0ZXIoZGJUZWNoVmlhTGF5ZXJSdWxlKQoKZGVmIGRiVGVjaFZpYUxheWVyUnVsZV9jcmVhdGUoKmFyZ3MpOgogICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoVmlhTGF5ZXJSdWxlX2NyZWF0ZSgqYXJncykKCmRlZiBkYlRlY2hWaWFMYXllclJ1bGVfZ2V0VGVjaFZpYUxheWVyUnVsZSh0ZWNoLCBvaWQpOgogICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoVmlhTGF5ZXJSdWxlX2dldFRlY2hWaWFMYXllclJ1bGUodGVjaCwgb2lkKQoKY2xhc3MgZGJUZWNoVmlhR2VuZXJhdGVSdWxlKG9iamVjdCk6CiAgICB0aGlzb3duID0gcHJvcGVydHkobGFtYmRhIHg6IHgudGhpcy5vd24oKSwgbGFtYmRhIHgsIHY6IHgudGhpcy5vd24odiksIGRvYz0nVGhlIG1lbWJlcnNoaXAgZmxhZycpCiAgICBfX3JlcHJfXyA9IF9zd2lnX3JlcHIKCiAgICBkZWYgZ2V0TmFtZShzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hWaWFHZW5lcmF0ZVJ1bGVfZ2V0TmFtZShzZWxmKQoKICAgIGRlZiBpc0RlZmF1bHQoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoVmlhR2VuZXJhdGVSdWxlX2lzRGVmYXVsdChzZWxmKQoKICAgIGRlZiBnZXRWaWFMYXllclJ1bGVDb3VudChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hWaWFHZW5lcmF0ZVJ1bGVfZ2V0VmlhTGF5ZXJSdWxlQ291bnQoc2VsZikKCiAgICBkZWYgZ2V0VmlhTGF5ZXJSdWxlKHNlbGYsIGluZHgpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaFZpYUdlbmVyYXRlUnVsZV9nZXRWaWFMYXllclJ1bGUoc2VsZiwgaW5keCkKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgY3JlYXRlKHRlY2gsIG5hbWUsIGlzX2RlZmF1bHQpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaFZpYUdlbmVyYXRlUnVsZV9jcmVhdGUodGVjaCwgbmFtZSwgaXNfZGVmYXVsdCkKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgZ2V0VGVjaFZpYUdlbmVyYXRlUnVsZSh0ZWNoLCBvaWQpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaFZpYUdlbmVyYXRlUnVsZV9nZXRUZWNoVmlhR2VuZXJhdGVSdWxlKHRlY2gsIG9pZCkKCiAgICBkZWYgX19pbml0X18oc2VsZik6CiAgICAgICAgX29kYl9weS5kYlRlY2hWaWFHZW5lcmF0ZVJ1bGVfc3dpZ2luaXQoc2VsZiwgX29kYl9weS5uZXdfZGJUZWNoVmlhR2VuZXJhdGVSdWxlKCkpCiAgICBfX3N3aWdfZGVzdHJveV9fID0gX29kYl9weS5kZWxldGVfZGJUZWNoVmlhR2VuZXJhdGVSdWxlCgojIFJlZ2lzdGVyIGRiVGVjaFZpYUdlbmVyYXRlUnVsZSBpbiBfb2RiX3B5Ogpfb2RiX3B5LmRiVGVjaFZpYUdlbmVyYXRlUnVsZV9zd2lncmVnaXN0ZXIoZGJUZWNoVmlhR2VuZXJhdGVSdWxlKQoKZGVmIGRiVGVjaFZpYUdlbmVyYXRlUnVsZV9jcmVhdGUodGVjaCwgbmFtZSwgaXNfZGVmYXVsdCk6CiAgICByZXR1cm4gX29kYl9weS5kYlRlY2hWaWFHZW5lcmF0ZVJ1bGVfY3JlYXRlKHRlY2gsIG5hbWUsIGlzX2RlZmF1bHQpCgpkZWYgZGJUZWNoVmlhR2VuZXJhdGVSdWxlX2dldFRlY2hWaWFHZW5lcmF0ZVJ1bGUodGVjaCwgb2lkKToKICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaFZpYUdlbmVyYXRlUnVsZV9nZXRUZWNoVmlhR2VuZXJhdGVSdWxlKHRlY2gsIG9pZCkKCmNsYXNzIGRiVGVjaExheWVyU3BhY2luZ1J1bGUob2JqZWN0KToKICAgIHRoaXNvd24gPSBwcm9wZXJ0eShsYW1iZGEgeDogeC50aGlzLm93bigpLCBsYW1iZGEgeCwgdjogeC50aGlzLm93bih2KSwgZG9jPSdUaGUgbWVtYmVyc2hpcCBmbGFnJykKICAgIF9fcmVwcl9fID0gX3N3aWdfcmVwcgoKICAgIGRlZiBpc1VuY29uZGl0aW9uYWwoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJTcGFjaW5nUnVsZV9pc1VuY29uZGl0aW9uYWwoc2VsZikKCiAgICBkZWYgZ2V0U3BhY2luZyhzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllclNwYWNpbmdSdWxlX2dldFNwYWNpbmcoc2VsZikKCiAgICBkZWYgZ2V0TGVuZ3RoVGhyZXNob2xkKHNlbGYsIHRocmVzaG9sZCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJTcGFjaW5nUnVsZV9nZXRMZW5ndGhUaHJlc2hvbGQoc2VsZiwgdGhyZXNob2xkKQoKICAgIGRlZiBnZXRMZW5ndGhUaHJlc2hvbGRSYW5nZShzZWxmLCBybWluLCBybWF4KToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllclNwYWNpbmdSdWxlX2dldExlbmd0aFRocmVzaG9sZFJhbmdlKHNlbGYsIHJtaW4sIHJtYXgpCgogICAgZGVmIGdldFJhbmdlKHNlbGYsIHJtaW4sIHJtYXgpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyU3BhY2luZ1J1bGVfZ2V0UmFuZ2Uoc2VsZiwgcm1pbiwgcm1heCkKCiAgICBkZWYgc2V0U3BhY2luZ05vdGNoTGVuZ3RoVmFsaWQoc2VsZiwgdmFsKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllclNwYWNpbmdSdWxlX3NldFNwYWNpbmdOb3RjaExlbmd0aFZhbGlkKHNlbGYsIHZhbCkKCiAgICBkZWYgc2V0U3BhY2luZ0VuZE9mTm90Y2hXaWR0aFZhbGlkKHNlbGYsIHZhbCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJTcGFjaW5nUnVsZV9zZXRTcGFjaW5nRW5kT2ZOb3RjaFdpZHRoVmFsaWQoc2VsZiwgdmFsKQoKICAgIGRlZiBoYXNTcGFjaW5nTm90Y2hMZW5ndGgoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJTcGFjaW5nUnVsZV9oYXNTcGFjaW5nTm90Y2hMZW5ndGgoc2VsZikKCiAgICBkZWYgaGFzU3BhY2luZ0VuZE9mTm90Y2hXaWR0aChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllclNwYWNpbmdSdWxlX2hhc1NwYWNpbmdFbmRPZk5vdGNoV2lkdGgoc2VsZikKCiAgICBkZWYgaGFzUmFuZ2Uoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJTcGFjaW5nUnVsZV9oYXNSYW5nZShzZWxmKQoKICAgIGRlZiBoYXNMZW5ndGhUaHJlc2hvbGQoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJTcGFjaW5nUnVsZV9oYXNMZW5ndGhUaHJlc2hvbGQoc2VsZikKCiAgICBkZWYgaGFzVXNlTGVuZ3RoVGhyZXNob2xkKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyU3BhY2luZ1J1bGVfaGFzVXNlTGVuZ3RoVGhyZXNob2xkKHNlbGYpCgogICAgZGVmIGdldEluZmx1ZW5jZShzZWxmLCBpbmZsdWVuY2UpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyU3BhY2luZ1J1bGVfZ2V0SW5mbHVlbmNlKHNlbGYsIGluZmx1ZW5jZSkKCiAgICBkZWYgZ2V0SW5mbHVlbmNlUmFuZ2Uoc2VsZiwgcm1pbiwgcm1heCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJTcGFjaW5nUnVsZV9nZXRJbmZsdWVuY2VSYW5nZShzZWxmLCBybWluLCBybWF4KQoKICAgIGRlZiBnZXRSYW5nZVJhbmdlKHNlbGYsIHJtaW4sIHJtYXgpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyU3BhY2luZ1J1bGVfZ2V0UmFuZ2VSYW5nZShzZWxmLCBybWluLCBybWF4KQoKICAgIGRlZiBnZXRBZGphY2VudEN1dHMoc2VsZiwgbnVtY3V0cywgd2l0aGluLCBzcGFjaW5nLCBleGNlcHRfc2FtZV9wZ25ldCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJTcGFjaW5nUnVsZV9nZXRBZGphY2VudEN1dHMoc2VsZiwgbnVtY3V0cywgd2l0aGluLCBzcGFjaW5nLCBleGNlcHRfc2FtZV9wZ25ldCkKCiAgICBkZWYgZ2V0Q3V0TGF5ZXI0U3BhY2luZyhzZWxmLCBvdXRseSk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJTcGFjaW5nUnVsZV9nZXRDdXRMYXllcjRTcGFjaW5nKHNlbGYsIG91dGx5KQoKICAgIGRlZiBnZXRDdXRTdGFja2luZyhzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllclNwYWNpbmdSdWxlX2dldEN1dFN0YWNraW5nKHNlbGYpCgogICAgZGVmIGdldEN1dENlbnRlclRvQ2VudGVyKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyU3BhY2luZ1J1bGVfZ2V0Q3V0Q2VudGVyVG9DZW50ZXIoc2VsZikKCiAgICBkZWYgZ2V0Q3V0U2FtZU5ldChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllclNwYWNpbmdSdWxlX2dldEN1dFNhbWVOZXQoc2VsZikKCiAgICBkZWYgZ2V0Q3V0UGFyYWxsZWxPdmVybGFwKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyU3BhY2luZ1J1bGVfZ2V0Q3V0UGFyYWxsZWxPdmVybGFwKHNlbGYpCgogICAgZGVmIGdldEN1dEFyZWEoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJTcGFjaW5nUnVsZV9nZXRDdXRBcmVhKHNlbGYpCgogICAgZGVmIHdyaXRlTGVmKHNlbGYsIHdyaXRlcik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJTcGFjaW5nUnVsZV93cml0ZUxlZihzZWxmLCB3cml0ZXIpCgogICAgZGVmIHNldFNhbWVOZXRQZ09ubHkoc2VsZiwgcGdvbmx5KToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllclNwYWNpbmdSdWxlX3NldFNhbWVOZXRQZ09ubHkoc2VsZiwgcGdvbmx5KQoKICAgIGRlZiBnZXRTYW1lTmV0UGdPbmx5KHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyU3BhY2luZ1J1bGVfZ2V0U2FtZU5ldFBnT25seShzZWxmKQoKICAgIGRlZiBzZXRMZW5ndGhUaHJlc2hvbGQoc2VsZiwgdGhyZXNob2xkKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllclNwYWNpbmdSdWxlX3NldExlbmd0aFRocmVzaG9sZChzZWxmLCB0aHJlc2hvbGQpCgogICAgZGVmIHNldFNwYWNpbmcoc2VsZiwgc3BhY2luZyk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJTcGFjaW5nUnVsZV9zZXRTcGFjaW5nKHNlbGYsIHNwYWNpbmcpCgogICAgZGVmIHNldExlbmd0aFRocmVzaG9sZFJhbmdlKHNlbGYsIHJtaW4sIHJtYXgpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyU3BhY2luZ1J1bGVfc2V0TGVuZ3RoVGhyZXNob2xkUmFuZ2Uoc2VsZiwgcm1pbiwgcm1heCkKCiAgICBkZWYgc2V0UmFuZ2Uoc2VsZiwgcm1pbiwgcm1heCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJTcGFjaW5nUnVsZV9zZXRSYW5nZShzZWxmLCBybWluLCBybWF4KQoKICAgIGRlZiBzZXRVc2VMZW5ndGhUaHJlc2hvbGQoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJTcGFjaW5nUnVsZV9zZXRVc2VMZW5ndGhUaHJlc2hvbGQoc2VsZikKCiAgICBkZWYgc2V0SW5mbHVlbmNlKHNlbGYsIGluZmx1ZW5jZSk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJTcGFjaW5nUnVsZV9zZXRJbmZsdWVuY2Uoc2VsZiwgaW5mbHVlbmNlKQoKICAgIGRlZiBzZXRJbmZsdWVuY2VSYW5nZShzZWxmLCBybWluLCBybWF4KToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllclNwYWNpbmdSdWxlX3NldEluZmx1ZW5jZVJhbmdlKHNlbGYsIHJtaW4sIHJtYXgpCgogICAgZGVmIHNldFJhbmdlUmFuZ2Uoc2VsZiwgcm1pbiwgcm1heCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJTcGFjaW5nUnVsZV9zZXRSYW5nZVJhbmdlKHNlbGYsIHJtaW4sIHJtYXgpCgogICAgZGVmIHNldEFkamFjZW50Q3V0cyhzZWxmLCBudW1jdXRzLCB3aXRoaW4sIHNwYWNpbmcsIGV4Y2VwdF9zYW1lX3BnbmV0KToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllclNwYWNpbmdSdWxlX3NldEFkamFjZW50Q3V0cyhzZWxmLCBudW1jdXRzLCB3aXRoaW4sIHNwYWNpbmcsIGV4Y2VwdF9zYW1lX3BnbmV0KQoKICAgIGRlZiBzZXRDdXRMYXllcjRTcGFjaW5nKHNlbGYsIGN1dGx5KToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllclNwYWNpbmdSdWxlX3NldEN1dExheWVyNFNwYWNpbmcoc2VsZiwgY3V0bHkpCgogICAgZGVmIHNldEN1dFN0YWNraW5nKHNlbGYsIHN0YWNraW5nKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllclNwYWNpbmdSdWxlX3NldEN1dFN0YWNraW5nKHNlbGYsIHN0YWNraW5nKQoKICAgIGRlZiBzZXRDdXRDZW50ZXJUb0NlbnRlcihzZWxmLCBjMmMpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyU3BhY2luZ1J1bGVfc2V0Q3V0Q2VudGVyVG9DZW50ZXIoc2VsZiwgYzJjKQoKICAgIGRlZiBzZXRDdXRTYW1lTmV0KHNlbGYsIHNhbWVfbmV0KToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllclNwYWNpbmdSdWxlX3NldEN1dFNhbWVOZXQoc2VsZiwgc2FtZV9uZXQpCgogICAgZGVmIHNldEN1dFBhcmFsbGVsT3ZlcmxhcChzZWxmLCBvdmVybGFwKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllclNwYWNpbmdSdWxlX3NldEN1dFBhcmFsbGVsT3ZlcmxhcChzZWxmLCBvdmVybGFwKQoKICAgIGRlZiBzZXRDdXRBcmVhKHNlbGYsIGFyZWEpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyU3BhY2luZ1J1bGVfc2V0Q3V0QXJlYShzZWxmLCBhcmVhKQoKICAgIGRlZiBzZXRFb2woc2VsZiwgd2lkdGgsIHdpdGhpbiwgcGFyYWxsZWxFZGdlLCBwYXJhbGxlbFNwYWNlLCBwYXJhbGxlbFdpdGhpbiwgdHdvRWRnZXMpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyU3BhY2luZ1J1bGVfc2V0RW9sKHNlbGYsIHdpZHRoLCB3aXRoaW4sIHBhcmFsbGVsRWRnZSwgcGFyYWxsZWxTcGFjZSwgcGFyYWxsZWxXaXRoaW4sIHR3b0VkZ2VzKQoKICAgIGRlZiBnZXRFb2woc2VsZiwgd2lkdGgsIHdpdGhpbiwgcGFyYWxsZWxFZGdlLCBwYXJhbGxlbFNwYWNlLCBwYXJhbGxlbFdpdGhpbiwgdHdvRWRnZXMpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyU3BhY2luZ1J1bGVfZ2V0RW9sKHNlbGYsIHdpZHRoLCB3aXRoaW4sIHBhcmFsbGVsRWRnZSwgcGFyYWxsZWxTcGFjZSwgcGFyYWxsZWxXaXRoaW4sIHR3b0VkZ2VzKQoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBjcmVhdGUoaW5seSk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJTcGFjaW5nUnVsZV9jcmVhdGUoaW5seSkKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgZ2V0VGVjaExheWVyU3BhY2luZ1J1bGUoaW5seSwgZGJpZCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJTcGFjaW5nUnVsZV9nZXRUZWNoTGF5ZXJTcGFjaW5nUnVsZShpbmx5LCBkYmlkKQoKICAgIGRlZiBfX2luaXRfXyhzZWxmKToKICAgICAgICBfb2RiX3B5LmRiVGVjaExheWVyU3BhY2luZ1J1bGVfc3dpZ2luaXQoc2VsZiwgX29kYl9weS5uZXdfZGJUZWNoTGF5ZXJTcGFjaW5nUnVsZSgpKQogICAgX19zd2lnX2Rlc3Ryb3lfXyA9IF9vZGJfcHkuZGVsZXRlX2RiVGVjaExheWVyU3BhY2luZ1J1bGUKCiMgUmVnaXN0ZXIgZGJUZWNoTGF5ZXJTcGFjaW5nUnVsZSBpbiBfb2RiX3B5Ogpfb2RiX3B5LmRiVGVjaExheWVyU3BhY2luZ1J1bGVfc3dpZ3JlZ2lzdGVyKGRiVGVjaExheWVyU3BhY2luZ1J1bGUp",
"CgpkZWYgZGJUZWNoTGF5ZXJTcGFjaW5nUnVsZV9jcmVhdGUoaW5seSk6CiAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllclNwYWNpbmdSdWxlX2NyZWF0ZShpbmx5KQoKZGVmIGRiVGVjaExheWVyU3BhY2luZ1J1bGVfZ2V0VGVjaExheWVyU3BhY2luZ1J1bGUoaW5seSwgZGJpZCk6CiAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllclNwYWNpbmdSdWxlX2dldFRlY2hMYXllclNwYWNpbmdSdWxlKGlubHksIGRiaWQpCgpjbGFzcyBkYlRlY2hNaW5DdXRSdWxlKG9iamVjdCk6CiAgICB0aGlzb3duID0gcHJvcGVydHkobGFtYmRhIHg6IHgudGhpcy5vd24oKSwgbGFtYmRhIHgsIHY6IHgudGhpcy5vd24odiksIGRvYz0nVGhlIG1lbWJlcnNoaXAgZmxhZycpCiAgICBfX3JlcHJfXyA9IF9zd2lnX3JlcHIKCiAgICBkZWYgZ2V0TWluaW11bUN1dHMoc2VsZiwgbnVtY3V0cywgd2lkdGgpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaE1pbkN1dFJ1bGVfZ2V0TWluaW11bUN1dHMoc2VsZiwgbnVtY3V0cywgd2lkdGgpCgogICAgZGVmIHNldE1pbmltdW1DdXRzKHNlbGYsIG51bWN1dHMsIHdpZHRoLCBhYm92ZV9vbmx5LCBiZWxvd19vbmx5KToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hNaW5DdXRSdWxlX3NldE1pbmltdW1DdXRzKHNlbGYsIG51bWN1dHMsIHdpZHRoLCBhYm92ZV9vbmx5LCBiZWxvd19vbmx5KQoKICAgIGRlZiBnZXRDdXREaXN0YW5jZShzZWxmLCBjdXRfZGlzdGFuY2UpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaE1pbkN1dFJ1bGVfZ2V0Q3V0RGlzdGFuY2Uoc2VsZiwgY3V0X2Rpc3RhbmNlKQoKICAgIGRlZiBzZXRDdXREaXN0YW5jZShzZWxmLCBjdXRfZGlzdGFuY2UpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaE1pbkN1dFJ1bGVfc2V0Q3V0RGlzdGFuY2Uoc2VsZiwgY3V0X2Rpc3RhbmNlKQoKICAgIGRlZiBnZXRMZW5ndGhGb3JDdXRzKHNlbGYsIGxlbmd0aCwgZGlzdGFuY2UpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaE1pbkN1dFJ1bGVfZ2V0TGVuZ3RoRm9yQ3V0cyhzZWxmLCBsZW5ndGgsIGRpc3RhbmNlKQoKICAgIGRlZiBzZXRMZW5ndGhGb3JDdXRzKHNlbGYsIGxlbmd0aCwgZGlzdGFuY2UpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaE1pbkN1dFJ1bGVfc2V0TGVuZ3RoRm9yQ3V0cyhzZWxmLCBsZW5ndGgsIGRpc3RhbmNlKQoKICAgIGRlZiBpc0Fib3ZlT25seShzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hNaW5DdXRSdWxlX2lzQWJvdmVPbmx5KHNlbGYpCgogICAgZGVmIGlzQmVsb3dPbmx5KHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaE1pbkN1dFJ1bGVfaXNCZWxvd09ubHkoc2VsZikKCiAgICBkZWYgd3JpdGVMZWYoc2VsZiwgd3JpdGVyKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hNaW5DdXRSdWxlX3dyaXRlTGVmKHNlbGYsIHdyaXRlcikKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgY3JlYXRlKGlubHkpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaE1pbkN1dFJ1bGVfY3JlYXRlKGlubHkpCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIGdldE1pbkN1dFJ1bGUoaW5seSwgZGJpZCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTWluQ3V0UnVsZV9nZXRNaW5DdXRSdWxlKGlubHksIGRiaWQpCgogICAgZGVmIF9faW5pdF9fKHNlbGYpOgogICAgICAgIF9vZGJfcHkuZGJUZWNoTWluQ3V0UnVsZV9zd2lnaW5pdChzZWxmLCBfb2RiX3B5Lm5ld19kYlRlY2hNaW5DdXRSdWxlKCkpCiAgICBfX3N3aWdfZGVzdHJveV9fID0gX29kYl9weS5kZWxldGVfZGJUZWNoTWluQ3V0UnVsZQoKIyBSZWdpc3RlciBkYlRlY2hNaW5DdXRSdWxlIGluIF9vZGJfcHk6Cl9vZGJfcHkuZGJUZWNoTWluQ3V0UnVsZV9zd2lncmVnaXN0ZXIoZGJUZWNoTWluQ3V0UnVsZSkKCmRlZiBkYlRlY2hNaW5DdXRSdWxlX2NyZWF0ZShpbmx5KToKICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaE1pbkN1dFJ1bGVfY3JlYXRlKGlubHkpCgpkZWYgZGJUZWNoTWluQ3V0UnVsZV9nZXRNaW5DdXRSdWxlKGlubHksIGRiaWQpOgogICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTWluQ3V0UnVsZV9nZXRNaW5DdXRSdWxlKGlubHksIGRiaWQpCgpjbGFzcyBkYlRlY2hNaW5FbmNSdWxlKG9iamVjdCk6CiAgICB0aGlzb3duID0gcHJvcGVydHkobGFtYmRhIHg6IHgudGhpcy5vd24oKSwgbGFtYmRhIHgsIHY6IHgudGhpcy5vd24odiksIGRvYz0nVGhlIG1lbWJlcnNoaXAgZmxhZycpCiAgICBfX3JlcHJfXyA9IF9zd2lnX3JlcHIKCiAgICBkZWYgZ2V0RW5jbG9zdXJlKHNlbGYsIGFyZWEpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaE1pbkVuY1J1bGVfZ2V0RW5jbG9zdXJlKHNlbGYsIGFyZWEpCgogICAgZGVmIHNldEVuY2xvc3VyZShzZWxmLCBhcmVhKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hNaW5FbmNSdWxlX3NldEVuY2xvc3VyZShzZWxmLCBhcmVhKQoKICAgIGRlZiBnZXRFbmNsb3N1cmVXaWR0aChzZWxmLCB3aWR0aCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTWluRW5jUnVsZV9nZXRFbmNsb3N1cmVXaWR0aChzZWxmLCB3aWR0aCkKCiAgICBkZWYgc2V0RW5jbG9zdXJlV2lkdGgoc2VsZiwgd2lkdGgpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaE1pbkVuY1J1bGVfc2V0RW5jbG9zdXJlV2lkdGgoc2VsZiwgd2lkdGgpCgogICAgZGVmIHdyaXRlTGVmKHNlbGYsIHdyaXRlcik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTWluRW5jUnVsZV93cml0ZUxlZihzZWxmLCB3cml0ZXIpCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIGNyZWF0ZShpbmx5KToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hNaW5FbmNSdWxlX2NyZWF0ZShpbmx5KQoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBnZXRNaW5FbmNSdWxlKGlubHksIGRiaWQpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaE1pbkVuY1J1bGVfZ2V0TWluRW5jUnVsZShpbmx5LCBkYmlkKQoKICAgIGRlZiBfX2luaXRfXyhzZWxmKToKICAgICAgICBfb2RiX3B5LmRiVGVjaE1pbkVuY1J1bGVfc3dpZ2luaXQoc2VsZiwgX29kYl9weS5uZXdfZGJUZWNoTWluRW5jUnVsZSgpKQogICAgX19zd2lnX2Rlc3Ryb3lfXyA9IF9vZGJfcHkuZGVsZXRlX2RiVGVjaE1pbkVuY1J1bGUKCiMgUmVnaXN0ZXIgZGJUZWNoTWluRW5jUnVsZSBpbiBfb2RiX3B5Ogpfb2RiX3B5LmRiVGVjaE1pbkVuY1J1bGVfc3dpZ3JlZ2lzdGVyKGRiVGVjaE1pbkVuY1J1bGUpCgpkZWYgZGJUZWNoTWluRW5jUnVsZV9jcmVhdGUoaW5seSk6CiAgICByZXR1cm4gX29kYl9weS5kYlRlY2hNaW5FbmNSdWxlX2NyZWF0ZShpbmx5KQoKZGVmIGRiVGVjaE1pbkVuY1J1bGVfZ2V0TWluRW5jUnVsZShpbmx5LCBkYmlkKToKICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaE1pbkVuY1J1bGVfZ2V0TWluRW5jUnVsZShpbmx5LCBkYmlkKQoKY2xhc3MgZGJUZWNoVjU1SW5mbHVlbmNlRW50cnkob2JqZWN0KToKICAgIHRoaXNvd24gPSBwcm9wZXJ0eShsYW1iZGEgeDogeC50aGlzLm93bigpLCBsYW1iZGEgeCwgdjogeC50aGlzLm93bih2KSwgZG9jPSdUaGUgbWVtYmVyc2hpcCBmbGFnJykKICAgIF9fcmVwcl9fID0gX3N3aWdfcmVwcgoKICAgIGRlZiBzZXRWNTVJbmZsdWVuY2VFbnRyeShzZWxmLCB3aWR0aCwgd2l0aGluLCBzcGFjaW5nKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hWNTVJbmZsdWVuY2VFbnRyeV9zZXRWNTVJbmZsdWVuY2VFbnRyeShzZWxmLCB3aWR0aCwgd2l0aGluLCBzcGFjaW5nKQoKICAgIGRlZiB3cml0ZUxlZihzZWxmLCB3cml0ZXIpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaFY1NUluZmx1ZW5jZUVudHJ5X3dyaXRlTGVmKHNlbGYsIHdyaXRlcikKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgY3JlYXRlKGlubHkpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaFY1NUluZmx1ZW5jZUVudHJ5X2NyZWF0ZShpbmx5KQoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBnZXRWNTVJbmZsdWVuY2VFbnRyeSgqYXJncyk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoVjU1SW5mbHVlbmNlRW50cnlfZ2V0VjU1SW5mbHVlbmNlRW50cnkoKmFyZ3MpCgogICAgZGVmIF9faW5pdF9fKHNlbGYpOgogICAgICAgIF9vZGJfcHkuZGJUZWNoVjU1SW5mbHVlbmNlRW50cnlfc3dpZ2luaXQoc2VsZiwgX29kYl9weS5uZXdfZGJUZWNoVjU1SW5mbHVlbmNlRW50cnkoKSkKICAgIF9fc3dpZ19kZXN0cm95X18gPSBfb2RiX3B5LmRlbGV0ZV9kYlRlY2hWNTVJbmZsdWVuY2VFbnRyeQoKIyBSZWdpc3RlciBkYlRlY2hWNTVJbmZsdWVuY2VFbnRyeSBpbiBfb2RiX3B5Ogpfb2RiX3B5LmRiVGVjaFY1NUluZmx1ZW5jZUVudHJ5X3N3aWdyZWdpc3RlcihkYlRlY2hWNTVJbmZsdWVuY2VFbnRyeSkKCmRlZiBkYlRlY2hWNTVJbmZsdWVuY2VFbnRyeV9jcmVhdGUoaW5seSk6CiAgICByZXR1cm4gX29kYl9weS5kYlRlY2hWNTVJbmZsdWVuY2VFbnRyeV9jcmVhdGUoaW5seSkKCmRlZiBkYlRlY2hWNTVJbmZsdWVuY2VFbnRyeV9nZXRWNTVJbmZsdWVuY2VFbnRyeSgqYXJncyk6CiAgICByZXR1cm4gX29kYl9weS5kYlRlY2hWNTVJbmZsdWVuY2VFbnRyeV9nZXRWNTVJbmZsdWVuY2VFbnRyeSgqYXJncykKCmNsYXNzIGRiVGVjaExheWVyQW50ZW5uYVJ1bGUob2JqZWN0KToKICAgIHRoaXNvd24gPSBwcm9wZXJ0eShsYW1iZGEgeDogeC50aGlzLm93bigpLCBsYW1iZGEgeCwgdjogeC50aGlzLm93bih2KSwgZG9jPSdUaGUgbWVtYmVyc2hpcCBmbGFnJykKICAgIF9fcmVwcl9fID0gX3N3aWdfcmVwcgoKICAgIGRlZiBpc1ZhbGlkKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQW50ZW5uYVJ1bGVfaXNWYWxpZChzZWxmKQoKICAgIGRlZiB3cml0ZUxlZihzZWxmLCB3cml0ZXIpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQW50ZW5uYVJ1bGVfd3JpdGVMZWYoc2VsZiwgd3JpdGVyKQoKICAgIGRlZiBzZXRHYXRlUGx1c0RpZmZGYWN0b3Ioc2VsZiwgZmFjdG9yKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckFudGVubmFSdWxlX3NldEdhdGVQbHVzRGlmZkZhY3RvcihzZWxmLCBmYWN0b3IpCgogICAgZGVmIHNldEFyZWFNaW51c0RpZmZGYWN0b3Ioc2VsZiwgZmFjdG9yKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckFudGVubmFSdWxlX3NldEFyZWFNaW51c0RpZmZGYWN0b3Ioc2VsZiwgZmFjdG9yKQoKICAgIGRlZiBzZXRBcmVhRmFjdG9yKHNlbGYsIGZhY3RvciwgZGlmZnVzZT1GYWxzZSk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJBbnRlbm5hUnVsZV9zZXRBcmVhRmFjdG9yKHNlbGYsIGZhY3RvciwgZGlmZnVzZSkKCiAgICBkZWYgc2V0U2lkZUFyZWFGYWN0b3Ioc2VsZiwgZmFjdG9yLCBkaWZmdXNlPUZhbHNlKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckFudGVubmFSdWxlX3NldFNpZGVBcmVhRmFjdG9yKHNlbGYsIGZhY3RvciwgZGlmZnVzZSkKCiAgICBkZWYgaGFzQXJlYUZhY3RvcihzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckFudGVubmFSdWxlX2hhc0FyZWFGYWN0b3Ioc2VsZikKCiAgICBkZWYgaGFzU2lkZUFyZWFGYWN0b3Ioc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJBbnRlbm5hUnVsZV9oYXNTaWRlQXJlYUZhY3RvcihzZWxmKQoKICAgIGRlZiBnZXRBcmVhRmFjdG9yKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQW50ZW5uYVJ1bGVfZ2V0QXJlYUZhY3RvcihzZWxmKQoKICAgIGRlZiBnZXRTaWRlQXJlYUZhY3RvcihzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckFudGVubmFSdWxlX2dldFNpZGVBcmVhRmFjdG9yKHNlbGYpCgogICAgZGVmIGlzQXJlYUZhY3RvckRpZmZVc2VPbmx5KHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQW50ZW5uYVJ1bGVfaXNBcmVhRmFjdG9yRGlmZlVzZU9ubHkoc2VsZikKCiAgICBkZWYgaXNTaWRlQXJlYUZhY3RvckRpZmZVc2VPbmx5KHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQW50ZW5uYVJ1bGVfaXNTaWRlQXJlYUZhY3RvckRpZmZVc2VPbmx5KHNlbGYpCgogICAgZGVmIGhhc0FudGVubmFDdW1Sb3V0aW5nUGx1c0N1dChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckFudGVubmFSdWxlX2hhc0FudGVubmFDdW1Sb3V0aW5nUGx1c0N1dChzZWxmKQoKICAgIGRlZiBzZXRBbnRlbm5hQ3VtUm91dGluZ1BsdXNDdXQoc2VsZiwgdmFsdWU9VHJ1ZSk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJBbnRlbm5hUnVsZV9zZXRBbnRlbm5hQ3VtUm91dGluZ1BsdXNDdXQoc2VsZiwgdmFsdWUpCgogICAgZGVmIGdldFBBUihzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckFudGVubmFSdWxlX2dldFBBUihzZWxmKQoKICAgIGRlZiBnZXRDQVIoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJBbnRlbm5hUnVsZV9nZXRDQVIoc2VsZikKCiAgICBkZWYgZ2V0UFNSKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQW50ZW5uYVJ1bGVfZ2V0UFNSKHNlbGYpCgogICAgZGVmIGdldENTUihzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckFudGVubmFSdWxlX2dldENTUihzZWxmKQoKICAgIGRlZiBnZXRHYXRlUGx1c0RpZmZGYWN0b3Ioc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJBbnRlbm5hUnVsZV9nZXRHYXRlUGx1c0RpZmZGYWN0b3Ioc2VsZikKCiAgICBkZWYgZ2V0QXJlYU1pbnVzRGlmZkZhY3RvcihzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckFudGVubmFSdWxlX2dldEFyZWFNaW51c0RpZmZGYWN0b3Ioc2VsZikKCiAgICBkZWYgc2V0UEFSKHNlbGYsIHJhdGlvKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckFudGVubmFSdWxlX3NldFBBUihzZWxmLCByYXRpbykKCiAgICBkZWYgc2V0Q0FSKHNlbGYsIHJhdGlvKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckFudGVubmFSdWxlX3NldENBUihzZWxmLCByYXRpbykKCiAgICBkZWYgc2V0UFNSKHNlbGYsIHJhdGlvKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckFudGVubmFSdWxlX3NldFBTUihzZWxmLCByYXRpbykKCiAgICBkZWYgc2V0Q1NSKHNlbGYsIHJhdGlvKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckFudGVubmFSdWxlX3NldENTUihzZWxmLCByYXRpbykKCiAgICBkZWYgc2V0RGlmZlBBUihzZWxmLCAqYXJncyk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJBbnRlbm5hUnVsZV9zZXREaWZmUEFSKHNlbGYsICphcmdzKQoKICAgIGRlZiBzZXREaWZmQ0FSKHNlbGYsICphcmdzKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckFudGVubmFSdWxlX3NldERpZmZDQVIoc2VsZiwgKmFyZ3MpCgogICAgZGVmIHNldERpZmZQU1Ioc2VsZiwgKmFyZ3MpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQW50ZW5uYVJ1bGVfc2V0RGlmZlBTUihzZWxmLCAqYXJncykKCiAgICBkZWYgc2V0RGlmZkNTUihzZWxmLCAqYXJncyk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJBbnRlbm5hUnVsZV9zZXREaWZmQ1NSKHNlbGYsICphcmdzKQoKICAgIGRlZiBzZXRBcmVhRGlmZlJlZHVjZShzZWxmLCBhcmVhcywgZmFjdG9ycyk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJBbnRlbm5hUnVsZV9zZXRBcmVhRGlmZlJlZHVjZShzZWxmLCBhcmVhcywgZmFjdG9ycykKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgZ2V0QW50ZW5uYVJ1bGUoaW5seSwgZGJpZCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJBbnRlbm5hUnVsZV9nZXRBbnRlbm5hUnVsZShpbmx5LCBkYmlkKQoKICAgIGRlZiBfX2luaXRfXyhzZWxmKToKICAgICAgICBfb2RiX3B5LmRiVGVjaExheWVyQW50ZW5uYVJ1bGVfc3dpZ2luaXQoc2VsZiwgX29kYl9weS5uZXdfZGJUZWNoTGF5ZXJBbnRlbm5hUnVsZSgpKQogICAgX19zd2lnX2Rlc3Ryb3lfXyA9IF9vZGJfcHkuZGVsZXRlX2RiVGVjaExheWVyQW50ZW5uYVJ1bGUKCiMgUmVnaXN0ZXIgZGJUZWNoTGF5ZXJBbnRlbm5hUnVsZSBpbiBfb2RiX3B5Ogpfb2RiX3B5LmRiVGVjaExheWVyQW50ZW5uYVJ1bGVfc3dpZ3JlZ2lzdGVyKGRiVGVjaExheWVyQW50ZW5uYVJ1bGUpCgpkZWYgZGJUZWNoTGF5ZXJBbnRlbm5hUnVsZV9nZXRBbnRlbm5hUnVsZShpbmx5LCBkYmlkKToKICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQW50ZW5uYVJ1bGVfZ2V0QW50ZW5uYVJ1bGUoaW5seSwgZGJpZCkKCmNsYXNzIGRiVGVjaEFudGVubmFQaW5Nb2RlbChvYmplY3QpOgogICAgdGhpc293biA9IHByb3BlcnR5KGxhbWJkYSB4OiB4LnRoaXMub3duKCksIGxhbWJkYSB4LCB2OiB4LnRoaXMub3duKHYpLCBkb2M9J1RoZSBtZW1iZXJzaGlwIGZsYWcnKQogICAgX19yZXByX18gPSBfc3dpZ19yZXByCgogICAgZGVmIGFkZEdhdGVBcmVhRW50cnkoc2VsZiwgaW52YWwsIHJlZmx5PU5vbmUpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaEFudGVubmFQaW5Nb2RlbF9hZGRHYXRlQXJlYUVudHJ5KHNlbGYsIGludmFsLCByZWZseSkKCiAgICBkZWYgYWRkTWF4QXJlYUNBUkVudHJ5KHNlbGYsIGludmFsLCByZWZseT1Ob25lKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hBbnRlbm5hUGluTW9kZWxfYWRkTWF4QXJlYUNBUkVudHJ5KHNlbGYsIGludmFsLCByZWZseSkKCiAgICBkZWYgYWRkTWF4U2lkZUFyZWFDQVJFbnRyeShzZWxmLCBpbnZhbCwgcmVmbHk9Tm9uZSk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoQW50ZW5uYVBpbk1vZGVsX2FkZE1heFNpZGVBcmVhQ0FSRW50cnkoc2VsZiwgaW52YWwsIHJlZmx5KQoKICAgIGRlZiBhZGRNYXhDdXRDQVJFbnRyeShzZWxmLCBpbnZhbCwgcmVmbHk9Tm9uZSk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoQW50ZW5uYVBpbk1vZGVsX2FkZE1heEN1dENBUkVudHJ5KHNlbGYsIGludmFsLCByZWZseSkKCiAgICBkZWYgZ2V0R2F0ZUFyZWEoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoQW50ZW5uYVBpbk1vZGVsX2dldEdhdGVBcmVhKHNlbGYpCgogICAgZGVmIGdldE1heEFyZWFDQVIoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoQW50ZW5uYVBpbk1vZGVsX2dldE1heEFyZWFDQVIoc2VsZikKCiAgICBkZWYgZ2V0TWF4U2lkZUFyZWFDQVIoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoQW50ZW5uYVBpbk1vZGVsX2dldE1heFNpZGVBcmVhQ0FSKHNlbGYpCgogICAgZGVmIGdldE1heEN1dENBUihzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hBbnRlbm5hUGluTW9kZWxfZ2V0TWF4Q3V0Q0FSKHNlbGYpCgogICAgZGVmIHdyaXRlTGVmKHNlbGYsIHRlY2gsIHdyaXRlcik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoQW50ZW5uYVBpbk1vZGVsX3dyaXRlTGVmKHNlbGYsIHRlY2gsIHdyaXRlcikKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgZ2V0QW50ZW5uYVBpbk1vZGVsKG1hc3RlciwgZGJpZCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoQW50ZW5uYVBpbk1vZGVsX2dldEFudGVubmFQaW5Nb2RlbChtYXN0ZXIsIGRiaWQpCgogICAgZGVmIF9faW5pdF9fKHNlbGYpOgogICAgICAgIF9vZGJfcHkuZGJUZWNoQW50ZW5uYVBpbk1vZGVsX3N3aWdpbml0KHNlbGYsIF9vZGJfcHkubmV3X2RiVGVjaEFudGVubmFQaW5Nb2RlbCgpKQogICAgX19zd2lnX2Rlc3Ryb3lfXyA9IF9vZGJfcHkuZGVsZXRlX2RiVGVjaEFudGVubmFQaW5Nb2RlbAoKIyBSZWdpc3RlciBkYlRlY2hBbnRlbm5hUGluTW9kZWwgaW4gX29kYl9weToKX29kYl9weS5kYlRlY2hBbnRlbm5hUGluTW9kZWxfc3dpZ3JlZ2lzdGVyKGRiVGVjaEFudGVubmFQaW5Nb2RlbCkKCmRlZiBkYlRlY2hBbnRlbm5hUGluTW9kZWxfZ2V0QW50ZW5uYVBpbk1vZGVsKG1hc3RlciwgZGJpZCk6CiAgICByZXR1cm4gX29kYl9weS5kYlRlY2hBbnRlbm5hUGluTW9kZWxfZ2V0QW50ZW5uYVBpbk1vZGVsKG1hc3RlciwgZGJpZCkKCmNsYXNzIGRiVGVjaE5vbkRlZmF1bHRSdWxlKG9iamVjdCk6CiAgICB0aGlzb3duID0gcHJvcGVydHkobGFtYmRhIHg6IHgudGhpcy5vd24oKSwgbGFtYmRhIHgsIHY6IHgudGhpcy5vd24odiksIGRvYz0nVGhlIG1lbWJlcnNoaXAgZmxhZycpCiAgICBfX3JlcHJfXyA9IF9zd2lnX3JlcHIKCiAgICBkZWYgZ2V0TmFtZShzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hOb25EZWZhdWx0UnVsZV9nZXROYW1lKHNlbGYpCgogICAgZGVmIGdldENvbnN0TmFtZShzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hOb25EZWZhdWx0UnVsZV9nZXRDb25zdE5hbWUoc2VsZikKCiAgICBkZWYgaXNCbG9ja1J1bGUoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTm9uRGVmYXVsdFJ1bGVfaXNCbG9ja1J1bGUoc2VsZikKCiAgICBkZWYgZ2V0TGF5ZXJSdWxlKHNlbGYsIGxheWVyKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hOb25EZWZhdWx0UnVsZV9nZXRMYXllclJ1bGUoc2VsZiwgbGF5ZXIpCgogICAgZGVmIGdldExheWVyUnVsZXMoc2VsZiwgbGF5ZXJfcnVsZXMpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaE5vbkRlZmF1bHRSdWxlX2dldExheWVyUnVsZXMoc2VsZiwgbGF5ZXJfcnVsZXMpCgogICAgZGVmIGdldFZpYXMoc2VsZiwgdmlhcyk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTm9uRGVmYXVsdFJ1bGVfZ2V0VmlhcyhzZWxmLCB2aWFzKQoKICAgIGRlZiBmaW5kU2FtZU5ldFJ1bGUoc2VsZiwgbDEsIGwyKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hOb25EZWZhdWx0UnVsZV9maW5kU2FtZU5ldFJ1bGUoc2VsZiwgbDEsIGwyKQoKICAgIGRlZiBnZXRTYW1lTmV0UnVsZXMoc2VsZiwgcnVsZXMpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaE5vbkRlZmF1bHRSdWxlX2dldFNhbWVOZXRSdWxlcyhzZWxmLCBydWxlcykKCiAgICBkZWYgZ2V0SGFyZFNwYWNpbmcoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTm9uRGVmYXVsdFJ1bGVfZ2V0SGFyZFNwYWNpbmcoc2VsZikKCiAgICBkZWYgc2V0SGFyZFNwYWNpbmcoc2VsZiwgdmFsdWUpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaE5vbkRlZmF1bHRSdWxlX3NldEhhcmRTcGFjaW5nKHNlbGYsIHZhbHVlKQoKICAgIGRlZiBhZGRVc2VWaWEoc2VsZiwgdmlhKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hOb25EZWZhdWx0UnVsZV9hZGRVc2VWaWEoc2VsZiwgdmlhKQoKICAgIGRlZiBnZXRVc2VWaWFzKHNlbGYsIHZpYXMpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaE5vbkRlZmF1bHRSdWxlX2dldFVzZVZpYXMoc2VsZiwgdmlhcykKCiAgICBkZWYgYWRkVXNlVmlhUnVsZShzZWxmLCBydWxlKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hOb25EZWZhdWx0UnVsZV9hZGRVc2VWaWFSdWxlKHNlbGYsIHJ1bGUpCgogICAgZGVmIGdldFVzZVZpYVJ1bGVzKHNlbGYsIHJ1bGVzKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hOb25EZWZhdWx0UnVsZV9nZXRVc2VWaWFSdWxlcyhzZWxmLCBydWxlcykKCiAgICBkZWYgc2V0TWluQ3V0cyhzZWxmLCBjdXRfbGF5ZXIsIGNvdW50KToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hOb25EZWZhdWx0UnVsZV9zZXRNaW5DdXRzKHNlbGYsIGN1dF9sYXllciwgY291bnQpCgogICAgZGVmIGdldE1pbkN1dHMoc2VsZiwgY3V0X2xheWVyLCBjb3VudCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTm9uRGVmYXVsdFJ1bGVfZ2V0TWluQ3V0cyhzZWxmLCBjdXRfbGF5ZXIsIGNvdW50KQoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBjcmVhdGUoKmFyZ3MpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaE5vbkRlZmF1bHRSdWxlX2NyZWF0ZSgqYXJncykKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgZ2V0VGVjaE5vbkRlZmF1bHRSdWxlKCphcmdzKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hOb25EZWZhdWx0UnVsZV9nZXRUZWNoTm9uRGVmYXVsdFJ1bGUoKmFyZ3MpCgogICAgZGVmIF9faW5pdF9fKHNlbGYpOgogICAgICAgIF9vZGJfcHkuZGJUZWNoTm9uRGVmYXVsdFJ1bGVfc3dpZ2luaXQoc2VsZiwgX29kYl9weS5uZXdfZGJUZWNoTm9uRGVmYXVsdFJ1bGUoKSkKICAgIF9fc3dpZ19kZXN0cm95X18gPSBfb2RiX3B5LmRlbGV0ZV9kYlRlY2hOb25EZWZhdWx0UnVsZQoKIyBSZWdpc3RlciBkYlRlY2hOb25EZWZhdWx0UnVsZSBpbiBfb2RiX3B5Ogpfb2RiX3B5LmRiVGVjaE5vbkRlZmF1bHRSdWxlX3N3aWdyZWdpc3RlcihkYlRlY2hOb25EZWZhdWx0UnVsZSkKCmRlZiBkYlRlY2hOb25EZWZhdWx0UnVsZV9jcmVhdGUoKmFyZ3MpOgogICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTm9uRGVmYXVsdFJ1bGVfY3JlYXRlKCphcmdzKQoKZGVmIGRiVGVjaE5vbkRlZmF1bHRSdWxlX2dldFRlY2hOb25EZWZhdWx0UnVsZSgqYXJncyk6CiAgICByZXR1cm4gX29kYl9weS5kYlRlY2hOb25EZWZhdWx0UnVsZV9nZXRUZWNoTm9uRGVmYXVsdFJ1bGUoKmFyZ3MpCgpjbGFzcyBkYlRlY2hMYXllclJ1bGUob2JqZWN0KToKICAgIHRoaXNvd24gPSBwcm9wZXJ0eShsYW1iZGEgeDogeC50aGlzLm93bigpLCBsYW1iZGEgeCwgdjogeC50aGlzLm93bih2KSwgZG9jPSdUaGUgbWVtYmVyc2hpcCBmbGFnJykKICAgIF9fcmVwcl9fID0gX3N3aWdfcmVwcgoKICAgIGRlZiBnZXRMYXllcihzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllclJ1bGVfZ2V0TGF5ZXIoc2VsZikKCiAgICBkZWYgaXNCbG9ja1J1bGUoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJSdWxlX2lzQmxvY2tSdWxlKHNlbGYpCgogICAgZGVmIGdldE5vbkRlZmF1bHRSdWxlKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyUnVsZV9nZXROb25EZWZhdWx0UnVsZShzZWxmKQoKICAgIGRlZiBnZXRXaWR0aChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllclJ1bGVfZ2V0V2lkdGgoc2VsZikKCiAgICBkZWYgc2V0V2lkdGgoc2VsZiwgd2lkdGgpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyUnVsZV9zZXRXaWR0aChzZWxmLCB3aWR0aCkKCiAgICBkZWYgZ2V0U3BhY2luZyhzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllclJ1bGVfZ2V0U3BhY2luZyhzZWxmKQoKICAgIGRlZiBzZXRTcGFjaW5nKHNlbGYsIHNwYWNpbmcpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyUnVsZV9zZXRTcGFjaW5nKHNlbGYsIHNwYWNpbmcpCgogICAgZGVmIGdldFJlc2lzdGFuY2Uoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJSdWxlX2dldFJlc2lzdGFuY2Uoc2VsZikKCiAgICBkZWYgc2V0UmVzaXN0YW5jZShzZWxmLCByZXMpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyUnVsZV9zZXRSZXNpc3RhbmNlKHNlbGYsIHJlcykKCiAgICBkZWYgZ2V0Q2FwYWNpdGFuY2Uoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJSdWxlX2dldENhcGFjaXRhbmNlKHNlbGYpCgogICAgZGVmIHNldENhcGFjaXRhbmNlKHNlbGYsIGNhcCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJSdWxlX3NldENhcGFjaXRhbmNlKHNlbGYsIGNhcCkKCiAgICBkZWYgZ2V0RWRnZUNhcGFjaXRhbmNlKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyUnVsZV9nZXRFZGdlQ2FwYWNpdGFuY2Uoc2VsZikKCiAgICBkZWYgc2V0RWRnZUNhcGFjaXRhbmNlKHNlbGYsIGNhcCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJSdWxlX3NldEVkZ2VDYXBhY2l0YW5jZShzZWxmLCBjYXApCgogICAgZGVmIGdldFdpcmVFeHRlbnNpb24oc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJSdWxlX2dldFdpcmVFeHRlbnNpb24oc2VsZikKCiAgICBkZWYgc2V0V2lyZUV4dGVuc2lvbihzZWxmLCBleHQpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyUnVsZV9zZXRXaXJlRXh0ZW5zaW9uKHNlbGYsIGV4dCkKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgY3JlYXRlKHJ1bGUsIGxheWVyKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllclJ1bGVfY3JlYXRlKHJ1bGUsIGxheWVyKQoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBnZXRUZWNoTGF5ZXJSdWxlKCphcmdzKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllclJ1bGVfZ2V0VGVjaExheWVyUnVsZSgqYXJncykKCiAgICBkZWYgX19pbml0X18oc2VsZik6CiAgICAgICAgX29kYl9weS5kYlRlY2hMYXllclJ1bGVfc3dpZ2luaXQoc2VsZiwgX29kYl9weS5uZXdfZGJUZWNoTGF5ZXJSdWxlKCkpCiAgICBfX3N3aWdfZGVzdHJveV9fID0gX29kYl9weS5kZWxldGVfZGJUZWNoTGF5ZXJSdWxlCgojIFJlZ2lzdGVyIGRiVGVjaExheWVyUnVsZSBpbiBfb2RiX3B5Ogpfb2RiX3B5LmRiVGVjaExheWVyUnVsZV9zd2lncmVnaXN0ZXIoZGJUZWNoTGF5ZXJSdWxlKQoKZGVmIGRiVGVjaExheWVyUnVsZV9jcmVhdGUocnVsZSwgbGF5ZXIpOgogICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJSdWxlX2NyZWF0ZShydWxlLCBsYXllcikKCmRlZiBkYlRlY2hMYXllclJ1bGVfZ2V0VGVjaExheWVyUnVsZSgqYXJncyk6CiAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllclJ1bGVfZ2V0VGVjaExheWVyUnVsZSgqYXJncykKCmNsYXNzIGRiVGVjaFNhbWVOZXRSdWxlKG9iamVjdCk6CiAgICB0aGlzb3duID0gcHJvcGVydHkobGFtYmRhIHg6IHgudGhpcy5vd24oKSwgbGFtYmRhIHgsIHY6IHgudGhpcy5vd24odiksIGRvYz0nVGhlIG1lbWJlcnNoaXAgZmxhZycpCiAgICBfX3JlcHJfXyA9IF9zd2lnX3JlcHIKCiAgICBkZWYgZ2V0TGF5ZXIxKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaFNhbWVOZXRSdWxlX2dldExheWVyMShzZWxmKQoKICAgIGRlZiBnZXRMYXllcjIoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoU2FtZU5ldFJ1bGVfZ2V0TGF5ZXIyKHNlbGYpCgogICAgZGVmIGdldFNwYWNpbmcoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoU2FtZU5ldFJ1bGVfZ2V0U3BhY2luZyhzZWxmKQoKICAgIGRlZiBzZXRTcGFjaW5nKHNlbGYsIHNwYWNpbmcpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaFNhbWVOZXRSdWxlX3NldFNwYWNpbmcoc2VsZiwgc3BhY2luZykKCiAgICBkZWYgc2V0QWxsb3dTdGFja2VkVmlhcyhzZWxmLCB2YWx1ZSk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoU2FtZU5ldFJ1bGVfc2V0QWxsb3dTdGFja2VkVmlhcyhzZWxmLCB2YWx1ZSkKCiAgICBkZWYgZ2V0QWxsb3dTdGFja2VkVmlhcyhzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hTYW1lTmV0UnVsZV9nZXRBbGxvd1N0YWNrZWRWaWFzKHNlbGYpCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIGNyZWF0ZSgqYXJncyk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoU2FtZU5ldFJ1bGVfY3JlYXRlKCphcmdzKQoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBnZXRUZWNoU2FtZU5ldFJ1bGUodGVjaCwgb2lkKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hTYW1lTmV0UnVsZV9nZXRUZWNoU2FtZU5ldFJ1bGUodGVjaCwgb2lkKQoKICAgIGRlZiBfX2luaXRfXyhzZWxmKToKICAgICAgICBfb2RiX3B5LmRiVGVjaFNhbWVOZXRSdWxlX3N3aWdpbml0KHNlbGYsIF9vZGJfcHkubmV3X2RiVGVjaFNhbWVOZXRSdWxlKCkpCiAgICBfX3N3aWdfZGVzdHJveV9fID0gX29kYl9weS5kZWxldGVfZGJUZWNoU2FtZU5ldFJ1bGUKCiMgUmVnaXN0ZXIgZGJUZWNoU2FtZU5ldFJ1bGUgaW4gX29kYl9weToKX29kYl9weS5kYlRlY2hTYW1lTmV0UnVsZV9zd2lncmVnaXN0ZXIoZGJUZWNoU2FtZU5ldFJ1bGUpCgpkZWYgZGJUZWNoU2FtZU5ldFJ1bGVfY3JlYXRlKCphcmdzKToKICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaFNhbWVOZXRSdWxlX2NyZWF0ZSgqYXJncykKCmRlZiBkYlRlY2hTYW1lTmV0UnVsZV9nZXRUZWNoU2FtZU5ldFJ1bGUodGVjaCwgb2lkKToKICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaFNhbWVOZXRSdWxlX2dldFRlY2hTYW1lTmV0UnVsZSh0ZWNoLCBvaWQpCgpjbGFzcyBkYlZpYVBhcmFtcyhvYmplY3QpOgogICAgdGhpc293biA9IHByb3BlcnR5KGxhbWJkYSB4OiB4LnRoaXMub3duKCksIGxhbWJkYSB4LCB2OiB4LnRoaXMub3duKHYpLCBkb2M9J1RoZSBtZW1iZXJzaGlwIGZsYWcnKQogICAgX19yZXByX18gPSBfc3dpZ19yZXByCgogICAgZGVmIF9faW5pdF9fKHNlbGYsICphcmdzKToKICAgICAgICBfb2RiX3B5LmRiVmlhUGFyYW1zX3N3aWdpbml0KHNlbGYsIF9vZGJfcHkubmV3X2RiVmlhUGFyYW1zKCphcmdzKSkKICAgIF9fc3dpZ19kZXN0cm95X18gPSBfb2RiX3B5LmRlbGV0ZV9kYlZpYVBhcmFtcwoKICAgIGRlZiBnZXRYQ3V0U2l6ZShzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlZpYVBhcmFtc19nZXRYQ3V0U2l6ZShzZWxmKQoKICAgIGRlZiBnZXRZQ3V0U2l6ZShzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlZpYVBhcmFtc19nZXRZQ3V0U2l6ZShzZWxmKQoKICAgIGRlZiBnZXRYQ3V0U3BhY2luZyhzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlZpYVBhcmFtc19nZXRYQ3V0U3BhY2luZyhzZWxmKQoKICAgIGRlZiBnZXRZQ3V0U3BhY2luZyhzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlZpYVBhcmFtc19nZXRZQ3V0U3BhY2luZyhzZWxmKQoKICAgIGRlZiBnZXRYVG9wRW5jbG9zdXJlKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVmlhUGFyYW1zX2dldFhUb3BFbmNsb3N1cmUoc2VsZikKCiAgICBkZWYgZ2V0WVRvcEVuY2xvc3VyZShzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlZpYVBhcmFtc19nZXRZVG9wRW5jbG9zdXJlKHNlbGYpCgogICAgZGVmIGdldFhCb3R0b21FbmNsb3N1cmUoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJWaWFQYXJhbXNfZ2V0WEJvdHRvbUVuY2xvc3VyZShzZWxmKQoKICAgIGRlZiBnZXRZQm90dG9tRW5jbG9zdXJlKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVmlhUGFyYW1zX2dldFlCb3R0b21FbmNsb3N1cmUoc2VsZikKCiAgICBkZWYgZ2V0TnVtQ3V0Um93cyhzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlZpYVBhcmFtc19nZXROdW1DdXRSb3dzKHNlbGYpCgogICAgZGVmIGdldE51bUN1dENvbHMoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJWaWFQYXJhbXNfZ2V0TnVtQ3V0Q29scyhzZWxmKQoKICAgIGRlZiBnZXRYT3JpZ2luKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVmlhUGFyYW1zX2dldFhPcmlnaW4oc2VsZikKCiAgICBkZWYgZ2V0WU9yaWdpbihzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlZpYVBhcmFtc19nZXRZT3JpZ2luKHNlbGYpCgogICAgZGVmIGdldFhUb3BPZmZzZXQoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJWaWFQYXJhbXNfZ2V0WFRvcE9mZnNldChzZWxmKQoKICAgIGRlZiBnZXRZVG9wT2Zmc2V0KHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVmlhUGFyYW1zX2dldFlUb3BPZmZzZXQoc2VsZikKCiAgICBkZWYgZ2V0WEJvdHRvbU9mZnNldChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlZpYVBhcmFtc19nZXRYQm90dG9tT2Zmc2V0KHNlbGYpCgogICAgZGVmIGdldFlCb3R0b21PZmZzZXQoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJWaWFQYXJhbXNfZ2V0WUJvdHRvbU9mZnNldChzZWxmKQoKICAgIGRlZiBnZXRUb3BMYXllcihzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlZpYVBhcmFtc19nZXRUb3BMYXllcihzZWxmKQoKICAgIGRlZiBnZXRDdXRMYXllcihzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlZpYVBhcmFtc19nZXRDdXRMYXllcihzZWxmKQoKICAgIGRlZiBnZXRCb3R0b21MYXllcihzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlZpYVBhcmFtc19nZXRCb3R0b21MYXllcihzZWxmKQoKICAgIGRlZiBzZXRYQ3V0U2l6ZShzZWxmLCB2YWx1ZSk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJWaWFQYXJhbXNfc2V0WEN1dFNpemUoc2VsZiwgdmFsdWUpCgogICAgZGVmIHNldFlDdXRTaXplKHNlbGYsIHZhbHVlKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlZpYVBhcmFtc19zZXRZQ3V0U2l6ZShzZWxmLCB2YWx1ZSkKCiAgICBkZWYgc2V0WEN1dFNwYWNpbmcoc2VsZiwgdmFsdWUpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVmlhUGFyYW1zX3NldFhDdXRTcGFjaW5nKHNlbGYsIHZhbHVlKQoKICAgIGRlZiBzZXRZQ3V0U3BhY2luZyhzZWxmLCB2YWx1ZSk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJWaWFQYXJhbXNfc2V0WUN1dFNwYWNpbmcoc2VsZiwgdmFsdWUpCgogICAgZGVmIHNldFhUb3BFbmNsb3N1cmUoc2VsZiwgdmFsdWUpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVmlhUGFyYW1zX3NldFhUb3BFbmNsb3N1cmUoc2VsZiwgdmFsdWUpCgogICAgZGVmIHNldFlUb3BFbmNsb3N1cmUoc2VsZiwgdmFsdWUpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVmlhUGFyYW1zX3NldFlUb3BFbmNsb3N1cmUoc2VsZiwgdmFsdWUpCgogICAgZGVmIHNldFhCb3R0b21FbmNsb3N1cmUoc2VsZiwgdmFsdWUpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVmlhUGFyYW1zX3NldFhCb3R0b21FbmNsb3N1cmUoc2VsZiwgdmFsdWUpCgogICAgZGVmIHNldFlCb3R0b21FbmNsb3N1cmUoc2VsZiwgdmFsdWUpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVmlhUGFyYW1zX3NldFlCb3R0b21FbmNsb3N1cmUoc2VsZiwgdmFsdWUpCgogICAgZGVmIHNldE51bUN1dFJvd3Moc2VsZiwgdmFsdWUpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVmlhUGFyYW1zX3NldE51bUN1dFJvd3Moc2VsZiwgdmFsdWUpCgogICAgZGVmIHNldE51bUN1dENvbHMoc2VsZiwgdmFsdWUpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVmlhUGFyYW1zX3NldE51bUN1dENvbHMoc2VsZiwgdmFsdWUpCgogICAgZGVmIHNldFhPcmlnaW4oc2VsZiwgdmFsdWUpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVmlhUGFyYW1zX3NldFhPcmlnaW4oc2VsZiwgdmFsdWUpCgogICAgZGVmIHNldFlPcmlnaW4oc2VsZiwgdmFsdWUpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVmlhUGFyYW1zX3NldFlPcmlnaW4oc2VsZiwgdmFsdWUpCgogICAgZGVmIHNldFhUb3BPZmZzZXQoc2VsZiwgdmFsdWUpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVmlhUGFyYW1zX3NldFhUb3BPZmZzZXQoc2VsZiwgdmFsdWUpCgogICAgZGVmIHNldFlUb3BPZmZzZXQoc2VsZiwgdmFsdWUpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVmlhUGFyYW1zX3NldFlUb3BPZmZzZXQoc2VsZiwgdmFsdWUpCgogICAgZGVmIHNldFhCb3R0b21PZmZzZXQoc2VsZiwgdmFsdWUpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVmlhUGFyYW1zX3NldFhCb3R0b21PZmZzZXQoc2VsZiwgdmFsdWUpCgogICAgZGVmIHNldFlCb3R0b21PZmZzZXQoc2VsZiwgdmFsdWUpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVmlhUGFyYW1zX3NldFlCb3R0b21PZmZzZXQoc2VsZiwgdmFsdWUpCgogICAgZGVmIHNldFRvcExheWVyKHNlbGYsIGxheWVyKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlZpYVBhcmFtc19zZXRUb3BMYXllcihzZWxmLCBsYXllcikKCiAgICBkZWYgc2V0Q3V0TGF5ZXIoc2VsZiwgbGF5ZXIpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVmlhUGFyYW1zX3NldEN1dExheWVyKHNlbGYsIGxheWVyKQoKICAgIGRlZiBzZXRCb3R0b21MYXllcihzZWxmLCBsYXllcik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJWaWFQYXJhbXNfc2V0Qm90dG9tTGF5ZXIoc2VsZiwgbGF5ZXIpCgojIFJlZ2lzdGVyIGRiVmlhUGFyYW1zIGluIF9vZGJfcHk6Cl9vZGJfcHkuZGJWaWFQYXJhbXNfc3dpZ3JlZ2lzdGVyKGRiVmlhUGFyYW1zKQoKY2xhc3MgZGJBY2Nlc3NQb2ludChvYmplY3QpOgogICAgdGhpc293biA9IHByb3BlcnR5KGxhbWJkYSB4OiB4LnRoaXMub3duKCksIGxhbWJkYSB4LCB2OiB4LnRoaXMub3duKHYpLCBkb2M9J1RoZSBtZW1iZXJzaGlwIGZsYWcnKQogICAgX19yZXByX18gPSBfc3dpZ19yZXByCgogICAgZGVmIHNldFBvaW50KHNlbGYsIHBvaW50KToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkFjY2Vzc1BvaW50X3NldFBvaW50KHNlbGYsIHBvaW50KQoKICAgIGRlZiBnZXRQb2ludChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkFjY2Vzc1BvaW50X2dldFBvaW50KHNlbGYpCgogICAgZGVmIHNldExheWVyKHNlbGYsIGxheWVyKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkFjY2Vzc1BvaW50X3NldExheWVyKHNlbGYsIGxheWVyKQoKICAgIGRlZiBzZXRBY2Nlc3NlcyhzZWxmLCBhY2Nlc3Nlcyk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJBY2Nlc3NQb2ludF9zZXRBY2Nlc3NlcyhzZWxmLCBhY2Nlc3NlcykKCiAgICBkZWYgZ2V0QWNjZXNzZXMoc2VsZiwgdGJsKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkFjY2Vzc1BvaW50X2dldEFjY2Vzc2VzKHNlbGYsIHRibCkKCiAgICBkZWYgc2V0TG93VHlwZShzZWxmLCB0eXBlX2xvdyk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJBY2Nlc3NQb2ludF9zZXRMb3dUeXBlKHNlbGYsIHR5cGVfbG93KQoKICAgIGRlZiBnZXRMb3dUeXBlKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQWNjZXNzUG9pbnRfZ2V0TG93VHlwZShzZWxmKQoKICAgIGRlZiBzZXRIaWdoVHlwZShzZWxmLCB0eXBlX2hpZ2gpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQWNjZXNzUG9pbnRfc2V0SGlnaFR5cGUoc2VsZiwgdHlwZV9oaWdoKQoKICAgIGRlZiBnZXRIaWdoVHlwZShzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkFjY2Vzc1BvaW50X2dldEhpZ2hUeXBlKHNlbGYpCgogICAgZGVmIHNldEFjY2VzcyhzZWxmLCBhY2Nlc3MsIGRpcik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJBY2Nlc3NQb2ludF9zZXRBY2Nlc3Moc2VsZiwgYWNjZXNzLCBkaXIpCgogICAgZGVmIGhhc0FjY2VzcyhzZWxmLCAqYXJncyk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJBY2Nlc3NQb2ludF9oYXNBY2Nlc3Moc2VsZiwgKmFyZ3MpCgogICAgZGVmIGdldExheWVyKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQWNjZXNzUG9pbnRfZ2V0TGF5ZXIoc2VsZikKCiAgICBkZWYgZ2V0TVBpbihzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkFjY2Vzc1BvaW50X2dldE1QaW4oc2VsZikKCiAgICBkZWYgZ2V0QlBpbihzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkFjY2Vzc1BvaW50X2dldEJQaW4oc2VsZikKCiAgICBkZWYgZ2V0VmlhcyhzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkFjY2Vzc1BvaW50X2dldFZpYXMoc2VsZikKCiAgICBkZWYgYWRkVGVjaFZpYShzZWxmLCBudW1fY3V0cywgdmlhKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkFjY2Vzc1BvaW50X2FkZFRlY2hWaWEoc2VsZiwgbnVtX2N1dHMsIHZpYSkKCiAgICBkZWYgYWRkQmxvY2tWaWEoc2VsZiwgbnVtX2N1dHMsIHZpYSk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJBY2Nlc3NQb2ludF9hZGRCbG9ja1ZpYShzZWxmLCBudW1fY3V0cywgdmlhKQoKICAgIGRlZiBhZGRTZWdtZW50KHNlbGYsIHNlZ21lbnQsIGJlZ2luX3N0eWxlX3RydW5jLCBlbmRfc3R5bGVfdHJ1bmMpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQWNjZXNzUG9pbnRfYWRkU2VnbWVudChzZWxmLCBzZWdtZW50LCBiZWdpbl9zdHlsZV90cnVuYywgZW5kX3N0eWxlX3RydW5jKQoKICAgIGRlZiBnZXRTZWdtZW50cyhzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkFjY2Vzc1BvaW50X2dldFNlZ21lbnRzKHNlbGYpCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIGNyZWF0ZSgqYXJncyk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJBY2Nlc3NQb2ludF9jcmVhdGUoKmFyZ3MpCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIGdldEFjY2Vzc1BvaW50KGJsb2NrLCBkYmlkKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkFjY2Vzc1BvaW50X2dldEFjY2Vzc1BvaW50KGJsb2NrLCBkYmlkKQoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBkZXN0cm95KGFwKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkFjY2Vzc1BvaW50X2Rlc3Ryb3koYXApCgogICAgZGVmIF9faW5pdF9fKHNlbGYpOgogICAgICAgIF9vZGJfcHkuZGJBY2Nlc3NQb2ludF9zd2lnaW5pdChzZWxmLCBfb2RiX3B5Lm5ld19kYkFjY2Vzc1BvaW50KCkpCiAgICBfX3N3aWdfZGVzdHJveV9fID0gX29kYl9weS5kZWxldGVfZGJBY2Nlc3NQb2ludAoKIyBSZWdpc3RlciBkYkFjY2Vzc1BvaW50IGluIF9vZGJfcHk6Cl9vZGJfcHkuZGJBY2Nlc3NQb2ludF9zd2lncmVnaXN0ZXIoZGJBY2Nlc3NQb2ludCkKCmRlZiBkYkFjY2Vzc1BvaW50X2NyZWF0ZSgqYXJncyk6CiAgICByZXR1cm4gX29kYl9weS5kYkFjY2Vzc1BvaW50X2NyZWF0ZSgqYXJncykKCmRlZiBkYkFjY2Vzc1BvaW50X2dldEFjY2Vzc1BvaW50KGJsb2NrLCBkYmlkKToKICAgIHJldHVybiBfb2RiX3B5LmRiQWNjZXNzUG9pbnRfZ2V0QWNjZXNzUG9pbnQoYmxvY2ssIGRiaWQpCgpkZWYgZGJBY2Nlc3NQb2ludF9kZXN0cm95KGFwKToKICAgIHJldHVybiBfb2RiX3B5LmRiQWNjZXNzUG9pbnRfZGVzdHJveShhcCkKCmNsYXNzIGRiQnVzUG9ydChvYmplY3QpOgogICAgdGhpc293biA9IHByb3BlcnR5KGxhbWJkYSB4OiB4LnRoaXMub3duKCksIGxhbWJkYSB4LCB2OiB4LnRoaXMub3duKHYpLCBkb2M9J1RoZSBtZW1iZXJzaGlwIGZsYWcnKQogICAgX19yZXByX18gPSBfc3dpZ19yZXByCgogICAgZGVmIGdldEZyb20oc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJCdXNQb3J0X2dldEZyb20oc2VsZikKCiAgICBkZWYgZ2V0VG8oc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJCdXNQb3J0X2dldFRvKHNlbGYpCgogICAgZGVmIGdldFBvcnQoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJCdXNQb3J0X2dldFBvcnQoc2VsZikKCiAgICBkZWYgc2V0TWVtYmVycyhzZWxmLCBtZW1iZXJzKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkJ1c1BvcnRfc2V0TWVtYmVycyhzZWxmLCBtZW1iZXJzKQoKICAgIGRlZiBnZXRNZW1iZXJzKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQnVzUG9ydF9nZXRNZW1iZXJzKHNlbGYpCgogICAgZGVmIHNldExhc3Qoc2VsZiwgbGFzdCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJCdXNQb3J0X3NldExhc3Qoc2VsZiwgbGFzdCkKCiAgICBkZWYgZ2V0TGFzdChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkJ1c1BvcnRfZ2V0TGFzdChzZWxmKQoKICAgIGRlZiBnZXRQYXJlbnQoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJCdXNQb3J0X2dldFBhcmVudChzZWxmKQoKICAgIGRlZiBnZXRCdXNJbmRleGVkRWxlbWVudChzZWxmLCBpbmRleCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJCdXNQb3J0X2dldEJ1c0luZGV4ZWRFbGVtZW50KHNlbGYsIGluZGV4KQoKICAgIGRlZiBnZXRCdXNQb3J0TWVtYmVycyhzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkJ1c1BvcnRfZ2V0QnVzUG9ydE1lbWJlcnMoc2VsZikKCiAgICBkZWYgZ2V0U2l6ZShzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkJ1c1BvcnRfZ2V0U2l6ZShzZWxmKQoKICAgIGRlZiBnZXRVcGRvd24oc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJCdXNQb3J0X2dldFVwZG93bihzZWxmKQoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBjcmVhdGUocGFyZW50TW9kdWxlLCBwb3J0LCBmcm9tX2l4LCB0b19peCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJCdXNQb3J0X2NyZWF0ZShwYXJlbnRNb2R1bGUsIHBvcnQsIGZyb21faXgsIHRvX2l4KQoKICAgIGRlZiBfX2luaXRfXyhzZWxmKToKICAgICAgICBfb2RiX3B5LmRiQnVzUG9ydF9zd2lnaW5pdChzZWxmLCBfb2RiX3B5Lm5ld19kYkJ1c1BvcnQoKSkKICAgIF9fc3dpZ19kZXN0cm95X18gPSBfb2RiX3B5LmRlbGV0ZV9kYkJ1c1BvcnQKCiMgUmVnaXN0ZXIgZGJCdXNQb3J0IGluIF9vZGJfcHk6Cl9vZGJfcHkuZGJCdXNQb3J0X3N3aWdyZWdpc3RlcihkYkJ1c1BvcnQpCgpkZWYgZGJCdXNQb3J0X2NyZWF0ZShwYXJlbnRNb2R1bGUsIHBvcnQsIGZyb21faXgsIHRvX2l4KToKICAgIHJldHVybiBfb2RiX3B5LmRiQnVzUG9ydF9jcmVhdGUocGFyZW50TW9kdWxlLCBwb3J0LCBmcm9tX2l4LCB0b19peCkKCmNsYXNzIGRiQ2VsbEVkZ2VTcGFjaW5nKG9iamVjdCk6CiAgICB0aGlzb3duID0gcHJvcGVydHkobGFtYmRhIHg6IHgudGhpcy5vd24oKSwgbGFtYmRhIHgsIHY6IHgudGhpcy5vd24odiksIGRvYz0nVGhlIG1lbWJlcnNoaXAgZmxhZycpCiAgICBfX3JlcHJfXyA9IF9zd2lnX3JlcHIKCiAgICBkZWYgc2V0Rmlyc3RFZGdlVHlwZShzZWxmLCBmaXJzdF9lZGdlX3R5cGUpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQ2VsbEVkZ2VTcGFjaW5nX3NldEZpcnN0RWRnZVR5cGUoc2VsZiwgZmlyc3RfZWRnZV90eXBlKQoKICAgIGRlZiBnZXRGaXJzdEVkZ2VUeXBlKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQ2VsbEVkZ2VTcGFjaW5nX2dldEZpcnN0RWRnZVR5cGUoc2VsZikKCiAgICBkZWYgc2V0U2Vjb25kRWRnZVR5cGUoc2VsZiwgc2Vjb25kX2VkZ2VfdHlwZSk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJDZWxsRWRnZVNwYWNpbmdfc2V0U2Vjb25kRWRnZVR5cGUoc2VsZiwgc2Vjb25kX2VkZ2VfdHlwZSkKCiAgICBkZWYgZ2V0U2Vjb25kRWRnZVR5cGUoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJDZWxsRWRnZVNwYWNpbmdfZ2V0U2Vjb25kRWRnZVR5cGUoc2VsZikKCiAgICBkZWYgc2V0U3BhY2luZyhzZWxmLCBzcGFjaW5nKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkNlbGxFZGdlU3BhY2luZ19zZXRTcGFjaW5nKHNlbGYsIHNwYWNpbmcpCgogICAgZGVmIGdldFNwYWNpbmcoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJDZWxsRWRnZVNwYWNpbmdfZ2V0U3BhY2luZyhzZWxmKQoKICAgIGRlZiBzZXRFeGNlcHRBYnV0dGVkKHNlbGYsIGV4Y2VwdF9hYnV0dGVkKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkNlbGxFZGdlU3BhY2luZ19zZXRFeGNlcHRBYnV0dGVkKHNlbGYsIGV4Y2VwdF9hYnV0dGVkKQoKICAgIGRlZiBpc0V4Y2VwdEFidXR0ZWQoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJDZWxsRWRnZVNwYWNpbmdfaXNFeGNlcHRBYnV0dGVkKHNlbGYpCgogICAgZGVmIHNldEV4Y2VwdE5vbkZpbGxlckluQmV0d2VlbihzZWxmLCBleGNlcHRfbm9uX2ZpbGxlcl9pbl9iZXR3ZWVuKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkNlbGxFZGdlU3BhY2luZ19zZXRFeGNlcHROb25GaWxsZXJJbkJldHdlZW4oc2VsZiwgZXhjZXB0X25vbl9maWxsZXJfaW5fYmV0d2VlbikKCiAgICBkZWYgaXNFeGNlcHROb25GaWxsZXJJbkJldHdlZW4oc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJDZWxsRWRnZVNwYWNpbmdfaXNFeGNlcHROb25GaWxsZXJJbkJldHdlZW4oc2VsZikKCiAgICBkZWYgc2V0T3B0aW9uYWwoc2VsZiwgb3B0aW9uYWwpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQ2VsbEVkZ2VTcGFjaW5nX3NldE9wdGlvbmFsKHNlbGYsIG9wdGlvbmFsKQoKICAgIGRlZiBpc09wdGlvbmFsKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQ2VsbEVkZ2VTcGFjaW5nX2lzT3B0aW9uYWwoc2VsZikKCiAgICBkZWYgc2V0U29mdChzZWxmLCBzb2Z0KToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkNlbGxFZGdlU3BhY2luZ19zZXRTb2Z0KHNlbGYsIHNvZnQpCgogICAgZGVmIGlzU29mdChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkNlbGxFZGdlU3BhY2luZ19pc1NvZnQoc2VsZikKCiAgICBkZWYgc2V0RXhhY3Qoc2VsZiwgZXhhY3QpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQ2VsbEVkZ2VTcGFjaW5nX3NldEV4YWN0KHNlbGYsIGV4YWN0KQoKICAgIGRlZiBpc0V4YWN0KHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQ2VsbEVkZ2VTcGFjaW5nX2lzRXhhY3Qoc2VsZikKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgY3JlYXRlKGFyZzEpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQ2VsbEVkZ2VTcGFjaW5nX2NyZWF0ZShhcmcxKQoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBkZXN0cm95KGFyZzEpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQ2VsbEVkZ2VTcGFjaW5nX2Rlc3Ryb3koYXJnMSkKCiAgICBkZWYgX19pbml0X18oc2VsZik6CiAgICAgICAgX29kYl9weS5kYkNlbGxFZGdlU3BhY2luZ19zd2lnaW5pdChzZWxmLCBfb2RiX3B5Lm5ld19kYkNlbGxFZGdlU3BhY2luZygpKQogICAgX19zd2lnX2Rlc3Ryb3lfXyA9IF9vZGJfcHkuZGVsZXRlX2RiQ2VsbEVkZ2VTcGFjaW5nCgojIFJlZ2lzdGVyIGRiQ2VsbEVkZ2VTcGFjaW5nIGluIF9vZGJfcHk6Cl9vZGJfcHkuZGJDZWxsRWRnZVNwYWNpbmdfc3dpZ3JlZ2lzdGVyKGRiQ2VsbEVkZ2VTcGFjaW5nKQoKZGVmIGRiQ2VsbEVkZ2VTcGFjaW5nX2NyZWF0ZShhcmcxKToKICAgIHJldHVybiBfb2RiX3B5LmRiQ2VsbEVkZ2VTcGFjaW5nX2NyZWF0ZShhcmcxKQoKZGVmIGRiQ2VsbEVkZ2VTcGFjaW5nX2Rlc3Ryb3koYXJnMSk6CiAgICByZXR1cm4gX29kYl9weS5kYkNlbGxFZGdlU3BhY2luZ19kZXN0cm95KGFyZzEpCgpjbGFzcyBkYkNoaXAob2JqZWN0KToKICAgIHRoaXNvd24gPSBwcm9wZXJ0eShsYW1iZGEgeDogeC50aGlzLm93bigpLCBsYW1iZGEgeCwgdjogeC50aGlzLm93bih2KSwgZG9jPSdUaGUgbWVtYmVyc2hpcCBmbGFnJykKICAgIF9fcmVwcl9fID0gX3N3aWdfcmVwcgogICAgQ2hpcFR5cGVfRElFID0gX29kYl9weS5kYkNoaXBfQ2hpcFR5cGVfRElFCiAgICBDaGlwVHlwZV9SREwgPSBfb2RiX3B5LmRiQ2hpcF9DaGlwVHlwZV9SREwKICAgIENoaXBUeXBlX0lQID0gX29kYl9weS5kYkNoaXBfQ2hpcFR5cGVfSVAKICAgIENoaXBUeXBlX1NVQlNUUkFURSA9IF9vZGJfcHkuZGJDaGlwX0NoaXBUeXBlX1NVQlNUUkFURQogICAgQ2hpcFR5cGVfSElFUiA9IF9vZGJfcHkuZGJDaGlwX0NoaXBUeXBlX0hJRVIKCiAgICBkZWYgZ2V0TmFtZShzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkNoaXBfZ2V0TmFtZShzZWxmKQoKICAgIGRlZiBzZXRPZmZzZXQoc2VsZiwgb2Zmc2V0KToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkNoaXBfc2V0T2Zmc2V0KHNlbGYsIG9mZnNldCkKCiAgICBkZWYgZ2V0T2Zmc2V0KHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQ2hpcF9nZXRPZmZzZXQoc2VsZikKCiAgICBkZWYgc2V0V2lkdGgoc2VsZiwgd2lkdGgpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQ2hpcF9zZXRXaWR0aChzZWxmLCB3aWR0aCkKCiAgICBkZWYgZ2V0V2lkdGgoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJDaGlwX2dldFdpZHRoKHNlbGYpCgogICAgZGVmIHNldEhlaWdodChzZWxmLCBoZWlnaHQpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQ2hpcF9zZXRIZWlnaHQoc2VsZiwgaGVpZ2h0KQoKICAgIGRlZiBnZXRIZWlnaHQoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJDaGlwX2dldEhlaWdodChzZWxmKQoKICAgIGRlZiBzZXRUaGlja25lc3Moc2VsZiwgdGhpY2tuZXNzKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkNoaXBfc2V0VGhpY2tuZXNzKHNlbGYsIHRoaWNrbmVzcykKCiAgICBkZWYgZ2V0VGhpY2tuZXNzKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQ2hpcF9nZXRUaGlja25lc3Moc2VsZikKCiAgICBkZWYgc2V0U2hyaW5rKHNlbGYsIHNocmluayk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJDaGlwX3NldFNocmluayhzZWxmLCBzaHJpbmspCgogICAgZGVmIGdldFNocmluayhzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkNoaXBfZ2V0U2hyaW5rKHNlbGYpCgogICAgZGVmIHNldFNlYWxSaW5nRWFzdChzZWxmLCBzZWFsX3JpbmdfZWFzdCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJDaGlwX3NldFNlYWxSaW5nRWFzdChzZWxmLCBzZWFsX3JpbmdfZWFzdCkKCiAgICBkZWYgZ2V0U2VhbFJpbmdFYXN0KHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQ2hpcF9nZXRTZWFsUmluZ0Vhc3Qoc2VsZikKCiAgICBkZWYgc2V0U2VhbFJpbmdXZXN0KHNlbGYsIHNlYWxfcmluZ193ZXN0KToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkNoaXBfc2V0U2VhbFJpbmdXZXN0KHNlbGYsIHNlYWxfcmluZ193ZXN0KQoKICAgIGRlZiBnZXRTZWFsUmluZ1dlc3Qoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJDaGlwX2dldFNlYWxSaW5nV2VzdChzZWxmKQoKICAgIGRlZiBzZXRTZWFsUmluZ05vcnRoKHNlbGYsIHNlYWxfcmluZ19ub3J0aCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJDaGlwX3NldFNlYWxSaW5nTm9ydGgoc2VsZiwgc2VhbF9yaW5nX25vcnRoKQoKICAgIGRlZiBnZXRTZWFsUmluZ05vcnRoKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQ2hpcF9nZXRTZWFsUmluZ05vcnRoKHNlbGYpCgogICAgZGVmIHNldFNlYWxSaW5nU291dGgoc2VsZiwgc2VhbF9yaW5nX3NvdXRoKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkNoaXBfc2V0U2VhbFJpbmdTb3V0aChzZWxmLCBzZWFsX3Jpbmdfc291dGgpCgogICAgZGVmIGdldFNlYWxSaW5nU291dGgoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJDaGlwX2dldFNlYWxSaW5nU291dGgoc2VsZikKCiAgICBkZWYgc2V0U2NyaWJlTGluZUVhc3Qoc2VsZiwgc2NyaWJlX2xpbmVfZWFzdCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJDaGlwX3NldFNjcmliZUxpbmVFYXN0KHNlbGYsIHNjcmliZV9saW5lX2Vhc3QpCgogICAgZGVmIGdldFNjcmliZUxpbmVFYXN0KHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQ2hpcF9nZXRTY3JpYmVMaW5lRWFzdChzZWxmKQoKICAgIGRlZiBzZXRTY3JpYmVMaW5lV2VzdChzZWxmLCBzY3JpYmVfbGluZV93ZXN0KToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkNoaXBfc2V0U2NyaWJlTGluZVdlc3Qoc2VsZiwgc2NyaWJlX2xpbmVfd2VzdCkKCiAgICBkZWYgZ2V0U2NyaWJlTGluZVdlc3Qoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJDaGlwX2dldFNjcmliZUxpbmVXZXN0KHNlbGYpCgogICAgZGVmIHNldFNjcmliZUxpbmVOb3J0aChzZWxmLCBzY3JpYmVfbGluZV9ub3J0aCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJDaGlwX3NldFNjcmliZUxpbmVOb3J0aChzZWxmLCBzY3JpYmVfbGluZV9ub3J0aCkKCiAgICBkZWYgZ2V0U2NyaWJlTGluZU5vcnRoKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQ2hpcF9nZXRTY3JpYmVMaW5lTm9ydGgoc2VsZikKCiAgICBkZWYgc2V0U2NyaWJlTGluZVNvdXRoKHNlbGYsIHNjcmliZV9saW5lX3NvdXRoKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkNoaXBfc2V0U2NyaWJlTGluZVNvdXRoKHNlbGYsIHNjcmliZV9saW5lX3NvdXRoKQoKICAgIGRlZiBnZXRTY3JpYmVMaW5lU291dGgoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJDaGlwX2dldFNjcmliZUxpbmVTb3V0aChzZWxmKQoKICAgIGRlZiBzZXRUc3Yoc2VsZiwgdHN2KToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkNoaXBfc2V0VHN2KHNlbGYsIHRzdikKCiAgICBkZWYgaXNUc3Yoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJDaGlwX2lzVHN2KHNlbGYpCgogICAgZGVmIGdldENoaXBSZWdpb25zKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQ2hpcF9nZXRDaGlwUmVnaW9ucyhzZWxmKQoKICAgIGRlZiBnZXRDaGlwVHlwZShzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkNoaXBfZ2V0Q2hpcFR5cGUoc2VsZikKCiAgICBkZWYgZ2V0QmxvY2soc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJDaGlwX2dldEJsb2NrKHNlbGYpCgogICAgZGVmIGdldENoaXBJbnN0cyhzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkNoaXBfZ2V0Q2hpcEluc3RzKHNlbGYpCgogICAgZGVmIGdldENoaXBDb25ucyhzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkNoaXBfZ2V0Q2hpcENvbm5zKHNlbGYpCgogICAgZGVmIGdldENoaXBOZXRzKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQ2hpcF9nZXRDaGlwTmV0cyhzZWxmKQoKICAgIGRlZiBmaW5kQ2hpcEluc3Qoc2VsZiwgbmFtZSk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJDaGlwX2ZpbmRDaGlwSW5zdChzZWxmLCBuYW1lKQoKICAgIGRlZiBmaW5kQ2hpcFJlZ2lvbihzZWxmLCBuYW1lKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkNoaXBfZmluZENoaXBSZWdpb24oc2VsZiwgbmFtZSkKCiAgICBkZWYgZ2V0VGVjaChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkNoaXBfZ2V0VGVjaChzZWxmKQoKICAgIGRlZiBnZXRCQm94KHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQ2hpcF9nZXRCQm94KHNlbGYpCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIGNyZWF0ZSgqYXJncyk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJDaGlwX2NyZWF0ZSgqYXJncykKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgZ2V0Q2hpcChkYiwgb2lkKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkNoaXBfZ2V0Q2hpcChkYiwgb2lkKQoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBkZXN0cm95KGNoaXApOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQ2hpcF9kZXN0cm95KGNoaXApCgogICAgZGVmIF9faW5pdF9fKHNlbGYpOgogICAgICAgIF9vZGJfcHkuZGJDaGlwX3N3aWdpbml0KHNlbGYsIF9vZGJfcHkubmV3X2RiQ2hpcCgpKQogICAgX19zd2lnX2Rlc3Ryb3lfXyA9IF9vZGJfcHkuZGVsZXRlX2RiQ2hpcAoKIyBSZWdpc3RlciBkYkNoaXAgaW4gX29kYl9weToKX29kYl9weS5kYkNoaXBfc3dpZ3JlZ2lzdGVyKGRiQ2hpcCkKCmRlZiBkYkNoaXBfY3JlYXRlKCphcmdzKToKICAgIHJldHVybiBfb2RiX3B5LmRiQ2hpcF9jcmVhdGUoKmFyZ3MpCgpkZWYgZGJDaGlwX2dldENoaXAoZGIsIG9pZCk6CiAgICByZXR1cm4gX29kYl9weS5kYkNoaXBfZ2V0Q2hpcChkYiwgb2lkKQoKZGVmIGRiQ2hpcF9kZXN0cm95KGNoaXApOgogICAgcmV0dXJuIF9vZGJfcHkuZGJDaGlwX2Rlc3Ryb3koY2hpcCkKCmNsYXNzIGRiQ2hpcEJ1bXAob2JqZWN0KToKICAgIHRoaXNvd24gPSBwcm9wZXJ0eShsYW1iZGEgeDogeC50aGlzLm93bigpLCBsYW1iZGEgeCwgdjogeC50aGlzLm93bih2KSwgZG9jPSdUaGUgbWVtYmVyc2hpcCBmbGFnJykKICAgIF9fcmVwcl9fID0gX3N3aWdfcmVwcgoKICAgIGRlZiBnZXRDaGlwKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQ2hpcEJ1bXBfZ2V0Q2hpcChzZWxmKQoKICAgIGRlZiBnZXRDaGlwUmVnaW9uKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQ2hpcEJ1bXBfZ2V0Q2hpcFJlZ2lvbihzZWxmKQoKICAgIGRlZiBnZXRJbnN0KHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQ2hpcEJ1bXBfZ2V0SW5zdChzZWxmKQoKICAgIGRlZiBnZXROZXQoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJDaGlwQnVtcF9nZXROZXQoc2VsZikKCiAgICBkZWYgZ2V0QlRlcm0oc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJDaGlwQnVtcF9nZXRCVGVybShzZWxmKQoKICAgIGRlZiBzZXROZXQoc2VsZiwgbmV0KToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkNoaXBCdW1wX3NldE5ldChzZWxmLCBuZXQpCgogICAgZGVmIHNldEJUZXJtKHNlbGYsIGJ0ZXJtKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkNoaXBCdW1wX3NldEJUZXJtKHNlbGYsIGJ0ZXJtKQoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBjcmVhdGUoY2hpcF9yZWdpb24sIGluc3QpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQ2hpcEJ1bXBfY3JlYXRlKGNoaXBfcmVnaW9uLCBpbnN0KQoKICAgIGRlZiBfX2luaXRfXyhzZWxmKToKICAgICAgICBfb2RiX3B5LmRiQ2hpcEJ1bXBfc3dpZ2luaXQoc2VsZiwgX29kYl9weS5uZXdfZGJDaGlwQnVtcCgpKQogICAgX19zd2lnX2Rlc3Ryb3lfXyA9IF9vZGJfcHkuZGVsZXRlX2RiQ2hpcEJ1bXAKCiMgUmVnaXN0ZXIgZGJDaGlwQnVtcCBpbiBfb2RiX3B5Ogpfb2RiX3B5LmRiQ2hpcEJ1bXBfc3dpZ3JlZ2lzdGVyKGRiQ2hpcEJ1bXApCgpkZWYgZGJDaGlwQnVtcF9jcmVhdGUoY2hpcF9yZWdpb24sIGluc3QpOgogICAgcmV0dXJuIF9vZGJfcHkuZGJDaGlwQnVtcF9jcmVhdGUoY2hpcF9yZWdpb24sIGluc3QpCgpjbGFzcyBkYkNoaXBCdW1wSW5zdChvYmplY3QpOgogICAgdGhpc293biA9IHByb3BlcnR5KGxhbWJkYSB4OiB4LnRoaXMub3duKCksIGxhbWJkYSB4LCB2OiB4LnRoaXMub3duKHYpLCBkb2M9J1RoZSBtZW1iZXJzaGlwIGZsYWcnKQogICAgX19yZXByX18gPSBfc3dpZ19yZXByCgogICAgZGVmIGdldENoaXBCdW1wKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQ2hpcEJ1bXBJbnN0X2dldENoaXBCdW1wKHNlbGYpCgogICAgZGVmIGdldENoaXBSZWdpb25JbnN0KHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQ2hpcEJ1bXBJbnN0X2dldENoaXBSZWdpb25JbnN0KHNlbGYpCgogICAgZGVmIF9faW5pdF9fKHNlbGYpOgogICAgICAgIF9vZGJfcHkuZGJDaGlwQnVtcEluc3Rfc3dpZ2luaXQoc2VsZiwgX29kYl9weS5uZXdfZGJDaGlwQnVtcEluc3QoKSkKICAgIF9fc3dpZ19kZXN0cm95X18gPSBfb2RiX3B5LmRlbGV0ZV9kYkNoaXBCdW1wSW5zdAoKIyBSZWdpc3RlciBkYkNoaXBCdW1wSW5zdCBpbiBfb2RiX3B5Ogpfb2RiX3B5LmRiQ2hpcEJ1bXBJbnN0X3N3aWdyZWdpc3RlcihkYkNoaXBCdW1wSW5zdCkKCmNsYXNzIGRiQ2hpcENvbm4ob2JqZWN0KToKICAgIHRoaXNvd24gPSBwcm9wZXJ0eShsYW1iZGEgeDogeC50aGlzLm93bigpLCBsYW1iZGEgeCwgdjogeC50aGlzLm93bih2KSwgZG9jPSdUaGUgbWVtYmVyc2hpcCBmbGFnJykKICAgIF9fcmVwcl9fID0gX3N3aWdfcmVwcgoKICAgIGRlZiBnZXROYW1lKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQ2hpcENvbm5fZ2V0TmFtZShzZWxmKQoKICAgIGRlZiBzZXRUaGlja25lc3Moc2VsZiwgdGhpY2tuZXNzKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkNoaXBDb25uX3NldFRoaWNrbmVzcyhzZWxmLCB0aGlja25lc3MpCgogICAgZGVmIGdldFRoaWNrbmVzcyhzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkNoaXBDb25uX2dldFRoaWNrbmVzcyhzZWxmKQoKICAgIGRlZiBnZXRQYXJlbnRDaGlwKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQ2hpcENvbm5fZ2V0UGFyZW50Q2hpcChzZWxmKQoKICAgIGRlZiBnZXRUb3BSZWdpb24oc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJDaGlwQ29ubl9nZXRUb3BSZWdpb24oc2VsZikKCiAgICBkZWYgZ2V0Qm90dG9tUmVnaW9uKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQ2hpcENvbm5fZ2V0Qm90dG9tUmVnaW9uKHNlbGYpCgogICAgZGVmIGdldFRvcFJlZ2lvblBhdGgoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJDaGlwQ29ubl9nZXRUb3BSZWdpb25QYXRoKHNlbGYpCgogICAgZGVmIGdldEJvdHRvbVJlZ2lvblBhdGgoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJDaGlwQ29ubl9nZXRCb3R0b21SZWdpb25QYXRoKHNlbGYpCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIGNyZWF0ZShuYW1lLCBwYXJlbnRfY2hpcCwgdG9wX3JlZ2lvbl9wYXRoLCB0b3BfcmVnaW9uLCBib3R0b21fcmVnaW9uX3BhdGgsIGJvdHRvbV9yZWdpb24pOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQ2hpcENvbm5fY3JlYXRlKG5hbWUsIHBhcmVudF9jaGlwLCB0b3BfcmVnaW9uX3BhdGgsIHRvcF9yZWdpb24sIGJvdHRvbV9yZWdpb25fcGF0aCwgYm90dG9tX3JlZ2lvbikKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgZGVzdHJveShjaGlwQ29ubik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJDaGlwQ29ubl9kZXN0cm95KGNoaXBDb25uKQoKICAgIGRlZiBfX2luaXRfXyhzZWxmKToKICAgICAgICBfb2RiX3B5LmRiQ2hpcENvbm5fc3dpZ2luaXQoc2VsZiwgX29kYl9weS5uZXdfZGJDaGlwQ29ubigpKQogICAgX19zd2lnX2Rlc3Ryb3lfXyA9IF9vZGJfcHkuZGVsZXRlX2RiQ2hpcENvbm4KCiMgUmVnaXN0ZXIgZGJDaGlwQ29ubiBpbiBfb2RiX3B5Ogpfb2RiX3B5LmRiQ2hpcENvbm5fc3dpZ3JlZ2lzdGVyKGRiQ2hpcENvbm4pCgpkZWYgZGJDaGlwQ29ubl9jcmVhdGUobmFtZSwgcGFyZW50X2NoaXAsIHRvcF9yZWdpb25fcGF0aCwgdG9wX3JlZ2lvbiwgYm90dG9tX3JlZ2lvbl9wYXRoLCBib3R0b21fcmVnaW9uKToKICAgIHJldHVybiBfb2RiX3B5LmRiQ2hpcENvbm5fY3JlYXRlKG5hbWUsIHBhcmVudF9jaGlwLCB0b3BfcmVnaW9uX3BhdGgsIHRvcF9yZWdpb24sIGJvdHRvbV9yZWdpb25fcGF0aCwgYm90dG9tX3JlZ2lvbikKCmRlZiBkYkNoaXBDb25uX2Rlc3Ryb3koY2hpcENvbm4pOgogICAgcmV0dXJuIF9vZGJfcHkuZGJDaGlwQ29ubl9kZXN0cm95KGNoaXBDb25uKQoKY2xhc3MgZGJDaGlwSW5zdChvYmplY3QpOgogICAgdGhpc293biA9IHByb3BlcnR5KGxhbWJkYSB4OiB4LnRoaXMub3duKCksIGxhbWJkYSB4LCB2OiB4LnRoaXMub3duKHYpLCBkb2M9J1RoZSBtZW1iZXJzaGlwIGZsYWcnKQogICAgX19yZXByX18gPSBfc3dpZ19yZXByCgogICAgZGVmIGdldE5hbWUoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJDaGlwSW5zdF9nZXROYW1lKHNlbGYpCgogICAgZGVmIHNldExvYyhzZWxmLCBsb2MpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQ2hpcEluc3Rfc2V0TG9jKHNlbGYsIGxvYykKCiAgICBkZWYgZ2V0TG9jKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQ2hpcEluc3RfZ2V0TG9jKHNlbGYpCgogICAgZGVmIHNldE9yaWVudChzZWxmLCBvcmllbnQpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQ2hpcEluc3Rfc2V0T3JpZW50KHNlbGYsIG9yaWVudCkKCiAgICBkZWYgZ2V0T3JpZW50KHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQ2hpcEluc3RfZ2V0T3JpZW50KHNlbGYpCgogICAgZGVmIGdldE1hc3RlckNoaXAoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJDaGlwSW5zdF9nZXRNYXN0ZXJDaGlwKHNlbGYpCgogICAgZGVmIGdldFBhcmVudENoaXAoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJDaGlwSW5zdF9nZXRQYXJlbnRDaGlwKHNlbGYpCgogICAgZGVmIGdldFRyYW5zZm9ybShzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkNoaXBJbnN0X2dldFRyYW5zZm9ybShzZWxmKQoKICAgIGRlZiBnZXRCQm94KHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQ2hpcEluc3RfZ2V0QkJveChzZWxmKQoKICAgIGRlZiBnZXRSZWdpb25zKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQ2hpcEluc3RfZ2V0UmVnaW9ucyhzZWxmKQoKICAgIGRlZiBmaW5kQ2hpcFJlZ2lvbkluc3Qoc2VsZiwgKmFyZ3MpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQ2hpcEluc3RfZmluZENoaXBSZWdpb25JbnN0KHNlbGYsICphcmdzKQoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBjcmVhdGUocGFyZW50X2NoaXAsIG1hc3Rlcl9jaGlwLCBuYW1lKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkNoaXBJbnN0X2NyZWF0ZShwYXJlbnRfY2hpcCwgbWFzdGVyX2NoaXAsIG5hbWUpCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIGRlc3Ryb3koY2hpcEluc3QpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQ2hpcEluc3RfZGVzdHJveShjaGlwSW5zdCkKCiAgICBkZWYgX19pbml0X18oc2VsZik6CiAgICAgICAgX29kYl9weS5kYkNoaXBJbnN0X3N3aWdpbml0KHNlbGYsIF9vZGJfcHkubmV3X2RiQ2hpcEluc3QoKSkKICAgIF9fc3dpZ19kZXN0cm95X18gPSBfb2RiX3B5LmRlbGV0ZV9kYkNoaXBJbnN0CgojIFJlZ2lzdGVyIGRiQ2hpcEluc3QgaW4gX29kYl9weToKX29kYl9weS5kYkNoaXBJbnN0X3N3aWdyZWdpc3RlcihkYkNoaXBJbnN0KQoKZGVmIGRiQ2hpcEluc3RfY3JlYXRlKHBhcmVudF9jaGlwLCBtYXN0ZXJfY2hpcCwgbmFtZSk6CiAgICByZXR1cm4gX29kYl9weS5kYkNoaXBJbnN0X2NyZWF0ZShwYXJlbnRfY2hpcCwgbWFzdGVyX2NoaXAsIG5hbWUpCgpkZWYgZGJDaGlwSW5zdF9kZXN0cm95KGNoaXBJbnN0KToKICAgIHJldHVybiBfb2RiX3B5LmRiQ2hpcEluc3RfZGVzdHJveShjaGlwSW5zdCkKCmNsYXNzIGRiQ2hpcE5ldChvYmplY3QpOgogICAgdGhpc293biA9IHByb3BlcnR5KGxhbWJkYSB4OiB4LnRoaXMub3duKCksIGxhbWJkYSB4LCB2OiB4LnRoaXMub3duKHYpLCBkb2M9J1RoZSBtZW1iZXJzaGlwIGZsYWcnKQogICAgX19yZXByX18gPSBfc3dpZ19yZXByCgogICAgZGVmIGdldE5hbWUoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJDaGlwTmV0X2dldE5hbWUoc2VsZikKCiAgICBkZWYgZ2V0Q2hpcChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkNoaXBOZXRfZ2V0Q2hpcChzZWxmKQoKICAgIGRlZiBnZXROdW1CdW1wSW5zdHMoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJDaGlwTmV0X2dldE51bUJ1bXBJbnN0cyhzZWxmKQoKICAgIGRlZiBnZXRCdW1wSW5zdChzZWxmLCBpbmRleCwgcGF0aCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJDaGlwTmV0X2dldEJ1bXBJbnN0KHNlbGYsIGluZGV4LCBwYXRoKQoKICAgIGRlZiBhZGRCdW1wSW5zdChzZWxmLCBidW1wX2luc3QsIHBhdGgpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQ2hpcE5ldF9hZGRCdW1wSW5zdChzZWxmLCBidW1wX2luc3QsIHBhdGgpCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIGNyZWF0ZShjaGlwLCBuYW1lKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkNoaXBOZXRfY3JlYXRlKGNoaXAsIG5hbWUpCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIGRlc3Ryb3kobmV0KToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkNoaXBOZXRfZGVzdHJveShuZXQpCgogICAgZGVmIF9faW5pdF9fKHNlbGYpOgogICAgICAgIF9vZGJfcHkuZGJDaGlwTmV0X3N3aWdpbml0KHNlbGYsIF9vZGJfcHkubmV3X2RiQ2hpcE5ldCgpKQogICAgX19zd2lnX2Rlc3Ryb3lfXyA9IF9vZGJfcHkuZGVsZXRlX2RiQ2hpcE5ldAoKIyBSZWdpc3RlciBkYkNoaXBOZXQgaW4gX29kYl9weToKX29kYl9weS5kYkNoaXBOZXRfc3dpZ3JlZ2lzdGVyKGRiQ2hpcE5ldCkKCmRlZiBkYkNoaXBOZXRfY3JlYXRlKGNoaXAsIG5hbWUpOgogICAgcmV0dXJuIF9vZGJfcHkuZGJDaGlwTmV0X2NyZWF0ZShjaGlwLCBuYW1lKQoKZGVmIGRiQ2hpcE5ldF9kZXN0cm95KG5ldCk6CiAgICByZXR1cm4gX29kYl9weS5kYkNoaXBOZXRfZGVzdHJveShuZXQpCgpjbGFzcyBkYkNoaXBSZWdpb24ob2JqZWN0KToKICAgIHRoaXNvd24gPSBwcm9wZXJ0eShsYW1iZGEgeDogeC50aGlzLm93bigpLCBsYW1iZGEgeCwgdjogeC50aGlzLm93bih2KSwgZG9jPSdUaGUgbWVtYmVyc2hpcCBmbGFnJykKICAgIF9fcmVwcl9fID0gX3N3aWdfcmVwcgogICAgU2lkZV9GUk9OVCA9IF9vZGJfcHkuZGJDaGlwUmVnaW9uX1NpZGVfRlJPTlQKICAgIFNpZGVfQkFDSyA9IF9vZGJfcHkuZGJDaGlwUmVnaW9uX1NpZGVfQkFDSwogICAgU2lkZV9JTlRFUk5BTCA9IF9vZGJfcHkuZGJDaGlwUmVnaW9uX1NpZGVfSU5URVJOQUwKICAgIFNpZGVfSU5URVJOQUxfRVhUID0gX29kYl9weS5kYkNoaXBSZWdpb25fU2lkZV9JTlRFUk5BTF9FWFQKCiAgICBkZWYgZ2V0TmFtZShzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkNoaXBSZWdpb25fZ2V0TmFtZShzZWxmKQoKICAgIGRlZiBzZXRCb3goc2VsZiwgYm94KToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkNoaXBSZWdpb25fc2V0Qm94KHNlbGYsIGJveCkKCiAgICBkZWYgZ2V0Qm94KHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQ2hpcFJlZ2lvbl9nZXRCb3goc2VsZikKCiAgICBkZWYgZ2V0Q2hpcEJ1bXBzKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQ2hpcFJlZ2lvbl9nZXRDaGlwQnVtcHMoc2VsZikKCiAgICBkZWYgZ2V0Q2hpcChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkNoaXBSZWdpb25fZ2V0Q2hpcChzZWxmKQoKICAgIGRlZiBnZXRTaWRlKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQ2hpcFJlZ2lvbl9nZXRTaWRlKHNlbGYpCgogICAgZGVmIGdldExheWVyKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQ2hpcFJlZ2lvbl9nZXRMYXllcihzZWxmKQoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBjcmVhdGUoY2hpcCwgbmFtZSwgc2lkZSwgbGF5ZXIpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQ2hpcFJlZ2lvbl9jcmVhdGUoY2hpcCwgbmFtZSwgc2lkZSwgbGF5ZXIpCgogICAgZGVmIF9faW5pdF9fKHNlbGYpOgogICAgICAgIF9vZGJfcHkuZGJDaGlwUmVnaW9uX3N3aWdpbml0KHNlbGYsIF9vZGJfcHkubmV3X2RiQ2hpcFJlZ2lvbigpKQogICAgX19zd2lnX2Rlc3Ryb3lfXyA9IF9vZGJfcHkuZGVsZXRlX2RiQ2hpcFJlZ2lvbgoKIyBSZWdpc3RlciBkYkNoaXBSZWdpb24gaW4gX29kYl9weToKX29kYl9weS5kYkNoaXBSZWdpb25fc3dpZ3JlZ2lzdGVyKGRiQ2hpcFJlZ2lvbikKCmRlZiBkYkNoaXBSZWdpb25fY3JlYXRlKGNoaXAsIG5hbWUsIHNpZGUsIGxheWVyKToKICAgIHJldHVybiBfb2RiX3B5LmRiQ2hpcFJlZ2lvbl9jcmVhdGUoY2hpcCwgbmFtZSwgc2lkZSwgbGF5ZXIpCgpjbGFzcyBkYkNoaXBSZWdpb25JbnN0KG9iamVjdCk6CiAgICB0aGlzb3duID0gcHJvcGVydHkobGFtYmRhIHg6IHgudGhpcy5vd24oKSwgbGFtYmRhIHgsIHY6IHgudGhpcy5vd24odiksIGRvYz0nVGhlIG1lbWJlcnNoaXAgZmxhZycpCiAgICBfX3JlcHJfXyA9IF9zd2lnX3JlcHIKCiAgICBkZWYgZ2V0Q2hpcEluc3Qoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJDaGlwUmVnaW9uSW5zdF9nZXRDaGlwSW5zdChzZWxmKQoKICAgIGRlZiBnZXRDaGlwUmVnaW9uKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQ2hpcFJlZ2lvbkluc3RfZ2V0Q2hpcFJlZ2lvbihzZWxmKQoKICAgIGRlZiBnZXRDaGlwQnVtcEluc3RzKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQ2hpcFJlZ2lvbkluc3RfZ2V0Q2hpcEJ1bXBJbnN0cyhzZWxmKQoKICAgIGRlZiBfX2luaXRfXyhzZWxmKToKICAgICAgICBfb2RiX3B5LmRiQ2hpcFJlZ2lvbkluc3Rfc3dpZ2luaXQoc2VsZiwgX29kYl9weS5uZXdfZGJDaGlwUmVnaW9uSW5zdCgpKQogICAgX19zd2lnX2Rlc3Ryb3lfXyA9IF9vZGJfcHkuZGVsZXRlX2RiQ2hpcFJlZ2lvbkluc3QKCiMgUmVnaXN0ZXIgZGJDaGlwUmVnaW9uSW5zdCBpbiBfb2RiX3B5Ogpfb2RiX3B5LmRiQ2hpcFJlZ2lvbkluc3Rfc3dpZ3JlZ2lzdGVyKGRiQ2hpcFJlZ2lvbkluc3QpCgpjbGFzcyBkYkRhdGFiYXNlKG9iamVjdCk6CiAgICB0aGlzb3duID0gcHJvcGVydHkobGFtYmRhIHg6IHgudGhpcy5vd24oKSwgbGFtYmRhIHgsIHY6IHgudGhpcy5vd24odiksIGRvYz0nVGhlIG1lbWJlcnNoaXAgZmxhZycpCiAgICBfX3JlcHJfXyA9IF9zd2lnX3JlcHIKCiAgICBkZWYgc2V0RGJ1UGVyTWljcm9uKHNlbGYsIGRidV9wZXJfbWljcm9uKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkRhdGFiYXNlX3NldERidVBlck1pY3JvbihzZWxmLCBkYnVfcGVyX21pY3JvbikKCiAgICBkZWYgZ2V0RGJ1UGVyTWljcm9uKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiRGF0YWJhc2VfZ2V0RGJ1UGVyTWljcm9uKHNlbGYpCgogICAgZGVmIGdldENoaXBzKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiRGF0YWJhc2VfZ2V0Q2hpcHMoc2VsZikKCiAgICBkZWYgZmluZENoaXAoc2VsZiwgbmFtZSk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJEYXRhYmFzZV9maW5kQ2hpcChzZWxmLCBuYW1lKQoKICAgIGRlZiBnZXRQcm9wZXJ0aWVzKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiRGF0YWJhc2VfZ2V0UHJvcGVydGllcyhzZWxmKQoKICAgIGRlZiBnZXRDaGlwSW5zdHMoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJEYXRhYmFzZV9nZXRDaGlwSW5zdHMoc2VsZikKCiAgICBkZWYgZ2V0Q2hpcFJlZ2lvbkluc3RzKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiRGF0YWJhc2VfZ2V0Q2hpcFJlZ2lvbkluc3RzKHNlbGYpCgogICAgZGVmIGdldENoaXBDb25ucyhzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkRhdGFiYXNlX2dldENoaXBDb25ucyhzZWxmKQoKICAgIGRlZiBnZXRDaGlwQnVtcEluc3RzKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiRGF0YWJhc2VfZ2V0Q2hpcEJ1bXBJbnN0cyhzZWxmKQoKICAgIGRlZiBnZXRDaGlwTmV0cyhzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkRhdGFiYXNlX2dldENoaXBOZXRzKHNlbGYpCgogICAgZGVmIHNldFRvcENoaXAoc2VsZiwgY2hpcCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJEYXRhYmFzZV9zZXRUb3BDaGlwKHNlbGYsIGNoaXApCgogICAgZGVmIGdldExpYnMoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJEYXRhYmFzZV9nZXRMaWJzKHNlbGYpCgogICAgZGVmIGZpbmRMaWIoc2VsZiwgbmFtZSk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJEYXRhYmFzZV9maW5kTGliKHNlbGYsIG5hbWUpCgogICAgZGVmIGdldFRlY2hzKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiRGF0YWJhc2VfZ2V0VGVjaHMoc2VsZikKCiAgICBkZWYgZmluZFRlY2goc2VsZiwgbmFtZSk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJEYXRhYmFzZV9maW5kVGVjaChzZWxmLCBuYW1lKQoKICAgIGRlZiBmaW5kTWFzdGVyKHNlbGYsIG5hbWUpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiRGF0YWJhc2VfZmluZE1hc3RlcihzZWxmLCBuYW1lKQoKICAgIGRlZiByZW1vdmVVbnVzZWRNYXN0ZXJzKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiRGF0YWJhc2VfcmVtb3ZlVW51c2VkTWFzdGVycyhzZWxmKQoKICAgIGRlZiBnZXRDaGlwKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiRGF0YWJhc2VfZ2V0Q2hpcChzZWxmKQoKICAgIGRlZiBnZXRUZWNoKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiRGF0YWJhc2VfZ2V0VGVjaChzZWxmKQoKICAgIGRlZiBnZXROdW1iZXJPZk1hc3RlcnMoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJEYXRhYmFzZV9nZXROdW1iZXJPZk1hc3RlcnMoc2VsZikKCiAgICBkZWYgcmVhZChzZWxmLCBmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkRhdGFiYXNlX3JlYWQoc2VsZiwgZikKCiAgICBkZWYgd3JpdGUoc2VsZiwgZmlsZSk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJEYXRhYmFzZV93cml0ZShzZWxmLCBmaWxlKQoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBiZWdpbkVjbyhibG9jayk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJEYXRhYmFzZV9iZWdpbkVjbyhibG9jaykKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgZW5kRWNvKGJsb2NrKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkRhdGFiYXNlX2VuZEVjbyhibG9jaykKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgZWNvRW1wdHkoYmxvY2spOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiRGF0YWJhc2VfZWNvRW1wdHkoYmxvY2spCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIHJlYWRFY28oYmxvY2ssIGZpbGVuYW1lKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkRhdGFiYXNlX3JlYWRFY28oYmxvY2ssIGZpbGVuYW1lKQoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiB3cml0ZUVjbyhibG9jaywgZmlsZW5hbWUpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiRGF0YWJhc2Vfd3JpdGVFY28oYmxvY2ssIGZpbGVuYW1lKQoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBjaGVja0VjbyhibG9jayk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJEYXRhYmFzZV9jaGVja0VjbyhibG9jaykKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgY29tbWl0RWNvKGJsb2NrKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkRhdGFiYXNlX2NvbW1pdEVjbyhibG9jaykKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgdW5kb0VjbyhibG9jayk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJEYXRhYmFzZV91bmRvRWNvKGJsb2NrKQoKICAgIGRlZiBzZXRMb2dnZXIoc2VsZiwgbG9nZ2VyKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkRhdGFiYXNlX3NldExvZ2dlcihzZWxmLCBsb2dnZXIpCgogICAgZGVmIGNsZWFyKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiRGF0YWJhc2VfY2xlYXIoc2VsZikKCiAgICBkZWYgcmVwb3J0KHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiRGF0YWJhc2VfcmVwb3J0KHNlbGYpCgogICAgZGVmIGFkZE9ic2VydmVyKHNlbGYsIG9ic2VydmVyKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkRhdGFiYXNlX2FkZE9ic2VydmVyKHNlbGYsIG9ic2VydmVyKQoKICAgIGRlZiByZW1vdmVPYnNlcnZlcihzZWxmLCBvYnNlcnZlcik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJEYXRhYmFzZV9yZW1vdmVPYnNlcnZlcihzZWxmLCBvYnNlcnZlcikKCiAgICBkZWYgdHJpZ2dlclBvc3RSZWFkTGVmKHNlbGYsIHRlY2gsIGxpYnJhcnkpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiRGF0YWJhc2VfdHJpZ2dlclBvc3RSZWFkTGVmKHNlbGYsIHRlY2gsIGxpYnJhcnkpCgogICAgZGVmIHRyaWdnZXJQb3N0UmVhZERlZihzZWxmLCBibG9jaywgZmxvb3JwbGFuKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkRhdGFiYXNlX3RyaWdnZXJQb3N0UmVhZERlZihzZWxmLCBibG9jaywgZmxvb3JwbGFuKQoKICAgIGRlZiB0cmlnZ2VyUG9zdFJlYWREYihzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkRhdGFiYXNlX3RyaWdnZXJQb3N0UmVhZERiKHNlbGYpCgogICAgZGVmIHRyaWdnZXJQb3N0UmVhZDNEYngoc2VsZiwgY2hpcCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJEYXRhYmFzZV90cmlnZ2VyUG9zdFJlYWQzRGJ4KHNlbGYsIGNoaXApCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIGNyZWF0ZSgpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiRGF0YWJhc2VfY3JlYXRlKCkKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgZGVzdHJveShkYik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJEYXRhYmFzZV9kZXN0cm95KGRiKQoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBnZXREYXRhYmFzZShvaWQpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiRGF0YWJhc2VfZ2V0RGF0YWJhc2Uob2lkKQoKICAgIGRlZiBfX2luaXRfXyhzZWxmKToKICAgICAgICBfb2RiX3B5LmRiRGF0YWJhc2Vfc3dpZ2luaXQoc2VsZiwgX29kYl9weS5uZXdfZGJEYXRhYmFzZSgpKQogICAgX19zd2lnX2Rlc3Ryb3lfXyA9IF9vZGJfcHkuZGVsZXRlX2RiRGF0YWJhc2UKCiMgUmVnaXN0ZXIgZGJEYXRhYmFzZSBpbiBfb2RiX3B5Ogpfb2RiX3B5LmRiRGF0YWJhc2Vfc3dpZ3JlZ2lzdGVyKGRiRGF0YWJhc2UpCgpkZWYgZGJEYXRhYmFzZV9iZWdpbkVjbyhibG9jayk6CiAgICByZXR1cm4gX29kYl9weS5kYkRhdGFiYXNlX2JlZ2luRWNvKGJsb2NrKQoKZGVmIGRiRGF0YWJhc2VfZW5kRWNvKGJsb2NrKToKICAgIHJldHVybiBfb2RiX3B5LmRiRGF0YWJhc2VfZW5kRWNvKGJsb2NrKQoKZGVmIGRiRGF0YWJhc2VfZWNvRW1wdHkoYmxvY2spOgogICAgcmV0dXJuIF9vZGJfcHkuZGJEYXRhYmFzZV9lY29FbXB0eShibG9jaykKCmRlZiBkYkRhdGFiYXNlX3JlYWRFY28oYmxvY2ssIGZpbGVuYW1lKToKICAgIHJldHVybiBfb2RiX3B5LmRiRGF0YWJhc2VfcmVhZEVjbyhibG9jaywgZmlsZW5hbWUpCgpkZWYgZGJEYXRhYmFzZV93cml0ZUVjbyhibG9jaywgZmlsZW5hbWUpOgogICAgcmV0dXJuIF9vZGJfcHkuZGJEYXRhYmFzZV93cml0ZUVjbyhibG9jaywgZmlsZW5hbWUpCgpkZWYgZGJEYXRhYmFzZV9jaGVja0VjbyhibG9jayk6CiAgICByZXR1cm4gX29kYl9weS5kYkRhdGFiYXNlX2NoZWNrRWNvKGJsb2NrKQoKZGVmIGRiRGF0YWJhc2VfY29tbWl0RWNvKGJsb2NrKToKICAgIHJldHVybiBfb2RiX3B5LmRiRGF0YWJhc2VfY29tbWl0RWNvKGJsb2NrKQoKZGVmIGRiRGF0YWJhc2VfdW5kb0VjbyhibG9jayk6CiAgICByZXR1cm4gX29kYl9weS5kYkRhdGFiYXNlX3VuZG9FY28oYmxvY2spCgpkZWYgZGJEYXRhYmFzZV9jcmVhdGUoKToKICAgIHJldHVybiBfb2RiX3B5LmRiRGF0YWJhc2VfY3JlYXRlKCkKCmRlZiBkYkRhdGFiYXNlX2Rlc3Ryb3koZGIpOgogICAgcmV0dXJuIF9vZGJfcHkuZGJEYXRhYmFzZV9kZXN0cm95KGRiKQoKZGVmIGRiRGF0YWJhc2VfZ2V0RGF0YWJhc2Uob2lkKToKICAgIHJldHVybiBfb2RiX3B5LmRiRGF0YWJhc2VfZ2V0RGF0YWJhc2Uob2lkKQoKY2xhc3MgZGJEZnQob2JqZWN0KToKICAgIHRoaXNvd24gPSBwcm9wZXJ0eShsYW1iZGEgeDogeC50aGlzLm93bigpLCBsYW1iZGEgeCwgdjogeC50aGlzLm93bih2KSwgZG9jPSdUaGUgbWVtYmVyc2hpcCBmbGFnJykKICAgIF9fcmVwcl9fID0gX3N3aWdfcmVwcgoKICAgIGRlZiBzZXRTY2FuSW5zZXJ0ZWQoc2VsZiwgc2Nhbl9pbnNlcnRlZCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJEZnRfc2V0U2Nhbkluc2VydGVkKHNlbGYsIHNjYW5faW5zZXJ0ZWQpCgogICAgZGVmIGlzU2Nhbkluc2VydGVkKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiRGZ0X2lzU2Nhbkluc2VydGVkKHNlbGYpCgogICAgZGVmIGdldFNjYW5DaGFpbnMoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJEZnRfZ2V0U2NhbkNoYWlucyhzZWxmKQoKICAgIGRlZiBfX2luaXRfXyhzZWxmKToKICAgICAgICBfb2RiX3B5LmRiRGZ0X3N3aWdpbml0KHNlbGYsIF9vZGJfcHkubmV3X2RiRGZ0KCkpCiAgICBfX3N3aWdfZGVzdHJveV9fID0gX29kYl9weS5kZWxldGVfZGJEZnQKCiMgUmVnaXN0ZXIgZGJEZnQgaW4gX29kYl9weToKX29kYl9weS5kYkRmdF9zd2lncmVnaXN0ZXIoZGJEZnQpCgpjbGFzcyBkYkdDZWxsR3JpZChvYmplY3QpOgogICAgdGhpc293biA9IHByb3BlcnR5KGxhbWJkYSB4OiB4LnRoaXMub3duKCksIGxhbWJkYSB4LCB2OiB4LnRoaXMub3duKHYpLCBkb2M9J1RoZSBtZW1iZXJzaGlwIGZsYWcnKQogICAgX19yZXByX18gPSBfc3dpZ19yZXByCgogICAgZGVmIGdldEdyaWRYKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiR0NlbGxHcmlkX2dldEdyaWRYKHNlbGYpCgogICAgZGVmIGdldEdyaWRZKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiR0NlbGxHcmlkX2dldEdyaWRZKHNlbGYpCgogICAgZGVmIGdldEJsb2NrKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiR0NlbGxHcmlkX2dldEJsb2NrKHNlbGYpCgogICAgZGVmIGFkZEdyaWRQYXR0ZXJuWChzZWxmLCBvcmlnaW5feCwgbGluZV9jb3VudCwgc3RlcCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJHQ2VsbEdyaWRfYWRkR3JpZFBhdHRlcm5YKHNlbGYsIG9yaWdpbl94LCBsaW5lX2NvdW50LCBzdGVwKQoKICAgIGRlZiBhZGRHcmlkUGF0dGVyblkoc2VsZiwgb3JpZ2luX3ksIGxpbmVfY291bnQsIHN0ZXApOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiR0NlbGxHcmlkX2FkZEdyaWRQYXR0ZXJuWShzZWxmLCBvcmlnaW5feSwgbGluZV9jb3VudCwgc3RlcCkKCiAgICBkZWYgZ2V0TnVtR3JpZFBhdHRlcm5zWChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkdDZWxsR3JpZF9nZXROdW1HcmlkUGF0dGVybnNYKHNlbGYpCgogICAgZGVmIGdldE51bUdyaWRQYXR0ZXJuc1koc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJHQ2VsbEdyaWRfZ2V0TnVtR3JpZFBhdHRlcm5zWShzZWxmKQoKICAgIGRlZiBnZXRHcmlkUGF0dGVyblgoc2VsZiwgaSk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJHQ2VsbEdyaWRfZ2V0R3JpZFBhdHRlcm5YKHNlbGYsIGkpCgogICAgZGVmIGdldEdyaWRQYXR0ZXJuWShzZWxmLCBpKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkdDZWxsR3JpZF9nZXRHcmlkUGF0dGVyblkoc2VsZiwgaSkKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgY3JlYXRlKGJsb2NrKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkdDZWxsR3JpZF9jcmVhdGUoYmxvY2spCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIGdldEdDZWxsR3JpZChibG9jaywgb2lkKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkdDZWxsR3JpZF9nZXRHQ2VsbEdyaWQoYmxvY2ssIG9pZCkKCiAgICBkZWYgZ2V0WElkeChzZWxmLCB4KToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkdDZWxsR3JpZF9nZXRYSWR4KHNlbGYsIHgpCgogICAgZGVmIGdldFlJZHgoc2VsZiwgeSk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJHQ2VsbEdyaWRfZ2V0WUlkeChzZWxmLCB5KQoKICAgIGRlZiBnZXRDYXBhY2l0eShzZWxmLCBsYXllciwgeF9pZHgsIHlfaWR4KToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkdDZWxsR3JpZF9nZXRDYXBhY2l0eShzZWxmLCBsYXllciwgeF9pZHgsIHlfaWR4KQoKICAgIGRlZiBnZXRVc2FnZShzZWxmLCBsYXllciwgeF9pZHgsIHlfaWR4KToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkdDZWxsR3JpZF9nZXRVc2FnZShzZWxmLCBsYXllciwgeF9pZHgsIHlfaWR4KQoKICAgIGRlZiBzZXRDYXBhY2l0eShzZWxmLCBsYXllciwgeF9pZHgsIHlfaWR4LCBjYXBhY2l0eSk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJHQ2VsbEdyaWRfc2V0Q2FwYWNpdHkoc2VsZiwgbGF5ZXIsIHhfaWR4LCB5X2lkeCwgY2FwYWNpdHkpCgogICAgZGVmIHNldFVzYWdlKHNlbGYsIGxheWVyLCB4X2lkeCwgeV9pZHgsIHVzZSk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJHQ2VsbEdyaWRfc2V0VXNhZ2Uoc2VsZiwgbGF5ZXIsIHhfaWR4LCB5X2lkeCwgdXNlKQoKICAgIGRlZiByZXNldENvbmdlc3Rpb25NYXAoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJHQ2VsbEdyaWRfcmVzZXRDb25nZXN0aW9uTWFwKHNlbGYpCgogICAgZGVmIHJlc2V0R3JpZChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkdDZWxsR3JpZF9yZXNldEdyaWQoc2VsZikKCiAgICBkZWYgZ2V0TGF5ZXJDb25nZXN0aW9uTWFwKHNlbGYsIGxheWVyKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkdDZWxsR3JpZF9nZXRMYXllckNvbmdlc3Rpb25NYXAoc2VsZiwgbGF5ZXIpCgogICAgZGVmIGdldERpcmVjdGlvbkNvbmdlc3Rpb25NYXAoc2VsZiwgZGlyZWN0aW9uKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkdDZWxsR3JpZF9nZXREaXJlY3Rpb25Db25nZXN0aW9uTWFwKHNlbGYsIGRpcmVjdGlvbikKCiAgICBkZWYgX19pbml0X18oc2VsZik6CiAgICAgICAgX29kYl9weS5kYkdDZWxsR3JpZF9zd2lnaW5pdChzZWxmLCBfb2RiX3B5Lm5ld19kYkdDZWxsR3JpZCgpKQogICAgX19zd2lnX2Rlc3Ryb3lfXyA9IF9vZGJfcHkuZGVsZXRlX2RiR0NlbGxHcmlkCgojIFJlZ2lzdGVyIGRiR0NlbGxHcmlkIGluIF9vZGJfcHk6Cl9vZGJfcHkuZGJHQ2VsbEdyaWRfc3dpZ3JlZ2lzdGVyKGRiR0NlbGxHcmlkKQoKZGVmIGRiR0NlbGxHcmlkX2NyZWF0ZShibG9jayk6CiAgICByZXR1cm4gX29kYl9weS5kYkdDZWxsR3JpZF9jcmVhdGUoYmxvY2spCgpkZWYgZGJHQ2VsbEdyaWRfZ2V0R0NlbGxHcmlkKGJsb2NrLCBvaWQpOgogICAgcmV0dXJuIF9vZGJfcHkuZGJHQ2VsbEdyaWRfZ2V0R0NlbGxHcmlkKGJsb2NrLCBvaWQpCgpjbGFzcyBkYkdEU0FSZWYob2JqZWN0KToKICAgIHRoaXNvd24gPSBwcm9wZXJ0eShsYW1iZGEgeDogeC50aGlzLm93bigpLCBsYW1iZGEgeCwgdjogeC50aGlzLm93bih2KSwgZG9jPSdUaGUgbWVtYmVyc2hpcCBmbGFnJykKICAgIF9fcmVwcl9fID0gX3N3aWdfcmVwcgoKICAgIGRlZiBzZXRPcmlnaW4oc2VsZiwgb3JpZ2luKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkdEU0FSZWZfc2V0T3JpZ2luKHNlbGYsIG9yaWdpbikKCiAgICBkZWYgZ2V0T3JpZ2luKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiR0RTQVJlZl9nZXRPcmlnaW4oc2VsZikKCiAgICBkZWYgc2V0THIoc2VsZiwgbHIpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiR0RTQVJlZl9zZXRMcihzZWxmLCBscikKCiAgICBkZWYgZ2V0THIoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJHRFNBUmVmX2dldExyKHNlbGYp",
"CgogICAgZGVmIHNldFVsKHNlbGYsIHVsKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkdEU0FSZWZfc2V0VWwoc2VsZiwgdWwpCgogICAgZGVmIGdldFVsKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiR0RTQVJlZl9nZXRVbChzZWxmKQoKICAgIGRlZiBzZXRUcmFuc2Zvcm0oc2VsZiwgdHJhbnNmb3JtKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkdEU0FSZWZfc2V0VHJhbnNmb3JtKHNlbGYsIHRyYW5zZm9ybSkKCiAgICBkZWYgZ2V0VHJhbnNmb3JtKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiR0RTQVJlZl9nZXRUcmFuc2Zvcm0oc2VsZikKCiAgICBkZWYgc2V0TnVtUm93cyhzZWxmLCBudW1fcm93cyk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJHRFNBUmVmX3NldE51bVJvd3Moc2VsZiwgbnVtX3Jvd3MpCgogICAgZGVmIGdldE51bVJvd3Moc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJHRFNBUmVmX2dldE51bVJvd3Moc2VsZikKCiAgICBkZWYgc2V0TnVtQ29sdW1ucyhzZWxmLCBudW1fY29sdW1ucyk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJHRFNBUmVmX3NldE51bUNvbHVtbnMoc2VsZiwgbnVtX2NvbHVtbnMpCgogICAgZGVmIGdldE51bUNvbHVtbnMoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJHRFNBUmVmX2dldE51bUNvbHVtbnMoc2VsZikKCiAgICBkZWYgZ2V0U3RydWN0dXJlKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiR0RTQVJlZl9nZXRTdHJ1Y3R1cmUoc2VsZikKCiAgICBkZWYgZ2V0UHJvcGF0dHIoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJHRFNBUmVmX2dldFByb3BhdHRyKHNlbGYpCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIGNyZWF0ZShwYXJlbnQsIGNoaWxkKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkdEU0FSZWZfY3JlYXRlKHBhcmVudCwgY2hpbGQpCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIGRlc3Ryb3koYXJlZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJHRFNBUmVmX2Rlc3Ryb3koYXJlZikKCiAgICBkZWYgX19pbml0X18oc2VsZik6CiAgICAgICAgX29kYl9weS5kYkdEU0FSZWZfc3dpZ2luaXQoc2VsZiwgX29kYl9weS5uZXdfZGJHRFNBUmVmKCkpCiAgICBfX3N3aWdfZGVzdHJveV9fID0gX29kYl9weS5kZWxldGVfZGJHRFNBUmVmCgojIFJlZ2lzdGVyIGRiR0RTQVJlZiBpbiBfb2RiX3B5Ogpfb2RiX3B5LmRiR0RTQVJlZl9zd2lncmVnaXN0ZXIoZGJHRFNBUmVmKQoKZGVmIGRiR0RTQVJlZl9jcmVhdGUocGFyZW50LCBjaGlsZCk6CiAgICByZXR1cm4gX29kYl9weS5kYkdEU0FSZWZfY3JlYXRlKHBhcmVudCwgY2hpbGQpCgpkZWYgZGJHRFNBUmVmX2Rlc3Ryb3koYXJlZik6CiAgICByZXR1cm4gX29kYl9weS5kYkdEU0FSZWZfZGVzdHJveShhcmVmKQoKY2xhc3MgZGJHRFNCb3VuZGFyeShvYmplY3QpOgogICAgdGhpc293biA9IHByb3BlcnR5KGxhbWJkYSB4OiB4LnRoaXMub3duKCksIGxhbWJkYSB4LCB2OiB4LnRoaXMub3duKHYpLCBkb2M9J1RoZSBtZW1iZXJzaGlwIGZsYWcnKQogICAgX19yZXByX18gPSBfc3dpZ19yZXByCgogICAgZGVmIHNldExheWVyKHNlbGYsIGxheWVyKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkdEU0JvdW5kYXJ5X3NldExheWVyKHNlbGYsIGxheWVyKQoKICAgIGRlZiBnZXRMYXllcihzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkdEU0JvdW5kYXJ5X2dldExheWVyKHNlbGYpCgogICAgZGVmIHNldERhdGF0eXBlKHNlbGYsIGRhdGF0eXBlKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkdEU0JvdW5kYXJ5X3NldERhdGF0eXBlKHNlbGYsIGRhdGF0eXBlKQoKICAgIGRlZiBnZXREYXRhdHlwZShzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkdEU0JvdW5kYXJ5X2dldERhdGF0eXBlKHNlbGYpCgogICAgZGVmIHNldFh5KHNlbGYsIHh5KToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkdEU0JvdW5kYXJ5X3NldFh5KHNlbGYsIHh5KQoKICAgIGRlZiBnZXRYeShzZWxmLCB0YmwpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiR0RTQm91bmRhcnlfZ2V0WHkoc2VsZiwgdGJsKQoKICAgIGRlZiBnZXRYWShzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkdEU0JvdW5kYXJ5X2dldFhZKHNlbGYpCgogICAgZGVmIGdldFByb3BhdHRyKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiR0RTQm91bmRhcnlfZ2V0UHJvcGF0dHIoc2VsZikKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgY3JlYXRlKHN0cnVjdHVyZSk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJHRFNCb3VuZGFyeV9jcmVhdGUoc3RydWN0dXJlKQoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBkZXN0cm95KGJvdW5kYXJ5KToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkdEU0JvdW5kYXJ5X2Rlc3Ryb3koYm91bmRhcnkpCgogICAgZGVmIF9faW5pdF9fKHNlbGYpOgogICAgICAgIF9vZGJfcHkuZGJHRFNCb3VuZGFyeV9zd2lnaW5pdChzZWxmLCBfb2RiX3B5Lm5ld19kYkdEU0JvdW5kYXJ5KCkpCiAgICBfX3N3aWdfZGVzdHJveV9fID0gX29kYl9weS5kZWxldGVfZGJHRFNCb3VuZGFyeQoKIyBSZWdpc3RlciBkYkdEU0JvdW5kYXJ5IGluIF9vZGJfcHk6Cl9vZGJfcHkuZGJHRFNCb3VuZGFyeV9zd2lncmVnaXN0ZXIoZGJHRFNCb3VuZGFyeSkKCmRlZiBkYkdEU0JvdW5kYXJ5X2NyZWF0ZShzdHJ1Y3R1cmUpOgogICAgcmV0dXJuIF9vZGJfcHkuZGJHRFNCb3VuZGFyeV9jcmVhdGUoc3RydWN0dXJlKQoKZGVmIGRiR0RTQm91bmRhcnlfZGVzdHJveShib3VuZGFyeSk6CiAgICByZXR1cm4gX29kYl9weS5kYkdEU0JvdW5kYXJ5X2Rlc3Ryb3koYm91bmRhcnkpCgpjbGFzcyBkYkdEU0JveChvYmplY3QpOgogICAgdGhpc293biA9IHByb3BlcnR5KGxhbWJkYSB4OiB4LnRoaXMub3duKCksIGxhbWJkYSB4LCB2OiB4LnRoaXMub3duKHYpLCBkb2M9J1RoZSBtZW1iZXJzaGlwIGZsYWcnKQogICAgX19yZXByX18gPSBfc3dpZ19yZXByCgogICAgZGVmIHNldExheWVyKHNlbGYsIGxheWVyKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkdEU0JveF9zZXRMYXllcihzZWxmLCBsYXllcikKCiAgICBkZWYgZ2V0TGF5ZXIoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJHRFNCb3hfZ2V0TGF5ZXIoc2VsZikKCiAgICBkZWYgc2V0RGF0YXR5cGUoc2VsZiwgZGF0YXR5cGUpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiR0RTQm94X3NldERhdGF0eXBlKHNlbGYsIGRhdGF0eXBlKQoKICAgIGRlZiBnZXREYXRhdHlwZShzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkdEU0JveF9nZXREYXRhdHlwZShzZWxmKQoKICAgIGRlZiBzZXRCb3VuZHMoc2VsZiwgYm91bmRzKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkdEU0JveF9zZXRCb3VuZHMoc2VsZiwgYm91bmRzKQoKICAgIGRlZiBnZXRCb3VuZHMoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJHRFNCb3hfZ2V0Qm91bmRzKHNlbGYpCgogICAgZGVmIGdldFByb3BhdHRyKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiR0RTQm94X2dldFByb3BhdHRyKHNlbGYpCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIGNyZWF0ZShzdHJ1Y3R1cmUpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiR0RTQm94X2NyZWF0ZShzdHJ1Y3R1cmUpCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIGRlc3Ryb3koYm94KToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkdEU0JveF9kZXN0cm95KGJveCkKCiAgICBkZWYgX19pbml0X18oc2VsZik6CiAgICAgICAgX29kYl9weS5kYkdEU0JveF9zd2lnaW5pdChzZWxmLCBfb2RiX3B5Lm5ld19kYkdEU0JveCgpKQogICAgX19zd2lnX2Rlc3Ryb3lfXyA9IF9vZGJfcHkuZGVsZXRlX2RiR0RTQm94CgojIFJlZ2lzdGVyIGRiR0RTQm94IGluIF9vZGJfcHk6Cl9vZGJfcHkuZGJHRFNCb3hfc3dpZ3JlZ2lzdGVyKGRiR0RTQm94KQoKZGVmIGRiR0RTQm94X2NyZWF0ZShzdHJ1Y3R1cmUpOgogICAgcmV0dXJuIF9vZGJfcHkuZGJHRFNCb3hfY3JlYXRlKHN0cnVjdHVyZSkKCmRlZiBkYkdEU0JveF9kZXN0cm95KGJveCk6CiAgICByZXR1cm4gX29kYl9weS5kYkdEU0JveF9kZXN0cm95KGJveCkKCmNsYXNzIGRiR0RTUGF0aChvYmplY3QpOgogICAgdGhpc293biA9IHByb3BlcnR5KGxhbWJkYSB4OiB4LnRoaXMub3duKCksIGxhbWJkYSB4LCB2OiB4LnRoaXMub3duKHYpLCBkb2M9J1RoZSBtZW1iZXJzaGlwIGZsYWcnKQogICAgX19yZXByX18gPSBfc3dpZ19yZXByCgogICAgZGVmIHNldExheWVyKHNlbGYsIGxheWVyKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkdEU1BhdGhfc2V0TGF5ZXIoc2VsZiwgbGF5ZXIpCgogICAgZGVmIGdldExheWVyKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiR0RTUGF0aF9nZXRMYXllcihzZWxmKQoKICAgIGRlZiBzZXREYXRhdHlwZShzZWxmLCBkYXRhdHlwZSk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJHRFNQYXRoX3NldERhdGF0eXBlKHNlbGYsIGRhdGF0eXBlKQoKICAgIGRlZiBnZXREYXRhdHlwZShzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkdEU1BhdGhfZ2V0RGF0YXR5cGUoc2VsZikKCiAgICBkZWYgc2V0WHkoc2VsZiwgeHkpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiR0RTUGF0aF9zZXRYeShzZWxmLCB4eSkKCiAgICBkZWYgZ2V0WHkoc2VsZiwgdGJsKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkdEU1BhdGhfZ2V0WHkoc2VsZiwgdGJsKQoKICAgIGRlZiBzZXRXaWR0aChzZWxmLCB3aWR0aCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJHRFNQYXRoX3NldFdpZHRoKHNlbGYsIHdpZHRoKQoKICAgIGRlZiBnZXRXaWR0aChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkdEU1BhdGhfZ2V0V2lkdGgoc2VsZikKCiAgICBkZWYgc2V0UGF0aFR5cGUoc2VsZiwgcGF0aF90eXBlKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkdEU1BhdGhfc2V0UGF0aFR5cGUoc2VsZiwgcGF0aF90eXBlKQoKICAgIGRlZiBnZXRQYXRoVHlwZShzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkdEU1BhdGhfZ2V0UGF0aFR5cGUoc2VsZikKCiAgICBkZWYgZ2V0WFkoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJHRFNQYXRoX2dldFhZKHNlbGYpCgogICAgZGVmIGdldFByb3BhdHRyKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiR0RTUGF0aF9nZXRQcm9wYXR0cihzZWxmKQoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBjcmVhdGUoc3RydWN0dXJlKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkdEU1BhdGhfY3JlYXRlKHN0cnVjdHVyZSkKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgZGVzdHJveShwYXRoKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkdEU1BhdGhfZGVzdHJveShwYXRoKQoKICAgIGRlZiBfX2luaXRfXyhzZWxmKToKICAgICAgICBfb2RiX3B5LmRiR0RTUGF0aF9zd2lnaW5pdChzZWxmLCBfb2RiX3B5Lm5ld19kYkdEU1BhdGgoKSkKICAgIF9fc3dpZ19kZXN0cm95X18gPSBfb2RiX3B5LmRlbGV0ZV9kYkdEU1BhdGgKCiMgUmVnaXN0ZXIgZGJHRFNQYXRoIGluIF9vZGJfcHk6Cl9vZGJfcHkuZGJHRFNQYXRoX3N3aWdyZWdpc3RlcihkYkdEU1BhdGgpCgpkZWYgZGJHRFNQYXRoX2NyZWF0ZShzdHJ1Y3R1cmUpOgogICAgcmV0dXJuIF9vZGJfcHkuZGJHRFNQYXRoX2NyZWF0ZShzdHJ1Y3R1cmUpCgpkZWYgZGJHRFNQYXRoX2Rlc3Ryb3kocGF0aCk6CiAgICByZXR1cm4gX29kYl9weS5kYkdEU1BhdGhfZGVzdHJveShwYXRoKQoKY2xhc3MgZGJHRFNTUmVmKG9iamVjdCk6CiAgICB0aGlzb3duID0gcHJvcGVydHkobGFtYmRhIHg6IHgudGhpcy5vd24oKSwgbGFtYmRhIHgsIHY6IHgudGhpcy5vd24odiksIGRvYz0nVGhlIG1lbWJlcnNoaXAgZmxhZycpCiAgICBfX3JlcHJfXyA9IF9zd2lnX3JlcHIKCiAgICBkZWYgc2V0T3JpZ2luKHNlbGYsIG9yaWdpbik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJHRFNTUmVmX3NldE9yaWdpbihzZWxmLCBvcmlnaW4pCgogICAgZGVmIGdldE9yaWdpbihzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkdEU1NSZWZfZ2V0T3JpZ2luKHNlbGYpCgogICAgZGVmIHNldFRyYW5zZm9ybShzZWxmLCB0cmFuc2Zvcm0pOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiR0RTU1JlZl9zZXRUcmFuc2Zvcm0oc2VsZiwgdHJhbnNmb3JtKQoKICAgIGRlZiBnZXRUcmFuc2Zvcm0oc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJHRFNTUmVmX2dldFRyYW5zZm9ybShzZWxmKQoKICAgIGRlZiBnZXRTdHJ1Y3R1cmUoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJHRFNTUmVmX2dldFN0cnVjdHVyZShzZWxmKQoKICAgIGRlZiBnZXRQcm9wYXR0cihzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkdEU1NSZWZfZ2V0UHJvcGF0dHIoc2VsZikKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgY3JlYXRlKHBhcmVudCwgY2hpbGQpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiR0RTU1JlZl9jcmVhdGUocGFyZW50LCBjaGlsZCkKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgZGVzdHJveShzcmVmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkdEU1NSZWZfZGVzdHJveShzcmVmKQoKICAgIGRlZiBfX2luaXRfXyhzZWxmKToKICAgICAgICBfb2RiX3B5LmRiR0RTU1JlZl9zd2lnaW5pdChzZWxmLCBfb2RiX3B5Lm5ld19kYkdEU1NSZWYoKSkKICAgIF9fc3dpZ19kZXN0cm95X18gPSBfb2RiX3B5LmRlbGV0ZV9kYkdEU1NSZWYKCiMgUmVnaXN0ZXIgZGJHRFNTUmVmIGluIF9vZGJfcHk6Cl9vZGJfcHkuZGJHRFNTUmVmX3N3aWdyZWdpc3RlcihkYkdEU1NSZWYpCgpkZWYgZGJHRFNTUmVmX2NyZWF0ZShwYXJlbnQsIGNoaWxkKToKICAgIHJldHVybiBfb2RiX3B5LmRiR0RTU1JlZl9jcmVhdGUocGFyZW50LCBjaGlsZCkKCmRlZiBkYkdEU1NSZWZfZGVzdHJveShzcmVmKToKICAgIHJldHVybiBfb2RiX3B5LmRiR0RTU1JlZl9kZXN0cm95KHNyZWYpCgpjbGFzcyBkYkdEU1N0cnVjdHVyZShvYmplY3QpOgogICAgdGhpc293biA9IHByb3BlcnR5KGxhbWJkYSB4OiB4LnRoaXMub3duKCksIGxhbWJkYSB4LCB2OiB4LnRoaXMub3duKHYpLCBkb2M9J1RoZSBtZW1iZXJzaGlwIGZsYWcnKQogICAgX19yZXByX18gPSBfc3dpZ19yZXByCgogICAgZGVmIGdldE5hbWUoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJHRFNTdHJ1Y3R1cmVfZ2V0TmFtZShzZWxmKQoKICAgIGRlZiBnZXRHRFNCb3VuZGFyaWVzKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiR0RTU3RydWN0dXJlX2dldEdEU0JvdW5kYXJpZXMoc2VsZikKCiAgICBkZWYgZ2V0R0RTQm94cyhzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkdEU1N0cnVjdHVyZV9nZXRHRFNCb3hzKHNlbGYpCgogICAgZGVmIGdldEdEU1BhdGhzKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiR0RTU3RydWN0dXJlX2dldEdEU1BhdGhzKHNlbGYpCgogICAgZGVmIGdldEdEU1NSZWZzKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiR0RTU3RydWN0dXJlX2dldEdEU1NSZWZzKHNlbGYpCgogICAgZGVmIGdldEdEU0FSZWZzKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiR0RTU3RydWN0dXJlX2dldEdEU0FSZWZzKHNlbGYpCgogICAgZGVmIGdldEdEU1RleHRzKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiR0RTU3RydWN0dXJlX2dldEdEU1RleHRzKHNlbGYpCgogICAgZGVmIGdldEdEU0xpYihzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkdEU1N0cnVjdHVyZV9nZXRHRFNMaWIoc2VsZikKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgY3JlYXRlKGxpYiwgbmFtZSk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJHRFNTdHJ1Y3R1cmVfY3JlYXRlKGxpYiwgbmFtZSkKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgZGVzdHJveShzdHJ1Y3R1cmUpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiR0RTU3RydWN0dXJlX2Rlc3Ryb3koc3RydWN0dXJlKQoKICAgIGRlZiBfX2luaXRfXyhzZWxmKToKICAgICAgICBfb2RiX3B5LmRiR0RTU3RydWN0dXJlX3N3aWdpbml0KHNlbGYsIF9vZGJfcHkubmV3X2RiR0RTU3RydWN0dXJlKCkpCiAgICBfX3N3aWdfZGVzdHJveV9fID0gX29kYl9weS5kZWxldGVfZGJHRFNTdHJ1Y3R1cmUKCiMgUmVnaXN0ZXIgZGJHRFNTdHJ1Y3R1cmUgaW4gX29kYl9weToKX29kYl9weS5kYkdEU1N0cnVjdHVyZV9zd2lncmVnaXN0ZXIoZGJHRFNTdHJ1Y3R1cmUpCgpkZWYgZGJHRFNTdHJ1Y3R1cmVfY3JlYXRlKGxpYiwgbmFtZSk6CiAgICByZXR1cm4gX29kYl9weS5kYkdEU1N0cnVjdHVyZV9jcmVhdGUobGliLCBuYW1lKQoKZGVmIGRiR0RTU3RydWN0dXJlX2Rlc3Ryb3koc3RydWN0dXJlKToKICAgIHJldHVybiBfb2RiX3B5LmRiR0RTU3RydWN0dXJlX2Rlc3Ryb3koc3RydWN0dXJlKQoKY2xhc3MgZGJHRFNUZXh0KG9iamVjdCk6CiAgICB0aGlzb3duID0gcHJvcGVydHkobGFtYmRhIHg6IHgudGhpcy5vd24oKSwgbGFtYmRhIHgsIHY6IHgudGhpcy5vd24odiksIGRvYz0nVGhlIG1lbWJlcnNoaXAgZmxhZycpCiAgICBfX3JlcHJfXyA9IF9zd2lnX3JlcHIKCiAgICBkZWYgc2V0TGF5ZXIoc2VsZiwgbGF5ZXIpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiR0RTVGV4dF9zZXRMYXllcihzZWxmLCBsYXllcikKCiAgICBkZWYgZ2V0TGF5ZXIoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJHRFNUZXh0X2dldExheWVyKHNlbGYpCgogICAgZGVmIHNldERhdGF0eXBlKHNlbGYsIGRhdGF0eXBlKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkdEU1RleHRfc2V0RGF0YXR5cGUoc2VsZiwgZGF0YXR5cGUpCgogICAgZGVmIGdldERhdGF0eXBlKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiR0RTVGV4dF9nZXREYXRhdHlwZShzZWxmKQoKICAgIGRlZiBzZXRPcmlnaW4oc2VsZiwgb3JpZ2luKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkdEU1RleHRfc2V0T3JpZ2luKHNlbGYsIG9yaWdpbikKCiAgICBkZWYgZ2V0T3JpZ2luKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiR0RTVGV4dF9nZXRPcmlnaW4oc2VsZikKCiAgICBkZWYgc2V0UHJlc2VudGF0aW9uKHNlbGYsIHByZXNlbnRhdGlvbik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJHRFNUZXh0X3NldFByZXNlbnRhdGlvbihzZWxmLCBwcmVzZW50YXRpb24pCgogICAgZGVmIGdldFByZXNlbnRhdGlvbihzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkdEU1RleHRfZ2V0UHJlc2VudGF0aW9uKHNlbGYpCgogICAgZGVmIHNldFRyYW5zZm9ybShzZWxmLCB0cmFuc2Zvcm0pOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiR0RTVGV4dF9zZXRUcmFuc2Zvcm0oc2VsZiwgdHJhbnNmb3JtKQoKICAgIGRlZiBnZXRUcmFuc2Zvcm0oc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJHRFNUZXh0X2dldFRyYW5zZm9ybShzZWxmKQoKICAgIGRlZiBzZXRUZXh0KHNlbGYsIHRleHQpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiR0RTVGV4dF9zZXRUZXh0KHNlbGYsIHRleHQpCgogICAgZGVmIGdldFRleHQoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJHRFNUZXh0X2dldFRleHQoc2VsZikKCiAgICBkZWYgZ2V0UHJvcGF0dHIoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJHRFNUZXh0X2dldFByb3BhdHRyKHNlbGYpCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIGNyZWF0ZShzdHJ1Y3R1cmUpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiR0RTVGV4dF9jcmVhdGUoc3RydWN0dXJlKQoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBkZXN0cm95KHRleHQpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiR0RTVGV4dF9kZXN0cm95KHRleHQpCgogICAgZGVmIF9faW5pdF9fKHNlbGYpOgogICAgICAgIF9vZGJfcHkuZGJHRFNUZXh0X3N3aWdpbml0KHNlbGYsIF9vZGJfcHkubmV3X2RiR0RTVGV4dCgpKQogICAgX19zd2lnX2Rlc3Ryb3lfXyA9IF9vZGJfcHkuZGVsZXRlX2RiR0RTVGV4dAoKIyBSZWdpc3RlciBkYkdEU1RleHQgaW4gX29kYl9weToKX29kYl9weS5kYkdEU1RleHRfc3dpZ3JlZ2lzdGVyKGRiR0RTVGV4dCkKCmRlZiBkYkdEU1RleHRfY3JlYXRlKHN0cnVjdHVyZSk6CiAgICByZXR1cm4gX29kYl9weS5kYkdEU1RleHRfY3JlYXRlKHN0cnVjdHVyZSkKCmRlZiBkYkdEU1RleHRfZGVzdHJveSh0ZXh0KToKICAgIHJldHVybiBfb2RiX3B5LmRiR0RTVGV4dF9kZXN0cm95KHRleHQpCgpjbGFzcyBkYkdsb2JhbENvbm5lY3Qob2JqZWN0KToKICAgIHRoaXNvd24gPSBwcm9wZXJ0eShsYW1iZGEgeDogeC50aGlzLm93bigpLCBsYW1iZGEgeCwgdjogeC50aGlzLm93bih2KSwgZG9jPSdUaGUgbWVtYmVyc2hpcCBmbGFnJykKICAgIF9fcmVwcl9fID0gX3N3aWdfcmVwcgoKICAgIGRlZiBnZXRSZWdpb24oc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJHbG9iYWxDb25uZWN0X2dldFJlZ2lvbihzZWxmKQoKICAgIGRlZiBnZXROZXQoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJHbG9iYWxDb25uZWN0X2dldE5ldChzZWxmKQoKICAgIGRlZiBnZXRJbnN0UGF0dGVybihzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkdsb2JhbENvbm5lY3RfZ2V0SW5zdFBhdHRlcm4oc2VsZikKCiAgICBkZWYgZ2V0UGluUGF0dGVybihzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkdsb2JhbENvbm5lY3RfZ2V0UGluUGF0dGVybihzZWxmKQoKICAgIGRlZiBnZXRJbnN0cyhzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkdsb2JhbENvbm5lY3RfZ2V0SW5zdHMoc2VsZikKCiAgICBkZWYgY29ubmVjdChzZWxmLCBpbnN0KToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkdsb2JhbENvbm5lY3RfY29ubmVjdChzZWxmLCBpbnN0KQoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBjcmVhdGUobmV0LCByZWdpb24sIGluc3RfcGF0dGVybiwgcGluX3BhdHRlcm4pOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiR2xvYmFsQ29ubmVjdF9jcmVhdGUobmV0LCByZWdpb24sIGluc3RfcGF0dGVybiwgcGluX3BhdHRlcm4pCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIGRlc3Ryb3koKmFyZ3MpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiR2xvYmFsQ29ubmVjdF9kZXN0cm95KCphcmdzKQoKICAgIGRlZiBfX2luaXRfXyhzZWxmKToKICAgICAgICBfb2RiX3B5LmRiR2xvYmFsQ29ubmVjdF9zd2lnaW5pdChzZWxmLCBfb2RiX3B5Lm5ld19kYkdsb2JhbENvbm5lY3QoKSkKICAgIF9fc3dpZ19kZXN0cm95X18gPSBfb2RiX3B5LmRlbGV0ZV9kYkdsb2JhbENvbm5lY3QKCiMgUmVnaXN0ZXIgZGJHbG9iYWxDb25uZWN0IGluIF9vZGJfcHk6Cl9vZGJfcHkuZGJHbG9iYWxDb25uZWN0X3N3aWdyZWdpc3RlcihkYkdsb2JhbENvbm5lY3QpCgpkZWYgZGJHbG9iYWxDb25uZWN0X2NyZWF0ZShuZXQsIHJlZ2lvbiwgaW5zdF9wYXR0ZXJuLCBwaW5fcGF0dGVybik6CiAgICByZXR1cm4gX29kYl9weS5kYkdsb2JhbENvbm5lY3RfY3JlYXRlKG5ldCwgcmVnaW9uLCBpbnN0X3BhdHRlcm4sIHBpbl9wYXR0ZXJuKQoKZGVmIGRiR2xvYmFsQ29ubmVjdF9kZXN0cm95KCphcmdzKToKICAgIHJldHVybiBfb2RiX3B5LmRiR2xvYmFsQ29ubmVjdF9kZXN0cm95KCphcmdzKQoKY2xhc3MgZGJHcm91cChvYmplY3QpOgogICAgdGhpc293biA9IHByb3BlcnR5KGxhbWJkYSB4OiB4LnRoaXMub3duKCksIGxhbWJkYSB4LCB2OiB4LnRoaXMub3duKHYpLCBkb2M9J1RoZSBtZW1iZXJzaGlwIGZsYWcnKQogICAgX19yZXByX18gPSBfc3dpZ19yZXByCgogICAgZGVmIGdldE5hbWUoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJHcm91cF9nZXROYW1lKHNlbGYpCgogICAgZGVmIGdldFBhcmVudEdyb3VwKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiR3JvdXBfZ2V0UGFyZW50R3JvdXAoc2VsZikKCiAgICBkZWYgZ2V0UmVnaW9uKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiR3JvdXBfZ2V0UmVnaW9uKHNlbGYpCgogICAgZGVmIHNldFR5cGUoc2VsZiwgdHlwZSk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJHcm91cF9zZXRUeXBlKHNlbGYsIHR5cGUpCgogICAgZGVmIGdldFR5cGUoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJHcm91cF9nZXRUeXBlKHNlbGYpCgogICAgZGVmIGFkZE1vZEluc3Qoc2VsZiwgbW9kaW5zdCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJHcm91cF9hZGRNb2RJbnN0KHNlbGYsIG1vZGluc3QpCgogICAgZGVmIHJlbW92ZU1vZEluc3Qoc2VsZiwgbW9kaW5zdCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJHcm91cF9yZW1vdmVNb2RJbnN0KHNlbGYsIG1vZGluc3QpCgogICAgZGVmIGdldE1vZEluc3RzKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiR3JvdXBfZ2V0TW9kSW5zdHMoc2VsZikKCiAgICBkZWYgYWRkSW5zdChzZWxmLCBpbnN0KToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkdyb3VwX2FkZEluc3Qoc2VsZiwgaW5zdCkKCiAgICBkZWYgcmVtb3ZlSW5zdChzZWxmLCBpbnN0KToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkdyb3VwX3JlbW92ZUluc3Qoc2VsZiwgaW5zdCkKCiAgICBkZWYgZ2V0SW5zdHMoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJHcm91cF9nZXRJbnN0cyhzZWxmKQoKICAgIGRlZiBhZGRHcm91cChzZWxmLCBncm91cCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJHcm91cF9hZGRHcm91cChzZWxmLCBncm91cCkKCiAgICBkZWYgcmVtb3ZlR3JvdXAoc2VsZiwgZ3JvdXApOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiR3JvdXBfcmVtb3ZlR3JvdXAoc2VsZiwgZ3JvdXApCgogICAgZGVmIGdldEdyb3VwcyhzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkdyb3VwX2dldEdyb3VwcyhzZWxmKQoKICAgIGRlZiBhZGRQb3dlck5ldChzZWxmLCBuZXQpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiR3JvdXBfYWRkUG93ZXJOZXQoc2VsZiwgbmV0KQoKICAgIGRlZiBhZGRHcm91bmROZXQoc2VsZiwgbmV0KToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkdyb3VwX2FkZEdyb3VuZE5ldChzZWxmLCBuZXQpCgogICAgZGVmIHJlbW92ZU5ldChzZWxmLCBuZXQpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiR3JvdXBfcmVtb3ZlTmV0KHNlbGYsIG5ldCkKCiAgICBkZWYgZ2V0UG93ZXJOZXRzKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiR3JvdXBfZ2V0UG93ZXJOZXRzKHNlbGYpCgogICAgZGVmIGdldEdyb3VuZE5ldHMoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJHcm91cF9nZXRHcm91bmROZXRzKHNlbGYpCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIGNyZWF0ZSgqYXJncyk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJHcm91cF9jcmVhdGUoKmFyZ3MpCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIGRlc3Ryb3koZ3JvdXApOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiR3JvdXBfZGVzdHJveShncm91cCkKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgZ2V0R3JvdXAoYmxvY2tfLCBkYmlkXyk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJHcm91cF9nZXRHcm91cChibG9ja18sIGRiaWRfKQoKICAgIGRlZiBfX2luaXRfXyhzZWxmKToKICAgICAgICBfb2RiX3B5LmRiR3JvdXBfc3dpZ2luaXQoc2VsZiwgX29kYl9weS5uZXdfZGJHcm91cCgpKQogICAgX19zd2lnX2Rlc3Ryb3lfXyA9IF9vZGJfcHkuZGVsZXRlX2RiR3JvdXAKCiMgUmVnaXN0ZXIgZGJHcm91cCBpbiBfb2RiX3B5Ogpfb2RiX3B5LmRiR3JvdXBfc3dpZ3JlZ2lzdGVyKGRiR3JvdXApCgpkZWYgZGJHcm91cF9jcmVhdGUoKmFyZ3MpOgogICAgcmV0dXJuIF9vZGJfcHkuZGJHcm91cF9jcmVhdGUoKmFyZ3MpCgpkZWYgZGJHcm91cF9kZXN0cm95KGdyb3VwKToKICAgIHJldHVybiBfb2RiX3B5LmRiR3JvdXBfZGVzdHJveShncm91cCkKCmRlZiBkYkdyb3VwX2dldEdyb3VwKGJsb2NrXywgZGJpZF8pOgogICAgcmV0dXJuIF9vZGJfcHkuZGJHcm91cF9nZXRHcm91cChibG9ja18sIGRiaWRfKQoKY2xhc3MgZGJHdWlkZShvYmplY3QpOgogICAgdGhpc293biA9IHByb3BlcnR5KGxhbWJkYSB4OiB4LnRoaXMub3duKCksIGxhbWJkYSB4LCB2OiB4LnRoaXMub3duKHYpLCBkb2M9J1RoZSBtZW1iZXJzaGlwIGZsYWcnKQogICAgX19yZXByX18gPSBfc3dpZ19yZXByCgogICAgZGVmIGdldEJveChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkd1aWRlX2dldEJveChzZWxmKQoKICAgIGRlZiBnZXROZXQoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJHdWlkZV9nZXROZXQoc2VsZikKCiAgICBkZWYgZ2V0TGF5ZXIoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJHdWlkZV9nZXRMYXllcihzZWxmKQoKICAgIGRlZiBnZXRWaWFMYXllcihzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkd1aWRlX2dldFZpYUxheWVyKHNlbGYpCgogICAgZGVmIGlzQ29uZ2VzdGVkKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiR3VpZGVfaXNDb25nZXN0ZWQoc2VsZikKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgY3JlYXRlKG5ldCwgbGF5ZXIsIHZpYV9sYXllciwgYm94LCBpc19jb25nZXN0ZWQpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiR3VpZGVfY3JlYXRlKG5ldCwgbGF5ZXIsIHZpYV9sYXllciwgYm94LCBpc19jb25nZXN0ZWQpCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIGdldEd1aWRlKGJsb2NrLCBkYmlkKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkd1aWRlX2dldEd1aWRlKGJsb2NrLCBkYmlkKQoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBkZXN0cm95KCphcmdzKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkd1aWRlX2Rlc3Ryb3koKmFyZ3MpCgogICAgZGVmIGlzSnVtcGVyKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiR3VpZGVfaXNKdW1wZXIoc2VsZikKCiAgICBkZWYgc2V0SXNKdW1wZXIoc2VsZiwganVtcGVyKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkd1aWRlX3NldElzSnVtcGVyKHNlbGYsIGp1bXBlcikKCiAgICBkZWYgaXNDb25uZWN0ZWRUb1Rlcm0oc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJHdWlkZV9pc0Nvbm5lY3RlZFRvVGVybShzZWxmKQoKICAgIGRlZiBzZXRJc0Nvbm5lY3RlZFRvVGVybShzZWxmLCBpc19jb25uZWN0ZWQpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiR3VpZGVfc2V0SXNDb25uZWN0ZWRUb1Rlcm0oc2VsZiwgaXNfY29ubmVjdGVkKQoKICAgIGRlZiBfX2luaXRfXyhzZWxmKToKICAgICAgICBfb2RiX3B5LmRiR3VpZGVfc3dpZ2luaXQoc2VsZiwgX29kYl9weS5uZXdfZGJHdWlkZSgpKQogICAgX19zd2lnX2Rlc3Ryb3lfXyA9IF9vZGJfcHkuZGVsZXRlX2RiR3VpZGUKCiMgUmVnaXN0ZXIgZGJHdWlkZSBpbiBfb2RiX3B5Ogpfb2RiX3B5LmRiR3VpZGVfc3dpZ3JlZ2lzdGVyKGRiR3VpZGUpCgpkZWYgZGJHdWlkZV9jcmVhdGUobmV0LCBsYXllciwgdmlhX2xheWVyLCBib3gsIGlzX2Nvbmdlc3RlZCk6CiAgICByZXR1cm4gX29kYl9weS5kYkd1aWRlX2NyZWF0ZShuZXQsIGxheWVyLCB2aWFfbGF5ZXIsIGJveCwgaXNfY29uZ2VzdGVkKQoKZGVmIGRiR3VpZGVfZ2V0R3VpZGUoYmxvY2ssIGRiaWQpOgogICAgcmV0dXJuIF9vZGJfcHkuZGJHdWlkZV9nZXRHdWlkZShibG9jaywgZGJpZCkKCmRlZiBkYkd1aWRlX2Rlc3Ryb3koKmFyZ3MpOgogICAgcmV0dXJuIF9vZGJfcHkuZGJHdWlkZV9kZXN0cm95KCphcmdzKQoKY2xhc3MgZGJJc29sYXRpb24ob2JqZWN0KToKICAgIHRoaXNvd24gPSBwcm9wZXJ0eShsYW1iZGEgeDogeC50aGlzLm93bigpLCBsYW1iZGEgeCwgdjogeC50aGlzLm93bih2KSwgZG9jPSdUaGUgbWVtYmVyc2hpcCBmbGFnJykKICAgIF9fcmVwcl9fID0gX3N3aWdfcmVwcgoKICAgIGRlZiBnZXROYW1lKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiSXNvbGF0aW9uX2dldE5hbWUoc2VsZikKCiAgICBkZWYgZ2V0QXBwbGllc1RvKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiSXNvbGF0aW9uX2dldEFwcGxpZXNUbyhzZWxmKQoKICAgIGRlZiBnZXRDbGFtcFZhbHVlKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiSXNvbGF0aW9uX2dldENsYW1wVmFsdWUoc2VsZikKCiAgICBkZWYgZ2V0SXNvbGF0aW9uU2lnbmFsKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiSXNvbGF0aW9uX2dldElzb2xhdGlvblNpZ25hbChzZWxmKQoKICAgIGRlZiBnZXRJc29sYXRpb25TZW5zZShzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYklzb2xhdGlvbl9nZXRJc29sYXRpb25TZW5zZShzZWxmKQoKICAgIGRlZiBnZXRMb2NhdGlvbihzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYklzb2xhdGlvbl9nZXRMb2NhdGlvbihzZWxmKQoKICAgIGRlZiBzZXRQb3dlckRvbWFpbihzZWxmLCBwb3dlcl9kb21haW4pOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiSXNvbGF0aW9uX3NldFBvd2VyRG9tYWluKHNlbGYsIHBvd2VyX2RvbWFpbikKCiAgICBkZWYgZ2V0UG93ZXJEb21haW4oc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJJc29sYXRpb25fZ2V0UG93ZXJEb21haW4oc2VsZikKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgY3JlYXRlKGJsb2NrLCBuYW1lKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYklzb2xhdGlvbl9jcmVhdGUoYmxvY2ssIG5hbWUpCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIGRlc3Ryb3koaXNvKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYklzb2xhdGlvbl9kZXN0cm95KGlzbykKCiAgICBkZWYgc2V0QXBwbGllc1RvKHNlbGYsIGFwcGxpZXNfdG8pOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiSXNvbGF0aW9uX3NldEFwcGxpZXNUbyhzZWxmLCBhcHBsaWVzX3RvKQoKICAgIGRlZiBzZXRDbGFtcFZhbHVlKHNlbGYsIGNsYW1wX3ZhbHVlKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYklzb2xhdGlvbl9zZXRDbGFtcFZhbHVlKHNlbGYsIGNsYW1wX3ZhbHVlKQoKICAgIGRlZiBzZXRJc29sYXRpb25TaWduYWwoc2VsZiwgaXNvbGF0aW9uX3NpZ25hbCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJJc29sYXRpb25fc2V0SXNvbGF0aW9uU2lnbmFsKHNlbGYsIGlzb2xhdGlvbl9zaWduYWwpCgogICAgZGVmIHNldElzb2xhdGlvblNlbnNlKHNlbGYsIGlzb2xhdGlvbl9zZW5zZSk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJJc29sYXRpb25fc2V0SXNvbGF0aW9uU2Vuc2Uoc2VsZiwgaXNvbGF0aW9uX3NlbnNlKQoKICAgIGRlZiBzZXRMb2NhdGlvbihzZWxmLCBsb2NhdGlvbik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJJc29sYXRpb25fc2V0TG9jYXRpb24oc2VsZiwgbG9jYXRpb24pCgogICAgZGVmIGFkZElzb2xhdGlvbkNlbGwoc2VsZiwgbWFzdGVyKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYklzb2xhdGlvbl9hZGRJc29sYXRpb25DZWxsKHNlbGYsIG1hc3RlcikKCiAgICBkZWYgZ2V0SXNvbGF0aW9uQ2VsbHMoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJJc29sYXRpb25fZ2V0SXNvbGF0aW9uQ2VsbHMoc2VsZikKCiAgICBkZWYgYXBwbGllc1RvKHNlbGYsIGlvKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYklzb2xhdGlvbl9hcHBsaWVzVG8oc2VsZiwgaW8pCgogICAgZGVmIF9faW5pdF9fKHNlbGYpOgogICAgICAgIF9vZGJfcHkuZGJJc29sYXRpb25fc3dpZ2luaXQoc2VsZiwgX29kYl9weS5uZXdfZGJJc29sYXRpb24oKSkKICAgIF9fc3dpZ19kZXN0cm95X18gPSBfb2RiX3B5LmRlbGV0ZV9kYklzb2xhdGlvbgoKIyBSZWdpc3RlciBkYklzb2xhdGlvbiBpbiBfb2RiX3B5Ogpfb2RiX3B5LmRiSXNvbGF0aW9uX3N3aWdyZWdpc3RlcihkYklzb2xhdGlvbikKCmRlZiBkYklzb2xhdGlvbl9jcmVhdGUoYmxvY2ssIG5hbWUpOgogICAgcmV0dXJuIF9vZGJfcHkuZGJJc29sYXRpb25fY3JlYXRlKGJsb2NrLCBuYW1lKQoKZGVmIGRiSXNvbGF0aW9uX2Rlc3Ryb3koaXNvKToKICAgIHJldHVybiBfb2RiX3B5LmRiSXNvbGF0aW9uX2Rlc3Ryb3koaXNvKQoKY2xhc3MgZGJMZXZlbFNoaWZ0ZXIob2JqZWN0KToKICAgIHRoaXNvd24gPSBwcm9wZXJ0eShsYW1iZGEgeDogeC50aGlzLm93bigpLCBsYW1iZGEgeCwgdjogeC50aGlzLm93bih2KSwgZG9jPSdUaGUgbWVtYmVyc2hpcCBmbGFnJykKICAgIF9fcmVwcl9fID0gX3N3aWdfcmVwcgoKICAgIGRlZiBnZXROYW1lKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTGV2ZWxTaGlmdGVyX2dldE5hbWUoc2VsZikKCiAgICBkZWYgZ2V0RG9tYWluKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTGV2ZWxTaGlmdGVyX2dldERvbWFpbihzZWxmKQoKICAgIGRlZiBzZXRTb3VyY2Uoc2VsZiwgc291cmNlKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkxldmVsU2hpZnRlcl9zZXRTb3VyY2Uoc2VsZiwgc291cmNlKQoKICAgIGRlZiBnZXRTb3VyY2Uoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJMZXZlbFNoaWZ0ZXJfZ2V0U291cmNlKHNlbGYpCgogICAgZGVmIHNldFNpbmsoc2VsZiwgc2luayk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJMZXZlbFNoaWZ0ZXJfc2V0U2luayhzZWxmLCBzaW5rKQoKICAgIGRlZiBnZXRTaW5rKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTGV2ZWxTaGlmdGVyX2dldFNpbmsoc2VsZikKCiAgICBkZWYgc2V0VXNlRnVuY3Rpb25hbEVxdWl2YWxlbmNlKHNlbGYsIHVzZV9mdW5jdGlvbmFsX2VxdWl2YWxlbmNlKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkxldmVsU2hpZnRlcl9zZXRVc2VGdW5jdGlvbmFsRXF1aXZhbGVuY2Uoc2VsZiwgdXNlX2Z1bmN0aW9uYWxfZXF1aXZhbGVuY2UpCgogICAgZGVmIGlzVXNlRnVuY3Rpb25hbEVxdWl2YWxlbmNlKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTGV2ZWxTaGlmdGVyX2lzVXNlRnVuY3Rpb25hbEVxdWl2YWxlbmNlKHNlbGYpCgogICAgZGVmIHNldEFwcGxpZXNUbyhzZWxmLCBhcHBsaWVzX3RvKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkxldmVsU2hpZnRlcl9zZXRBcHBsaWVzVG8oc2VsZiwgYXBwbGllc190bykKCiAgICBkZWYgZ2V0QXBwbGllc1RvKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTGV2ZWxTaGlmdGVyX2dldEFwcGxpZXNUbyhzZWxmKQoKICAgIGRlZiBzZXRBcHBsaWVzVG9Cb3VuZGFyeShzZWxmLCBhcHBsaWVzX3RvX2JvdW5kYXJ5KToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkxldmVsU2hpZnRlcl9zZXRBcHBsaWVzVG9Cb3VuZGFyeShzZWxmLCBhcHBsaWVzX3RvX2JvdW5kYXJ5KQoKICAgIGRlZiBnZXRBcHBsaWVzVG9Cb3VuZGFyeShzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkxldmVsU2hpZnRlcl9nZXRBcHBsaWVzVG9Cb3VuZGFyeShzZWxmKQoKICAgIGRlZiBzZXRSdWxlKHNlbGYsIHJ1bGUpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTGV2ZWxTaGlmdGVyX3NldFJ1bGUoc2VsZiwgcnVsZSkKCiAgICBkZWYgZ2V0UnVsZShzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkxldmVsU2hpZnRlcl9nZXRSdWxlKHNlbGYpCgogICAgZGVmIHNldFRocmVzaG9sZChzZWxmLCB0aHJlc2hvbGQpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTGV2ZWxTaGlmdGVyX3NldFRocmVzaG9sZChzZWxmLCB0aHJlc2hvbGQpCgogICAgZGVmIGdldFRocmVzaG9sZChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkxldmVsU2hpZnRlcl9nZXRUaHJlc2hvbGQoc2VsZikKCiAgICBkZWYgc2V0Tm9TaGlmdChzZWxmLCBub19zaGlmdCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJMZXZlbFNoaWZ0ZXJfc2V0Tm9TaGlmdChzZWxmLCBub19zaGlmdCkKCiAgICBkZWYgaXNOb1NoaWZ0KHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTGV2ZWxTaGlmdGVyX2lzTm9TaGlmdChzZWxmKQoKICAgIGRlZiBzZXRGb3JjZVNoaWZ0KHNlbGYsIGZvcmNlX3NoaWZ0KToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkxldmVsU2hpZnRlcl9zZXRGb3JjZVNoaWZ0KHNlbGYsIGZvcmNlX3NoaWZ0KQoKICAgIGRlZiBpc0ZvcmNlU2hpZnQoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJMZXZlbFNoaWZ0ZXJfaXNGb3JjZVNoaWZ0KHNlbGYpCgogICAgZGVmIHNldExvY2F0aW9uKHNlbGYsIGxvY2F0aW9uKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkxldmVsU2hpZnRlcl9zZXRMb2NhdGlvbihzZWxmLCBsb2NhdGlvbikKCiAgICBkZWYgZ2V0TG9jYXRpb24oc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJMZXZlbFNoaWZ0ZXJfZ2V0TG9jYXRpb24oc2VsZikKCiAgICBkZWYgc2V0SW5wdXRTdXBwbHkoc2VsZiwgaW5wdXRfc3VwcGx5KToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkxldmVsU2hpZnRlcl9zZXRJbnB1dFN1cHBseShzZWxmLCBpbnB1dF9zdXBwbHkpCgogICAgZGVmIGdldElucHV0U3VwcGx5KHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTGV2ZWxTaGlmdGVyX2dldElucHV0U3VwcGx5KHNlbGYpCgogICAgZGVmIHNldE91dHB1dFN1cHBseShzZWxmLCBvdXRwdXRfc3VwcGx5KToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkxldmVsU2hpZnRlcl9zZXRPdXRwdXRTdXBwbHkoc2VsZiwgb3V0cHV0X3N1cHBseSkKCiAgICBkZWYgZ2V0T3V0cHV0U3VwcGx5KHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTGV2ZWxTaGlmdGVyX2dldE91dHB1dFN1cHBseShzZWxmKQoKICAgIGRlZiBzZXRJbnRlcm5hbFN1cHBseShzZWxmLCBpbnRlcm5hbF9zdXBwbHkpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTGV2ZWxTaGlmdGVyX3NldEludGVybmFsU3VwcGx5KHNlbGYsIGludGVybmFsX3N1cHBseSkKCiAgICBkZWYgZ2V0SW50ZXJuYWxTdXBwbHkoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJMZXZlbFNoaWZ0ZXJfZ2V0SW50ZXJuYWxTdXBwbHkoc2VsZikKCiAgICBkZWYgc2V0TmFtZVByZWZpeChzZWxmLCBuYW1lX3ByZWZpeCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJMZXZlbFNoaWZ0ZXJfc2V0TmFtZVByZWZpeChzZWxmLCBuYW1lX3ByZWZpeCkKCiAgICBkZWYgZ2V0TmFtZVByZWZpeChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkxldmVsU2hpZnRlcl9nZXROYW1lUHJlZml4KHNlbGYpCgogICAgZGVmIHNldE5hbWVTdWZmaXgoc2VsZiwgbmFtZV9zdWZmaXgpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTGV2ZWxTaGlmdGVyX3NldE5hbWVTdWZmaXgoc2VsZiwgbmFtZV9zdWZmaXgpCgogICAgZGVmIGdldE5hbWVTdWZmaXgoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJMZXZlbFNoaWZ0ZXJfZ2V0TmFtZVN1ZmZpeChzZWxmKQoKICAgIGRlZiBzZXRDZWxsTmFtZShzZWxmLCBjZWxsX25hbWUpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTGV2ZWxTaGlmdGVyX3NldENlbGxOYW1lKHNlbGYsIGNlbGxfbmFtZSkKCiAgICBkZWYgZ2V0Q2VsbE5hbWUoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJMZXZlbFNoaWZ0ZXJfZ2V0Q2VsbE5hbWUoc2VsZikKCiAgICBkZWYgc2V0Q2VsbElucHV0KHNlbGYsIGNlbGxfaW5wdXQpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTGV2ZWxTaGlmdGVyX3NldENlbGxJbnB1dChzZWxmLCBjZWxsX2lucHV0KQoKICAgIGRlZiBnZXRDZWxsSW5wdXQoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJMZXZlbFNoaWZ0ZXJfZ2V0Q2VsbElucHV0KHNlbGYpCgogICAgZGVmIHNldENlbGxPdXRwdXQoc2VsZiwgY2VsbF9vdXRwdXQpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTGV2ZWxTaGlmdGVyX3NldENlbGxPdXRwdXQoc2VsZiwgY2VsbF9vdXRwdXQpCgogICAgZGVmIGdldENlbGxPdXRwdXQoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJMZXZlbFNoaWZ0ZXJfZ2V0Q2VsbE91dHB1dChzZWxmKQoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBjcmVhdGUoYmxvY2ssIG5hbWUsIGRvbWFpbik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJMZXZlbFNoaWZ0ZXJfY3JlYXRlKGJsb2NrLCBuYW1lLCBkb21haW4pCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIGRlc3Ryb3koc2hpZnRlcik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJMZXZlbFNoaWZ0ZXJfZGVzdHJveShzaGlmdGVyKQoKICAgIGRlZiBhZGRFbGVtZW50KHNlbGYsIGVsZW1lbnQpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTGV2ZWxTaGlmdGVyX2FkZEVsZW1lbnQoc2VsZiwgZWxlbWVudCkKCiAgICBkZWYgYWRkRXhjbHVkZUVsZW1lbnQoc2VsZiwgZWxlbWVudCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJMZXZlbFNoaWZ0ZXJfYWRkRXhjbHVkZUVsZW1lbnQoc2VsZiwgZWxlbWVudCkKCiAgICBkZWYgYWRkSW5zdGFuY2Uoc2VsZiwgaW5zdGFuY2UsIHBvcnQpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTGV2ZWxTaGlmdGVyX2FkZEluc3RhbmNlKHNlbGYsIGluc3RhbmNlLCBwb3J0KQoKICAgIGRlZiBnZXRFbGVtZW50cyhzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkxldmVsU2hpZnRlcl9nZXRFbGVtZW50cyhzZWxmKQoKICAgIGRlZiBnZXRFeGNsdWRlRWxlbWVudHMoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJMZXZlbFNoaWZ0ZXJfZ2V0RXhjbHVkZUVsZW1lbnRzKHNlbGYpCgogICAgZGVmIGdldEluc3RhbmNlcyhzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkxldmVsU2hpZnRlcl9nZXRJbnN0YW5jZXMoc2VsZikKCiAgICBkZWYgX19pbml0X18oc2VsZik6CiAgICAgICAgX29kYl9weS5kYkxldmVsU2hpZnRlcl9zd2lnaW5pdChzZWxmLCBfb2RiX3B5Lm5ld19kYkxldmVsU2hpZnRlcigpKQogICAgX19zd2lnX2Rlc3Ryb3lfXyA9IF9vZGJfcHkuZGVsZXRlX2RiTGV2ZWxTaGlmdGVyCgojIFJlZ2lzdGVyIGRiTGV2ZWxTaGlmdGVyIGluIF9vZGJfcHk6Cl9vZGJfcHkuZGJMZXZlbFNoaWZ0ZXJfc3dpZ3JlZ2lzdGVyKGRiTGV2ZWxTaGlmdGVyKQoKZGVmIGRiTGV2ZWxTaGlmdGVyX2NyZWF0ZShibG9jaywgbmFtZSwgZG9tYWluKToKICAgIHJldHVybiBfb2RiX3B5LmRiTGV2ZWxTaGlmdGVyX2NyZWF0ZShibG9jaywgbmFtZSwgZG9tYWluKQoKZGVmIGRiTGV2ZWxTaGlmdGVyX2Rlc3Ryb3koc2hpZnRlcik6CiAgICByZXR1cm4gX29kYl9weS5kYkxldmVsU2hpZnRlcl9kZXN0cm95KHNoaWZ0ZXIpCgpjbGFzcyBkYkxvZ2ljUG9ydChvYmplY3QpOgogICAgdGhpc293biA9IHByb3BlcnR5KGxhbWJkYSB4OiB4LnRoaXMub3duKCksIGxhbWJkYSB4LCB2OiB4LnRoaXMub3duKHYpLCBkb2M9J1RoZSBtZW1iZXJzaGlwIGZsYWcnKQogICAgX19yZXByX18gPSBfc3dpZ19yZXByCgogICAgZGVmIGdldE5hbWUoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJMb2dpY1BvcnRfZ2V0TmFtZShzZWxmKQoKICAgIGRlZiBnZXREaXJlY3Rpb24oc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJMb2dpY1BvcnRfZ2V0RGlyZWN0aW9uKHNlbGYpCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIGNyZWF0ZShibG9jaywgbmFtZSwgZGlyZWN0aW9uKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkxvZ2ljUG9ydF9jcmVhdGUoYmxvY2ssIG5hbWUsIGRpcmVjdGlvbikKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgZGVzdHJveShscCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJMb2dpY1BvcnRfZGVzdHJveShscCkKCiAgICBkZWYgX19pbml0X18oc2VsZik6CiAgICAgICAgX29kYl9weS5kYkxvZ2ljUG9ydF9zd2lnaW5pdChzZWxmLCBfb2RiX3B5Lm5ld19kYkxvZ2ljUG9ydCgpKQogICAgX19zd2lnX2Rlc3Ryb3lfXyA9IF9vZGJfcHkuZGVsZXRlX2RiTG9naWNQb3J0CgojIFJlZ2lzdGVyIGRiTG9naWNQb3J0IGluIF9vZGJfcHk6Cl9vZGJfcHkuZGJMb2dpY1BvcnRfc3dpZ3JlZ2lzdGVyKGRiTG9naWNQb3J0KQoKZGVmIGRiTG9naWNQb3J0X2NyZWF0ZShibG9jaywgbmFtZSwgZGlyZWN0aW9uKToKICAgIHJldHVybiBfb2RiX3B5LmRiTG9naWNQb3J0X2NyZWF0ZShibG9jaywgbmFtZSwgZGlyZWN0aW9uKQoKZGVmIGRiTG9naWNQb3J0X2Rlc3Ryb3kobHApOgogICAgcmV0dXJuIF9vZGJfcHkuZGJMb2dpY1BvcnRfZGVzdHJveShscCkKCmNsYXNzIGRiTWFya2VyKG9iamVjdCk6CiAgICB0aGlzb3duID0gcHJvcGVydHkobGFtYmRhIHg6IHgudGhpcy5vd24oKSwgbGFtYmRhIHgsIHY6IHgudGhpcy5vd24odiksIGRvYz0nVGhlIG1lbWJlcnNoaXAgZmxhZycpCiAgICBfX3JlcHJfXyA9IF9zd2lnX3JlcHIKCiAgICBkZWYgc2V0Q29tbWVudChzZWxmLCBjb21tZW50KToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk1hcmtlcl9zZXRDb21tZW50KHNlbGYsIGNvbW1lbnQpCgogICAgZGVmIGdldENvbW1lbnQoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJNYXJrZXJfZ2V0Q29tbWVudChzZWxmKQoKICAgIGRlZiBzZXRMaW5lTnVtYmVyKHNlbGYsIGxpbmVfbnVtYmVyKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk1hcmtlcl9zZXRMaW5lTnVtYmVyKHNlbGYsIGxpbmVfbnVtYmVyKQoKICAgIGRlZiBnZXRMaW5lTnVtYmVyKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTWFya2VyX2dldExpbmVOdW1iZXIoc2VsZikKCiAgICBkZWYgc2V0VmlzaXRlZChzZWxmLCB2aXNpdGVkKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk1hcmtlcl9zZXRWaXNpdGVkKHNlbGYsIHZpc2l0ZWQpCgogICAgZGVmIGlzVmlzaXRlZChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk1hcmtlcl9pc1Zpc2l0ZWQoc2VsZikKCiAgICBkZWYgc2V0VmlzaWJsZShzZWxmLCB2aXNpYmxlKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk1hcmtlcl9zZXRWaXNpYmxlKHNlbGYsIHZpc2libGUpCgogICAgZGVmIGlzVmlzaWJsZShzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk1hcmtlcl9pc1Zpc2libGUoc2VsZikKCiAgICBkZWYgc2V0V2FpdmVkKHNlbGYsIHdhaXZlZCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJNYXJrZXJfc2V0V2FpdmVkKHNlbGYsIHdhaXZlZCkKCiAgICBkZWYgaXNXYWl2ZWQoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJNYXJrZXJfaXNXYWl2ZWQoc2VsZikKCiAgICBkZWYgZ2V0TmFtZShzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk1hcmtlcl9nZXROYW1lKHNlbGYpCgogICAgZGVmIGdldENhdGVnb3J5KHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTWFya2VyX2dldENhdGVnb3J5KHNlbGYpCgogICAgZGVmIGdldFNoYXBlcyhzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk1hcmtlcl9nZXRTaGFwZXMoc2VsZikKCiAgICBkZWYgZ2V0VGVjaExheWVyKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTWFya2VyX2dldFRlY2hMYXllcihzZWxmKQoKICAgIGRlZiBnZXRCQm94KHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTWFya2VyX2dldEJCb3goc2VsZikKCiAgICBkZWYgZ2V0U291cmNlcyhzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk1hcmtlcl9nZXRTb3VyY2VzKHNlbGYpCgogICAgZGVmIGFkZFNoYXBlKHNlbGYsICphcmdzKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk1hcmtlcl9hZGRTaGFwZShzZWxmLCAqYXJncykKCiAgICBkZWYgc2V0VGVjaExheWVyKHNlbGYsIGxheWVyKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk1hcmtlcl9zZXRUZWNoTGF5ZXIoc2VsZiwgbGF5ZXIpCgogICAgZGVmIGFkZFNvdXJjZShzZWxmLCBvYmopOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTWFya2VyX2FkZFNvdXJjZShzZWxmLCBvYmopCgogICAgZGVmIGFkZE9ic3RydWN0aW9uRnJvbUJsb2NrKHNlbGYsIGJsb2NrKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk1hcmtlcl9hZGRPYnN0cnVjdGlvbkZyb21CbG9jayhzZWxmLCBibG9jaykKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgY3JlYXRlKGNhdGVnb3J5KToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk1hcmtlcl9jcmVhdGUoY2F0ZWdvcnkpCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIGRlc3Ryb3kobWFya2VyKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk1hcmtlcl9kZXN0cm95KG1hcmtlcikKCiAgICBkZWYgX19pbml0X18oc2VsZik6CiAgICAgICAgX29kYl9weS5kYk1hcmtlcl9zd2lnaW5pdChzZWxmLCBfb2RiX3B5Lm5ld19kYk1hcmtlcigpKQogICAgX19zd2lnX2Rlc3Ryb3lfXyA9IF9vZGJfcHkuZGVsZXRlX2RiTWFya2VyCgojIFJlZ2lzdGVyIGRiTWFya2VyIGluIF9vZGJfcHk6Cl9vZGJfcHkuZGJNYXJrZXJfc3dpZ3JlZ2lzdGVyKGRiTWFya2VyKQoKZGVmIGRiTWFya2VyX2NyZWF0ZShjYXRlZ29yeSk6CiAgICByZXR1cm4gX29kYl9weS5kYk1hcmtlcl9jcmVhdGUoY2F0ZWdvcnkpCgpkZWYgZGJNYXJrZXJfZGVzdHJveShtYXJrZXIpOgogICAgcmV0dXJuIF9vZGJfcHkuZGJNYXJrZXJfZGVzdHJveShtYXJrZXIpCgpjbGFzcyBkYk1hcmtlckNhdGVnb3J5KG9iamVjdCk6CiAgICB0aGlzb3duID0gcHJvcGVydHkobGFtYmRhIHg6IHgudGhpcy5vd24oKSwgbGFtYmRhIHgsIHY6IHgudGhpcy5vd24odiksIGRvYz0nVGhlIG1lbWJlcnNoaXAgZmxhZycpCiAgICBfX3JlcHJfXyA9IF9zd2lnX3JlcHIKCiAgICBkZWYgZ2V0TmFtZShzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk1hcmtlckNhdGVnb3J5X2dldE5hbWUoc2VsZikKCiAgICBkZWYgc2V0RGVzY3JpcHRpb24oc2VsZiwgZGVzY3JpcHRpb24pOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTWFya2VyQ2F0ZWdvcnlfc2V0RGVzY3JpcHRpb24oc2VsZiwgZGVzY3JpcHRpb24pCgogICAgZGVmIGdldERlc2NyaXB0aW9uKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTWFya2VyQ2F0ZWdvcnlfZ2V0RGVzY3JpcHRpb24oc2VsZikKCiAgICBkZWYgc2V0U291cmNlKHNlbGYsIHNvdXJjZSk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJNYXJrZXJDYXRlZ29yeV9zZXRTb3VyY2Uoc2VsZiwgc291cmNlKQoKICAgIGRlZiBzZXRNYXhNYXJrZXJzKHNlbGYsIG1heF9tYXJrZXJzKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk1hcmtlckNhdGVnb3J5X3NldE1heE1hcmtlcnMoc2VsZiwgbWF4X21hcmtlcnMpCgogICAgZGVmIGdldE1heE1hcmtlcnMoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJNYXJrZXJDYXRlZ29yeV9nZXRNYXhNYXJrZXJzKHNlbGYpCgogICAgZGVmIGdldE1hcmtlcnMoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJNYXJrZXJDYXRlZ29yeV9nZXRNYXJrZXJzKHNlbGYpCgogICAgZGVmIGdldE1hcmtlckNhdGVnb3JpZXMoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJNYXJrZXJDYXRlZ29yeV9nZXRNYXJrZXJDYXRlZ29yaWVzKHNlbGYpCgogICAgZGVmIGZpbmRNYXJrZXJDYXRlZ29yeShzZWxmLCBuYW1lKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk1hcmtlckNhdGVnb3J5X2ZpbmRNYXJrZXJDYXRlZ29yeShzZWxmLCBuYW1lKQoKICAgIGRlZiBnZXRUb3BDYXRlZ29yeShzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk1hcmtlckNhdGVnb3J5X2dldFRvcENhdGVnb3J5KHNlbGYpCgogICAgZGVmIGdldFBhcmVudChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk1hcmtlckNhdGVnb3J5X2dldFBhcmVudChzZWxmKQoKICAgIGRlZiBnZXRTb3VyY2Uoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJNYXJrZXJDYXRlZ29yeV9nZXRTb3VyY2Uoc2VsZikKCiAgICBkZWYgZ2V0QWxsTWFya2VycyhzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk1hcmtlckNhdGVnb3J5X2dldEFsbE1hcmtlcnMoc2VsZikKCiAgICBkZWYgcmVuYW1lKHNlbGYsIG5hbWUpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTWFya2VyQ2F0ZWdvcnlfcmVuYW1lKHNlbGYsIG5hbWUpCgogICAgZGVmIGdldE1hcmtlckNvdW50KHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTWFya2VyQ2F0ZWdvcnlfZ2V0TWFya2VyQ291bnQoc2VsZikKCiAgICBkZWYgd3JpdGVKU09OKHNlbGYsICphcmdzKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk1hcmtlckNhdGVnb3J5X3dyaXRlSlNPTihzZWxmLCAqYXJncykKCiAgICBkZWYgd3JpdGVUUihzZWxmLCAqYXJncyk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJNYXJrZXJDYXRlZ29yeV93cml0ZVRSKHNlbGYsICphcmdzKQoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBmcm9tSlNPTigqYXJncyk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJNYXJrZXJDYXRlZ29yeV9mcm9tSlNPTigqYXJncykKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgZnJvbVRSKCphcmdzKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk1hcmtlckNhdGVnb3J5X2Zyb21UUigqYXJncykKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgY3JlYXRlKCphcmdzKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk1hcmtlckNhdGVnb3J5X2NyZWF0ZSgqYXJncykKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgY3JlYXRlT3JHZXQoKmFyZ3MpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTWFya2VyQ2F0ZWdvcnlfY3JlYXRlT3JHZXQoKmFyZ3MpCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIGNyZWF0ZU9yUmVwbGFjZSgqYXJncyk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJNYXJrZXJDYXRlZ29yeV9jcmVhdGVPclJlcGxhY2UoKmFyZ3MpCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIGRlc3Ryb3koY2F0ZWdvcnkpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTWFya2VyQ2F0ZWdvcnlfZGVzdHJveShjYXRlZ29yeSkKCiAgICBkZWYgX19pbml0X18oc2VsZik6CiAgICAgICAgX29kYl9weS5kYk1hcmtlckNhdGVnb3J5X3N3aWdpbml0KHNlbGYsIF9vZGJfcHkubmV3X2RiTWFya2VyQ2F0ZWdvcnkoKSkKICAgIF9fc3dpZ19kZXN0cm95X18gPSBfb2RiX3B5LmRlbGV0ZV9kYk1hcmtlckNhdGVnb3J5CgojIFJlZ2lzdGVyIGRiTWFya2VyQ2F0ZWdvcnkgaW4gX29kYl9weToKX29kYl9weS5kYk1hcmtlckNhdGVnb3J5X3N3aWdyZWdpc3RlcihkYk1hcmtlckNhdGVnb3J5KQoKZGVmIGRiTWFya2VyQ2F0ZWdvcnlfZnJvbUpTT04oKmFyZ3MpOgogICAgcmV0dXJuIF9vZGJfcHkuZGJNYXJrZXJDYXRlZ29yeV9mcm9tSlNPTigqYXJncykKCmRlZiBkYk1hcmtlckNhdGVnb3J5X2Zyb21UUigqYXJncyk6CiAgICByZXR1cm4gX29kYl9weS5kYk1hcmtlckNhdGVnb3J5X2Zyb21UUigqYXJncykKCmRlZiBkYk1hcmtlckNhdGVnb3J5X2NyZWF0ZSgqYXJncyk6CiAgICByZXR1cm4gX29kYl9weS5kYk1hcmtlckNhdGVnb3J5X2NyZWF0ZSgqYXJncykKCmRlZiBkYk1hcmtlckNhdGVnb3J5X2NyZWF0ZU9yR2V0KCphcmdzKToKICAgIHJldHVybiBfb2RiX3B5LmRiTWFya2VyQ2F0ZWdvcnlfY3JlYXRlT3JHZXQoKmFyZ3MpCgpkZWYgZGJNYXJrZXJDYXRlZ29yeV9jcmVhdGVPclJlcGxhY2UoKmFyZ3MpOgogICAgcmV0dXJuIF9vZGJfcHkuZGJNYXJrZXJDYXRlZ29yeV9jcmVhdGVPclJlcGxhY2UoKmFyZ3MpCgpkZWYgZGJNYXJrZXJDYXRlZ29yeV9kZXN0cm95KGNhdGVnb3J5KToKICAgIHJldHVybiBfb2RiX3B5LmRiTWFya2VyQ2F0ZWdvcnlfZGVzdHJveShjYXRlZ29yeSkKCmNsYXNzIGRiTWFzdGVyRWRnZVR5cGUob2JqZWN0KToKICAgIHRoaXNvd24gPSBwcm9wZXJ0eShsYW1iZGEgeDogeC50aGlzLm93bigpLCBsYW1iZGEgeCwgdjogeC50aGlzLm93bih2KSwgZG9jPSdUaGUgbWVtYmVyc2hpcCBmbGFnJykKICAgIF9fcmVwcl9fID0gX3N3aWdfcmVwcgogICAgVE9QID0gX29kYl9weS5kYk1hc3RlckVkZ2VUeXBlX1RPUAogICAgUklHSFQgPSBfb2RiX3B5LmRiTWFzdGVyRWRnZVR5cGVfUklHSFQKICAgIExFRlQgPSBfb2RiX3B5LmRiTWFzdGVyRWRnZVR5cGVfTEVGVAogICAgQk9UVE9NID0gX29kYl9weS5kYk1hc3RlckVkZ2VUeXBlX0JPVFRPTQoKICAgIGRlZiBzZXRFZGdlVHlwZShzZWxmLCBlZGdlX3R5cGUpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTWFzdGVyRWRnZVR5cGVfc2V0RWRnZVR5cGUoc2VsZiwgZWRnZV90eXBlKQoKICAgIGRlZiBnZXRFZGdlVHlwZShzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk1hc3RlckVkZ2VUeXBlX2dldEVkZ2VUeXBlKHNlbGYpCgogICAgZGVmIHNldENlbGxSb3coc2VsZiwgY2VsbF9yb3cpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTWFzdGVyRWRnZVR5cGVfc2V0Q2VsbFJvdyhzZWxmLCBjZWxsX3JvdykKCiAgICBkZWYgZ2V0Q2VsbFJvdyhzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk1hc3RlckVkZ2VUeXBlX2dldENlbGxSb3coc2VsZikKCiAgICBkZWYgc2V0SGFsZlJvdyhzZWxmLCBoYWxmX3Jvdyk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJNYXN0ZXJFZGdlVHlwZV9zZXRIYWxmUm93KHNlbGYsIGhhbGZfcm93KQoKICAgIGRlZiBnZXRIYWxmUm93KHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTWFzdGVyRWRnZVR5cGVfZ2V0SGFsZlJvdyhzZWxmKQoKICAgIGRlZiBzZXRSYW5nZUJlZ2luKHNlbGYsIHJhbmdlX2JlZ2luKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk1hc3RlckVkZ2VUeXBlX3NldFJhbmdlQmVnaW4oc2VsZiwgcmFuZ2VfYmVnaW4pCgogICAgZGVmIGdldFJhbmdlQmVnaW4oc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJNYXN0ZXJFZGdlVHlwZV9nZXRSYW5nZUJlZ2luKHNlbGYpCgogICAgZGVmIHNldFJhbmdlRW5kKHNlbGYsIHJhbmdlX2VuZCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJNYXN0ZXJFZGdlVHlwZV9zZXRSYW5nZUVuZChzZWxmLCByYW5nZV9lbmQpCgogICAgZGVmIGdldFJhbmdlRW5kKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTWFzdGVyRWRnZVR5cGVfZ2V0UmFuZ2VFbmQoc2VsZikKCiAgICBkZWYgc2V0RWRnZURpcihzZWxmLCBlZGdlX2Rpcik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJNYXN0ZXJFZGdlVHlwZV9zZXRFZGdlRGlyKHNlbGYsIGVkZ2VfZGlyKQoKICAgIGRlZiBnZXRFZGdlRGlyKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTWFzdGVyRWRnZVR5cGVfZ2V0RWRnZURpcihzZWxmKQoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBjcmVhdGUobWFzdGVyKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk1hc3RlckVkZ2VUeXBlX2NyZWF0ZShtYXN0ZXIpCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIGRlc3Ryb3koZWRnZV90eXBlKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk1hc3RlckVkZ2VUeXBlX2Rlc3Ryb3koZWRnZV90eXBlKQoKICAgIGRlZiBfX2luaXRfXyhzZWxmKToKICAgICAgICBfb2RiX3B5LmRiTWFzdGVyRWRnZVR5cGVfc3dpZ2luaXQoc2VsZiwgX29kYl9weS5uZXdfZGJNYXN0ZXJFZGdlVHlwZSgpKQogICAgX19zd2lnX2Rlc3Ryb3lfXyA9IF9vZGJfcHkuZGVsZXRlX2RiTWFzdGVyRWRnZVR5cGUKCiMgUmVnaXN0ZXIgZGJNYXN0ZXJFZGdlVHlwZSBpbiBfb2RiX3B5Ogpfb2RiX3B5LmRiTWFzdGVyRWRnZVR5cGVfc3dpZ3JlZ2lzdGVyKGRiTWFzdGVyRWRnZVR5cGUpCgpkZWYgZGJNYXN0ZXJFZGdlVHlwZV9jcmVhdGUobWFzdGVyKToKICAgIHJldHVybiBfb2RiX3B5LmRiTWFzdGVyRWRnZVR5cGVfY3JlYXRlKG1hc3RlcikKCmRlZiBkYk1hc3RlckVkZ2VUeXBlX2Rlc3Ryb3koZWRnZV90eXBlKToKICAgIHJldHVybiBfb2RiX3B5LmRiTWFzdGVyRWRnZVR5cGVfZGVzdHJveShlZGdlX3R5cGUpCgpjbGFzcyBkYk1ldGFsV2lkdGhWaWFNYXAob2JqZWN0KToKICAgIHRoaXNvd24gPSBwcm9wZXJ0eShsYW1iZGEgeDogeC50aGlzLm93bigpLCBsYW1iZGEgeCwgdjogeC50aGlzLm93bih2KSwgZG9jPSdUaGUgbWVtYmVyc2hpcCBmbGFnJykKICAgIF9fcmVwcl9fID0gX3N3aWdfcmVwcgoKICAgIGRlZiBzZXRWaWFDdXRDbGFzcyhzZWxmLCB2aWFfY3V0X2NsYXNzKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk1ldGFsV2lkdGhWaWFNYXBfc2V0VmlhQ3V0Q2xhc3Moc2VsZiwgdmlhX2N1dF9jbGFzcykKCiAgICBkZWYgaXNWaWFDdXRDbGFzcyhzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk1ldGFsV2lkdGhWaWFNYXBfaXNWaWFDdXRDbGFzcyhzZWxmKQoKICAgIGRlZiBzZXRDdXRMYXllcihzZWxmLCBjdXRfbGF5ZXIpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTWV0YWxXaWR0aFZpYU1hcF9zZXRDdXRMYXllcihzZWxmLCBjdXRfbGF5ZXIpCgogICAgZGVmIHNldEJlbG93TGF5ZXJXaWR0aExvdyhzZWxmLCBiZWxvd19sYXllcl93aWR0aF9sb3cpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTWV0YWxXaWR0aFZpYU1hcF9zZXRCZWxvd0xheWVyV2lkdGhMb3coc2VsZiwgYmVsb3dfbGF5ZXJfd2lkdGhfbG93KQoKICAgIGRlZiBnZXRCZWxvd0xheWVyV2lkdGhMb3coc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJNZXRhbFdpZHRoVmlhTWFwX2dldEJlbG93TGF5ZXJXaWR0aExvdyhzZWxmKQoKICAgIGRlZiBzZXRCZWxvd0xheWVyV2lkdGhIaWdoKHNlbGYsIGJlbG93X2xheWVyX3dpZHRoX2hpZ2gpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTWV0YWxXaWR0aFZpYU1hcF9zZXRCZWxvd0xheWVyV2lkdGhIaWdoKHNlbGYsIGJlbG93X2xheWVyX3dpZHRoX2hpZ2gpCgogICAgZGVmIGdldEJlbG93TGF5ZXJXaWR0aEhpZ2goc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJNZXRhbFdpZHRoVmlhTWFwX2dldEJlbG93TGF5ZXJXaWR0aEhpZ2goc2VsZikKCiAgICBkZWYgc2V0QWJvdmVMYXllcldpZHRoTG93KHNlbGYsIGFib3ZlX2xheWVyX3dpZHRoX2xvdyk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJNZXRhbFdpZHRoVmlhTWFwX3NldEFib3ZlTGF5ZXJXaWR0aExvdyhzZWxmLCBhYm92ZV9sYXllcl93aWR0aF9sb3cpCgogICAgZGVmIGdldEFib3ZlTGF5ZXJXaWR0aExvdyhzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk1ldGFsV2lkdGhWaWFNYXBfZ2V0QWJvdmVMYXllcldpZHRoTG93KHNlbGYpCgogICAgZGVmIHNldEFib3ZlTGF5ZXJXaWR0aEhpZ2goc2VsZiwgYWJvdmVfbGF5ZXJfd2lkdGhfaGlnaCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJNZXRhbFdpZHRoVmlhTWFwX3NldEFib3ZlTGF5ZXJXaWR0aEhpZ2goc2VsZiwgYWJvdmVfbGF5ZXJfd2lkdGhfaGlnaCkKCiAgICBkZWYgZ2V0QWJvdmVMYXllcldpZHRoSGlnaChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk1ldGFsV2lkdGhWaWFNYXBfZ2V0QWJvdmVMYXllcldpZHRoSGlnaChzZWxmKQoKICAgIGRlZiBzZXRWaWFOYW1lKHNlbGYsIHZpYV9uYW1lKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk1ldGFsV2lkdGhWaWFNYXBfc2V0VmlhTmFtZShzZWxmLCB2aWFfbmFtZSkKCiAgICBkZWYgZ2V0VmlhTmFtZShzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk1ldGFsV2lkdGhWaWFNYXBfZ2V0VmlhTmFtZShzZWxmKQoKICAgIGRlZiBzZXRQZ1ZpYShzZWxmLCBwZ192aWEpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTWV0YWxXaWR0aFZpYU1hcF9zZXRQZ1ZpYShzZWxmLCBwZ192aWEpCgogICAgZGVmIGlzUGdWaWEoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJNZXRhbFdpZHRoVmlhTWFwX2lzUGdWaWEoc2VsZikKCiAgICBkZWYgZ2V0Q3V0TGF5ZXIoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJNZXRhbFdpZHRoVmlhTWFwX2dldEN1dExheWVyKHNlbGYpCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIGNyZWF0ZSh0ZWNoKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk1ldGFsV2lkdGhWaWFNYXBfY3JlYXRlKHRlY2gpCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIGRlc3Ryb3kodmlhX21hcCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJNZXRhbFdpZHRoVmlhTWFwX2Rlc3Ryb3kodmlhX21hcCkKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgZ2V0TWV0YWxXaWR0aFZpYU1hcCh0ZWNoLCBkYmlkKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk1ldGFsV2lkdGhWaWFNYXBfZ2V0TWV0YWxXaWR0aFZpYU1hcCh0ZWNoLCBkYmlkKQoKICAgIGRlZiBfX2luaXRfXyhzZWxmKToKICAgICAgICBfb2RiX3B5LmRiTWV0YWxXaWR0aFZpYU1hcF9zd2lnaW5pdChzZWxmLCBfb2RiX3B5Lm5ld19kYk1ldGFsV2lkdGhWaWFNYXAoKSkKICAgIF9fc3dpZ19kZXN0cm95X18gPSBfb2RiX3B5LmRlbGV0ZV9kYk1ldGFsV2lkdGhWaWFNYXAKCiMgUmVnaXN0ZXIgZGJNZXRhbFdpZHRoVmlhTWFwIGluIF9vZGJfcHk6Cl9vZGJfcHkuZGJNZXRhbFdpZHRoVmlhTWFwX3N3aWdyZWdpc3RlcihkYk1ldGFsV2lkdGhWaWFNYXApCgpkZWYgZGJNZXRhbFdpZHRoVmlhTWFwX2NyZWF0ZSh0ZWNoKToKICAgIHJldHVybiBfb2RiX3B5LmRiTWV0YWxXaWR0aFZpYU1hcF9jcmVhdGUodGVjaCkKCmRlZiBkYk1ldGFsV2lkdGhWaWFNYXBfZGVzdHJveSh2aWFfbWFwKToKICAgIHJldHVybiBfb2RiX3B5LmRiTWV0YWxXaWR0aFZpYU1hcF9kZXN0cm95KHZpYV9tYXApCgpkZWYgZGJNZXRhbFdpZHRoVmlhTWFwX2dldE1ldGFsV2lkdGhWaWFNYXAodGVjaCwgZGJpZCk6CiAgICByZXR1cm4gX29kYl9weS5kYk1ldGFsV2lkdGhWaWFNYXBfZ2V0TWV0YWxXaWR0aFZpYU1hcCh0ZWNoLCBkYmlkKQoKY2xhc3MgZGJNb2RCVGVybShvYmplY3QpOgogICAgdGhpc293biA9IHByb3BlcnR5KGxhbWJkYSB4OiB4LnRoaXMub3duKCksIGxhbWJkYSB4LCB2OiB4LnRoaXMub3duKHYpLCBkb2M9J1RoZSBtZW1iZXJzaGlwIGZsYWcnKQogICAgX19yZXByX18gPSBfc3dpZ19yZXByCgogICAgZGVmIGdldE5hbWUoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJNb2RCVGVybV9nZXROYW1lKHNlbGYpCgogICAgZGVmIGdldFBhcmVudChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk1vZEJUZXJtX2dldFBhcmVudChzZWxmKQoKICAgIGRlZiBzZXRQYXJlbnRNb2RJVGVybShzZWxmLCBwYXJlbnRfcGluKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk1vZEJUZXJtX3NldFBhcmVudE1vZElUZXJtKHNlbGYsIHBhcmVudF9waW4pCgogICAgZGVmIGdldFBhcmVudE1vZElUZXJtKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTW9kQlRlcm1fZ2V0UGFyZW50TW9kSVRlcm0oc2VsZikKCiAgICBkZWYgc2V0TW9kTmV0KHNlbGYsIG1vZE5ldCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJNb2RCVGVybV9zZXRNb2ROZXQoc2VsZiwgbW9kTmV0KQoKICAgIGRlZiBnZXRNb2ROZXQoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJNb2RCVGVybV9nZXRNb2ROZXQoc2VsZikKCiAgICBkZWYgc2V0U2lnVHlwZShzZWxmLCB0eXBlKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk1vZEJUZXJtX3NldFNpZ1R5cGUoc2VsZiwgdHlwZSkKCiAgICBkZWYgZ2V0U2lnVHlwZShzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk1vZEJUZXJtX2dldFNpZ1R5cGUoc2VsZikKCiAgICBkZWYgc2V0SW9UeXBlKHNlbGYsIHR5cGUpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTW9kQlRlcm1fc2V0SW9UeXBlKHNlbGYsIHR5cGUpCgogICAgZGVmIGdldElvVHlwZShzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk1vZEJUZXJtX2dldElvVHlwZShzZWxmKQoKICAgIGRlZiBjb25uZWN0KHNlbGYsIG5ldCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJNb2RCVGVybV9jb25uZWN0KHNlbGYsIG5ldCkKCiAgICBkZWYgZGlzY29ubmVjdChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk1vZEJUZXJtX2Rpc2Nvbm5lY3Qoc2VsZikKCiAgICBkZWYgaXNCdXNQb3J0KHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTW9kQlRlcm1faXNCdXNQb3J0KHNlbGYpCgogICAgZGVmIHNldEJ1c1BvcnQoc2VsZiwgYXJnMik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJNb2RCVGVybV9zZXRCdXNQb3J0KHNlbGYsIGFyZzIpCgogICAgZGVmIGdldEJ1c1BvcnQoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJNb2RCVGVybV9nZXRCdXNQb3J0KHNlbGYpCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIGNyZWF0ZShwYXJlbnRNb2R1bGUsIG5hbWUpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTW9kQlRlcm1fY3JlYXRlKHBhcmVudE1vZHVsZSwgbmFtZSkKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgZGVzdHJveSgqYXJncyk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJNb2RCVGVybV9kZXN0cm95KCphcmdzKQoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBnZXRNb2RCVGVybShibG9jaywgZGJpZCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJNb2RCVGVybV9nZXRNb2RCVGVybShibG9jaywgZGJpZCkKCiAgICBkZWYgX19pbml0X18oc2VsZik6CiAgICAgICAgX29kYl9weS5kYk1vZEJUZXJtX3N3aWdpbml0KHNlbGYsIF9vZGJfcHkubmV3X2RiTW9kQlRlcm0oKSkKICAgIF9fc3dpZ19kZXN0cm95X18gPSBfb2RiX3B5LmRlbGV0ZV9kYk1vZEJUZXJtCgojIFJlZ2lzdGVyIGRiTW9kQlRlcm0gaW4gX29kYl9weToKX29kYl9weS5kYk1vZEJUZXJtX3N3aWdyZWdpc3RlcihkYk1vZEJUZXJtKQoKZGVmIGRiTW9kQlRlcm1fY3JlYXRlKHBhcmVudE1vZHVsZSwgbmFtZSk6CiAgICByZXR1cm4gX29kYl9weS5kYk1vZEJUZXJtX2NyZWF0ZShwYXJlbnRNb2R1bGUsIG5hbWUpCgpkZWYgZGJNb2RCVGVybV9kZXN0cm95KCphcmdzKToKICAgIHJldHVybiBfb2RiX3B5LmRiTW9kQlRlcm1fZGVzdHJveSgqYXJncykKCmRlZiBkYk1vZEJUZXJtX2dldE1vZEJUZXJtKGJsb2NrLCBkYmlkKToKICAgIHJldHVybiBfb2RiX3B5LmRiTW9kQlRlcm1fZ2V0TW9kQlRlcm0oYmxvY2ssIGRiaWQpCgpjbGFzcyBkYk1vZEluc3Qob2JqZWN0KToKICAgIHRoaXNvd24gPSBwcm9wZXJ0eShsYW1iZGEgeDogeC50aGlzLm93bigpLCBsYW1iZGEgeCwgdjogeC50aGlzLm93bih2KSwgZG9jPSdUaGUgbWVtYmVyc2hpcCBmbGFnJykKICAgIF9fcmVwcl9fID0gX3N3aWdfcmVwcgoKICAgIGRlZiBnZXROYW1lKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTW9kSW5zdF9nZXROYW1lKHNlbGYpCgogICAgZGVmIGdldFBhcmVudChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk1vZEluc3RfZ2V0UGFyZW50KHNlbGYpCgogICAgZGVmIGdldE1hc3RlcihzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk1vZEluc3RfZ2V0TWFzdGVyKHNlbGYpCgogICAgZGVmIGdldEdyb3VwKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTW9kSW5zdF9nZXRHcm91cChzZWxmKQoKICAgIGRlZiBnZXRIaWVyYXJjaGljYWxOYW1lKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTW9kSW5zdF9nZXRIaWVyYXJjaGljYWxOYW1lKHNlbGYpCgogICAgZGVmIGZpbmRNb2RJVGVybShzZWxmLCBuYW1lKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk1vZEluc3RfZmluZE1vZElUZXJtKHNlbGYsIG5hbWUpCgogICAgZGVmIGdldE1vZElUZXJtcyhzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk1vZEluc3RfZ2V0TW9kSVRlcm1zKHNlbGYpCgogICAgZGVmIHJlbW92ZVVudXNlZFBvcnRzQW5kUGlucyhzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk1vZEluc3RfcmVtb3ZlVW51c2VkUG9ydHNBbmRQaW5zKHNlbGYpCgogICAgZGVmIGZpbmRIaWVyTmV0KHNlbGYsIGJhc2VfbmFtZSk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJNb2RJbnN0X2ZpbmRIaWVyTmV0KHNlbGYsIGJhc2VfbmFtZSkKCiAgICBkZWYgZmluZEZsYXROZXQoc2VsZiwgYmFzZV9uYW1lKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk1vZEluc3RfZmluZEZsYXROZXQoc2VsZiwgYmFzZV9uYW1lKQoKICAgIGRlZiBmaW5kTmV0KHNlbGYsIGJhc2VfbmFtZSwgZmxhdF9uZXQsIGhpZXJfbmV0KToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk1vZEluc3RfZmluZE5ldChzZWxmLCBiYXNlX25hbWUsIGZsYXRfbmV0LCBoaWVyX25ldCkKCiAgICBkZWYgc3dhcE1hc3RlcihzZWxmLCBtb2R1bGUpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTW9kSW5zdF9zd2FwTWFzdGVyKHNlbGYsIG1vZHVsZSkKCiAgICBkZWYgY29udGFpbnNEYkluc3Qoc2VsZiwgaW5zdCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJNb2RJbnN0X2NvbnRhaW5zRGJJbnN0KHNlbGYsIGluc3QpCgogICAgZGVmIGNvbnRhaW5zRGJNb2RJbnN0KHNlbGYsIG1vZF9pbnN0KToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk1vZEluc3RfY29udGFpbnNEYk1vZEluc3Qoc2VsZiwgbW9kX2luc3QpCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIGNyZWF0ZShwYXJlbnRNb2R1bGUsIG1hc3Rlck1vZHVsZSwgbmFtZSk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJNb2RJbnN0X2NyZWF0ZShwYXJlbnRNb2R1bGUsIG1hc3Rlck1vZHVsZSwgbmFtZSkKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgZGVzdHJveSgqYXJncyk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJNb2RJbnN0X2Rlc3Ryb3koKmFyZ3MpCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIGdldE1vZEluc3QoYmxvY2tfLCBkYmlkXyk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJNb2RJbnN0X2dldE1vZEluc3QoYmxvY2tfLCBkYmlkXykKCiAgICBkZWYgX19pbml0X18oc2VsZik6CiAgICAgICAgX29kYl9weS5kYk1vZEluc3Rfc3dpZ2luaXQoc2VsZiwgX29kYl9weS5uZXdfZGJNb2RJbnN0KCkpCiAgICBfX3N3aWdfZGVzdHJveV9fID0gX29kYl9weS5kZWxldGVfZGJNb2RJbnN0CgojIFJlZ2lzdGVyIGRiTW9kSW5zdCBpbiBfb2RiX3B5Ogpfb2RiX3B5LmRiTW9kSW5zdF9zd2lncmVnaXN0ZXIoZGJNb2RJbnN0KQoKZGVmIGRiTW9kSW5zdF9jcmVhdGUocGFyZW50TW9kdWxlLCBtYXN0ZXJNb2R1bGUsIG5hbWUpOgogICAgcmV0dXJuIF9vZGJfcHkuZGJNb2RJbnN0X2NyZWF0ZShwYXJlbnRNb2R1bGUsIG1hc3Rlck1vZHVsZSwgbmFtZSkKCmRlZiBkYk1vZEluc3RfZGVzdHJveSgqYXJncyk6CiAgICByZXR1cm4gX29kYl9weS5kYk1vZEluc3RfZGVzdHJveSgqYXJncykKCmRlZiBkYk1vZEluc3RfZ2V0TW9kSW5zdChibG9ja18sIGRiaWRfKToKICAgIHJldHVybiBfb2RiX3B5LmRiTW9kSW5zdF9nZXRNb2RJbnN0KGJsb2NrXywgZGJpZF8pCgpjbGFzcyBkYk1vZElUZXJtKG9iamVjdCk6CiAgICB0aGlzb3duID0gcHJvcGVydHkobGFtYmRhIHg6IHgudGhpcy5vd24oKSwgbGFtYmRhIHgsIHY6IHgudGhpcy5vd24odiksIGRvYz0nVGhlIG1lbWJlcnNoaXAgZmxhZycpCiAgICBfX3JlcHJfXyA9IF9zd2lnX3JlcHIKCiAgICBkZWYgZ2V0TmFtZShzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk1vZElUZXJtX2dldE5hbWUoc2VsZikKCiAgICBkZWYgZ2V0UGFyZW50KHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTW9kSVRlcm1fZ2V0UGFyZW50KHNlbGYpCgogICAgZGVmIHNldE1vZE5ldChzZWxmLCBtb2ROZXQpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTW9kSVRlcm1fc2V0TW9kTmV0KHNlbGYsIG1vZE5ldCkKCiAgICBkZWYgZ2V0TW9kTmV0KHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTW9kSVRlcm1fZ2V0TW9kTmV0KHNlbGYpCgogICAgZGVmIHNldENoaWxkTW9kQlRlcm0oc2VsZiwgY2hpbGRfcG9ydCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJNb2RJVGVybV9zZXRDaGlsZE1vZEJUZXJtKHNlbGYsIGNoaWxkX3BvcnQpCgogICAgZGVmIGdldENoaWxkTW9kQlRlcm0oc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJNb2RJVGVybV9nZXRDaGlsZE1vZEJUZXJtKHNlbGYpCgogICAgZGVmIGNvbm5lY3Qoc2VsZiwgbW9kbmV0KToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk1vZElUZXJtX2Nvbm5lY3Qoc2VsZiwgbW9kbmV0KQoKICAgIGRlZiBkaXNjb25uZWN0KHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTW9kSVRlcm1fZGlzY29ubmVjdChzZWxmKQoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBjcmVhdGUocGFyZW50SW5zdGFuY2UsIG5hbWUsIG1vZGJ0ZXJtPU5vbmUpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTW9kSVRlcm1fY3JlYXRlKHBhcmVudEluc3RhbmNlLCBuYW1lLCBtb2RidGVybSkKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgZGVzdHJveSgqYXJncyk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJNb2RJVGVybV9kZXN0cm95KCphcmdzKQoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBnZXRNb2RJVGVybShibG9jaywgZGJpZCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJNb2RJVGVybV9nZXRNb2RJVGVybShibG9jaywgZGJpZCkKCiAgICBkZWYgX19pbml0X18oc2VsZik6CiAgICAgICAgX29kYl9weS5kYk1vZElUZXJtX3N3aWdpbml0KHNlbGYsIF9vZGJfcHkubmV3X2RiTW9kSVRlcm0oKSkKICAgIF9fc3dpZ19kZXN0cm95X18gPSBfb2RiX3B5LmRlbGV0ZV9kYk1vZElUZXJtCgojIFJlZ2lzdGVyIGRiTW9kSVRlcm0gaW4gX29kYl9weToKX29kYl9weS5kYk1vZElUZXJtX3N3aWdyZWdpc3RlcihkYk1vZElUZXJtKQoKZGVmIGRiTW9kSVRlcm1fY3JlYXRlKHBhcmVudEluc3RhbmNlLCBuYW1lLCBtb2RidGVybT1Ob25lKToKICAgIHJldHVybiBfb2RiX3B5LmRiTW9kSVRlcm1fY3JlYXRlKHBhcmVudEluc3RhbmNlLCBuYW1lLCBtb2RidGVybSkKCmRlZiBkYk1vZElUZXJtX2Rlc3Ryb3koKmFyZ3MpOgogICAgcmV0dXJuIF9vZGJfcHkuZGJNb2RJVGVybV9kZXN0cm95KCphcmdzKQoKZGVmIGRiTW9kSVRlcm1fZ2V0TW9kSVRlcm0oYmxvY2ssIGRiaWQpOgogICAgcmV0dXJuIF9vZGJfcHkuZGJNb2RJVGVybV9nZXRNb2RJVGVybShibG9jaywgZGJpZCkKCmNsYXNzIGRiTW9kTmV0KG9iamVjdCk6CiAgICB0aGlzb3duID0gcHJvcGVydHkobGFtYmRhIHg6IHgudGhpcy5vd24oKSwgbGFtYmRhIHgsIHY6IHgudGhpcy5vd24odiksIGRvYz0nVGhlIG1lbWJlcnNoaXAgZmxhZycpCiAgICBfX3JlcHJfXyA9IF9zd2lnX3JlcHIKCiAgICBkZWYgZ2V0UGFyZW50KHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTW9kTmV0X2dldFBhcmVudChzZWxmKQoKICAgIGRlZiBnZXRNb2RJVGVybXMoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJNb2ROZXRfZ2V0TW9kSVRlcm1zKHNlbGYpCgogICAgZGVmIGdldE1vZEJUZXJtcyhzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk1vZE5ldF9nZXRNb2RCVGVybXMoc2VsZikKCiAgICBkZWYgZ2V0SVRlcm1zKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTW9kTmV0X2dldElUZXJtcyhzZWxmKQoKICAgIGRlZiBnZXRCVGVybXMoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJNb2ROZXRfZ2V0QlRlcm1zKHNlbGYpCgogICAgZGVmIGNvbm5lY3Rpb25Db3VudChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk1vZE5ldF9jb25uZWN0aW9uQ291bnQoc2VsZikKCiAgICBkZWYgZ2V0TmFtZShzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk1vZE5ldF9nZXROYW1lKHNlbGYpCgogICAgZGVmIGdldENvbnN0TmFtZShzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk1vZE5ldF9nZXRDb25zdE5hbWUoc2VsZikKCiAgICBkZWYgZ2V0SGllcmFyY2hpY2FsTmFtZShzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk1vZE5ldF9nZXRIaWVyYXJjaGljYWxOYW1lKHNlbGYpCgogICAgZGVmIHJlbmFtZShzZWxmLCBuZXdfbmFtZSk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJNb2ROZXRfcmVuYW1lKHNlbGYsIG5ld19uYW1lKQoKICAgIGRlZiBkaXNjb25uZWN0QWxsVGVybXMoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJNb2ROZXRfZGlzY29ubmVjdEFsbFRlcm1zKHNlbGYpCgogICAgZGVmIGR1bXAoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJNb2ROZXRfZHVtcChzZWxmKQoKICAgIGRlZiBmaW5kUmVsYXRlZE5ldChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk1vZE5ldF9maW5kUmVsYXRlZE5ldChzZWxmKQoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBnZXRNb2ROZXQoYmxvY2ssIGlkKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk1vZE5ldF9nZXRNb2ROZXQoYmxvY2ssIGlkKQoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBjcmVhdGUocGFyZW50TW9kdWxlLCBiYXNlX25hbWUpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTW9kTmV0X2NyZWF0ZShwYXJlbnRNb2R1bGUsIGJhc2VfbmFtZSkKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgZGVzdHJveSgqYXJncyk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJNb2ROZXRfZGVzdHJveSgqYXJncykKCiAgICBkZWYgX19pbml0X18oc2VsZik6CiAgICAgICAgX29kYl9weS5kYk1vZE5ldF9zd2lnaW5pdChzZWxmLCBfb2RiX3B5Lm5ld19kYk1vZE5ldCgpKQogICAgX19zd2lnX2Rlc3Ryb3lfXyA9IF9vZGJfcHkuZGVsZXRlX2RiTW9kTmV0CgojIFJlZ2lzdGVyIGRiTW9kTmV0IGluIF9vZGJfcHk6Cl9vZGJfcHkuZGJNb2ROZXRfc3dpZ3JlZ2lzdGVyKGRiTW9kTmV0KQoKZGVmIGRiTW9kTmV0X2dldE1vZE5ldChibG9jaywgaWQpOgogICAgcmV0dXJuIF9vZGJfcHkuZGJNb2ROZXRfZ2V0TW9kTmV0KGJsb2NrLCBpZCkKCmRlZiBkYk1vZE5ldF9jcmVhdGUocGFyZW50TW9kdWxlLCBiYXNlX25hbWUpOgogICAgcmV0dXJuIF9vZGJfcHkuZGJNb2ROZXRfY3JlYXRlKHBhcmVudE1vZHVsZSwgYmFzZV9uYW1lKQoKZGVmIGRiTW9kTmV0X2Rlc3Ryb3koKmFyZ3MpOgogICAgcmV0dXJuIF9vZGJfcHkuZGJNb2ROZXRfZGVzdHJveSgqYXJncykKCmNsYXNzIGRiTW9kdWxlKG9iamVjdCk6CiAgICB0aGlzb3duID0gcHJvcGVydHkobGFtYmRhIHg6IHgudGhpcy5vd24oKSwgbGFtYmRhIHgsIHY6IHgudGhpcy5vd24odiksIGRvYz0nVGhlIG1lbWJlcnNoaXAgZmxhZycpCiAgICBfX3JlcHJfXyA9IF9zd2lnX3JlcHIKCiAgICBkZWYgZ2V0TmFtZShzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk1vZHVsZV9nZXROYW1lKHNlbGYpCgogICAgZGVmIHNldE1vZEluc3Qoc2VsZiwgbW9kX2luc3QpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTW9kdWxlX3NldE1vZEluc3Qoc2VsZiwgbW9kX2luc3QpCgogICAgZGVmIGdldE1vZEluc3Qoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJNb2R1bGVfZ2V0TW9kSW5zdChzZWxmKQoKICAgIGRlZiBnZXRIaWVyYXJjaGljYWxOYW1lKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTW9kdWxlX2dldEhpZXJhcmNoaWNhbE5hbWUoc2VsZikKCiAgICBkZWYgZ2V0TW9kTmV0KHNlbGYsIG5ldF9uYW1lKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk1vZHVsZV9nZXRNb2ROZXQoc2VsZiwgbmV0X25hbWUpCgogICAgZGVmIGFkZEluc3Qoc2VsZiwgaW5zdCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJNb2R1bGVfYWRkSW5zdChzZWxmLCBpbnN0KQoKICAgIGRlZiBnZXRPd25lcihzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk1vZHVsZV9nZXRPd25lcihzZWxmKQoKICAgIGRlZiBnZXRDaGlsZHJlbihzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk1vZHVsZV9nZXRDaGlsZHJlbihzZWxmKQoKICAgIGRlZiBnZXRNb2RJbnN0cyhzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk1vZHVsZV9nZXRNb2RJbnN0cyhzZWxmKQoKICAgIGRlZiBnZXRNb2ROZXRzKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTW9kdWxlX2dldE1vZE5ldHMoc2VsZikKCiAgICBkZWYgZ2V0UG9ydHMoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJNb2R1bGVfZ2V0UG9ydHMoc2VsZikKCiAgICBkZWYgZ2V0TW9kQlRlcm1zKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTW9kdWxlX2dldE1vZEJUZXJtcyhzZWxmKQoKICAgIGRlZiBnZXRNb2RCVGVybShzZWxmLCBpZCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJNb2R1bGVfZ2V0TW9kQlRlcm0oc2VsZiwgaWQpCgogICAgZGVmIGdldEluc3RzKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTW9kdWxlX2dldEluc3RzKHNlbGYpCgogICAgZGVmIGZpbmRNb2RJbnN0KHNlbGYsIG5hbWUpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTW9kdWxlX2ZpbmRNb2RJbnN0KHNlbGYsIG5hbWUpCgogICAgZGVmIGZpbmREYkluc3Qoc2VsZiwgbmFtZSk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJNb2R1bGVfZmluZERiSW5zdChzZWxmLCBuYW1lKQoKICAgIGRlZiBmaW5kTW9kQlRlcm0oc2VsZiwgbmFtZSk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJNb2R1bGVfZmluZE1vZEJUZXJtKHNlbGYsIG5hbWUpCgogICAgZGVmIGdldExlYWZJbnN0cyhzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk1vZHVsZV9nZXRMZWFmSW5zdHMoc2VsZikKCiAgICBkZWYgZ2V0TW9kSW5zdENvdW50KHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTW9kdWxlX2dldE1vZEluc3RDb3VudChzZWxmKQoKICAgIGRlZiBnZXREYkluc3RDb3VudChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk1vZHVsZV9nZXREYkluc3RDb3VudChzZWxmKQoKICAgIGRlZiBnZXRIZWFkRGJNb2RCVGVybShzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk1vZHVsZV9nZXRIZWFkRGJNb2RCVGVybShzZWxmKQoKICAgIGRlZiBjYW5Td2FwV2l0aChzZWxmLCBuZXdfbW9kdWxlKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk1vZHVsZV9jYW5Td2FwV2l0aChzZWxmLCBuZXdfbW9kdWxlKQoKICAgIGRlZiBpc1RvcChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk1vZHVsZV9pc1RvcChzZWxmKQoKICAgIGRlZiBjb250YWluc0RiSW5zdChzZWxmLCBpbnN0KToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk1vZHVsZV9jb250YWluc0RiSW5zdChzZWxmLCBpbnN0KQoKICAgIGRlZiBjb250YWluc0RiTW9kSW5zdChzZWxmLCBpbnN0KToKICAgICAgICByZXR1cm4gX29kYl9weS5kYk1vZHVsZV9jb250YWluc0RiTW9kSW5zdChzZWxmLCBpbnN0KQoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBjcmVhdGUoYmxvY2ssIG5hbWUpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTW9kdWxlX2NyZWF0ZShibG9jaywgbmFtZSkKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgZGVzdHJveShtb2R1bGUpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTW9kdWxlX2Rlc3Ryb3kobW9kdWxlKQoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBnZXRNb2R1bGUoYmxvY2tfLCBkYmlkXyk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJNb2R1bGVfZ2V0TW9kdWxlKGJsb2NrXywgZGJpZF8pCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIG1ha2VVbmlxdWVEYk1vZHVsZShjZWxsX25hbWUsIGluc3RfbmFtZSwgYmxvY2spOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTW9kdWxlX21ha2VVbmlxdWVEYk1vZHVsZShjZWxsX25hbWUsIGluc3RfbmFtZSwgYmxvY2spCgogICAgZGVmIF9faW5pdF9fKHNlbGYpOgogICAgICAgIF9vZGJfcHkuZGJNb2R1bGVfc3dpZ2luaXQoc2VsZiwgX29kYl9weS5uZXdfZGJNb2R1bGUoKSkKICAgIF9fc3dpZ19kZXN0cm95X18gPSBfb2RiX3B5LmRlbGV0ZV9kYk1vZHVsZQoKIyBSZWdpc3RlciBkYk1vZHVsZSBpbiBfb2RiX3B5Ogpfb2RiX3B5LmRiTW9kdWxlX3N3aWdyZWdpc3RlcihkYk1vZHVsZSkKCmRlZiBkYk1vZHVsZV9jcmVhdGUoYmxvY2ssIG5hbWUpOgogICAgcmV0dXJuIF9vZGJfcHkuZGJNb2R1bGVfY3JlYXRlKGJsb2NrLCBuYW1lKQoKZGVmIGRiTW9kdWxlX2Rlc3Ryb3kobW9kdWxlKToKICAgIHJldHVybiBfb2RiX3B5LmRiTW9kdWxlX2Rlc3Ryb3kobW9kdWxlKQoKZGVmIGRiTW9kdWxlX2dldE1vZHVsZShibG9ja18sIGRiaWRfKToKICAgIHJldHVybiBfb2RiX3B5LmRiTW9kdWxlX2dldE1vZHVsZShibG9ja18sIGRiaWRfKQoKZGVmIGRiTW9kdWxlX21ha2VVbmlxdWVEYk1vZHVsZShjZWxsX25hbWUsIGluc3RfbmFtZSwgYmxvY2spOgogICAgcmV0dXJuIF9vZGJfcHkuZGJNb2R1bGVfbWFrZVVuaXF1ZURiTW9kdWxlKGNlbGxfbmFtZSwgaW5zdF9uYW1lLCBibG9jaykKCmNsYXNzIGRiTmV0VHJhY2sob2JqZWN0KToKICAgIHRoaXNvd24gPSBwcm9wZXJ0eShsYW1iZGEgeDogeC50aGlzLm93bigpLCBsYW1iZGEgeCwgdjogeC50aGlzLm93bih2KSwgZG9jPSdUaGUgbWVtYmVyc2hpcCBmbGFnJykKICAgIF9fcmVwcl9fID0gX3N3aWdfcmVwcgoKICAgIGRlZiBnZXRCb3goc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJOZXRUcmFja19nZXRCb3goc2VsZikKCiAgICBkZWYgZ2V0TmV0KHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTmV0VHJhY2tfZ2V0TmV0KHNlbGYpCgogICAgZGVmIGdldExheWVyKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiTmV0VHJhY2tfZ2V0TGF5ZXIoc2VsZikKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgY3JlYXRlKG5ldCwgbGF5ZXIsIGJveCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJOZXRUcmFja19jcmVhdGUobmV0LCBsYXllciwgYm94KQoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBnZXROZXRUcmFjayhibG9jaywgZGJpZCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJOZXRUcmFja19nZXROZXRUcmFjayhibG9jaywgZGJpZCkKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgZGVzdHJveSgqYXJncyk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJOZXRUcmFja19kZXN0cm95KCphcmdzKQoKICAgIGRlZiBfX2luaXRfXyhzZWxmKToKICAgICAgICBfb2RiX3B5LmRiTmV0VHJhY2tfc3dpZ2luaXQoc2VsZiwgX29kYl9weS5uZXdfZGJOZXRUcmFjaygpKQogICAgX19zd2lnX2Rlc3Ryb3lfXyA9IF9vZGJfcHkuZGVsZXRlX2RiTmV0VHJhY2sKCiMgUmVnaXN0ZXIgZGJOZXRUcmFjayBpbiBfb2RiX3B5Ogpfb2RiX3B5LmRiTmV0VHJhY2tfc3dpZ3JlZ2lzdGVyKGRiTmV0VHJhY2spCgpkZWYgZGJOZXRUcmFja19jcmVhdGUobmV0LCBsYXllciwgYm94KToKICAgIHJldHVybiBfb2RiX3B5LmRiTmV0VHJhY2tfY3JlYXRlKG5ldCwgbGF5ZXIsIGJveCkKCmRlZiBkYk5ldFRyYWNrX2dldE5ldFRyYWNrKGJsb2NrLCBkYmlkKToKICAgIHJldHVybiBfb2RiX3B5LmRiTmV0VHJhY2tfZ2V0TmV0VHJhY2soYmxvY2ssIGRiaWQpCgpkZWYgZGJOZXRUcmFja19kZXN0cm95KCphcmdzKToKICAgIHJldHVybiBfb2RiX3B5LmRiTmV0VHJhY2tfZGVzdHJveSgqYXJncykKCmNsYXNzIGRiUG9seWdvbihvYmplY3QpOgogICAgdGhpc293biA9IHByb3BlcnR5KGxhbWJkYSB4OiB4LnRoaXMub3duKCksIGxhbWJkYSB4LCB2OiB4LnRoaXMub3duKHYpLCBkb2M9J1RoZSBtZW1iZXJzaGlwIGZsYWcnKQogICAgX19yZXByX18gPSBfc3dpZ19yZXByCgogICAgZGVmIGdldFBvbHlnb24oc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJQb2x5Z29uX2dldFBvbHlnb24oc2VsZikKCiAgICBkZWYgZ2V0RGVzaWduUnVsZVdpZHRoKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiUG9seWdvbl9nZXREZXNpZ25SdWxlV2lkdGgoc2VsZikKCiAgICBkZWYgZ2V0VGVjaExheWVyKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiUG9seWdvbl9nZXRUZWNoTGF5ZXIoc2VsZikKCiAgICBkZWYgZ2V0R2VvbWV0cnkoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJQb2x5Z29uX2dldEdlb21ldHJ5KHNlbGYpCgogICAgZGVmIHNldERlc2lnblJ1bGVXaWR0aChzZWxmLCBkZXNpZ25fcnVsZV93aWR0aCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJQb2x5Z29uX3NldERlc2lnblJ1bGVXaWR0aChzZWxmLCBkZXNpZ25fcnVsZV93aWR0aCkKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgY3JlYXRlKCphcmdzKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlBvbHlnb25fY3JlYXRlKCphcmdzKQoKICAgIGRlZiBfX2luaXRfXyhzZWxmKToKICAgICAgICBfb2RiX3B5LmRiUG9seWdvbl9zd2lnaW5pdChzZWxmLCBfb2RiX3B5Lm5ld19kYlBvbHlnb24oKSkKICAgIF9fc3dpZ19kZXN0cm95X18gPSBfb2RiX3B5LmRlbGV0ZV9kYlBvbHlnb24KCiMgUmVnaXN0ZXIgZGJQb2x5Z29uIGluIF9vZGJfcHk6Cl9vZGJfcHkuZGJQb2x5Z29uX3N3aWdyZWdpc3RlcihkYlBvbHlnb24pCgpkZWYgZGJQb2x5Z29uX2NyZWF0ZSgqYXJncyk6CiAgICByZXR1cm4gX29kYl9weS5kYlBvbHlnb25fY3JlYXRlKCphcmdzKQoKY2xhc3MgZGJQb3dlckRvbWFpbihvYmplY3QpOgogICAgdGhpc293biA9IHByb3BlcnR5KGxhbWJkYSB4OiB4LnRoaXMub3duKCksIGxhbWJkYSB4LCB2OiB4LnRoaXMub3duKHYpLCBkb2M9J1RoZSBtZW1iZXJzaGlwIGZsYWcnKQogICAgX19yZXByX18gPSBfc3dpZ19yZXByCgogICAgZGVmIGdldE5hbWUoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJQb3dlckRvbWFpbl9nZXROYW1lKHNlbGYpCgogICAgZGVmIGdldEdyb3VwKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiUG93ZXJEb21haW5fZ2V0R3JvdXAoc2VsZikKCiAgICBkZWYgc2V0VG9wKHNlbGYsIHRvcCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJQb3dlckRvbWFpbl9zZXRUb3Aoc2VsZiwgdG9wKQoKICAgIGRlZiBpc1Rv",
"cChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlBvd2VyRG9tYWluX2lzVG9wKHNlbGYpCgogICAgZGVmIHNldFBhcmVudChzZWxmLCBwYXJlbnQpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiUG93ZXJEb21haW5fc2V0UGFyZW50KHNlbGYsIHBhcmVudCkKCiAgICBkZWYgZ2V0UGFyZW50KHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiUG93ZXJEb21haW5fZ2V0UGFyZW50KHNlbGYpCgogICAgZGVmIHNldFZvbHRhZ2Uoc2VsZiwgdm9sdGFnZSk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJQb3dlckRvbWFpbl9zZXRWb2x0YWdlKHNlbGYsIHZvbHRhZ2UpCgogICAgZGVmIGdldFZvbHRhZ2Uoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJQb3dlckRvbWFpbl9nZXRWb2x0YWdlKHNlbGYpCgogICAgZGVmIHNldEdyb3VwKHNlbGYsIGdyb3VwKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlBvd2VyRG9tYWluX3NldEdyb3VwKHNlbGYsIGdyb3VwKQoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBjcmVhdGUoYmxvY2ssIG5hbWUpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiUG93ZXJEb21haW5fY3JlYXRlKGJsb2NrLCBuYW1lKQoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBkZXN0cm95KHBkKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlBvd2VyRG9tYWluX2Rlc3Ryb3kocGQpCgogICAgZGVmIGFkZEVsZW1lbnQoc2VsZiwgZWxlbWVudCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJQb3dlckRvbWFpbl9hZGRFbGVtZW50KHNlbGYsIGVsZW1lbnQpCgogICAgZGVmIGdldEVsZW1lbnRzKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiUG93ZXJEb21haW5fZ2V0RWxlbWVudHMoc2VsZikKCiAgICBkZWYgYWRkUG93ZXJTd2l0Y2goc2VsZiwgcHMpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiUG93ZXJEb21haW5fYWRkUG93ZXJTd2l0Y2goc2VsZiwgcHMpCgogICAgZGVmIGFkZElzb2xhdGlvbihzZWxmLCBpc28pOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiUG93ZXJEb21haW5fYWRkSXNvbGF0aW9uKHNlbGYsIGlzbykKCiAgICBkZWYgYWRkTGV2ZWxTaGlmdGVyKHNlbGYsIHNoaWZ0ZXIpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiUG93ZXJEb21haW5fYWRkTGV2ZWxTaGlmdGVyKHNlbGYsIHNoaWZ0ZXIpCgogICAgZGVmIGdldFBvd2VyU3dpdGNoZXMoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJQb3dlckRvbWFpbl9nZXRQb3dlclN3aXRjaGVzKHNlbGYpCgogICAgZGVmIGdldElzb2xhdGlvbnMoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJQb3dlckRvbWFpbl9nZXRJc29sYXRpb25zKHNlbGYpCgogICAgZGVmIGdldExldmVsU2hpZnRlcnMoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJQb3dlckRvbWFpbl9nZXRMZXZlbFNoaWZ0ZXJzKHNlbGYpCgogICAgZGVmIHNldEFyZWEoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJQb3dlckRvbWFpbl9zZXRBcmVhKHNlbGYpCgogICAgZGVmIGdldEFyZWEoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJQb3dlckRvbWFpbl9nZXRBcmVhKHNlbGYpCgogICAgZGVmIF9faW5pdF9fKHNlbGYpOgogICAgICAgIF9vZGJfcHkuZGJQb3dlckRvbWFpbl9zd2lnaW5pdChzZWxmLCBfb2RiX3B5Lm5ld19kYlBvd2VyRG9tYWluKCkpCiAgICBfX3N3aWdfZGVzdHJveV9fID0gX29kYl9weS5kZWxldGVfZGJQb3dlckRvbWFpbgoKIyBSZWdpc3RlciBkYlBvd2VyRG9tYWluIGluIF9vZGJfcHk6Cl9vZGJfcHkuZGJQb3dlckRvbWFpbl9zd2lncmVnaXN0ZXIoZGJQb3dlckRvbWFpbikKCmRlZiBkYlBvd2VyRG9tYWluX2NyZWF0ZShibG9jaywgbmFtZSk6CiAgICByZXR1cm4gX29kYl9weS5kYlBvd2VyRG9tYWluX2NyZWF0ZShibG9jaywgbmFtZSkKCmRlZiBkYlBvd2VyRG9tYWluX2Rlc3Ryb3kocGQpOgogICAgcmV0dXJuIF9vZGJfcHkuZGJQb3dlckRvbWFpbl9kZXN0cm95KHBkKQoKY2xhc3MgZGJQb3dlclN3aXRjaChvYmplY3QpOgogICAgdGhpc293biA9IHByb3BlcnR5KGxhbWJkYSB4OiB4LnRoaXMub3duKCksIGxhbWJkYSB4LCB2OiB4LnRoaXMub3duKHYpLCBkb2M9J1RoZSBtZW1iZXJzaGlwIGZsYWcnKQogICAgX19yZXByX18gPSBfc3dpZ19yZXByCgogICAgZGVmIGdldE5hbWUoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJQb3dlclN3aXRjaF9nZXROYW1lKHNlbGYpCgogICAgZGVmIHNldFBvd2VyRG9tYWluKHNlbGYsIHBvd2VyX2RvbWFpbik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJQb3dlclN3aXRjaF9zZXRQb3dlckRvbWFpbihzZWxmLCBwb3dlcl9kb21haW4pCgogICAgZGVmIGdldFBvd2VyRG9tYWluKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiUG93ZXJTd2l0Y2hfZ2V0UG93ZXJEb21haW4oc2VsZikKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgY3JlYXRlKGJsb2NrLCBuYW1lKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlBvd2VyU3dpdGNoX2NyZWF0ZShibG9jaywgbmFtZSkKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgZGVzdHJveShwcyk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJQb3dlclN3aXRjaF9kZXN0cm95KHBzKQoKICAgIGRlZiBhZGRJblN1cHBseVBvcnQoc2VsZiwgaW5fcG9ydCwgbmV0KToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlBvd2VyU3dpdGNoX2FkZEluU3VwcGx5UG9ydChzZWxmLCBpbl9wb3J0LCBuZXQpCgogICAgZGVmIHNldE91dFN1cHBseVBvcnQoc2VsZiwgb3V0X3BvcnQsIG5ldCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJQb3dlclN3aXRjaF9zZXRPdXRTdXBwbHlQb3J0KHNlbGYsIG91dF9wb3J0LCBuZXQpCgogICAgZGVmIGFkZENvbnRyb2xQb3J0KHNlbGYsIGNvbnRyb2xfcG9ydCwgY29udHJvbF9uZXQpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiUG93ZXJTd2l0Y2hfYWRkQ29udHJvbFBvcnQoc2VsZiwgY29udHJvbF9wb3J0LCBjb250cm9sX25ldCkKCiAgICBkZWYgYWRkQWNrbm93bGVkZ2VQb3J0KHNlbGYsIHBvcnRfbmFtZSwgbmV0X25hbWUsIGJvb2xlYW5fZXhwcmVzc2lvbik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJQb3dlclN3aXRjaF9hZGRBY2tub3dsZWRnZVBvcnQoc2VsZiwgcG9ydF9uYW1lLCBuZXRfbmFtZSwgYm9vbGVhbl9leHByZXNzaW9uKQoKICAgIGRlZiBhZGRPblN0YXRlKHNlbGYsIG9uX3N0YXRlLCBwb3J0X25hbWUsIGJvb2xlYW5fZXhwcmVzc2lvbik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJQb3dlclN3aXRjaF9hZGRPblN0YXRlKHNlbGYsIG9uX3N0YXRlLCBwb3J0X25hbWUsIGJvb2xlYW5fZXhwcmVzc2lvbikKCiAgICBkZWYgc2V0TGliQ2VsbChzZWxmLCBtYXN0ZXIpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiUG93ZXJTd2l0Y2hfc2V0TGliQ2VsbChzZWxmLCBtYXN0ZXIpCgogICAgZGVmIGFkZFBvcnRNYXAoc2VsZiwgKmFyZ3MpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiUG93ZXJTd2l0Y2hfYWRkUG9ydE1hcChzZWxmLCAqYXJncykKCiAgICBkZWYgZ2V0Q29udHJvbFBvcnRzKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiUG93ZXJTd2l0Y2hfZ2V0Q29udHJvbFBvcnRzKHNlbGYpCgogICAgZGVmIGdldElucHV0U3VwcGx5UG9ydHMoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJQb3dlclN3aXRjaF9nZXRJbnB1dFN1cHBseVBvcnRzKHNlbGYpCgogICAgZGVmIGdldE91dHB1dFN1cHBseVBvcnQoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJQb3dlclN3aXRjaF9nZXRPdXRwdXRTdXBwbHlQb3J0KHNlbGYpCgogICAgZGVmIGdldEFja25vd2xlZGdlUG9ydHMoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJQb3dlclN3aXRjaF9nZXRBY2tub3dsZWRnZVBvcnRzKHNlbGYpCgogICAgZGVmIGdldE9uU3RhdGVzKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiUG93ZXJTd2l0Y2hfZ2V0T25TdGF0ZXMoc2VsZikKCiAgICBkZWYgZ2V0TGliQ2VsbChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlBvd2VyU3dpdGNoX2dldExpYkNlbGwoc2VsZikKCiAgICBkZWYgZ2V0UG9ydE1hcChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlBvd2VyU3dpdGNoX2dldFBvcnRNYXAoc2VsZikKCiAgICBkZWYgX19pbml0X18oc2VsZik6CiAgICAgICAgX29kYl9weS5kYlBvd2VyU3dpdGNoX3N3aWdpbml0KHNlbGYsIF9vZGJfcHkubmV3X2RiUG93ZXJTd2l0Y2goKSkKICAgIF9fc3dpZ19kZXN0cm95X18gPSBfb2RiX3B5LmRlbGV0ZV9kYlBvd2VyU3dpdGNoCgojIFJlZ2lzdGVyIGRiUG93ZXJTd2l0Y2ggaW4gX29kYl9weToKX29kYl9weS5kYlBvd2VyU3dpdGNoX3N3aWdyZWdpc3RlcihkYlBvd2VyU3dpdGNoKQoKZGVmIGRiUG93ZXJTd2l0Y2hfY3JlYXRlKGJsb2NrLCBuYW1lKToKICAgIHJldHVybiBfb2RiX3B5LmRiUG93ZXJTd2l0Y2hfY3JlYXRlKGJsb2NrLCBuYW1lKQoKZGVmIGRiUG93ZXJTd2l0Y2hfZGVzdHJveShwcyk6CiAgICByZXR1cm4gX29kYl9weS5kYlBvd2VyU3dpdGNoX2Rlc3Ryb3kocHMpCgpjbGFzcyBkYlByb3BlcnR5KG9iamVjdCk6CiAgICB0aGlzb3duID0gcHJvcGVydHkobGFtYmRhIHg6IHgudGhpcy5vd24oKSwgbGFtYmRhIHgsIHY6IHgudGhpcy5vd24odiksIGRvYz0nVGhlIG1lbWJlcnNoaXAgZmxhZycpCiAgICBfX3JlcHJfXyA9IF9zd2lnX3JlcHIKICAgIFNUUklOR19QUk9QID0gX29kYl9weS5kYlByb3BlcnR5X1NUUklOR19QUk9QCiAgICBCT09MX1BST1AgPSBfb2RiX3B5LmRiUHJvcGVydHlfQk9PTF9QUk9QCiAgICBJTlRfUFJPUCA9IF9vZGJfcHkuZGJQcm9wZXJ0eV9JTlRfUFJPUAogICAgRE9VQkxFX1BST1AgPSBfb2RiX3B5LmRiUHJvcGVydHlfRE9VQkxFX1BST1AKCiAgICBkZWYgZ2V0VHlwZShzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlByb3BlcnR5X2dldFR5cGUoc2VsZikKCiAgICBkZWYgZ2V0TmFtZShzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlByb3BlcnR5X2dldE5hbWUoc2VsZikKCiAgICBkZWYgZ2V0UHJvcE93bmVyKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiUHJvcGVydHlfZ2V0UHJvcE93bmVyKHNlbGYpCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIGZpbmQoKmFyZ3MpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiUHJvcGVydHlfZmluZCgqYXJncykKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgZGVzdHJveVByb3BlcnRpZXMob2JqKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlByb3BlcnR5X2Rlc3Ryb3lQcm9wZXJ0aWVzKG9iaikKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgZ2V0UHJvcGVydGllcyhvYmplY3QpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiUHJvcGVydHlfZ2V0UHJvcGVydGllcyhvYmplY3QpCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIGRlc3Ryb3koKmFyZ3MpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiUHJvcGVydHlfZGVzdHJveSgqYXJncykKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgd3JpdGVQcm9wZXJ0aWVzKG9iamVjdCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJQcm9wZXJ0eV93cml0ZVByb3BlcnRpZXMob2JqZWN0KQoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiB3cml0ZVByb3BWYWx1ZShwcm9wKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlByb3BlcnR5X3dyaXRlUHJvcFZhbHVlKHByb3ApCgogICAgZGVmIF9faW5pdF9fKHNlbGYpOgogICAgICAgIF9vZGJfcHkuZGJQcm9wZXJ0eV9zd2lnaW5pdChzZWxmLCBfb2RiX3B5Lm5ld19kYlByb3BlcnR5KCkpCiAgICBfX3N3aWdfZGVzdHJveV9fID0gX29kYl9weS5kZWxldGVfZGJQcm9wZXJ0eQoKIyBSZWdpc3RlciBkYlByb3BlcnR5IGluIF9vZGJfcHk6Cl9vZGJfcHkuZGJQcm9wZXJ0eV9zd2lncmVnaXN0ZXIoZGJQcm9wZXJ0eSkKCmRlZiBkYlByb3BlcnR5X2ZpbmQoKmFyZ3MpOgogICAgcmV0dXJuIF9vZGJfcHkuZGJQcm9wZXJ0eV9maW5kKCphcmdzKQoKZGVmIGRiUHJvcGVydHlfZGVzdHJveVByb3BlcnRpZXMob2JqKToKICAgIHJldHVybiBfb2RiX3B5LmRiUHJvcGVydHlfZGVzdHJveVByb3BlcnRpZXMob2JqKQoKZGVmIGRiUHJvcGVydHlfZ2V0UHJvcGVydGllcyhvYmplY3QpOgogICAgcmV0dXJuIF9vZGJfcHkuZGJQcm9wZXJ0eV9nZXRQcm9wZXJ0aWVzKG9iamVjdCkKCmRlZiBkYlByb3BlcnR5X2Rlc3Ryb3koKmFyZ3MpOgogICAgcmV0dXJuIF9vZGJfcHkuZGJQcm9wZXJ0eV9kZXN0cm95KCphcmdzKQoKZGVmIGRiUHJvcGVydHlfd3JpdGVQcm9wZXJ0aWVzKG9iamVjdCk6CiAgICByZXR1cm4gX29kYl9weS5kYlByb3BlcnR5X3dyaXRlUHJvcGVydGllcyhvYmplY3QpCgpkZWYgZGJQcm9wZXJ0eV93cml0ZVByb3BWYWx1ZShwcm9wKToKICAgIHJldHVybiBfb2RiX3B5LmRiUHJvcGVydHlfd3JpdGVQcm9wVmFsdWUocHJvcCkKCmNsYXNzIGRiU2NhbkNoYWluKG9iamVjdCk6CiAgICB0aGlzb3duID0gcHJvcGVydHkobGFtYmRhIHg6IHgudGhpcy5vd24oKSwgbGFtYmRhIHgsIHY6IHgudGhpcy5vd24odiksIGRvYz0nVGhlIG1lbWJlcnNoaXAgZmxhZycpCiAgICBfX3JlcHJfXyA9IF9zd2lnX3JlcHIKCiAgICBkZWYgZ2V0U2NhblBhcnRpdGlvbnMoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJTY2FuQ2hhaW5fZ2V0U2NhblBhcnRpdGlvbnMoc2VsZikKCiAgICBkZWYgZ2V0TmFtZShzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlNjYW5DaGFpbl9nZXROYW1lKHNlbGYpCgogICAgZGVmIHNldE5hbWUoc2VsZiwgbmFtZSk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJTY2FuQ2hhaW5fc2V0TmFtZShzZWxmLCBuYW1lKQoKICAgIGRlZiBzZXRTY2FuSW4oc2VsZiwgKmFyZ3MpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiU2NhbkNoYWluX3NldFNjYW5JbihzZWxmLCAqYXJncykKCiAgICBkZWYgZ2V0U2NhbkluKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiU2NhbkNoYWluX2dldFNjYW5JbihzZWxmKQoKICAgIGRlZiBzZXRTY2FuT3V0KHNlbGYsICphcmdzKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlNjYW5DaGFpbl9zZXRTY2FuT3V0KHNlbGYsICphcmdzKQoKICAgIGRlZiBnZXRTY2FuT3V0KHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiU2NhbkNoYWluX2dldFNjYW5PdXQoc2VsZikKCiAgICBkZWYgc2V0U2NhbkVuYWJsZShzZWxmLCAqYXJncyk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJTY2FuQ2hhaW5fc2V0U2NhbkVuYWJsZShzZWxmLCAqYXJncykKCiAgICBkZWYgZ2V0U2NhbkVuYWJsZShzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlNjYW5DaGFpbl9nZXRTY2FuRW5hYmxlKHNlbGYpCgogICAgZGVmIHNldFRlc3RNb2RlKHNlbGYsICphcmdzKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlNjYW5DaGFpbl9zZXRUZXN0TW9kZShzZWxmLCAqYXJncykKCiAgICBkZWYgZ2V0VGVzdE1vZGUoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJTY2FuQ2hhaW5fZ2V0VGVzdE1vZGUoc2VsZikKCiAgICBkZWYgc2V0VGVzdE1vZGVOYW1lKHNlbGYsIHRlc3RfbW9kZV9uYW1lKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlNjYW5DaGFpbl9zZXRUZXN0TW9kZU5hbWUoc2VsZiwgdGVzdF9tb2RlX25hbWUpCgogICAgZGVmIGdldFRlc3RNb2RlTmFtZShzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlNjYW5DaGFpbl9nZXRUZXN0TW9kZU5hbWUoc2VsZikKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgY3JlYXRlKGRmdCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJTY2FuQ2hhaW5fY3JlYXRlKGRmdCkKCiAgICBkZWYgX19pbml0X18oc2VsZik6CiAgICAgICAgX29kYl9weS5kYlNjYW5DaGFpbl9zd2lnaW5pdChzZWxmLCBfb2RiX3B5Lm5ld19kYlNjYW5DaGFpbigpKQogICAgX19zd2lnX2Rlc3Ryb3lfXyA9IF9vZGJfcHkuZGVsZXRlX2RiU2NhbkNoYWluCgojIFJlZ2lzdGVyIGRiU2NhbkNoYWluIGluIF9vZGJfcHk6Cl9vZGJfcHkuZGJTY2FuQ2hhaW5fc3dpZ3JlZ2lzdGVyKGRiU2NhbkNoYWluKQoKZGVmIGRiU2NhbkNoYWluX2NyZWF0ZShkZnQpOgogICAgcmV0dXJuIF9vZGJfcHkuZGJTY2FuQ2hhaW5fY3JlYXRlKGRmdCkKCmNsYXNzIGRiU2Nhbkluc3Qob2JqZWN0KToKICAgIHRoaXNvd24gPSBwcm9wZXJ0eShsYW1iZGEgeDogeC50aGlzLm93bigpLCBsYW1iZGEgeCwgdjogeC50aGlzLm93bih2KSwgZG9jPSdUaGUgbWVtYmVyc2hpcCBmbGFnJykKICAgIF9fcmVwcl9fID0gX3N3aWdfcmVwcgogICAgQ2xvY2tFZGdlX1Jpc2luZyA9IF9vZGJfcHkuZGJTY2FuSW5zdF9DbG9ja0VkZ2VfUmlzaW5nCiAgICBDbG9ja0VkZ2VfRmFsbGluZyA9IF9vZGJfcHkuZGJTY2FuSW5zdF9DbG9ja0VkZ2VfRmFsbGluZwoKICAgIGRlZiBzZXRTY2FuQ2xvY2soc2VsZiwgc2Nhbl9jbG9jayk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJTY2FuSW5zdF9zZXRTY2FuQ2xvY2soc2VsZiwgc2Nhbl9jbG9jaykKCiAgICBkZWYgZ2V0U2NhbkNsb2NrKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiU2Nhbkluc3RfZ2V0U2NhbkNsb2NrKHNlbGYpCgogICAgZGVmIHNldENsb2NrRWRnZShzZWxmLCBjbG9ja19lZGdlKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlNjYW5JbnN0X3NldENsb2NrRWRnZShzZWxmLCBjbG9ja19lZGdlKQoKICAgIGRlZiBnZXRDbG9ja0VkZ2Uoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJTY2FuSW5zdF9nZXRDbG9ja0VkZ2Uoc2VsZikKCiAgICBkZWYgZ2V0Q2xvY2tFZGdlU3RyaW5nKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiU2Nhbkluc3RfZ2V0Q2xvY2tFZGdlU3RyaW5nKHNlbGYpCgogICAgZGVmIHNldEJpdHMoc2VsZiwgYml0cyk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJTY2FuSW5zdF9zZXRCaXRzKHNlbGYsIGJpdHMpCgogICAgZGVmIGdldEJpdHMoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJTY2FuSW5zdF9nZXRCaXRzKHNlbGYpCgogICAgZGVmIHNldFNjYW5FbmFibGUoc2VsZiwgKmFyZ3MpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiU2Nhbkluc3Rfc2V0U2NhbkVuYWJsZShzZWxmLCAqYXJncykKCiAgICBkZWYgZ2V0U2NhbkVuYWJsZShzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlNjYW5JbnN0X2dldFNjYW5FbmFibGUoc2VsZikKCiAgICBkZWYgc2V0QWNjZXNzUGlucyhzZWxmLCBhY2Nlc3NfcGlucyk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJTY2FuSW5zdF9zZXRBY2Nlc3NQaW5zKHNlbGYsIGFjY2Vzc19waW5zKQoKICAgIGRlZiBnZXRBY2Nlc3NQaW5zKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiU2Nhbkluc3RfZ2V0QWNjZXNzUGlucyhzZWxmKQoKICAgIGRlZiBnZXRJbnN0KHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiU2Nhbkluc3RfZ2V0SW5zdChzZWxmKQoKICAgIGRlZiBpbnNlcnRBdEZyb250KHNlbGYsIHNjYW5fbGlzdCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJTY2FuSW5zdF9pbnNlcnRBdEZyb250KHNlbGYsIHNjYW5fbGlzdCkKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgY3JlYXRlKHNjYW5fbGlzdCwgaW5zdCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJTY2FuSW5zdF9jcmVhdGUoc2Nhbl9saXN0LCBpbnN0KQoKICAgIGRlZiBfX2luaXRfXyhzZWxmKToKICAgICAgICBfb2RiX3B5LmRiU2Nhbkluc3Rfc3dpZ2luaXQoc2VsZiwgX29kYl9weS5uZXdfZGJTY2FuSW5zdCgpKQogICAgX19zd2lnX2Rlc3Ryb3lfXyA9IF9vZGJfcHkuZGVsZXRlX2RiU2Nhbkluc3QKCiMgUmVnaXN0ZXIgZGJTY2FuSW5zdCBpbiBfb2RiX3B5Ogpfb2RiX3B5LmRiU2Nhbkluc3Rfc3dpZ3JlZ2lzdGVyKGRiU2Nhbkluc3QpCgpkZWYgZGJTY2FuSW5zdF9jcmVhdGUoc2Nhbl9saXN0LCBpbnN0KToKICAgIHJldHVybiBfb2RiX3B5LmRiU2Nhbkluc3RfY3JlYXRlKHNjYW5fbGlzdCwgaW5zdCkKCmNsYXNzIGRiU2Nhbkxpc3Qob2JqZWN0KToKICAgIHRoaXNvd24gPSBwcm9wZXJ0eShsYW1iZGEgeDogeC50aGlzLm93bigpLCBsYW1iZGEgeCwgdjogeC50aGlzLm93bih2KSwgZG9jPSdUaGUgbWVtYmVyc2hpcCBmbGFnJykKICAgIF9fcmVwcl9fID0gX3N3aWdfcmVwcgoKICAgIGRlZiBnZXRTY2FuSW5zdHMoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJTY2FuTGlzdF9nZXRTY2FuSW5zdHMoc2VsZikKCiAgICBkZWYgYWRkKHNlbGYsIGluc3QpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiU2Nhbkxpc3RfYWRkKHNlbGYsIGluc3QpCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIGNyZWF0ZShzY2FuX3BhcnRpdGlvbik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJTY2FuTGlzdF9jcmVhdGUoc2Nhbl9wYXJ0aXRpb24pCgogICAgZGVmIF9faW5pdF9fKHNlbGYpOgogICAgICAgIF9vZGJfcHkuZGJTY2FuTGlzdF9zd2lnaW5pdChzZWxmLCBfb2RiX3B5Lm5ld19kYlNjYW5MaXN0KCkpCiAgICBfX3N3aWdfZGVzdHJveV9fID0gX29kYl9weS5kZWxldGVfZGJTY2FuTGlzdAoKIyBSZWdpc3RlciBkYlNjYW5MaXN0IGluIF9vZGJfcHk6Cl9vZGJfcHkuZGJTY2FuTGlzdF9zd2lncmVnaXN0ZXIoZGJTY2FuTGlzdCkKCmRlZiBkYlNjYW5MaXN0X2NyZWF0ZShzY2FuX3BhcnRpdGlvbik6CiAgICByZXR1cm4gX29kYl9weS5kYlNjYW5MaXN0X2NyZWF0ZShzY2FuX3BhcnRpdGlvbikKCmNsYXNzIGRiU2NhblBhcnRpdGlvbihvYmplY3QpOgogICAgdGhpc293biA9IHByb3BlcnR5KGxhbWJkYSB4OiB4LnRoaXMub3duKCksIGxhbWJkYSB4LCB2OiB4LnRoaXMub3duKHYpLCBkb2M9J1RoZSBtZW1iZXJzaGlwIGZsYWcnKQogICAgX19yZXByX18gPSBfc3dpZ19yZXByCgogICAgZGVmIGdldFNjYW5MaXN0cyhzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlNjYW5QYXJ0aXRpb25fZ2V0U2Nhbkxpc3RzKHNlbGYpCgogICAgZGVmIGdldE5hbWUoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJTY2FuUGFydGl0aW9uX2dldE5hbWUoc2VsZikKCiAgICBkZWYgc2V0TmFtZShzZWxmLCBuYW1lKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlNjYW5QYXJ0aXRpb25fc2V0TmFtZShzZWxmLCBuYW1lKQoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBjcmVhdGUoY2hhaW4pOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiU2NhblBhcnRpdGlvbl9jcmVhdGUoY2hhaW4pCgogICAgZGVmIF9faW5pdF9fKHNlbGYpOgogICAgICAgIF9vZGJfcHkuZGJTY2FuUGFydGl0aW9uX3N3aWdpbml0KHNlbGYsIF9vZGJfcHkubmV3X2RiU2NhblBhcnRpdGlvbigpKQogICAgX19zd2lnX2Rlc3Ryb3lfXyA9IF9vZGJfcHkuZGVsZXRlX2RiU2NhblBhcnRpdGlvbgoKIyBSZWdpc3RlciBkYlNjYW5QYXJ0aXRpb24gaW4gX29kYl9weToKX29kYl9weS5kYlNjYW5QYXJ0aXRpb25fc3dpZ3JlZ2lzdGVyKGRiU2NhblBhcnRpdGlvbikKCmRlZiBkYlNjYW5QYXJ0aXRpb25fY3JlYXRlKGNoYWluKToKICAgIHJldHVybiBfb2RiX3B5LmRiU2NhblBhcnRpdGlvbl9jcmVhdGUoY2hhaW4pCgpjbGFzcyBkYlNjYW5QaW4ob2JqZWN0KToKICAgIHRoaXNvd24gPSBwcm9wZXJ0eShsYW1iZGEgeDogeC50aGlzLm93bigpLCBsYW1iZGEgeCwgdjogeC50aGlzLm93bih2KSwgZG9jPSdUaGUgbWVtYmVyc2hpcCBmbGFnJykKICAgIF9fcmVwcl9fID0gX3N3aWdfcmVwcgoKICAgIGRlZiBnZXRQaW4oc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJTY2FuUGluX2dldFBpbihzZWxmKQoKICAgIGRlZiBzZXRQaW4oc2VsZiwgKmFyZ3MpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiU2NhblBpbl9zZXRQaW4oc2VsZiwgKmFyZ3MpCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIGNyZWF0ZSgqYXJncyk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJTY2FuUGluX2NyZWF0ZSgqYXJncykKCiAgICBkZWYgX19pbml0X18oc2VsZik6CiAgICAgICAgX29kYl9weS5kYlNjYW5QaW5fc3dpZ2luaXQoc2VsZiwgX29kYl9weS5uZXdfZGJTY2FuUGluKCkpCiAgICBfX3N3aWdfZGVzdHJveV9fID0gX29kYl9weS5kZWxldGVfZGJTY2FuUGluCgojIFJlZ2lzdGVyIGRiU2NhblBpbiBpbiBfb2RiX3B5Ogpfb2RiX3B5LmRiU2NhblBpbl9zd2lncmVnaXN0ZXIoZGJTY2FuUGluKQoKZGVmIGRiU2NhblBpbl9jcmVhdGUoKmFyZ3MpOgogICAgcmV0dXJuIF9vZGJfcHkuZGJTY2FuUGluX2NyZWF0ZSgqYXJncykKCmNsYXNzIGRiVGVjaExheWVyKG9iamVjdCk6CiAgICB0aGlzb3duID0gcHJvcGVydHkobGFtYmRhIHg6IHgudGhpcy5vd24oKSwgbGFtYmRhIHgsIHY6IHgudGhpcy5vd24odiksIGRvYz0nVGhlIG1lbWJlcnNoaXAgZmxhZycpCiAgICBfX3JlcHJfXyA9IF9zd2lnX3JlcHIKICAgIE5PTkUgPSBfb2RiX3B5LmRiVGVjaExheWVyX05PTkUKICAgIE5XRUxMID0gX29kYl9weS5kYlRlY2hMYXllcl9OV0VMTAogICAgUFdFTEwgPSBfb2RiX3B5LmRiVGVjaExheWVyX1BXRUxMCiAgICBBQk9WRURJRUVER0UgPSBfb2RiX3B5LmRiVGVjaExheWVyX0FCT1ZFRElFRURHRQogICAgQkVMT1dESUVFREdFID0gX29kYl9weS5kYlRlY2hMYXllcl9CRUxPV0RJRUVER0UKICAgIERJRkZVU0lPTiA9IF9vZGJfcHkuZGJUZWNoTGF5ZXJfRElGRlVTSU9OCiAgICBUUklNUE9MWSA9IF9vZGJfcHkuZGJUZWNoTGF5ZXJfVFJJTVBPTFkKICAgIE1JTUNBUCA9IF9vZGJfcHkuZGJUZWNoTGF5ZXJfTUlNQ0FQCiAgICBTVEFDS0VETUlNQ0FQID0gX29kYl9weS5kYlRlY2hMYXllcl9TVEFDS0VETUlNQ0FQCiAgICBUU1ZNRVRBTCA9IF9vZGJfcHkuZGJUZWNoTGF5ZXJfVFNWTUVUQUwKICAgIFRTViA9IF9vZGJfcHkuZGJUZWNoTGF5ZXJfVFNWCiAgICBQQVNTSVZBVElPTiA9IF9vZGJfcHkuZGJUZWNoTGF5ZXJfUEFTU0lWQVRJT04KICAgIEhJR0hSID0gX29kYl9weS5kYlRlY2hMYXllcl9ISUdIUgogICAgVFJJTU1FVEFMID0gX29kYl9weS5kYlRlY2hMYXllcl9UUklNTUVUQUwKICAgIFJFR0lPTiA9IF9vZGJfcHkuZGJUZWNoTGF5ZXJfUkVHSU9OCiAgICBNRU9MID0gX29kYl9weS5kYlRlY2hMYXllcl9NRU9MCiAgICBXRUxMRElTVEFOQ0UgPSBfb2RiX3B5LmRiVGVjaExheWVyX1dFTExESVNUQU5DRQogICAgQ1BPREUgPSBfb2RiX3B5LmRiVGVjaExheWVyX0NQT0RFCiAgICBQQURNRVRBTCA9IF9vZGJfcHkuZGJUZWNoTGF5ZXJfUEFETUVUQUwKICAgIFBPTFlST1VUSU5HID0gX29kYl9weS5kYlRlY2hMYXllcl9QT0xZUk9VVElORwoKICAgIGRlZiBzZXRXcm9uZ1dheVdpZHRoKHNlbGYsIHdyb25nX3dheV93aWR0aCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJfc2V0V3JvbmdXYXlXaWR0aChzZWxmLCB3cm9uZ193YXlfd2lkdGgpCgogICAgZGVmIGdldFdyb25nV2F5V2lkdGgoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJfZ2V0V3JvbmdXYXlXaWR0aChzZWxmKQoKICAgIGRlZiBzZXRMYXllckFkanVzdG1lbnQoc2VsZiwgbGF5ZXJfYWRqdXN0bWVudCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJfc2V0TGF5ZXJBZGp1c3RtZW50KHNlbGYsIGxheWVyX2FkanVzdG1lbnQpCgogICAgZGVmIGdldExheWVyQWRqdXN0bWVudChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllcl9nZXRMYXllckFkanVzdG1lbnQoc2VsZikKCiAgICBkZWYgZ2V0T3J0aFNwYWNpbmdUYWJsZShzZWxmLCB0YmwpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyX2dldE9ydGhTcGFjaW5nVGFibGUoc2VsZiwgdGJsKQoKICAgIGRlZiBnZXRUZWNoTGF5ZXJDdXRDbGFzc1J1bGVzKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyX2dldFRlY2hMYXllckN1dENsYXNzUnVsZXMoc2VsZikKCiAgICBkZWYgZmluZFRlY2hMYXllckN1dENsYXNzUnVsZShzZWxmLCBuYW1lKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllcl9maW5kVGVjaExheWVyQ3V0Q2xhc3NSdWxlKHNlbGYsIG5hbWUpCgogICAgZGVmIGdldFRlY2hMYXllclNwYWNpbmdFb2xSdWxlcyhzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllcl9nZXRUZWNoTGF5ZXJTcGFjaW5nRW9sUnVsZXMoc2VsZikKCiAgICBkZWYgZ2V0VGVjaExheWVyQ3V0U3BhY2luZ1J1bGVzKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyX2dldFRlY2hMYXllckN1dFNwYWNpbmdSdWxlcyhzZWxmKQoKICAgIGRlZiBnZXRUZWNoTGF5ZXJNaW5TdGVwUnVsZXMoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJfZ2V0VGVjaExheWVyTWluU3RlcFJ1bGVzKHNlbGYpCgogICAgZGVmIGdldFRlY2hMYXllckNvcm5lclNwYWNpbmdSdWxlcyhzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllcl9nZXRUZWNoTGF5ZXJDb3JuZXJTcGFjaW5nUnVsZXMoc2VsZikKCiAgICBkZWYgZ2V0VGVjaExheWVyU3BhY2luZ1RhYmxlUHJsUnVsZXMoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJfZ2V0VGVjaExheWVyU3BhY2luZ1RhYmxlUHJsUnVsZXMoc2VsZikKCiAgICBkZWYgZ2V0VGVjaExheWVyQ3V0U3BhY2luZ1RhYmxlT3J0aFJ1bGVzKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyX2dldFRlY2hMYXllckN1dFNwYWNpbmdUYWJsZU9ydGhSdWxlcyhzZWxmKQoKICAgIGRlZiBnZXRUZWNoTGF5ZXJDdXRTcGFjaW5nVGFibGVEZWZSdWxlcyhzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllcl9nZXRUZWNoTGF5ZXJDdXRTcGFjaW5nVGFibGVEZWZSdWxlcyhzZWxmKQoKICAgIGRlZiBnZXRUZWNoTGF5ZXJDdXRFbmNsb3N1cmVSdWxlcyhzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllcl9nZXRUZWNoTGF5ZXJDdXRFbmNsb3N1cmVSdWxlcyhzZWxmKQoKICAgIGRlZiBnZXRUZWNoTGF5ZXJFb2xFeHRlbnNpb25SdWxlcyhzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllcl9nZXRUZWNoTGF5ZXJFb2xFeHRlbnNpb25SdWxlcyhzZWxmKQoKICAgIGRlZiBnZXRUZWNoTGF5ZXJBcnJheVNwYWNpbmdSdWxlcyhzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllcl9nZXRUZWNoTGF5ZXJBcnJheVNwYWNpbmdSdWxlcyhzZWxmKQoKICAgIGRlZiBnZXRUZWNoTGF5ZXJFb2xLZWVwT3V0UnVsZXMoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJfZ2V0VGVjaExheWVyRW9sS2VlcE91dFJ1bGVzKHNlbGYpCgogICAgZGVmIGdldFRlY2hMYXllck1heFNwYWNpbmdSdWxlcyhzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllcl9nZXRUZWNoTGF5ZXJNYXhTcGFjaW5nUnVsZXMoc2VsZikKCiAgICBkZWYgZ2V0VGVjaExheWVyV2lkdGhUYWJsZVJ1bGVzKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyX2dldFRlY2hMYXllcldpZHRoVGFibGVSdWxlcyhzZWxmKQoKICAgIGRlZiBnZXRUZWNoTGF5ZXJNaW5DdXRSdWxlcyhzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllcl9nZXRUZWNoTGF5ZXJNaW5DdXRSdWxlcyhzZWxmKQoKICAgIGRlZiBnZXRUZWNoTGF5ZXJBcmVhUnVsZXMoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJfZ2V0VGVjaExheWVyQXJlYVJ1bGVzKHNlbGYpCgogICAgZGVmIGdldFRlY2hMYXllckZvcmJpZGRlblNwYWNpbmdSdWxlcyhzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllcl9nZXRUZWNoTGF5ZXJGb3JiaWRkZW5TcGFjaW5nUnVsZXMoc2VsZikKCiAgICBkZWYgZ2V0VGVjaExheWVyS2VlcE91dFpvbmVSdWxlcyhzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllcl9nZXRUZWNoTGF5ZXJLZWVwT3V0Wm9uZVJ1bGVzKHNlbGYpCgogICAgZGVmIGdldFRlY2hMYXllcldyb25nRGlyU3BhY2luZ1J1bGVzKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyX2dldFRlY2hMYXllcldyb25nRGlyU3BhY2luZ1J1bGVzKHNlbGYpCgogICAgZGVmIGdldFRlY2hMYXllclR3b1dpcmVzRm9yYmlkZGVuU3BjUnVsZXMoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJfZ2V0VGVjaExheWVyVHdvV2lyZXNGb3JiaWRkZW5TcGNSdWxlcyhzZWxmKQoKICAgIGRlZiBzZXRSZWN0T25seShzZWxmLCByZWN0X29ubHkpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyX3NldFJlY3RPbmx5KHNlbGYsIHJlY3Rfb25seSkKCiAgICBkZWYgaXNSZWN0T25seShzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllcl9pc1JlY3RPbmx5KHNlbGYpCgogICAgZGVmIHNldFJpZ2h0V2F5T25HcmlkT25seShzZWxmLCByaWdodF93YXlfb25fZ3JpZF9vbmx5KToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllcl9zZXRSaWdodFdheU9uR3JpZE9ubHkoc2VsZiwgcmlnaHRfd2F5X29uX2dyaWRfb25seSkKCiAgICBkZWYgaXNSaWdodFdheU9uR3JpZE9ubHkoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJfaXNSaWdodFdheU9uR3JpZE9ubHkoc2VsZikKCiAgICBkZWYgc2V0UmlnaHRXYXlPbkdyaWRPbmx5Q2hlY2tNYXNrKHNlbGYsIHJpZ2h0X3dheV9vbl9ncmlkX29ubHlfY2hlY2tfbWFzayk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJfc2V0UmlnaHRXYXlPbkdyaWRPbmx5Q2hlY2tNYXNrKHNlbGYsIHJpZ2h0X3dheV9vbl9ncmlkX29ubHlfY2hlY2tfbWFzaykKCiAgICBkZWYgaXNSaWdodFdheU9uR3JpZE9ubHlDaGVja01hc2soc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJfaXNSaWdodFdheU9uR3JpZE9ubHlDaGVja01hc2soc2VsZikKCiAgICBkZWYgc2V0UmVjdE9ubHlFeGNlcHROb25Db3JlUGlucyhzZWxmLCByZWN0X29ubHlfZXhjZXB0X25vbl9jb3JlX3BpbnMpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyX3NldFJlY3RPbmx5RXhjZXB0Tm9uQ29yZVBpbnMoc2VsZiwgcmVjdF9vbmx5X2V4Y2VwdF9ub25fY29yZV9waW5zKQoKICAgIGRlZiBpc1JlY3RPbmx5RXhjZXB0Tm9uQ29yZVBpbnMoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJfaXNSZWN0T25seUV4Y2VwdE5vbkNvcmVQaW5zKHNlbGYpCgogICAgZGVmIGZpbmRWNTVTcGFjaW5nKHNlbGYsIHdpZHRoLCBwcmwpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyX2ZpbmRWNTVTcGFjaW5nKHNlbGYsIHdpZHRoLCBwcmwpCgogICAgZGVmIGZpbmRUd1NwYWNpbmcoc2VsZiwgd2lkdGgxLCB3aWR0aDIsIHBybCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJfZmluZFR3U3BhY2luZyhzZWxmLCB3aWR0aDEsIHdpZHRoMiwgcHJsKQoKICAgIGRlZiBzZXRMZWY1OFR5cGUoc2VsZiwgdHlwZSk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJfc2V0TGVmNThUeXBlKHNlbGYsIHR5cGUpCgogICAgZGVmIGdldExlZjU4VHlwZShzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllcl9nZXRMZWY1OFR5cGUoc2VsZikKCiAgICBkZWYgZ2V0TGVmNThUeXBlU3RyaW5nKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyX2dldExlZjU4VHlwZVN0cmluZyhzZWxmKQoKICAgIGRlZiBnZXROYW1lKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyX2dldE5hbWUoc2VsZikKCiAgICBkZWYgZ2V0Q29uc3ROYW1lKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyX2dldENvbnN0TmFtZShzZWxmKQoKICAgIGRlZiBoYXNBbGlhcyhzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllcl9oYXNBbGlhcyhzZWxmKQoKICAgIGRlZiBnZXRBbGlhcyhzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllcl9nZXRBbGlhcyhzZWxmKQoKICAgIGRlZiBzZXRBbGlhcyhzZWxmLCBhbGlhcyk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJfc2V0QWxpYXMoc2VsZiwgYWxpYXMpCgogICAgZGVmIGdldFdpZHRoKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyX2dldFdpZHRoKHNlbGYpCgogICAgZGVmIHNldFdpZHRoKHNlbGYsIHdpZHRoKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllcl9zZXRXaWR0aChzZWxmLCB3aWR0aCkKCiAgICBkZWYgc2V0U3BhY2luZyhzZWxmLCBzcGFjaW5nKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllcl9zZXRTcGFjaW5nKHNlbGYsIHNwYWNpbmcpCgogICAgZGVmIGdldFNwYWNpbmcoc2VsZiwgKmFyZ3MpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyX2dldFNwYWNpbmcoc2VsZiwgKmFyZ3MpCgogICAgZGVmIGdldE51bU1hc2tzKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyX2dldE51bU1hc2tzKHNlbGYpCgogICAgZGVmIHNldE51bU1hc2tzKHNlbGYsIG51bWJlcik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJfc2V0TnVtTWFza3Moc2VsZiwgbnVtYmVyKQoKICAgIGRlZiBnZXRNYXhXaWRlRFJDUmFuZ2Uoc2VsZiwgb3dpZHRoLCBvbGVuZ3RoKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllcl9nZXRNYXhXaWRlRFJDUmFuZ2Uoc2VsZiwgb3dpZHRoLCBvbGVuZ3RoKQoKICAgIGRlZiBnZXRNaW5XaWRlRFJDUmFuZ2Uoc2VsZiwgb3dpZHRoLCBvbGVuZ3RoKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllcl9nZXRNaW5XaWRlRFJDUmFuZ2Uoc2VsZiwgb3dpZHRoLCBvbGVuZ3RoKQoKICAgIGRlZiBnZXRWNTRTcGFjaW5nUnVsZXMoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJfZ2V0VjU0U3BhY2luZ1J1bGVzKHNlbGYpCgogICAgZGVmIGhhc1Y1NVNwYWNpbmdSdWxlcyhzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllcl9oYXNWNTVTcGFjaW5nUnVsZXMoc2VsZikKCiAgICBkZWYgZ2V0VjU1U3BhY2luZ1dpZHRoc0FuZExlbmd0aHMoc2VsZiwgd2lkdGhfaWR4LCBsZW5ndGhfaWR4KToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllcl9nZXRWNTVTcGFjaW5nV2lkdGhzQW5kTGVuZ3RocyhzZWxmLCB3aWR0aF9pZHgsIGxlbmd0aF9pZHgpCgogICAgZGVmIHByaW50VjU1U3BhY2luZ1J1bGVzKHNlbGYsIHdyaXRlcik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJfcHJpbnRWNTVTcGFjaW5nUnVsZXMoc2VsZiwgd3JpdGVyKQoKICAgIGRlZiBnZXRWNTVTcGFjaW5nVGFibGUoc2VsZiwgc3B0YmwpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyX2dldFY1NVNwYWNpbmdUYWJsZShzZWxmLCBzcHRibCkKCiAgICBkZWYgaW5pdFY1NUxlbmd0aEluZGV4KHNlbGYsIG51bWVsZW1zKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllcl9pbml0VjU1TGVuZ3RoSW5kZXgoc2VsZiwgbnVtZWxlbXMpCgogICAgZGVmIGFkZFY1NUxlbmd0aEVudHJ5KHNlbGYsIGxlbmd0aCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJfYWRkVjU1TGVuZ3RoRW50cnkoc2VsZiwgbGVuZ3RoKQoKICAgIGRlZiBpbml0VjU1V2lkdGhJbmRleChzZWxmLCBudW1lbGVtcyk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJfaW5pdFY1NVdpZHRoSW5kZXgoc2VsZiwgbnVtZWxlbXMpCgogICAgZGVmIGFkZFY1NVdpZHRoRW50cnkoc2VsZiwgd2lkdGgpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyX2FkZFY1NVdpZHRoRW50cnkoc2VsZiwgd2lkdGgpCgogICAgZGVmIGluaXRWNTVTcGFjaW5nVGFibGUoc2VsZiwgbnVtcm93cywgbnVtY29scyk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJfaW5pdFY1NVNwYWNpbmdUYWJsZShzZWxmLCBudW1yb3dzLCBudW1jb2xzKQoKICAgIGRlZiBhZGRWNTVTcGFjaW5nVGFibGVFbnRyeShzZWxmLCBpbnJvdywgaW5jb2wsIHNwYWNpbmcpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyX2FkZFY1NVNwYWNpbmdUYWJsZUVudHJ5KHNlbGYsIGlucm93LCBpbmNvbCwgc3BhY2luZykKCiAgICBkZWYgZ2V0VjU1SW5mbHVlbmNlUnVsZXMoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJfZ2V0VjU1SW5mbHVlbmNlUnVsZXMoc2VsZikKCiAgICBkZWYgaGFzVHdvV2lkdGhzU3BhY2luZ1J1bGVzKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyX2hhc1R3b1dpZHRoc1NwYWNpbmdSdWxlcyhzZWxmKQoKICAgIGRlZiBwcmludFR3b1dpZHRoc1NwYWNpbmdSdWxlcyhzZWxmLCB3cml0ZXIpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyX3ByaW50VHdvV2lkdGhzU3BhY2luZ1J1bGVzKHNlbGYsIHdyaXRlcikKCiAgICBkZWYgZ2V0VHdvV2lkdGhzU3BhY2luZ1RhYmxlKHNlbGYsIHNwdGJsKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllcl9nZXRUd29XaWR0aHNTcGFjaW5nVGFibGUoc2VsZiwgc3B0YmwpCgogICAgZGVmIGdldFR3b1dpZHRoc1NwYWNpbmdUYWJsZU51bVdpZHRocyhzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllcl9nZXRUd29XaWR0aHNTcGFjaW5nVGFibGVOdW1XaWR0aHMoc2VsZikKCiAgICBkZWYgZ2V0VHdvV2lkdGhzU3BhY2luZ1RhYmxlV2lkdGgoc2VsZiwgcm93KToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllcl9nZXRUd29XaWR0aHNTcGFjaW5nVGFibGVXaWR0aChzZWxmLCByb3cpCgogICAgZGVmIGdldFR3b1dpZHRoc1NwYWNpbmdUYWJsZUhhc1BSTChzZWxmLCByb3cpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyX2dldFR3b1dpZHRoc1NwYWNpbmdUYWJsZUhhc1BSTChzZWxmLCByb3cpCgogICAgZGVmIGdldFR3b1dpZHRoc1NwYWNpbmdUYWJsZVBSTChzZWxmLCByb3cpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyX2dldFR3b1dpZHRoc1NwYWNpbmdUYWJsZVBSTChzZWxmLCByb3cpCgogICAgZGVmIGdldFR3b1dpZHRoc1NwYWNpbmdUYWJsZUVudHJ5KHNlbGYsIHJvdywgY29sKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllcl9nZXRUd29XaWR0aHNTcGFjaW5nVGFibGVFbnRyeShzZWxmLCByb3csIGNvbCkKCiAgICBkZWYgaW5pdFR3b1dpZHRocyhzZWxmLCBudW1fd2lkdGhzKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllcl9pbml0VHdvV2lkdGhzKHNlbGYsIG51bV93aWR0aHMpCgogICAgZGVmIGFkZFR3b1dpZHRoc0luZGV4RW50cnkoc2VsZiwgd2lkdGgsIHBhcmFsbGVsX3J1bl9sZW5ndGg9LTEpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyX2FkZFR3b1dpZHRoc0luZGV4RW50cnkoc2VsZiwgd2lkdGgsIHBhcmFsbGVsX3J1bl9sZW5ndGgpCgogICAgZGVmIGFkZFR3b1dpZHRoc1NwYWNpbmdUYWJsZUVudHJ5KHNlbGYsIGlucm93LCBpbmNvbCwgc3BhY2luZyk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJfYWRkVHdvV2lkdGhzU3BhY2luZ1RhYmxlRW50cnkoc2VsZiwgaW5yb3csIGluY29sLCBzcGFjaW5nKQoKICAgIGRlZiBjcmVhdGVEZWZhdWx0QW50ZW5uYVJ1bGUoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJfY3JlYXRlRGVmYXVsdEFudGVubmFSdWxlKHNlbGYpCgogICAgZGVmIGNyZWF0ZU94aWRlMkFudGVubmFSdWxlKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyX2NyZWF0ZU94aWRlMkFudGVubmFSdWxlKHNlbGYpCgogICAgZGVmIGhhc0RlZmF1bHRBbnRlbm5hUnVsZShzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllcl9oYXNEZWZhdWx0QW50ZW5uYVJ1bGUoc2VsZikKCiAgICBkZWYgaGFzT3hpZGUyQW50ZW5uYVJ1bGUoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJfaGFzT3hpZGUyQW50ZW5uYVJ1bGUoc2VsZikKCiAgICBkZWYgZ2V0RGVmYXVsdEFudGVubmFSdWxlKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyX2dldERlZmF1bHRBbnRlbm5hUnVsZShzZWxmKQoKICAgIGRlZiBnZXRPeGlkZTJBbnRlbm5hUnVsZShzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllcl9nZXRPeGlkZTJBbnRlbm5hUnVsZShzZWxmKQoKICAgIGRlZiB3cml0ZUFudGVubmFSdWxlc0xlZihzZWxmLCB3cml0ZXIpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyX3dyaXRlQW50ZW5uYVJ1bGVzTGVmKHNlbGYsIHdyaXRlcikKCiAgICBkZWYgZ2V0TWluaW11bUN1dFJ1bGVzKHNlbGYsIGN1dF9ydWxlcyk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJfZ2V0TWluaW11bUN1dFJ1bGVzKHNlbGYsIGN1dF9ydWxlcykKCiAgICBkZWYgZ2V0TWluRW5jbG9zdXJlUnVsZXMoc2VsZiwgZW5jX3J1bGVzKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllcl9nZXRNaW5FbmNsb3N1cmVSdWxlcyhzZWxmLCBlbmNfcnVsZXMpCgogICAgZGVmIGdldE1pbkN1dFJ1bGVzKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyX2dldE1pbkN1dFJ1bGVzKHNlbGYpCgogICAgZGVmIGdldE1pbkVuY1J1bGVzKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyX2dldE1pbkVuY1J1bGVzKHNlbGYpCgogICAgZGVmIGdldFBpdGNoKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyX2dldFBpdGNoKHNlbGYpCgogICAgZGVmIGdldFBpdGNoWChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllcl9nZXRQaXRjaFgoc2VsZikKCiAgICBkZWYgZ2V0UGl0Y2hZKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyX2dldFBpdGNoWShzZWxmKQoKICAgIGRlZiBnZXRGaXJzdExhc3RQaXRjaChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllcl9nZXRGaXJzdExhc3RQaXRjaChzZWxmKQoKICAgIGRlZiBzZXRQaXRjaChzZWxmLCBwaXRjaCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJfc2V0UGl0Y2goc2VsZiwgcGl0Y2gpCgogICAgZGVmIHNldFBpdGNoWFkoc2VsZiwgcGl0Y2hfeCwgcGl0Y2hfeSk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJfc2V0UGl0Y2hYWShzZWxmLCBwaXRjaF94LCBwaXRjaF95KQoKICAgIGRlZiBzZXRGaXJzdExhc3RQaXRjaChzZWxmLCBmaXJzdF9sYXN0X3BpdGNoKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllcl9zZXRGaXJzdExhc3RQaXRjaChzZWxmLCBmaXJzdF9sYXN0X3BpdGNoKQoKICAgIGRlZiBoYXNYWVBpdGNoKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyX2hhc1hZUGl0Y2goc2VsZikKCiAgICBkZWYgZ2V0T2Zmc2V0KHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyX2dldE9mZnNldChzZWxmKQoKICAgIGRlZiBnZXRPZmZzZXRYKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyX2dldE9mZnNldFgoc2VsZikKCiAgICBkZWYgZ2V0T2Zmc2V0WShzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllcl9nZXRPZmZzZXRZKHNlbGYpCgogICAgZGVmIHNldE9mZnNldChzZWxmLCBwaXRjaCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJfc2V0T2Zmc2V0KHNlbGYsIHBpdGNoKQoKICAgIGRlZiBzZXRPZmZzZXRYWShzZWxmLCBwaXRjaF94LCBwaXRjaF95KToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllcl9zZXRPZmZzZXRYWShzZWxmLCBwaXRjaF94LCBwaXRjaF95KQoKICAgIGRlZiBoYXNYWU9mZnNldChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllcl9oYXNYWU9mZnNldChzZWxmKQoKICAgIGRlZiBnZXRUaGlja25lc3Moc2VsZiwgaW50aGspOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyX2dldFRoaWNrbmVzcyhzZWxmLCBpbnRoaykKCiAgICBkZWYgc2V0VGhpY2tuZXNzKHNlbGYsIHRoaWNrbmVzcyk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJfc2V0VGhpY2tuZXNzKHNlbGYsIHRoaWNrbmVzcykKCiAgICBkZWYgaGFzQXJlYShzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllcl9oYXNBcmVhKHNlbGYpCgogICAgZGVmIGdldEFyZWEoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJfZ2V0QXJlYShzZWxmKQoKICAgIGRlZiBzZXRBcmVhKHNlbGYsIGFyZWEpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyX3NldEFyZWEoc2VsZiwgYXJlYSkKCiAgICBkZWYgaGFzTWF4V2lkdGgoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJfaGFzTWF4V2lkdGgoc2VsZikKCiAgICBkZWYgZ2V0TWF4V2lkdGgoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJfZ2V0TWF4V2lkdGgoc2VsZikKCiAgICBkZWYgc2V0TWF4V2lkdGgoc2VsZiwgbWF4X3dpZHRoKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllcl9zZXRNYXhXaWR0aChzZWxmLCBtYXhfd2lkdGgpCgogICAgZGVmIGdldE1pbldpZHRoKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyX2dldE1pbldpZHRoKHNlbGYpCgogICAgZGVmIHNldE1pbldpZHRoKHNlbGYsIG1heF93aWR0aCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJfc2V0TWluV2lkdGgoc2VsZiwgbWF4X3dpZHRoKQoKICAgIGRlZiBoYXNNaW5TdGVwKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyX2hhc01pblN0ZXAoc2VsZikKCiAgICBkZWYgZ2V0TWluU3RlcChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllcl9nZXRNaW5TdGVwKHNlbGYpCgogICAgZGVmIHNldE1pblN0ZXAoc2VsZiwgbWluX3N0ZXApOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyX3NldE1pblN0ZXAoc2VsZiwgbWluX3N0ZXApCgogICAgZGVmIGdldE1pblN0ZXBUeXBlKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyX2dldE1pblN0ZXBUeXBlKHNlbGYpCgogICAgZGVmIHNldE1pblN0ZXBUeXBlKHNlbGYsIHR5cGUpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyX3NldE1pblN0ZXBUeXBlKHNlbGYsIHR5cGUpCgogICAgZGVmIGhhc01pblN0ZXBNYXhMZW5ndGgoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJfaGFzTWluU3RlcE1heExlbmd0aChzZWxmKQoKICAgIGRlZiBnZXRNaW5TdGVwTWF4TGVuZ3RoKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyX2dldE1pblN0ZXBNYXhMZW5ndGgoc2VsZikKCiAgICBkZWYgc2V0TWluU3RlcE1heExlbmd0aChzZWxmLCBsZW5ndGgpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyX3NldE1pblN0ZXBNYXhMZW5ndGgoc2VsZiwgbGVuZ3RoKQoKICAgIGRlZiBoYXNNaW5TdGVwTWF4RWRnZXMoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJfaGFzTWluU3RlcE1heEVkZ2VzKHNlbGYpCgogICAgZGVmIGdldE1pblN0ZXBNYXhFZGdlcyhzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllcl9nZXRNaW5TdGVwTWF4RWRnZXMoc2VsZikKCiAgICBkZWYgc2V0TWluU3RlcE1heEVkZ2VzKHNlbGYsIGVkZ2VzKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllcl9zZXRNaW5TdGVwTWF4RWRnZXMoc2VsZiwgZWRnZXMpCgogICAgZGVmIGhhc1Byb3RydXNpb24oc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJfaGFzUHJvdHJ1c2lvbihzZWxmKQoKICAgIGRlZiBnZXRQcm90cnVzaW9uV2lkdGgoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJfZ2V0UHJvdHJ1c2lvbldpZHRoKHNlbGYpCgogICAgZGVmIGdldFByb3RydXNpb25MZW5ndGgoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJfZ2V0UHJvdHJ1c2lvbkxlbmd0aChzZWxmKQoKICAgIGRlZiBnZXRQcm90cnVzaW9uRnJvbVdpZHRoKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyX2dldFByb3RydXNpb25Gcm9tV2lkdGgoc2VsZikKCiAgICBkZWYgc2V0UHJvdHJ1c2lvbihzZWxmLCBwdF93aWR0aCwgcHRfbGVuZ3RoLCBwdF9mcm9tX3dpZHRoKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllcl9zZXRQcm90cnVzaW9uKHNlbGYsIHB0X3dpZHRoLCBwdF9sZW5ndGgsIHB0X2Zyb21fd2lkdGgpCgogICAgZGVmIGdldFR5cGUoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJfZ2V0VHlwZShzZWxmKQoKICAgIGRlZiBnZXREaXJlY3Rpb24oc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJfZ2V0RGlyZWN0aW9uKHNlbGYpCgogICAgZGVmIHNldERpcmVjdGlvbihzZWxmLCBkaXJlY3Rpb24pOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyX3NldERpcmVjdGlvbihzZWxmLCBkaXJlY3Rpb24pCgogICAgZGVmIGdldFJlc2lzdGFuY2Uoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJfZ2V0UmVzaXN0YW5jZShzZWxmKQoKICAgIGRlZiBzZXRSZXNpc3RhbmNlKHNlbGYsIHJlcyk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJfc2V0UmVzaXN0YW5jZShzZWxmLCByZXMpCgogICAgZGVmIGdldENhcGFjaXRhbmNlKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyX2dldENhcGFjaXRhbmNlKHNlbGYpCgogICAgZGVmIHNldENhcGFjaXRhbmNlKHNlbGYsIGNhcCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJfc2V0Q2FwYWNpdGFuY2Uoc2VsZiwgY2FwKQoKICAgIGRlZiBnZXRFZGdlQ2FwYWNpdGFuY2Uoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJfZ2V0RWRnZUNhcGFjaXRhbmNlKHNlbGYpCgogICAgZGVmIHNldEVkZ2VDYXBhY2l0YW5jZShzZWxmLCBjYXApOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyX3NldEVkZ2VDYXBhY2l0YW5jZShzZWxmLCBjYXApCgogICAgZGVmIGdldFdpcmVFeHRlbnNpb24oc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJfZ2V0V2lyZUV4dGVuc2lvbihzZWxmKQoKICAgIGRlZiBzZXRXaXJlRXh0ZW5zaW9uKHNlbGYsIGV4dCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJfc2V0V2lyZUV4dGVuc2lvbihzZWxmLCBleHQpCgogICAgZGVmIGdldE51bWJlcihzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllcl9nZXROdW1iZXIoc2VsZikKCiAgICBkZWYgZ2V0Um91dGluZ0xldmVsKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyX2dldFJvdXRpbmdMZXZlbChzZWxmKQoKICAgIGRlZiBnZXRMb3dlckxheWVyKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyX2dldExvd2VyTGF5ZXIoc2VsZikKCiAgICBkZWYgZ2V0VXBwZXJMYXllcihzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllcl9nZXRVcHBlckxheWVyKHNlbGYpCgogICAgZGVmIGdldFRlY2goc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJfZ2V0VGVjaChzZWxmKQoKICAgIGRlZiBoYXNPcnRoU3BhY2luZ1RhYmxlKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyX2hhc09ydGhTcGFjaW5nVGFibGUoc2VsZikKCiAgICBkZWYgYWRkT3J0aFNwYWNpbmdUYWJsZUVudHJ5KHNlbGYsIHdpdGhpbiwgc3BhY2luZyk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJfYWRkT3J0aFNwYWNpbmdUYWJsZUVudHJ5KHNlbGYsIHdpdGhpbiwgc3BhY2luZykKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgY3JlYXRlKHRlY2gsIG5hbWUsIHR5cGUpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyX2NyZWF0ZSh0ZWNoLCBuYW1lLCB0eXBlKQoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBnZXRUZWNoTGF5ZXIodGVjaCwgb2lkKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllcl9nZXRUZWNoTGF5ZXIodGVjaCwgb2lkKQoKICAgIGRlZiBfX2luaXRfXyhzZWxmKToKICAgICAgICBfb2RiX3B5LmRiVGVjaExheWVyX3N3aWdpbml0KHNlbGYsIF9vZGJfcHkubmV3X2RiVGVjaExheWVyKCkpCiAgICBfX3N3aWdfZGVzdHJveV9fID0gX29kYl9weS5kZWxldGVfZGJUZWNoTGF5ZXIKCiMgUmVnaXN0ZXIgZGJUZWNoTGF5ZXIgaW4gX29kYl9weToKX29kYl9weS5kYlRlY2hMYXllcl9zd2lncmVnaXN0ZXIoZGJUZWNoTGF5ZXIpCgpkZWYgZGJUZWNoTGF5ZXJfY3JlYXRlKHRlY2gsIG5hbWUsIHR5cGUpOgogICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJfY3JlYXRlKHRlY2gsIG5hbWUsIHR5cGUpCgpkZWYgZGJUZWNoTGF5ZXJfZ2V0VGVjaExheWVyKHRlY2gsIG9pZCk6CiAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllcl9nZXRUZWNoTGF5ZXIodGVjaCwgb2lkKQoKY2xhc3MgZGJUZWNoTGF5ZXJBcmVhUnVsZShvYmplY3QpOgogICAgdGhpc293biA9IHByb3BlcnR5KGxhbWJkYSB4OiB4LnRoaXMub3duKCksIGxhbWJkYSB4LCB2OiB4LnRoaXMub3duKHYpLCBkb2M9J1RoZSBtZW1iZXJzaGlwIGZsYWcnKQogICAgX19yZXByX18gPSBfc3dpZ19yZXByCgogICAgZGVmIHNldEFyZWEoc2VsZiwgYXJlYSk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJBcmVhUnVsZV9zZXRBcmVhKHNlbGYsIGFyZWEpCgogICAgZGVmIGdldEFyZWEoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJBcmVhUnVsZV9nZXRBcmVhKHNlbGYpCgogICAgZGVmIHNldEV4Y2VwdE1pbldpZHRoKHNlbGYsIGV4Y2VwdF9taW5fd2lkdGgpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQXJlYVJ1bGVfc2V0RXhjZXB0TWluV2lkdGgoc2VsZiwgZXhjZXB0X21pbl93aWR0aCkKCiAgICBkZWYgZ2V0RXhjZXB0TWluV2lkdGgoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJBcmVhUnVsZV9nZXRFeGNlcHRNaW5XaWR0aChzZWxmKQoKICAgIGRlZiBzZXRFeGNlcHRFZGdlTGVuZ3RoKHNlbGYsIGV4Y2VwdF9lZGdlX2xlbmd0aCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJBcmVhUnVsZV9zZXRFeGNlcHRFZGdlTGVuZ3RoKHNlbGYsIGV4Y2VwdF9lZGdlX2xlbmd0aCkKCiAgICBkZWYgZ2V0RXhjZXB0RWRnZUxlbmd0aChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckFyZWFSdWxlX2dldEV4Y2VwdEVkZ2VMZW5ndGgoc2VsZikKCiAgICBkZWYgc2V0RXhjZXB0RWRnZUxlbmd0aHMoc2VsZiwgZXhjZXB0X2VkZ2VfbGVuZ3Rocyk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJBcmVhUnVsZV9zZXRFeGNlcHRFZGdlTGVuZ3RocyhzZWxmLCBleGNlcHRfZWRnZV9sZW5ndGhzKQoKICAgIGRlZiBnZXRFeGNlcHRFZGdlTGVuZ3RocyhzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckFyZWFSdWxlX2dldEV4Y2VwdEVkZ2VMZW5ndGhzKHNlbGYpCgogICAgZGVmIHNldEV4Y2VwdE1pblNpemUoc2VsZiwgZXhjZXB0X21pbl9zaXplKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckFyZWFSdWxlX3NldEV4Y2VwdE1pblNpemUoc2VsZiwgZXhjZXB0X21pbl9zaXplKQoKICAgIGRlZiBnZXRFeGNlcHRNaW5TaXplKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQXJlYVJ1bGVfZ2V0RXhjZXB0TWluU2l6ZShzZWxmKQoKICAgIGRlZiBzZXRFeGNlcHRTdGVwKHNlbGYsIGV4Y2VwdF9zdGVwKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckFyZWFSdWxlX3NldEV4Y2VwdFN0ZXAoc2VsZiwgZXhjZXB0X3N0ZXApCgogICAgZGVmIGdldEV4Y2VwdFN0ZXAoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJBcmVhUnVsZV9nZXRFeGNlcHRTdGVwKHNlbGYpCgogICAgZGVmIHNldE1hc2soc2VsZiwgbWFzayk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJBcmVhUnVsZV9zZXRNYXNrKHNlbGYsIG1hc2spCgogICAgZGVmIGdldE1hc2soc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJBcmVhUnVsZV9nZXRNYXNrKHNlbGYpCgogICAgZGVmIHNldFJlY3RXaWR0aChzZWxmLCByZWN0X3dpZHRoKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckFyZWFSdWxlX3NldFJlY3RXaWR0aChzZWxmLCByZWN0X3dpZHRoKQoKICAgIGRlZiBnZXRSZWN0V2lkdGgoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJBcmVhUnVsZV9nZXRSZWN0V2lkdGgoc2VsZikKCiAgICBkZWYgc2V0RXhjZXB0UmVjdGFuZ2xlKHNlbGYsIGV4Y2VwdF9yZWN0YW5nbGUpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQXJlYVJ1bGVfc2V0RXhjZXB0UmVjdGFuZ2xlKHNlbGYsIGV4Y2VwdF9yZWN0YW5nbGUpCgogICAgZGVmIGlzRXhjZXB0UmVjdGFuZ2xlKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQXJlYVJ1bGVfaXNFeGNlcHRSZWN0YW5nbGUoc2VsZikKCiAgICBkZWYgc2V0T3ZlcmxhcChzZWxmLCBvdmVybGFwKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckFyZWFSdWxlX3NldE92ZXJsYXAoc2VsZiwgb3ZlcmxhcCkKCiAgICBkZWYgZ2V0T3ZlcmxhcChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckFyZWFSdWxlX2dldE92ZXJsYXAoc2VsZikKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgY3JlYXRlKF9sYXllcik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJBcmVhUnVsZV9jcmVhdGUoX2xheWVyKQoKICAgIGRlZiBzZXRUcmltTGF5ZXIoc2VsZiwgdHJpbV9sYXllcik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJBcmVhUnVsZV9zZXRUcmltTGF5ZXIoc2VsZiwgdHJpbV9sYXllcikKCiAgICBkZWYgZ2V0VHJpbUxheWVyKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQXJlYVJ1bGVfZ2V0VHJpbUxheWVyKHNlbGYpCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIGRlc3Ryb3kocnVsZSk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJBcmVhUnVsZV9kZXN0cm95KHJ1bGUpCgogICAgZGVmIF9faW5pdF9fKHNlbGYpOgogICAgICAgIF9vZGJfcHkuZGJUZWNoTGF5ZXJBcmVhUnVsZV9zd2lnaW5pdChzZWxmLCBfb2RiX3B5Lm5ld19kYlRlY2hMYXllckFyZWFSdWxlKCkpCiAgICBfX3N3aWdfZGVzdHJveV9fID0gX29kYl9weS5kZWxldGVfZGJUZWNoTGF5ZXJBcmVhUnVsZQoKIyBSZWdpc3RlciBkYlRlY2hMYXllckFyZWFSdWxlIGluIF9vZGJfcHk6Cl9vZGJfcHkuZGJUZWNoTGF5ZXJBcmVhUnVsZV9zd2lncmVnaXN0ZXIoZGJUZWNoTGF5ZXJBcmVhUnVsZSkKCmRlZiBkYlRlY2hMYXllckFyZWFSdWxlX2NyZWF0ZShfbGF5ZXIpOgogICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJBcmVhUnVsZV9jcmVhdGUoX2xheWVyKQoKZGVmIGRiVGVjaExheWVyQXJlYVJ1bGVfZGVzdHJveShydWxlKToKICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQXJlYVJ1bGVfZGVzdHJveShydWxlKQoKY2xhc3MgZGJUZWNoTGF5ZXJBcnJheVNwYWNpbmdSdWxlKG9iamVjdCk6CiAgICB0aGlzb3duID0gcHJvcGVydHkobGFtYmRhIHg6IHgudGhpcy5vd24oKSwgbGFtYmRhIHgsIHY6IHgudGhpcy5vd24odiksIGRvYz0nVGhlIG1lbWJlcnNoaXAgZmxhZycpCiAgICBfX3JlcHJfXyA9IF9zd2lnX3JlcHIKCiAgICBkZWYgc2V0VmlhV2lkdGgoc2VsZiwgdmlhX3dpZHRoKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckFycmF5U3BhY2luZ1J1bGVfc2V0VmlhV2lkdGgoc2VsZiwgdmlhX3dpZHRoKQoKICAgIGRlZiBnZXRWaWFXaWR0aChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckFycmF5U3BhY2luZ1J1bGVfZ2V0VmlhV2lkdGgoc2VsZikKCiAgICBkZWYgc2V0Q3V0U3BhY2luZyhzZWxmLCBjdXRfc3BhY2luZyk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJBcnJheVNwYWNpbmdSdWxlX3NldEN1dFNwYWNpbmcoc2VsZiwgY3V0X3NwYWNpbmcpCgogICAgZGVmIGdldEN1dFNwYWNpbmcoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJBcnJheVNwYWNpbmdSdWxlX2dldEN1dFNwYWNpbmcoc2VsZikKCiAgICBkZWYgc2V0V2l0aGluKHNlbGYsIHdpdGhpbik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJBcnJheVNwYWNpbmdSdWxlX3NldFdpdGhpbihzZWxmLCB3aXRoaW4pCgogICAgZGVmIGdldFdpdGhpbihzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckFycmF5U3BhY2luZ1J1bGVfZ2V0V2l0aGluKHNlbGYpCgogICAgZGVmIHNldEFycmF5V2lkdGgoc2VsZiwgYXJyYXlfd2lkdGgpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQXJyYXlTcGFjaW5nUnVsZV9zZXRBcnJheVdpZHRoKHNlbGYsIGFycmF5X3dpZHRoKQoKICAgIGRlZiBnZXRBcnJheVdpZHRoKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQXJyYXlTcGFjaW5nUnVsZV9nZXRBcnJheVdpZHRoKHNlbGYpCgogICAgZGVmIHNldEN1dENsYXNzKHNlbGYsIGN1dF9jbGFzcyk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJBcnJheVNwYWNpbmdSdWxlX3NldEN1dENsYXNzKHNlbGYsIGN1dF9jbGFzcykKCiAgICBkZWYgc2V0UGFyYWxsZWxPdmVybGFwKHNlbGYsIHBhcmFsbGVsX292ZXJsYXApOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQXJyYXlTcGFjaW5nUnVsZV9zZXRQYXJhbGxlbE92ZXJsYXAoc2VsZiwgcGFyYWxsZWxfb3ZlcmxhcCkKCiAgICBkZWYgaXNQYXJhbGxlbE92ZXJsYXAoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJBcnJheVNwYWNpbmdSdWxlX2lzUGFyYWxsZWxPdmVybGFwKHNlbGYpCgogICAgZGVmIHNldExvbmdBcnJheShzZWxmLCBsb25nX2FycmF5KToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckFycmF5U3BhY2luZ1J1bGVfc2V0TG9uZ0FycmF5KHNlbGYsIGxvbmdfYXJyYXkpCgogICAgZGVmIGlzTG9uZ0FycmF5KHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQXJyYXlTcGFjaW5nUnVsZV9pc0xvbmdBcnJheShzZWxmKQoKICAgIGRlZiBzZXRWaWFXaWR0aFZhbGlkKHNlbGYsIHZpYV93aWR0aF92YWxpZCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJBcnJheVNwYWNpbmdSdWxlX3NldFZpYVdpZHRoVmFsaWQoc2VsZiwgdmlhX3dpZHRoX3ZhbGlkKQoKICAgIGRlZiBpc1ZpYVdpZHRoVmFsaWQoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJBcnJheVNwYWNpbmdSdWxlX2lzVmlhV2lkdGhWYWxpZChzZWxmKQoKICAgIGRlZiBzZXRXaXRoaW5WYWxpZChzZWxmLCB3aXRoaW5fdmFsaWQpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQXJyYXlTcGFjaW5nUnVsZV9zZXRXaXRoaW5WYWxpZChzZWxmLCB3aXRoaW5fdmFsaWQpCgogICAgZGVmIGlzV2l0aGluVmFsaWQoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJBcnJheVNwYWNpbmdSdWxlX2lzV2l0aGluVmFsaWQoc2VsZikKCiAgICBkZWYgc2V0Q3V0c0FycmF5U3BhY2luZyhzZWxmLCBudW1fY3V0cywgc3BhY2luZyk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJBcnJheVNwYWNpbmdSdWxlX3NldEN1dHNBcnJheVNwYWNpbmcoc2VsZiwgbnVtX2N1dHMsIHNwYWNpbmcpCgogICAgZGVmIGdldEN1dHNBcnJheVNwYWNpbmcoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJBcnJheVNwYWNpbmdSdWxlX2dldEN1dHNBcnJheVNwYWNpbmcoc2VsZikKCiAgICBkZWYgZ2V0Q3V0Q2xhc3Moc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJBcnJheVNwYWNpbmdSdWxlX2dldEN1dENsYXNzKHNlbGYpCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIGNyZWF0ZShsYXllcik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJBcnJheVNwYWNpbmdSdWxlX2NyZWF0ZShsYXllcikKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgZ2V0VGVjaExheWVyQXJyYXlTcGFjaW5nUnVsZShpbmx5LCBkYmlkKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckFycmF5U3BhY2luZ1J1bGVfZ2V0VGVjaExheWVyQXJyYXlTcGFjaW5nUnVsZShpbmx5LCBkYmlkKQoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBkZXN0cm95KHJ1bGUpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQXJyYXlTcGFjaW5nUnVsZV9kZXN0cm95KHJ1bGUpCgogICAgZGVmIF9faW5pdF9fKHNlbGYpOgogICAgICAgIF9vZGJfcHkuZGJUZWNoTGF5ZXJBcnJheVNwYWNpbmdSdWxlX3N3aWdpbml0KHNlbGYsIF9vZGJfcHkubmV3X2RiVGVjaExheWVyQXJyYXlTcGFjaW5nUnVsZSgpKQogICAgX19zd2lnX2Rlc3Ryb3lfXyA9IF9vZGJfcHkuZGVsZXRlX2RiVGVjaExheWVyQXJyYXlTcGFjaW5nUnVsZQoKIyBSZWdpc3RlciBkYlRlY2hMYXllckFycmF5U3BhY2luZ1J1bGUgaW4gX29kYl9weToKX29kYl9weS5kYlRlY2hMYXllckFycmF5U3BhY2luZ1J1bGVfc3dpZ3JlZ2lzdGVyKGRiVGVjaExheWVyQXJyYXlTcGFjaW5nUnVsZSkKCmRlZiBkYlRlY2hMYXllckFycmF5U3BhY2luZ1J1bGVfY3JlYXRlKGxheWVyKToKICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQXJyYXlTcGFjaW5nUnVsZV9jcmVhdGUobGF5ZXIpCgpkZWYgZGJUZWNoTGF5ZXJBcnJheVNwYWNpbmdSdWxlX2dldFRlY2hMYXllckFycmF5U3BhY2luZ1J1bGUoaW5seSwgZGJpZCk6CiAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckFycmF5U3BhY2luZ1J1bGVfZ2V0VGVjaExheWVyQXJyYXlTcGFjaW5nUnVsZShpbmx5LCBkYmlkKQoKZGVmIGRiVGVjaExheWVyQXJyYXlTcGFjaW5nUnVsZV9kZXN0cm95KHJ1bGUpOgogICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJBcnJheVNwYWNpbmdSdWxlX2Rlc3Ryb3kocnVsZSkKCmNsYXNzIGRiVGVjaExheWVyQ29ybmVyU3BhY2luZ1J1bGUob2JqZWN0KToKICAgIHRoaXNvd24gPSBwcm9wZXJ0eShsYW1iZGEgeDogeC50aGlzLm93bigpLCBsYW1iZGEgeCwgdjogeC50aGlzLm93bih2KSwgZG9jPSdUaGUgbWVtYmVyc2hpcCBmbGFnJykKICAgIF9fcmVwcl9fID0gX3N3aWdfcmVwcgogICAgQ09OVkVYQ09STkVSID0gX29kYl9weS5kYlRlY2hMYXllckNvcm5lclNwYWNpbmdSdWxlX0NPTlZFWENPUk5FUgogICAgQ09OQ0FWRUNPUk5FUiA9IF9vZGJfcHkuZGJUZWNoTGF5ZXJDb3JuZXJTcGFjaW5nUnVsZV9DT05DQVZFQ09STkVSCgogICAgZGVmIHNldFdpdGhpbihzZWxmLCB3aXRoaW4pOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQ29ybmVyU3BhY2luZ1J1bGVfc2V0V2l0aGluKHNlbGYsIHdpdGhpbikKCiAgICBkZWYgZ2V0V2l0aGluKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQ29ybmVyU3BhY2luZ1J1bGVfZ2V0V2l0aGluKHNlbGYpCgogICAgZGVmIHNldEVvbFdpZHRoKHNlbGYsIGVvbF93aWR0aCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJDb3JuZXJTcGFjaW5nUnVsZV9zZXRFb2xXaWR0aChzZWxmLCBlb2xfd2lkdGgpCgogICAgZGVmIGdldEVvbFdpZHRoKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQ29ybmVyU3BhY2luZ1J1bGVfZ2V0RW9sV2lkdGgoc2VsZikKCiAgICBkZWYgc2V0Sm9nTGVuZ3RoKHNlbGYsIGpvZ19sZW5ndGgpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQ29ybmVyU3BhY2luZ1J1bGVfc2V0Sm9nTGVuZ3RoKHNlbGYsIGpvZ19sZW5ndGgpCgogICAgZGVmIGdldEpvZ0xlbmd0aChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckNvcm5lclNwYWNpbmdSdWxlX2dldEpvZ0xlbmd0aChzZWxmKQoKICAgIGRlZiBzZXRFZGdlTGVuZ3RoKHNlbGYsIGVkZ2VfbGVuZ3RoKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckNvcm5lclNwYWNpbmdSdWxlX3NldEVkZ2VMZW5ndGgoc2VsZiwgZWRnZV9sZW5ndGgpCgogICAgZGVmIGdldEVkZ2VMZW5ndGgoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJDb3JuZXJTcGFjaW5nUnVsZV9nZXRFZGdlTGVuZ3RoKHNlbGYpCgogICAgZGVmIHNldE1pbkxlbmd0aChzZWxmLCBtaW5fbGVuZ3RoKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckNvcm5lclNwYWNpbmdSdWxlX3NldE1pbkxlbmd0aChzZWxmLCBtaW5fbGVuZ3RoKQoKICAgIGRlZiBnZXRNaW5MZW5ndGgoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJDb3JuZXJTcGFjaW5nUnVsZV9nZXRNaW5MZW5ndGgoc2VsZikKCiAgICBkZWYgc2V0RXhjZXB0Tm90Y2hMZW5ndGgoc2VsZiwgZXhjZXB0X25vdGNoX2xlbmd0aCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJDb3JuZXJTcGFjaW5nUnVsZV9zZXRFeGNlcHROb3RjaExlbmd0aChzZWxmLCBleGNlcHRfbm90Y2hfbGVuZ3RoKQoKICAgIGRlZiBnZXRFeGNlcHROb3RjaExlbmd0aChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckNvcm5lclNwYWNpbmdSdWxlX2dldEV4Y2VwdE5vdGNoTGVuZ3RoKHNlbGYpCgogICAgZGVmIHNldFNhbWVNYXNrKHNlbGYsIHNhbWVfbWFzayk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJDb3JuZXJTcGFjaW5nUnVsZV9zZXRTYW1lTWFzayhzZWxmLCBzYW1lX21hc2spCgogICAgZGVmIGlzU2FtZU1hc2soc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJDb3JuZXJTcGFjaW5nUnVsZV9pc1NhbWVNYXNrKHNlbGYpCgogICAgZGVmIHNldENvcm5lck9ubHkoc2VsZiwgY29ybmVyX29ubHkpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQ29ybmVyU3BhY2luZ1J1bGVfc2V0Q29ybmVyT25seShzZWxmLCBjb3JuZXJfb25seSkKCiAgICBkZWYgaXNDb3JuZXJPbmx5KHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQ29ybmVyU3BhY2luZ1J1bGVfaXNDb3JuZXJPbmx5KHNlbGYpCgogICAgZGVmIHNldEV4Y2VwdEVvbChzZWxmLCBleGNlcHRfZW9sKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckNvcm5lclNwYWNpbmdSdWxlX3NldEV4Y2VwdEVvbChzZWxmLCBleGNlcHRfZW9sKQoKICAgIGRlZiBpc0V4Y2VwdEVvbChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckNvcm5lclNwYWNpbmdSdWxlX2lzRXhjZXB0RW9sKHNlbGYpCgogICAgZGVmIHNldEV4Y2VwdEpvZ0xlbmd0aChzZWxmLCBleGNlcHRfam9nX2xlbmd0aCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJDb3JuZXJTcGFjaW5nUnVsZV9zZXRFeGNlcHRKb2dMZW5ndGgoc2VsZiwgZXhjZXB0X2pvZ19sZW5ndGgpCgogICAgZGVmIGlzRXhjZXB0Sm9nTGVuZ3RoKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQ29ybmVyU3BhY2luZ1J1bGVfaXNFeGNlcHRKb2dMZW5ndGgoc2VsZikKCiAgICBkZWYgc2V0RWRnZUxlbmd0aFZhbGlkKHNlbGYsIGVkZ2VfbGVuZ3RoX3ZhbGlkKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckNvcm5lclNwYWNpbmdSdWxlX3NldEVkZ2VMZW5ndGhWYWxpZChzZWxmLCBlZGdlX2xlbmd0aF92YWxpZCkKCiAgICBkZWYgaXNFZGdlTGVuZ3RoVmFsaWQoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJDb3JuZXJTcGFjaW5nUnVsZV9pc0VkZ2VMZW5ndGhWYWxpZChzZWxmKQoKICAgIGRlZiBzZXRJbmNsdWRlU2hhcGUoc2VsZiwgaW5jbHVkZV9zaGFwZSk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJDb3JuZXJTcGFjaW5nUnVsZV9zZXRJbmNsdWRlU2hhcGUoc2VsZiwgaW5jbHVkZV9zaGFwZSkKCiAgICBkZWYgaXNJbmNsdWRlU2hhcGUoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJDb3JuZXJTcGFjaW5nUnVsZV9pc0luY2x1ZGVTaGFwZShzZWxmKQoKICAgIGRlZiBzZXRNaW5MZW5ndGhWYWxpZChzZWxmLCBtaW5fbGVuZ3RoX3ZhbGlkKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckNvcm5lclNwYWNpbmdSdWxlX3NldE1pbkxlbmd0aFZhbGlkKHNlbGYsIG1pbl9sZW5ndGhfdmFsaWQpCgogICAgZGVmIGlzTWluTGVuZ3RoVmFsaWQoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJDb3JuZXJTcGFjaW5nUnVsZV9pc01pbkxlbmd0aFZhbGlkKHNlbGYpCgogICAgZGVmIHNldEV4Y2VwdE5vdGNoKHNlbGYsIGV4Y2VwdF9ub3RjaCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJDb3JuZXJTcGFjaW5nUnVsZV9zZXRFeGNlcHROb3RjaChzZWxmLCBleGNlcHRfbm90Y2gpCgogICAgZGVmIGlzRXhjZXB0Tm90Y2goc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJDb3JuZXJTcGFjaW5nUnVsZV9pc0V4Y2VwdE5vdGNoKHNlbGYpCgogICAgZGVmIHNldEV4Y2VwdE5vdGNoTGVuZ3RoVmFsaWQoc2VsZiwgZXhjZXB0X25vdGNoX2xlbmd0aF92YWxpZCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJDb3JuZXJTcGFjaW5nUnVsZV9zZXRFeGNlcHROb3RjaExlbmd0aFZhbGlkKHNlbGYsIGV4Y2VwdF9ub3RjaF9sZW5ndGhfdmFsaWQpCgogICAgZGVmIGlzRXhjZXB0Tm90Y2hMZW5ndGhWYWxpZChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckNvcm5lclNwYWNpbmdSdWxlX2lzRXhjZXB0Tm90Y2hMZW5ndGhWYWxpZChzZWxmKQoKICAgIGRlZiBzZXRFeGNlcHRTYW1lTmV0KHNlbGYsIGV4Y2VwdF9zYW1lX25ldCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJDb3JuZXJTcGFjaW5nUnVsZV9zZXRFeGNlcHRTYW1lTmV0KHNlbGYsIGV4Y2VwdF9zYW1lX25ldCkKCiAgICBkZWYgaXNFeGNlcHRTYW1lTmV0KHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQ29ybmVyU3BhY2luZ1J1bGVfaXNFeGNlcHRTYW1lTmV0KHNlbGYpCgogICAgZGVmIHNldEV4Y2VwdFNhbWVNZXRhbChzZWxmLCBleGNlcHRfc2FtZV9tZXRhbCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJDb3JuZXJTcGFjaW5nUnVsZV9zZXRFeGNlcHRTYW1lTWV0YWwoc2VsZiwgZXhjZXB0X3NhbWVfbWV0YWwpCgogICAgZGVmIGlzRXhjZXB0U2FtZU1ldGFsKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQ29ybmVyU3BhY2luZ1J1bGVfaXNFeGNlcHRTYW1lTWV0YWwoc2VsZikKCiAgICBkZWYgc2V0Q29ybmVyVG9Db3JuZXIoc2VsZiwgY29ybmVyX3RvX2Nvcm5lcik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJDb3JuZXJTcGFjaW5nUnVsZV9zZXRDb3JuZXJUb0Nvcm5lcihzZWxmLCBjb3JuZXJfdG9fY29ybmVyKQoKICAgIGRlZiBpc0Nvcm5lclRvQ29ybmVyKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQ29ybmVyU3BhY2luZ1J1bGVfaXNDb3JuZXJUb0Nvcm5lcihzZWxmKQoKICAgIGRlZiBzZXRUeXBlKHNlbGYsIF90eXBlKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckNvcm5lclNwYWNpbmdSdWxlX3NldFR5cGUoc2VsZiwgX3R5cGUpCgogICAgZGVmIGdldFR5cGUoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJDb3JuZXJTcGFjaW5nUnVsZV9nZXRUeXBlKHNlbGYpCgogICAgZGVmIGFkZFNwYWNpbmcoc2VsZiwgd2lkdGgsIHNwYWNpbmcxLCBzcGFjaW5nMj0wKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckNvcm5lclNwYWNpbmdSdWxlX2FkZFNwYWNpbmcoc2VsZiwgd2lkdGgsIHNwYWNpbmcxLCBzcGFjaW5nMikKCiAgICBkZWYgZ2V0U3BhY2luZ1RhYmxlKHNlbGYsIHRibCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJDb3JuZXJTcGFjaW5nUnVsZV9nZXRTcGFjaW5nVGFibGUoc2VsZiwgdGJsKQoKICAgIGRlZiBnZXRXaWR0aFRhYmxlKHNlbGYsIHRibCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJDb3JuZXJTcGFjaW5nUnVsZV9nZXRXaWR0aFRhYmxlKHNlbGYsIHRibCkKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgY3JlYXRlKGxheWVyKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckNvcm5lclNwYWNpbmdSdWxlX2NyZWF0ZShsYXllcikKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgZ2V0VGVjaExheWVyQ29ybmVyU3BhY2luZ1J1bGUoaW5seSwgZGJpZCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJDb3JuZXJTcGFjaW5nUnVsZV9nZXRUZWNoTGF5ZXJDb3JuZXJTcGFjaW5nUnVsZShpbmx5LCBkYmlkKQoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBkZXN0cm95KHJ1bGUpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQ29ybmVyU3BhY2luZ1J1bGVfZGVzdHJveShydWxlKQoKICAgIGRlZiBfX2luaXRfXyhzZWxmKToKICAgICAgICBfb2RiX3B5LmRiVGVjaExheWVyQ29ybmVyU3BhY2luZ1J1bGVfc3dpZ2luaXQoc2VsZiwgX29kYl9weS5uZXdfZGJUZWNoTGF5ZXJDb3JuZXJTcGFjaW5nUnVsZSgpKQogICAgX19zd2lnX2Rlc3Ryb3lfXyA9IF9vZGJfcHkuZGVsZXRlX2RiVGVjaExheWVyQ29ybmVyU3BhY2luZ1J1bGUKCiMgUmVnaXN0ZXIgZGJUZWNoTGF5ZXJDb3JuZXJTcGFjaW5nUnVsZSBpbiBfb2RiX3B5Ogpfb2RiX3B5LmRiVGVjaExheWVyQ29ybmVyU3BhY2luZ1J1bGVfc3dpZ3JlZ2lzdGVyKGRiVGVjaExheWVyQ29ybmVyU3BhY2luZ1J1bGUpCgpkZWYgZGJUZWNoTGF5ZXJDb3JuZXJTcGFjaW5nUnVsZV9jcmVhdGUobGF5ZXIpOgogICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJDb3JuZXJTcGFjaW5nUnVsZV9jcmVhdGUobGF5ZXIpCgpkZWYgZGJUZWNoTGF5ZXJDb3JuZXJTcGFjaW5nUnVsZV9nZXRUZWNoTGF5ZXJDb3JuZXJTcGFjaW5nUnVsZShpbmx5LCBkYmlkKToKICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQ29ybmVyU3BhY2luZ1J1bGVfZ2V0VGVjaExheWVyQ29ybmVyU3BhY2luZ1J1bGUoaW5seSwgZGJpZCkKCmRlZiBkYlRlY2hMYXllckNvcm5lclNwYWNpbmdSdWxlX2Rlc3Ryb3kocnVsZSk6CiAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckNvcm5lclNwYWNpbmdSdWxlX2Rlc3Ryb3kocnVsZSkKCmNsYXNzIGRiVGVjaExheWVyQ3V0Q2xhc3NSdWxlKG9iamVjdCk6CiAgICB0aGlzb3duID0gcHJvcGVydHkobGFtYmRhIHg6IHgudGhpcy5vd24oKSwgbGFtYmRhIHgsIHY6IHgudGhpcy5vd24odiksIGRvYz0nVGhlIG1lbWJlcnNoaXAgZmxhZycpCiAgICBfX3JlcHJfXyA9IF9zd2lnX3JlcHIKCiAgICBkZWYgZ2V0TmFtZShzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckN1dENsYXNzUnVsZV9nZXROYW1lKHNlbGYpCgogICAgZGVmIHNldFdpZHRoKHNlbGYsIHdpZHRoKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckN1dENsYXNzUnVsZV9zZXRXaWR0aChzZWxmLCB3aWR0aCkKCiAgICBkZWYgZ2V0V2lkdGgoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJDdXRDbGFzc1J1bGVfZ2V0V2lkdGgoc2VsZikKCiAgICBkZWYgc2V0TGVuZ3RoKHNlbGYsIGxlbmd0aCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJDdXRDbGFzc1J1bGVfc2V0TGVuZ3RoKHNlbGYsIGxlbmd0aCkKCiAgICBkZWYgZ2V0TGVuZ3RoKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQ3V0Q2xhc3NSdWxlX2dldExlbmd0aChzZWxmKQoKICAgIGRlZiBzZXROdW1DdXRzKHNlbGYsIG51bV9jdXRzKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckN1dENsYXNzUnVsZV9zZXROdW1DdXRzKHNlbGYsIG51bV9jdXRzKQoKICAgIGRlZiBnZXROdW1DdXRzKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQ3V0Q2xhc3NSdWxlX2dldE51bUN1dHMoc2VsZikKCiAgICBkZWYgc2V0TGVuZ3RoVmFsaWQoc2VsZiwgbGVuZ3RoX3ZhbGlkKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckN1dENsYXNzUnVsZV9zZXRMZW5ndGhWYWxpZChzZWxmLCBsZW5ndGhfdmFsaWQpCgogICAgZGVmIGlzTGVuZ3RoVmFsaWQoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJDdXRDbGFzc1J1bGVfaXNMZW5ndGhWYWxpZChzZWxmKQoKICAgIGRlZiBzZXRDdXRzVmFsaWQoc2VsZiwgY3V0c192YWxpZCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJDdXRDbGFzc1J1bGVfc2V0Q3V0c1ZhbGlkKHNlbGYsIGN1dHNfdmFsaWQpCgogICAgZGVmIGlzQ3V0c1ZhbGlkKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQ3V0Q2xhc3NSdWxlX2lzQ3V0c1ZhbGlkKHNlbGYpCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIGdldFRlY2hMYXllckN1dENsYXNzUnVsZShpbmx5LCBkYmlkKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckN1dENsYXNzUnVsZV9nZXRUZWNoTGF5ZXJDdXRDbGFzc1J1bGUoaW5seSwgZGJpZCkKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgY3JlYXRlKF9sYXllciwgbmFtZSk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJDdXRDbGFzc1J1bGVfY3JlYXRlKF9sYXllciwgbmFtZSkKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgZGVzdHJveShydWxlKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckN1dENsYXNzUnVsZV9kZXN0cm95KHJ1bGUpCgogICAgZGVmIF9faW5pdF9fKHNlbGYpOgogICAgICAgIF9vZGJfcHkuZGJUZWNoTGF5ZXJDdXRDbGFzc1J1bGVfc3dpZ2luaXQoc2VsZiwgX29kYl9weS5uZXdfZGJUZWNoTGF5ZXJDdXRDbGFzc1J1bGUoKSkKICAgIF9fc3dpZ19kZXN0cm95X18gPSBfb2RiX3B5LmRlbGV0ZV9kYlRlY2hMYXllckN1dENsYXNzUnVsZQoKIyBSZWdpc3RlciBkYlRlY2hMYXllckN1dENsYXNzUnVsZSBpbiBfb2RiX3B5Ogpfb2RiX3B5LmRiVGVjaExheWVyQ3V0Q2xhc3NSdWxlX3N3aWdyZWdpc3RlcihkYlRlY2hMYXllckN1dENsYXNzUnVsZSkKCmRlZiBkYlRlY2hMYXllckN1dENsYXNzUnVsZV9nZXRUZWNoTGF5ZXJDdXRDbGFzc1J1bGUoaW5seSwgZGJpZCk6CiAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckN1dENsYXNzUnVsZV9nZXRUZWNoTGF5ZXJDdXRDbGFzc1J1bGUoaW5seSwgZGJpZCkKCmRlZiBkYlRlY2hMYXllckN1dENsYXNzUnVsZV9jcmVhdGUoX2xheWVyLCBuYW1lKToKICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQ3V0Q2xhc3NSdWxlX2NyZWF0ZShfbGF5ZXIsIG5hbWUpCgpkZWYgZGJUZWNoTGF5ZXJDdXRDbGFzc1J1bGVfZGVzdHJveShydWxlKToKICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQ3V0Q2xhc3NSdWxlX2Rlc3Ryb3kocnVsZSkKCmNsYXNzIGRiVGVjaExheWVyQ3V0RW5jbG9zdXJlUnVsZShvYmplY3QpOgogICAgdGhpc293biA9IHByb3BlcnR5KGxhbWJkYSB4OiB4LnRoaXMub3duKCksIGxhbWJkYSB4LCB2OiB4LnRoaXMub3duKHYpLCBkb2M9J1RoZSBtZW1iZXJzaGlwIGZsYWcnKQogICAgX19yZXByX18gPSBfc3dpZ19yZXByCiAgICBERUZBVUxUID0gX29kYl9weS5kYlRlY2hMYXllckN1dEVuY2xvc3VyZVJ1bGVfREVGQVVMVAogICAgRU9MID0gX29kYl9weS5kYlRlY2hMYXllckN1dEVuY2xvc3VyZVJ1bGVfRU9MCiAgICBFTkRTSURFID0gX29kYl9weS5kYlRlY2hMYXllckN1dEVuY2xvc3VyZVJ1bGVfRU5EU0lERQogICAgSE9SWl9BTkRfVkVSVCA9IF9vZGJfcHkuZGJUZWNoTGF5ZXJDdXRFbmNsb3N1cmVSdWxlX0hPUlpfQU5EX1ZFUlQKCiAgICBkZWYgc2V0Q3V0Q2xhc3Moc2VsZiwgY3V0X2NsYXNzKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckN1dEVuY2xvc3VyZVJ1bGVfc2V0Q3V0Q2xhc3Moc2VsZiwgY3V0X2NsYXNzKQoKICAgIGRlZiBnZXRDdXRDbGFzcyhzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckN1dEVuY2xvc3VyZVJ1bGVfZ2V0Q3V0Q2xhc3Moc2VsZikKCiAgICBkZWYgc2V0RW9sV2lkdGgoc2VsZiwgZW9sX3dpZHRoKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckN1dEVuY2xvc3VyZVJ1bGVfc2V0RW9sV2lkdGgoc2VsZiwgZW9sX3dpZHRoKQoKICAgIGRlZiBnZXRFb2xXaWR0aChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckN1dEVuY2xvc3VyZVJ1bGVfZ2V0RW9sV2lkdGgoc2VsZikKCiAgICBkZWYgc2V0RW9sTWluTGVuZ3RoKHNlbGYsIGVvbF9taW5fbGVuZ3RoKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckN1dEVuY2xvc3VyZVJ1bGVfc2V0RW9sTWluTGVuZ3RoKHNlbGYsIGVvbF9taW5fbGVuZ3RoKQoKICAgIGRlZiBnZXRFb2xNaW5MZW5ndGgoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJDdXRFbmNsb3N1cmVSdWxlX2dldEVvbE1pbkxlbmd0aChzZWxmKQoKICAgIGRlZiBzZXRGaXJzdE92ZXJoYW5nKHNlbGYsIGZpcnN0X292ZXJoYW5nKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckN1dEVuY2xvc3VyZVJ1bGVfc2V0Rmlyc3RPdmVyaGFuZyhzZWxmLCBmaXJzdF9vdmVyaGFuZykKCiAgICBkZWYgZ2V0Rmlyc3RPdmVyaGFuZyhzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckN1dEVuY2xvc3VyZVJ1bGVfZ2V0Rmlyc3RPdmVyaGFuZyhzZWxmKQoKICAgIGRlZiBzZXRTZWNvbmRPdmVyaGFuZyhzZWxmLCBzZWNvbmRfb3ZlcmhhbmcpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQ3V0RW5jbG9zdXJlUnVsZV9zZXRTZWNvbmRPdmVyaGFuZyhzZWxmLCBzZWNvbmRfb3ZlcmhhbmcpCgogICAgZGVmIGdldFNlY29uZE92ZXJoYW5nKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQ3V0RW5jbG9zdXJlUnVsZV9nZXRTZWNvbmRPdmVyaGFuZyhzZWxmKQoKICAgIGRlZiBzZXRTcGFjaW5nKHNlbGYsIHNwYWNpbmcpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQ3V0RW5jbG9zdXJlUnVsZV9zZXRTcGFjaW5nKHNlbGYsIHNwYWNpbmcpCgogICAgZGVmIGdldFNwYWNpbmcoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJDdXRFbmNsb3N1cmVSdWxlX2dldFNwYWNpbmcoc2VsZikKCiAgICBkZWYgc2V0RXh0ZW5zaW9uKHNlbGYsIGV4dGVuc2lvbik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJDdXRFbmNsb3N1cmVSdWxlX3NldEV4dGVuc2lvbihzZWxmLCBleHRlbnNpb24pCgogICAgZGVmIGdldEV4dGVuc2lvbihzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckN1dEVuY2xvc3VyZVJ1bGVfZ2V0RXh0ZW5zaW9uKHNlbGYpCgogICAgZGVmIHNldEZvcndhcmRFeHRlbnNpb24oc2VsZiwgZm9yd2FyZF9leHRlbnNpb24pOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQ3V0RW5jbG9zdXJlUnVsZV9zZXRGb3J3YXJkRXh0ZW5zaW9uKHNlbGYsIGZvcndhcmRfZXh0ZW5zaW9uKQoKICAgIGRlZiBnZXRGb3J3YXJkRXh0ZW5zaW9uKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQ3V0RW5jbG9zdXJlUnVsZV9nZXRGb3J3YXJkRXh0ZW5zaW9uKHNlbGYpCgogICAgZGVmIHNldEJhY2t3YXJkRXh0ZW5zaW9uKHNlbGYsIGJhY2t3YXJkX2V4dGVuc2lvbik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJDdXRFbmNsb3N1cmVSdWxlX3NldEJhY2t3YXJkRXh0ZW5zaW9uKHNlbGYsIGJhY2t3YXJkX2V4dGVuc2lvbikKCiAgICBkZWYgZ2V0QmFja3dhcmRFeHRlbnNpb24oc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJDdXRFbmNsb3N1cmVSdWxlX2dldEJhY2t3YXJkRXh0ZW5zaW9uKHNlbGYpCgogICAgZGVmIHNldE1pbldpZHRoKHNlbGYsIG1pbl93aWR0aCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJDdXRFbmNsb3N1cmVSdWxlX3NldE1pbldpZHRoKHNlbGYsIG1pbl93aWR0aCkKCiAgICBkZWYgZ2V0TWluV2lkdGgoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJDdXRFbmNsb3N1cmVSdWxlX2dldE1pbldpZHRoKHNlbGYpCgogICAgZGVmIHNldEN1dFdpdGhpbihzZWxmLCBjdXRfd2l0aGluKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckN1dEVuY2xvc3VyZVJ1bGVfc2V0Q3V0V2l0aGluKHNlbGYsIGN1dF93aXRoaW4pCgogICAgZGVmIGdldEN1dFdpdGhpbihzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckN1dEVuY2xvc3VyZVJ1bGVfZ2V0Q3V0V2l0aGluKHNlbGYpCgogICAgZGVmIHNldE1pbkxlbmd0aChzZWxmLCBtaW5fbGVuZ3RoKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckN1dEVuY2xvc3VyZVJ1bGVfc2V0TWluTGVuZ3RoKHNlbGYsIG1pbl9sZW5ndGgpCgogICAgZGVmIGdldE1pbkxlbmd0aChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckN1dEVuY2xvc3VyZVJ1bGVfZ2V0TWluTGVuZ3RoKHNlbGYpCgogICAgZGVmIHNldFBhckxlbmd0aChzZWxmLCBwYXJfbGVuZ3RoKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckN1dEVuY2xvc3VyZVJ1bGVfc2V0UGFyTGVuZ3RoKHNlbGYsIHBhcl9sZW5ndGgpCgogICAgZGVmIGdldFBhckxlbmd0aChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckN1dEVuY2xvc3VyZVJ1bGVfZ2V0UGFyTGVuZ3RoKHNlbGYpCgogICAgZGVmIHNldFNlY29uZFBhckxlbmd0aChzZWxmLCBzZWNvbmRfcGFyX2xlbmd0aCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJDdXRFbmNsb3N1cmVSdWxlX3NldFNlY29uZFBhckxlbmd0aChzZWxmLCBzZWNvbmRfcGFyX2xlbmd0aCkKCiAgICBkZWYgZ2V0U2Vjb25kUGFyTGVuZ3RoKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQ3V0RW5jbG9zdXJlUnVsZV9nZXRTZWNvbmRQYXJMZW5ndGgoc2VsZikKCiAgICBkZWYgc2V0UGFyV2l0aGluKHNlbGYsIHBhcl93aXRoaW4pOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQ3V0RW5jbG9zdXJlUnVsZV9zZXRQYXJXaXRoaW4oc2VsZiwgcGFyX3dpdGhpbikKCiAgICBkZWYgZ2V0UGFyV2l0aGluKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQ3V0RW5jbG9zdXJlUnVsZV9nZXRQYXJXaXRoaW4oc2VsZikKCiAgICBkZWYgc2V0U2Vjb25kUGFyV2l0aGluKHNlbGYsIHNlY29uZF9wYXJfd2l0aGluKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckN1dEVuY2xvc3VyZVJ1bGVfc2V0U2Vjb25kUGFyV2l0aGluKHNlbGYsIHNlY29uZF9wYXJfd2l0aGluKQoKICAgIGRlZiBnZXRTZWNvbmRQYXJXaXRoaW4oc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJDdXRFbmNsb3N1cmVSdWxlX2dldFNlY29uZFBhcldpdGhpbihzZWxmKQoKICAgIGRlZiBzZXRCZWxvd0VuY2xvc3VyZShzZWxmLCBiZWxvd19lbmNsb3N1cmUpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQ3V0RW5jbG9zdXJlUnVsZV9zZXRCZWxvd0VuY2xvc3VyZShzZWxmLCBiZWxvd19lbmNsb3N1cmUpCgogICAgZGVmIGdldEJlbG93RW5jbG9zdXJlKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQ3V0RW5jbG9zdXJlUnVsZV9nZXRCZWxvd0VuY2xvc3VyZShzZWxmKQoKICAgIGRlZiBzZXROdW1Db3JuZXJzKHNlbGYsIG51bV9jb3JuZXJzKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckN1dEVuY2xvc3VyZVJ1bGVfc2V0TnVtQ29ybmVycyhzZWxmLCBudW1fY29ybmVycykKCiAgICBkZWYgZ2V0TnVtQ29ybmVycyhzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckN1dEVu",
"Y2xvc3VyZVJ1bGVfZ2V0TnVtQ29ybmVycyhzZWxmKQoKICAgIGRlZiBzZXRDdXRDbGFzc1ZhbGlkKHNlbGYsIGN1dF9jbGFzc192YWxpZCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJDdXRFbmNsb3N1cmVSdWxlX3NldEN1dENsYXNzVmFsaWQoc2VsZiwgY3V0X2NsYXNzX3ZhbGlkKQoKICAgIGRlZiBpc0N1dENsYXNzVmFsaWQoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJDdXRFbmNsb3N1cmVSdWxlX2lzQ3V0Q2xhc3NWYWxpZChzZWxmKQoKICAgIGRlZiBzZXRBYm92ZShzZWxmLCBhYm92ZSk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJDdXRFbmNsb3N1cmVSdWxlX3NldEFib3ZlKHNlbGYsIGFib3ZlKQoKICAgIGRlZiBpc0Fib3ZlKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQ3V0RW5jbG9zdXJlUnVsZV9pc0Fib3ZlKHNlbGYpCgogICAgZGVmIHNldEJlbG93KHNlbGYsIGJlbG93KToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckN1dEVuY2xvc3VyZVJ1bGVfc2V0QmVsb3coc2VsZiwgYmVsb3cpCgogICAgZGVmIGlzQmVsb3coc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJDdXRFbmNsb3N1cmVSdWxlX2lzQmVsb3coc2VsZikKCiAgICBkZWYgc2V0RW9sTWluTGVuZ3RoVmFsaWQoc2VsZiwgZW9sX21pbl9sZW5ndGhfdmFsaWQpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQ3V0RW5jbG9zdXJlUnVsZV9zZXRFb2xNaW5MZW5ndGhWYWxpZChzZWxmLCBlb2xfbWluX2xlbmd0aF92YWxpZCkKCiAgICBkZWYgaXNFb2xNaW5MZW5ndGhWYWxpZChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckN1dEVuY2xvc3VyZVJ1bGVfaXNFb2xNaW5MZW5ndGhWYWxpZChzZWxmKQoKICAgIGRlZiBzZXRFb2xPbmx5KHNlbGYsIGVvbF9vbmx5KToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckN1dEVuY2xvc3VyZVJ1bGVfc2V0RW9sT25seShzZWxmLCBlb2xfb25seSkKCiAgICBkZWYgaXNFb2xPbmx5KHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQ3V0RW5jbG9zdXJlUnVsZV9pc0VvbE9ubHkoc2VsZikKCiAgICBkZWYgc2V0U2hvcnRFZGdlT25Fb2woc2VsZiwgc2hvcnRfZWRnZV9vbl9lb2wpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQ3V0RW5jbG9zdXJlUnVsZV9zZXRTaG9ydEVkZ2VPbkVvbChzZWxmLCBzaG9ydF9lZGdlX29uX2VvbCkKCiAgICBkZWYgaXNTaG9ydEVkZ2VPbkVvbChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckN1dEVuY2xvc3VyZVJ1bGVfaXNTaG9ydEVkZ2VPbkVvbChzZWxmKQoKICAgIGRlZiBzZXRTaWRlU3BhY2luZ1ZhbGlkKHNlbGYsIHNpZGVfc3BhY2luZ192YWxpZCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJDdXRFbmNsb3N1cmVSdWxlX3NldFNpZGVTcGFjaW5nVmFsaWQoc2VsZiwgc2lkZV9zcGFjaW5nX3ZhbGlkKQoKICAgIGRlZiBpc1NpZGVTcGFjaW5nVmFsaWQoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJDdXRFbmNsb3N1cmVSdWxlX2lzU2lkZVNwYWNpbmdWYWxpZChzZWxmKQoKICAgIGRlZiBzZXRFbmRTcGFjaW5nVmFsaWQoc2VsZiwgZW5kX3NwYWNpbmdfdmFsaWQpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQ3V0RW5jbG9zdXJlUnVsZV9zZXRFbmRTcGFjaW5nVmFsaWQoc2VsZiwgZW5kX3NwYWNpbmdfdmFsaWQpCgogICAgZGVmIGlzRW5kU3BhY2luZ1ZhbGlkKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQ3V0RW5jbG9zdXJlUnVsZV9pc0VuZFNwYWNpbmdWYWxpZChzZWxmKQoKICAgIGRlZiBzZXRPZmZDZW50ZXJMaW5lKHNlbGYsIG9mZl9jZW50ZXJfbGluZSk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJDdXRFbmNsb3N1cmVSdWxlX3NldE9mZkNlbnRlckxpbmUoc2VsZiwgb2ZmX2NlbnRlcl9saW5lKQoKICAgIGRlZiBpc09mZkNlbnRlckxpbmUoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJDdXRFbmNsb3N1cmVSdWxlX2lzT2ZmQ2VudGVyTGluZShzZWxmKQoKICAgIGRlZiBzZXRXaWR0aFZhbGlkKHNlbGYsIHdpZHRoX3ZhbGlkKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckN1dEVuY2xvc3VyZVJ1bGVfc2V0V2lkdGhWYWxpZChzZWxmLCB3aWR0aF92YWxpZCkKCiAgICBkZWYgaXNXaWR0aFZhbGlkKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQ3V0RW5jbG9zdXJlUnVsZV9pc1dpZHRoVmFsaWQoc2VsZikKCiAgICBkZWYgc2V0SW5jbHVkZUFidXR0ZWQoc2VsZiwgaW5jbHVkZV9hYnV0dGVkKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckN1dEVuY2xvc3VyZVJ1bGVfc2V0SW5jbHVkZUFidXR0ZWQoc2VsZiwgaW5jbHVkZV9hYnV0dGVkKQoKICAgIGRlZiBpc0luY2x1ZGVBYnV0dGVkKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQ3V0RW5jbG9zdXJlUnVsZV9pc0luY2x1ZGVBYnV0dGVkKHNlbGYpCgogICAgZGVmIHNldEV4Y2VwdEV4dHJhQ3V0KHNlbGYsIGV4Y2VwdF9leHRyYV9jdXQpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQ3V0RW5jbG9zdXJlUnVsZV9zZXRFeGNlcHRFeHRyYUN1dChzZWxmLCBleGNlcHRfZXh0cmFfY3V0KQoKICAgIGRlZiBpc0V4Y2VwdEV4dHJhQ3V0KHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQ3V0RW5jbG9zdXJlUnVsZV9pc0V4Y2VwdEV4dHJhQ3V0KHNlbGYpCgogICAgZGVmIHNldFBybChzZWxmLCBwcmwpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQ3V0RW5jbG9zdXJlUnVsZV9zZXRQcmwoc2VsZiwgcHJsKQoKICAgIGRlZiBpc1BybChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckN1dEVuY2xvc3VyZVJ1bGVfaXNQcmwoc2VsZikKCiAgICBkZWYgc2V0Tm9TaGFyZWRFZGdlKHNlbGYsIG5vX3NoYXJlZF9lZGdlKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckN1dEVuY2xvc3VyZVJ1bGVfc2V0Tm9TaGFyZWRFZGdlKHNlbGYsIG5vX3NoYXJlZF9lZGdlKQoKICAgIGRlZiBpc05vU2hhcmVkRWRnZShzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckN1dEVuY2xvc3VyZVJ1bGVfaXNOb1NoYXJlZEVkZ2Uoc2VsZikKCiAgICBkZWYgc2V0TGVuZ3RoVmFsaWQoc2VsZiwgbGVuZ3RoX3ZhbGlkKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckN1dEVuY2xvc3VyZVJ1bGVfc2V0TGVuZ3RoVmFsaWQoc2VsZiwgbGVuZ3RoX3ZhbGlkKQoKICAgIGRlZiBpc0xlbmd0aFZhbGlkKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQ3V0RW5jbG9zdXJlUnVsZV9pc0xlbmd0aFZhbGlkKHNlbGYpCgogICAgZGVmIHNldEV4dHJhQ3V0VmFsaWQoc2VsZiwgZXh0cmFfY3V0X3ZhbGlkKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckN1dEVuY2xvc3VyZVJ1bGVfc2V0RXh0cmFDdXRWYWxpZChzZWxmLCBleHRyYV9jdXRfdmFsaWQpCgogICAgZGVmIGlzRXh0cmFDdXRWYWxpZChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckN1dEVuY2xvc3VyZVJ1bGVfaXNFeHRyYUN1dFZhbGlkKHNlbGYpCgogICAgZGVmIHNldEV4dHJhT25seShzZWxmLCBleHRyYV9vbmx5KToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckN1dEVuY2xvc3VyZVJ1bGVfc2V0RXh0cmFPbmx5KHNlbGYsIGV4dHJhX29ubHkpCgogICAgZGVmIGlzRXh0cmFPbmx5KHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQ3V0RW5jbG9zdXJlUnVsZV9pc0V4dHJhT25seShzZWxmKQoKICAgIGRlZiBzZXRSZWR1bmRhbnRDdXRWYWxpZChzZWxmLCByZWR1bmRhbnRfY3V0X3ZhbGlkKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckN1dEVuY2xvc3VyZVJ1bGVfc2V0UmVkdW5kYW50Q3V0VmFsaWQoc2VsZiwgcmVkdW5kYW50X2N1dF92YWxpZCkKCiAgICBkZWYgaXNSZWR1bmRhbnRDdXRWYWxpZChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckN1dEVuY2xvc3VyZVJ1bGVfaXNSZWR1bmRhbnRDdXRWYWxpZChzZWxmKQoKICAgIGRlZiBzZXRQYXJhbGxlbFZhbGlkKHNlbGYsIHBhcmFsbGVsX3ZhbGlkKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckN1dEVuY2xvc3VyZVJ1bGVfc2V0UGFyYWxsZWxWYWxpZChzZWxmLCBwYXJhbGxlbF92YWxpZCkKCiAgICBkZWYgaXNQYXJhbGxlbFZhbGlkKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQ3V0RW5jbG9zdXJlUnVsZV9pc1BhcmFsbGVsVmFsaWQoc2VsZikKCiAgICBkZWYgc2V0U2Vjb25kUGFyYWxsZWxWYWxpZChzZWxmLCBzZWNvbmRfcGFyYWxsZWxfdmFsaWQpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQ3V0RW5jbG9zdXJlUnVsZV9zZXRTZWNvbmRQYXJhbGxlbFZhbGlkKHNlbGYsIHNlY29uZF9wYXJhbGxlbF92YWxpZCkKCiAgICBkZWYgaXNTZWNvbmRQYXJhbGxlbFZhbGlkKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQ3V0RW5jbG9zdXJlUnVsZV9pc1NlY29uZFBhcmFsbGVsVmFsaWQoc2VsZikKCiAgICBkZWYgc2V0U2Vjb25kUGFyV2l0aGluVmFsaWQoc2VsZiwgc2Vjb25kX3Bhcl93aXRoaW5fdmFsaWQpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQ3V0RW5jbG9zdXJlUnVsZV9zZXRTZWNvbmRQYXJXaXRoaW5WYWxpZChzZWxmLCBzZWNvbmRfcGFyX3dpdGhpbl92YWxpZCkKCiAgICBkZWYgaXNTZWNvbmRQYXJXaXRoaW5WYWxpZChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckN1dEVuY2xvc3VyZVJ1bGVfaXNTZWNvbmRQYXJXaXRoaW5WYWxpZChzZWxmKQoKICAgIGRlZiBzZXRCZWxvd0VuY2xvc3VyZVZhbGlkKHNlbGYsIGJlbG93X2VuY2xvc3VyZV92YWxpZCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJDdXRFbmNsb3N1cmVSdWxlX3NldEJlbG93RW5jbG9zdXJlVmFsaWQoc2VsZiwgYmVsb3dfZW5jbG9zdXJlX3ZhbGlkKQoKICAgIGRlZiBpc0JlbG93RW5jbG9zdXJlVmFsaWQoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJDdXRFbmNsb3N1cmVSdWxlX2lzQmVsb3dFbmNsb3N1cmVWYWxpZChzZWxmKQoKICAgIGRlZiBzZXRDb25jYXZlQ29ybmVyc1ZhbGlkKHNlbGYsIGNvbmNhdmVfY29ybmVyc192YWxpZCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJDdXRFbmNsb3N1cmVSdWxlX3NldENvbmNhdmVDb3JuZXJzVmFsaWQoc2VsZiwgY29uY2F2ZV9jb3JuZXJzX3ZhbGlkKQoKICAgIGRlZiBpc0NvbmNhdmVDb3JuZXJzVmFsaWQoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJDdXRFbmNsb3N1cmVSdWxlX2lzQ29uY2F2ZUNvcm5lcnNWYWxpZChzZWxmKQoKICAgIGRlZiBzZXRUeXBlKHNlbGYsIHR5cGUpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQ3V0RW5jbG9zdXJlUnVsZV9zZXRUeXBlKHNlbGYsIHR5cGUpCgogICAgZGVmIGdldFR5cGUoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJDdXRFbmNsb3N1cmVSdWxlX2dldFR5cGUoc2VsZikKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgY3JlYXRlKGxheWVyKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckN1dEVuY2xvc3VyZVJ1bGVfY3JlYXRlKGxheWVyKQoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBnZXRUZWNoTGF5ZXJDdXRFbmNsb3N1cmVSdWxlKGlubHksIGRiaWQpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQ3V0RW5jbG9zdXJlUnVsZV9nZXRUZWNoTGF5ZXJDdXRFbmNsb3N1cmVSdWxlKGlubHksIGRiaWQpCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIGRlc3Ryb3kocnVsZSk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJDdXRFbmNsb3N1cmVSdWxlX2Rlc3Ryb3kocnVsZSkKCiAgICBkZWYgX19pbml0X18oc2VsZik6CiAgICAgICAgX29kYl9weS5kYlRlY2hMYXllckN1dEVuY2xvc3VyZVJ1bGVfc3dpZ2luaXQoc2VsZiwgX29kYl9weS5uZXdfZGJUZWNoTGF5ZXJDdXRFbmNsb3N1cmVSdWxlKCkpCiAgICBfX3N3aWdfZGVzdHJveV9fID0gX29kYl9weS5kZWxldGVfZGJUZWNoTGF5ZXJDdXRFbmNsb3N1cmVSdWxlCgojIFJlZ2lzdGVyIGRiVGVjaExheWVyQ3V0RW5jbG9zdXJlUnVsZSBpbiBfb2RiX3B5Ogpfb2RiX3B5LmRiVGVjaExheWVyQ3V0RW5jbG9zdXJlUnVsZV9zd2lncmVnaXN0ZXIoZGJUZWNoTGF5ZXJDdXRFbmNsb3N1cmVSdWxlKQoKZGVmIGRiVGVjaExheWVyQ3V0RW5jbG9zdXJlUnVsZV9jcmVhdGUobGF5ZXIpOgogICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJDdXRFbmNsb3N1cmVSdWxlX2NyZWF0ZShsYXllcikKCmRlZiBkYlRlY2hMYXllckN1dEVuY2xvc3VyZVJ1bGVfZ2V0VGVjaExheWVyQ3V0RW5jbG9zdXJlUnVsZShpbmx5LCBkYmlkKToKICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQ3V0RW5jbG9zdXJlUnVsZV9nZXRUZWNoTGF5ZXJDdXRFbmNsb3N1cmVSdWxlKGlubHksIGRiaWQpCgpkZWYgZGJUZWNoTGF5ZXJDdXRFbmNsb3N1cmVSdWxlX2Rlc3Ryb3kocnVsZSk6CiAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckN1dEVuY2xvc3VyZVJ1bGVfZGVzdHJveShydWxlKQoKY2xhc3MgZGJUZWNoTGF5ZXJDdXRTcGFjaW5nUnVsZShvYmplY3QpOgogICAgdGhpc293biA9IHByb3BlcnR5KGxhbWJkYSB4OiB4LnRoaXMub3duKCksIGxhbWJkYSB4LCB2OiB4LnRoaXMub3duKHYpLCBkb2M9J1RoZSBtZW1iZXJzaGlwIGZsYWcnKQogICAgX19yZXByX18gPSBfc3dpZ19yZXByCiAgICBOT05FID0gX29kYl9weS5kYlRlY2hMYXllckN1dFNwYWNpbmdSdWxlX05PTkUKICAgIE1BWFhZID0gX29kYl9weS5kYlRlY2hMYXllckN1dFNwYWNpbmdSdWxlX01BWFhZCiAgICBTQU1FTUFTSyA9IF9vZGJfcHkuZGJUZWNoTGF5ZXJDdXRTcGFjaW5nUnVsZV9TQU1FTUFTSwogICAgTEFZRVIgPSBfb2RiX3B5LmRiVGVjaExheWVyQ3V0U3BhY2luZ1J1bGVfTEFZRVIKICAgIEFESkFDRU5UQ1VUUyA9IF9vZGJfcHkuZGJUZWNoTGF5ZXJDdXRTcGFjaW5nUnVsZV9BREpBQ0VOVENVVFMKICAgIFBBUkFMTEVMT1ZFUkxBUCA9IF9vZGJfcHkuZGJUZWNoTGF5ZXJDdXRTcGFjaW5nUnVsZV9QQVJBTExFTE9WRVJMQVAKICAgIFBBUkFMTEVMV0lUSElOID0gX29kYl9weS5kYlRlY2hMYXllckN1dFNwYWNpbmdSdWxlX1BBUkFMTEVMV0lUSElOCiAgICBTQU1FTUVUQUxTSEFSRURFREdFID0gX29kYl9weS5kYlRlY2hMYXllckN1dFNwYWNpbmdSdWxlX1NBTUVNRVRBTFNIQVJFREVER0UKICAgIEFSRUEgPSBfb2RiX3B5LmRiVGVjaExheWVyQ3V0U3BhY2luZ1J1bGVfQVJFQQoKICAgIGRlZiBzZXRDdXRTcGFjaW5nKHNlbGYsIGN1dF9zcGFjaW5nKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckN1dFNwYWNpbmdSdWxlX3NldEN1dFNwYWNpbmcoc2VsZiwgY3V0X3NwYWNpbmcpCgogICAgZGVmIGdldEN1dFNwYWNpbmcoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJDdXRTcGFjaW5nUnVsZV9nZXRDdXRTcGFjaW5nKHNlbGYpCgogICAgZGVmIHNldFNlY29uZExheWVyKHNlbGYsIHNlY29uZF9sYXllcik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJDdXRTcGFjaW5nUnVsZV9zZXRTZWNvbmRMYXllcihzZWxmLCBzZWNvbmRfbGF5ZXIpCgogICAgZGVmIHNldE9ydGhvZ29uYWxTcGFjaW5nKHNlbGYsIG9ydGhvZ29uYWxfc3BhY2luZyk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJDdXRTcGFjaW5nUnVsZV9zZXRPcnRob2dvbmFsU3BhY2luZyhzZWxmLCBvcnRob2dvbmFsX3NwYWNpbmcpCgogICAgZGVmIGdldE9ydGhvZ29uYWxTcGFjaW5nKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQ3V0U3BhY2luZ1J1bGVfZ2V0T3J0aG9nb25hbFNwYWNpbmcoc2VsZikKCiAgICBkZWYgc2V0V2lkdGgoc2VsZiwgd2lkdGgpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQ3V0U3BhY2luZ1J1bGVfc2V0V2lkdGgoc2VsZiwgd2lkdGgpCgogICAgZGVmIGdldFdpZHRoKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQ3V0U3BhY2luZ1J1bGVfZ2V0V2lkdGgoc2VsZikKCiAgICBkZWYgc2V0RW5jbG9zdXJlKHNlbGYsIGVuY2xvc3VyZSk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJDdXRTcGFjaW5nUnVsZV9zZXRFbmNsb3N1cmUoc2VsZiwgZW5jbG9zdXJlKQoKICAgIGRlZiBnZXRFbmNsb3N1cmUoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJDdXRTcGFjaW5nUnVsZV9nZXRFbmNsb3N1cmUoc2VsZikKCiAgICBkZWYgc2V0RWRnZUxlbmd0aChzZWxmLCBlZGdlX2xlbmd0aCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJDdXRTcGFjaW5nUnVsZV9zZXRFZGdlTGVuZ3RoKHNlbGYsIGVkZ2VfbGVuZ3RoKQoKICAgIGRlZiBnZXRFZGdlTGVuZ3RoKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQ3V0U3BhY2luZ1J1bGVfZ2V0RWRnZUxlbmd0aChzZWxmKQoKICAgIGRlZiBzZXRQYXJXaXRoaW4oc2VsZiwgcGFyX3dpdGhpbik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJDdXRTcGFjaW5nUnVsZV9zZXRQYXJXaXRoaW4oc2VsZiwgcGFyX3dpdGhpbikKCiAgICBkZWYgZ2V0UGFyV2l0aGluKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQ3V0U3BhY2luZ1J1bGVfZ2V0UGFyV2l0aGluKHNlbGYpCgogICAgZGVmIHNldFBhckVuY2xvc3VyZShzZWxmLCBwYXJfZW5jbG9zdXJlKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckN1dFNwYWNpbmdSdWxlX3NldFBhckVuY2xvc3VyZShzZWxmLCBwYXJfZW5jbG9zdXJlKQoKICAgIGRlZiBnZXRQYXJFbmNsb3N1cmUoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJDdXRTcGFjaW5nUnVsZV9nZXRQYXJFbmNsb3N1cmUoc2VsZikKCiAgICBkZWYgc2V0RWRnZUVuY2xvc3VyZShzZWxmLCBlZGdlX2VuY2xvc3VyZSk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJDdXRTcGFjaW5nUnVsZV9zZXRFZGdlRW5jbG9zdXJlKHNlbGYsIGVkZ2VfZW5jbG9zdXJlKQoKICAgIGRlZiBnZXRFZGdlRW5jbG9zdXJlKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQ3V0U3BhY2luZ1J1bGVfZ2V0RWRnZUVuY2xvc3VyZShzZWxmKQoKICAgIGRlZiBzZXRBZGpFbmNsb3N1cmUoc2VsZiwgYWRqX2VuY2xvc3VyZSk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJDdXRTcGFjaW5nUnVsZV9zZXRBZGpFbmNsb3N1cmUoc2VsZiwgYWRqX2VuY2xvc3VyZSkKCiAgICBkZWYgZ2V0QWRqRW5jbG9zdXJlKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQ3V0U3BhY2luZ1J1bGVfZ2V0QWRqRW5jbG9zdXJlKHNlbGYpCgogICAgZGVmIHNldEFib3ZlRW5jbG9zdXJlKHNlbGYsIGFib3ZlX2VuY2xvc3VyZSk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJDdXRTcGFjaW5nUnVsZV9zZXRBYm92ZUVuY2xvc3VyZShzZWxmLCBhYm92ZV9lbmNsb3N1cmUpCgogICAgZGVmIGdldEFib3ZlRW5jbG9zdXJlKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQ3V0U3BhY2luZ1J1bGVfZ2V0QWJvdmVFbmNsb3N1cmUoc2VsZikKCiAgICBkZWYgc2V0QWJvdmVXaWR0aChzZWxmLCBhYm92ZV93aWR0aCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJDdXRTcGFjaW5nUnVsZV9zZXRBYm92ZVdpZHRoKHNlbGYsIGFib3ZlX3dpZHRoKQoKICAgIGRlZiBnZXRBYm92ZVdpZHRoKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQ3V0U3BhY2luZ1J1bGVfZ2V0QWJvdmVXaWR0aChzZWxmKQoKICAgIGRlZiBzZXRNaW5MZW5ndGgoc2VsZiwgbWluX2xlbmd0aCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJDdXRTcGFjaW5nUnVsZV9zZXRNaW5MZW5ndGgoc2VsZiwgbWluX2xlbmd0aCkKCiAgICBkZWYgZ2V0TWluTGVuZ3RoKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQ3V0U3BhY2luZ1J1bGVfZ2V0TWluTGVuZ3RoKHNlbGYpCgogICAgZGVmIHNldEV4dGVuc2lvbihzZWxmLCBleHRlbnNpb24pOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQ3V0U3BhY2luZ1J1bGVfc2V0RXh0ZW5zaW9uKHNlbGYsIGV4dGVuc2lvbikKCiAgICBkZWYgZ2V0RXh0ZW5zaW9uKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQ3V0U3BhY2luZ1J1bGVfZ2V0RXh0ZW5zaW9uKHNlbGYpCgogICAgZGVmIHNldEVvbFdpZHRoKHNlbGYsIGVvbF93aWR0aCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJDdXRTcGFjaW5nUnVsZV9zZXRFb2xXaWR0aChzZWxmLCBlb2xfd2lkdGgpCgogICAgZGVmIGdldEVvbFdpZHRoKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQ3V0U3BhY2luZ1J1bGVfZ2V0RW9sV2lkdGgoc2VsZikKCiAgICBkZWYgc2V0TnVtQ3V0cyhzZWxmLCBudW1fY3V0cyk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJDdXRTcGFjaW5nUnVsZV9zZXROdW1DdXRzKHNlbGYsIG51bV9jdXRzKQoKICAgIGRlZiBnZXROdW1DdXRzKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQ3V0U3BhY2luZ1J1bGVfZ2V0TnVtQ3V0cyhzZWxmKQoKICAgIGRlZiBzZXRXaXRoaW4oc2VsZiwgd2l0aGluKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckN1dFNwYWNpbmdSdWxlX3NldFdpdGhpbihzZWxmLCB3aXRoaW4pCgogICAgZGVmIGdldFdpdGhpbihzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckN1dFNwYWNpbmdSdWxlX2dldFdpdGhpbihzZWxmKQoKICAgIGRlZiBzZXRTZWNvbmRXaXRoaW4oc2VsZiwgc2Vjb25kX3dpdGhpbik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJDdXRTcGFjaW5nUnVsZV9zZXRTZWNvbmRXaXRoaW4oc2VsZiwgc2Vjb25kX3dpdGhpbikKCiAgICBkZWYgZ2V0U2Vjb25kV2l0aGluKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQ3V0U3BhY2luZ1J1bGVfZ2V0U2Vjb25kV2l0aGluKHNlbGYpCgogICAgZGVmIHNldEN1dENsYXNzKHNlbGYsIGN1dF9jbGFzcyk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJDdXRTcGFjaW5nUnVsZV9zZXRDdXRDbGFzcyhzZWxmLCBjdXRfY2xhc3MpCgogICAgZGVmIHNldFR3b0N1dHMoc2VsZiwgdHdvX2N1dHMpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQ3V0U3BhY2luZ1J1bGVfc2V0VHdvQ3V0cyhzZWxmLCB0d29fY3V0cykKCiAgICBkZWYgZ2V0VHdvQ3V0cyhzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckN1dFNwYWNpbmdSdWxlX2dldFR3b0N1dHMoc2VsZikKCiAgICBkZWYgc2V0UHJsKHNlbGYsIHBybCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJDdXRTcGFjaW5nUnVsZV9zZXRQcmwoc2VsZiwgcHJsKQoKICAgIGRlZiBnZXRQcmwoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJDdXRTcGFjaW5nUnVsZV9nZXRQcmwoc2VsZikKCiAgICBkZWYgc2V0UGFyTGVuZ3RoKHNlbGYsIHBhcl9sZW5ndGgpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQ3V0U3BhY2luZ1J1bGVfc2V0UGFyTGVuZ3RoKHNlbGYsIHBhcl9sZW5ndGgpCgogICAgZGVmIGdldFBhckxlbmd0aChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckN1dFNwYWNpbmdSdWxlX2dldFBhckxlbmd0aChzZWxmKQoKICAgIGRlZiBzZXRDdXRBcmVhKHNlbGYsIGN1dF9hcmVhKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckN1dFNwYWNpbmdSdWxlX3NldEN1dEFyZWEoc2VsZiwgY3V0X2FyZWEpCgogICAgZGVmIGdldEN1dEFyZWEoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJDdXRTcGFjaW5nUnVsZV9nZXRDdXRBcmVhKHNlbGYpCgogICAgZGVmIHNldENlbnRlclRvQ2VudGVyKHNlbGYsIGNlbnRlcl90b19jZW50ZXIpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQ3V0U3BhY2luZ1J1bGVfc2V0Q2VudGVyVG9DZW50ZXIoc2VsZiwgY2VudGVyX3RvX2NlbnRlcikKCiAgICBkZWYgaXNDZW50ZXJUb0NlbnRlcihzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckN1dFNwYWNpbmdSdWxlX2lzQ2VudGVyVG9DZW50ZXIoc2VsZikKCiAgICBkZWYgc2V0U2FtZU5ldChzZWxmLCBzYW1lX25ldCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJDdXRTcGFjaW5nUnVsZV9zZXRTYW1lTmV0KHNlbGYsIHNhbWVfbmV0KQoKICAgIGRlZiBpc1NhbWVOZXQoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJDdXRTcGFjaW5nUnVsZV9pc1NhbWVOZXQoc2VsZikKCiAgICBkZWYgc2V0U2FtZU1ldGFsKHNlbGYsIHNhbWVfbWV0YWwpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQ3V0U3BhY2luZ1J1bGVfc2V0U2FtZU1ldGFsKHNlbGYsIHNhbWVfbWV0YWwpCgogICAgZGVmIGlzU2FtZU1ldGFsKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQ3V0U3BhY2luZ1J1bGVfaXNTYW1lTWV0YWwoc2VsZikKCiAgICBkZWYgc2V0U2FtZVZpYShzZWxmLCBzYW1lX3ZpYSk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJDdXRTcGFjaW5nUnVsZV9zZXRTYW1lVmlhKHNlbGYsIHNhbWVfdmlhKQoKICAgIGRlZiBpc1NhbWVWaWEoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJDdXRTcGFjaW5nUnVsZV9pc1NhbWVWaWEoc2VsZikKCiAgICBkZWYgc2V0U3RhY2soc2VsZiwgc3RhY2spOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQ3V0U3BhY2luZ1J1bGVfc2V0U3RhY2soc2VsZiwgc3RhY2spCgogICAgZGVmIGlzU3RhY2soc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJDdXRTcGFjaW5nUnVsZV9pc1N0YWNrKHNlbGYpCgogICAgZGVmIHNldE9ydGhvZ29uYWxTcGFjaW5nVmFsaWQoc2VsZiwgb3J0aG9nb25hbF9zcGFjaW5nX3ZhbGlkKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckN1dFNwYWNpbmdSdWxlX3NldE9ydGhvZ29uYWxTcGFjaW5nVmFsaWQoc2VsZiwgb3J0aG9nb25hbF9zcGFjaW5nX3ZhbGlkKQoKICAgIGRlZiBpc09ydGhvZ29uYWxTcGFjaW5nVmFsaWQoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJDdXRTcGFjaW5nUnVsZV9pc09ydGhvZ29uYWxTcGFjaW5nVmFsaWQoc2VsZikKCiAgICBkZWYgc2V0QWJvdmVXaWR0aEVuY2xvc3VyZVZhbGlkKHNlbGYsIGFib3ZlX3dpZHRoX2VuY2xvc3VyZV92YWxpZCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJDdXRTcGFjaW5nUnVsZV9zZXRBYm92ZVdpZHRoRW5jbG9zdXJlVmFsaWQoc2VsZiwgYWJvdmVfd2lkdGhfZW5jbG9zdXJlX3ZhbGlkKQoKICAgIGRlZiBpc0Fib3ZlV2lkdGhFbmNsb3N1cmVWYWxpZChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckN1dFNwYWNpbmdSdWxlX2lzQWJvdmVXaWR0aEVuY2xvc3VyZVZhbGlkKHNlbGYpCgogICAgZGVmIHNldFNob3J0RWRnZU9ubHkoc2VsZiwgc2hvcnRfZWRnZV9vbmx5KToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckN1dFNwYWNpbmdSdWxlX3NldFNob3J0RWRnZU9ubHkoc2VsZiwgc2hvcnRfZWRnZV9vbmx5KQoKICAgIGRlZiBpc1Nob3J0RWRnZU9ubHkoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJDdXRTcGFjaW5nUnVsZV9pc1Nob3J0RWRnZU9ubHkoc2VsZikKCiAgICBkZWYgc2V0Q29uY2F2ZUNvcm5lcldpZHRoKHNlbGYsIGNvbmNhdmVfY29ybmVyX3dpZHRoKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckN1dFNwYWNpbmdSdWxlX3NldENvbmNhdmVDb3JuZXJXaWR0aChzZWxmLCBjb25jYXZlX2Nvcm5lcl93aWR0aCkKCiAgICBkZWYgaXNDb25jYXZlQ29ybmVyV2lkdGgoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJDdXRTcGFjaW5nUnVsZV9pc0NvbmNhdmVDb3JuZXJXaWR0aChzZWxmKQoKICAgIGRlZiBzZXRDb25jYXZlQ29ybmVyUGFyYWxsZWwoc2VsZiwgY29uY2F2ZV9jb3JuZXJfcGFyYWxsZWwpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQ3V0U3BhY2luZ1J1bGVfc2V0Q29uY2F2ZUNvcm5lclBhcmFsbGVsKHNlbGYsIGNvbmNhdmVfY29ybmVyX3BhcmFsbGVsKQoKICAgIGRlZiBpc0NvbmNhdmVDb3JuZXJQYXJhbGxlbChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckN1dFNwYWNpbmdSdWxlX2lzQ29uY2F2ZUNvcm5lclBhcmFsbGVsKHNlbGYpCgogICAgZGVmIHNldENvbmNhdmVDb3JuZXJFZGdlTGVuZ3RoKHNlbGYsIGNvbmNhdmVfY29ybmVyX2VkZ2VfbGVuZ3RoKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckN1dFNwYWNpbmdSdWxlX3NldENvbmNhdmVDb3JuZXJFZGdlTGVuZ3RoKHNlbGYsIGNvbmNhdmVfY29ybmVyX2VkZ2VfbGVuZ3RoKQoKICAgIGRlZiBpc0NvbmNhdmVDb3JuZXJFZGdlTGVuZ3RoKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQ3V0U3BhY2luZ1J1bGVfaXNDb25jYXZlQ29ybmVyRWRnZUxlbmd0aChzZWxmKQoKICAgIGRlZiBzZXRDb25jYXZlQ29ybmVyKHNlbGYsIGNvbmNhdmVfY29ybmVyKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckN1dFNwYWNpbmdSdWxlX3NldENvbmNhdmVDb3JuZXIoc2VsZiwgY29uY2F2ZV9jb3JuZXIpCgogICAgZGVmIGlzQ29uY2F2ZUNvcm5lcihzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckN1dFNwYWNpbmdSdWxlX2lzQ29uY2F2ZUNvcm5lcihzZWxmKQoKICAgIGRlZiBzZXRFeHRlbnNpb25WYWxpZChzZWxmLCBleHRlbnNpb25fdmFsaWQpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQ3V0U3BhY2luZ1J1bGVfc2V0RXh0ZW5zaW9uVmFsaWQoc2VsZiwgZXh0ZW5zaW9uX3ZhbGlkKQoKICAgIGRlZiBpc0V4dGVuc2lvblZhbGlkKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQ3V0U3BhY2luZ1J1bGVfaXNFeHRlbnNpb25WYWxpZChzZWxmKQoKICAgIGRlZiBzZXROb25Fb2xDb252ZXhDb3JuZXIoc2VsZiwgbm9uX2VvbF9jb252ZXhfY29ybmVyKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckN1dFNwYWNpbmdSdWxlX3NldE5vbkVvbENvbnZleENvcm5lcihzZWxmLCBub25fZW9sX2NvbnZleF9jb3JuZXIpCgogICAgZGVmIGlzTm9uRW9sQ29udmV4Q29ybmVyKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQ3V0U3BhY2luZ1J1bGVfaXNOb25Fb2xDb252ZXhDb3JuZXIoc2VsZikKCiAgICBkZWYgc2V0RW9sV2lkdGhWYWxpZChzZWxmLCBlb2xfd2lkdGhfdmFsaWQpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQ3V0U3BhY2luZ1J1bGVfc2V0RW9sV2lkdGhWYWxpZChzZWxmLCBlb2xfd2lkdGhfdmFsaWQpCgogICAgZGVmIGlzRW9sV2lkdGhWYWxpZChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckN1dFNwYWNpbmdSdWxlX2lzRW9sV2lkdGhWYWxpZChzZWxmKQoKICAgIGRlZiBzZXRNaW5MZW5ndGhWYWxpZChzZWxmLCBtaW5fbGVuZ3RoX3ZhbGlkKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckN1dFNwYWNpbmdSdWxlX3NldE1pbkxlbmd0aFZhbGlkKHNlbGYsIG1pbl9sZW5ndGhfdmFsaWQpCgogICAgZGVmIGlzTWluTGVuZ3RoVmFsaWQoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJDdXRTcGFjaW5nUnVsZV9pc01pbkxlbmd0aFZhbGlkKHNlbGYpCgogICAgZGVmIHNldEFib3ZlV2lkdGhWYWxpZChzZWxmLCBhYm92ZV93aWR0aF92YWxpZCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJDdXRTcGFjaW5nUnVsZV9zZXRBYm92ZVdpZHRoVmFsaWQoc2VsZiwgYWJvdmVfd2lkdGhfdmFsaWQpCgogICAgZGVmIGlzQWJvdmVXaWR0aFZhbGlkKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQ3V0U3BhY2luZ1J1bGVfaXNBYm92ZVdpZHRoVmFsaWQoc2VsZikKCiAgICBkZWYgc2V0TWFza092ZXJsYXAoc2VsZiwgbWFza19vdmVybGFwKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckN1dFNwYWNpbmdSdWxlX3NldE1hc2tPdmVybGFwKHNlbGYsIG1hc2tfb3ZlcmxhcCkKCiAgICBkZWYgaXNNYXNrT3ZlcmxhcChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckN1dFNwYWNpbmdSdWxlX2lzTWFza092ZXJsYXAoc2VsZikKCiAgICBkZWYgc2V0V3JvbmdEaXJlY3Rpb24oc2VsZiwgd3JvbmdfZGlyZWN0aW9uKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckN1dFNwYWNpbmdSdWxlX3NldFdyb25nRGlyZWN0aW9uKHNlbGYsIHdyb25nX2RpcmVjdGlvbikKCiAgICBkZWYgaXNXcm9uZ0RpcmVjdGlvbihzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckN1dFNwYWNpbmdSdWxlX2lzV3JvbmdEaXJlY3Rpb24oc2VsZikKCiAgICBkZWYgc2V0QWRqYWNlbnRDdXRzKHNlbGYsIGFkamFjZW50X2N1dHMpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQ3V0U3BhY2luZ1J1bGVfc2V0QWRqYWNlbnRDdXRzKHNlbGYsIGFkamFjZW50X2N1dHMpCgogICAgZGVmIGdldEFkamFjZW50Q3V0cyhzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckN1dFNwYWNpbmdSdWxlX2dldEFkamFjZW50Q3V0cyhzZWxmKQoKICAgIGRlZiBzZXRFeGFjdEFsaWduZWQoc2VsZiwgZXhhY3RfYWxpZ25lZCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJDdXRTcGFjaW5nUnVsZV9zZXRFeGFjdEFsaWduZWQoc2VsZiwgZXhhY3RfYWxpZ25lZCkKCiAgICBkZWYgaXNFeGFjdEFsaWduZWQoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJDdXRTcGFjaW5nUnVsZV9pc0V4YWN0QWxpZ25lZChzZWxmKQoKICAgIGRlZiBzZXRDdXRDbGFzc1RvQWxsKHNlbGYsIGN1dF9jbGFzc190b19hbGwpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQ3V0U3BhY2luZ1J1bGVfc2V0Q3V0Q2xhc3NUb0FsbChzZWxmLCBjdXRfY2xhc3NfdG9fYWxsKQoKICAgIGRlZiBpc0N1dENsYXNzVG9BbGwoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJDdXRTcGFjaW5nUnVsZV9pc0N1dENsYXNzVG9BbGwoc2VsZikKCiAgICBkZWYgc2V0Tm9Qcmwoc2VsZiwgbm9fcHJsKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckN1dFNwYWNpbmdSdWxlX3NldE5vUHJsKHNlbGYsIG5vX3BybCkKCiAgICBkZWYgaXNOb1BybChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckN1dFNwYWNpbmdSdWxlX2lzTm9Qcmwoc2VsZikKCiAgICBkZWYgc2V0U2FtZU1hc2soc2VsZiwgc2FtZV9tYXNrKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckN1dFNwYWNpbmdSdWxlX3NldFNhbWVNYXNrKHNlbGYsIHNhbWVfbWFzaykKCiAgICBkZWYgaXNTYW1lTWFzayhzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckN1dFNwYWNpbmdSdWxlX2lzU2FtZU1hc2soc2VsZikKCiAgICBkZWYgc2V0RXhjZXB0U2FtZVBnbmV0KHNlbGYsIGV4Y2VwdF9zYW1lX3BnbmV0KToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckN1dFNwYWNpbmdSdWxlX3NldEV4Y2VwdFNhbWVQZ25ldChzZWxmLCBleGNlcHRfc2FtZV9wZ25ldCkKCiAgICBkZWYgaXNFeGNlcHRTYW1lUGduZXQoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJDdXRTcGFjaW5nUnVsZV9pc0V4Y2VwdFNhbWVQZ25ldChzZWxmKQoKICAgIGRlZiBzZXRTaWRlUGFyYWxsZWxPdmVybGFwKHNlbGYsIHNpZGVfcGFyYWxsZWxfb3ZlcmxhcCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJDdXRTcGFjaW5nUnVsZV9zZXRTaWRlUGFyYWxsZWxPdmVybGFwKHNlbGYsIHNpZGVfcGFyYWxsZWxfb3ZlcmxhcCkKCiAgICBkZWYgaXNTaWRlUGFyYWxsZWxPdmVybGFwKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQ3V0U3BhY2luZ1J1bGVfaXNTaWRlUGFyYWxsZWxPdmVybGFwKHNlbGYpCgogICAgZGVmIHNldEV4Y2VwdFNhbWVOZXQoc2VsZiwgZXhjZXB0X3NhbWVfbmV0KToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckN1dFNwYWNpbmdSdWxlX3NldEV4Y2VwdFNhbWVOZXQoc2VsZiwgZXhjZXB0X3NhbWVfbmV0KQoKICAgIGRlZiBpc0V4Y2VwdFNhbWVOZXQoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJDdXRTcGFjaW5nUnVsZV9pc0V4Y2VwdFNhbWVOZXQoc2VsZikKCiAgICBkZWYgc2V0RXhjZXB0U2FtZU1ldGFsKHNlbGYsIGV4Y2VwdF9zYW1lX21ldGFsKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckN1dFNwYWNpbmdSdWxlX3NldEV4Y2VwdFNhbWVNZXRhbChzZWxmLCBleGNlcHRfc2FtZV9tZXRhbCkKCiAgICBkZWYgaXNFeGNlcHRTYW1lTWV0YWwoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJDdXRTcGFjaW5nUnVsZV9pc0V4Y2VwdFNhbWVNZXRhbChzZWxmKQoKICAgIGRlZiBzZXRFeGNlcHRTYW1lTWV0YWxPdmVybGFwKHNlbGYsIGV4Y2VwdF9zYW1lX21ldGFsX292ZXJsYXApOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQ3V0U3BhY2luZ1J1bGVfc2V0RXhjZXB0U2FtZU1ldGFsT3ZlcmxhcChzZWxmLCBleGNlcHRfc2FtZV9tZXRhbF9vdmVybGFwKQoKICAgIGRlZiBpc0V4Y2VwdFNhbWVNZXRhbE92ZXJsYXAoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJDdXRTcGFjaW5nUnVsZV9pc0V4Y2VwdFNhbWVNZXRhbE92ZXJsYXAoc2VsZikKCiAgICBkZWYgc2V0RXhjZXB0U2FtZVZpYShzZWxmLCBleGNlcHRfc2FtZV92aWEpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQ3V0U3BhY2luZ1J1bGVfc2V0RXhjZXB0U2FtZVZpYShzZWxmLCBleGNlcHRfc2FtZV92aWEpCgogICAgZGVmIGlzRXhjZXB0U2FtZVZpYShzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckN1dFNwYWNpbmdSdWxlX2lzRXhjZXB0U2FtZVZpYShzZWxmKQoKICAgIGRlZiBzZXRBYm92ZShzZWxmLCBhYm92ZSk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJDdXRTcGFjaW5nUnVsZV9zZXRBYm92ZShzZWxmLCBhYm92ZSkKCiAgICBkZWYgaXNBYm92ZShzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckN1dFNwYWNpbmdSdWxlX2lzQWJvdmUoc2VsZikKCiAgICBkZWYgc2V0RXhjZXB0VHdvRWRnZXMoc2VsZiwgZXhjZXB0X3R3b19lZGdlcyk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJDdXRTcGFjaW5nUnVsZV9zZXRFeGNlcHRUd29FZGdlcyhzZWxmLCBleGNlcHRfdHdvX2VkZ2VzKQoKICAgIGRlZiBpc0V4Y2VwdFR3b0VkZ2VzKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQ3V0U3BhY2luZ1J1bGVfaXNFeGNlcHRUd29FZGdlcyhzZWxmKQoKICAgIGRlZiBzZXRUd29DdXRzVmFsaWQoc2VsZiwgdHdvX2N1dHNfdmFsaWQpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQ3V0U3BhY2luZ1J1bGVfc2V0VHdvQ3V0c1ZhbGlkKHNlbGYsIHR3b19jdXRzX3ZhbGlkKQoKICAgIGRlZiBpc1R3b0N1dHNWYWxpZChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckN1dFNwYWNpbmdSdWxlX2lzVHdvQ3V0c1ZhbGlkKHNlbGYpCgogICAgZGVmIHNldFNhbWVDdXQoc2VsZiwgc2FtZV9jdXQpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQ3V0U3BhY2luZ1J1bGVfc2V0U2FtZUN1dChzZWxmLCBzYW1lX2N1dCkKCiAgICBkZWYgaXNTYW1lQ3V0KHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQ3V0U3BhY2luZ1J1bGVfaXNTYW1lQ3V0KHNlbGYpCgogICAgZGVmIHNldExvbmdFZGdlT25seShzZWxmLCBsb25nX2VkZ2Vfb25seSk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJDdXRTcGFjaW5nUnVsZV9zZXRMb25nRWRnZU9ubHkoc2VsZiwgbG9uZ19lZGdlX29ubHkpCgogICAgZGVmIGlzTG9uZ0VkZ2VPbmx5KHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQ3V0U3BhY2luZ1J1bGVfaXNMb25nRWRnZU9ubHkoc2VsZikKCiAgICBkZWYgc2V0UHJsVmFsaWQoc2VsZiwgcHJsX3ZhbGlkKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckN1dFNwYWNpbmdSdWxlX3NldFBybFZhbGlkKHNlbGYsIHBybF92YWxpZCkKCiAgICBkZWYgaXNQcmxWYWxpZChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckN1dFNwYWNpbmdSdWxlX2lzUHJsVmFsaWQoc2VsZikKCiAgICBkZWYgc2V0QmVsb3coc2VsZiwgYmVsb3cpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQ3V0U3BhY2luZ1J1bGVfc2V0QmVsb3coc2VsZiwgYmVsb3cpCgogICAgZGVmIGlzQmVsb3coc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJDdXRTcGFjaW5nUnVsZV9pc0JlbG93KHNlbGYpCgogICAgZGVmIHNldFBhcldpdGhpbkVuY2xvc3VyZVZhbGlkKHNlbGYsIHBhcl93aXRoaW5fZW5jbG9zdXJlX3ZhbGlkKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckN1dFNwYWNpbmdSdWxlX3NldFBhcldpdGhpbkVuY2xvc3VyZVZhbGlkKHNlbGYsIHBhcl93aXRoaW5fZW5jbG9zdXJlX3ZhbGlkKQoKICAgIGRlZiBpc1BhcldpdGhpbkVuY2xvc3VyZVZhbGlkKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQ3V0U3BhY2luZ1J1bGVfaXNQYXJXaXRoaW5FbmNsb3N1cmVWYWxpZChzZWxmKQoKICAgIGRlZiBnZXRDdXRDbGFzcyhzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckN1dFNwYWNpbmdSdWxlX2dldEN1dENsYXNzKHNlbGYpCgogICAgZGVmIGdldFNlY29uZExheWVyKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQ3V0U3BhY2luZ1J1bGVfZ2V0U2Vjb25kTGF5ZXIoc2VsZikKCiAgICBkZWYgZ2V0VGVjaExheWVyKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQ3V0U3BhY2luZ1J1bGVfZ2V0VGVjaExheWVyKHNlbGYpCgogICAgZGVmIHNldFR5cGUoc2VsZiwgX3R5cGUpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQ3V0U3BhY2luZ1J1bGVfc2V0VHlwZShzZWxmLCBfdHlwZSkKCiAgICBkZWYgZ2V0VHlwZShzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckN1dFNwYWNpbmdSdWxlX2dldFR5cGUoc2VsZikKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgZ2V0VGVjaExheWVyQ3V0U3BhY2luZ1J1bGUoaW5seSwgZGJpZCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJDdXRTcGFjaW5nUnVsZV9nZXRUZWNoTGF5ZXJDdXRTcGFjaW5nUnVsZShpbmx5LCBkYmlkKQoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBjcmVhdGUoX2xheWVyKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckN1dFNwYWNpbmdSdWxlX2NyZWF0ZShfbGF5ZXIpCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIGRlc3Ryb3kocnVsZSk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJDdXRTcGFjaW5nUnVsZV9kZXN0cm95KHJ1bGUpCgogICAgZGVmIF9faW5pdF9fKHNlbGYpOgogICAgICAgIF9vZGJfcHkuZGJUZWNoTGF5ZXJDdXRTcGFjaW5nUnVsZV9zd2lnaW5pdChzZWxmLCBfb2RiX3B5Lm5ld19kYlRlY2hMYXllckN1dFNwYWNpbmdSdWxlKCkpCiAgICBfX3N3aWdfZGVzdHJveV9fID0gX29kYl9weS5kZWxldGVfZGJUZWNoTGF5ZXJDdXRTcGFjaW5nUnVsZQoKIyBSZWdpc3RlciBkYlRlY2hMYXllckN1dFNwYWNpbmdSdWxlIGluIF9vZGJfcHk6Cl9vZGJfcHkuZGJUZWNoTGF5ZXJDdXRTcGFjaW5nUnVsZV9zd2lncmVnaXN0ZXIoZGJUZWNoTGF5ZXJDdXRTcGFjaW5nUnVsZSkKCmRlZiBkYlRlY2hMYXllckN1dFNwYWNpbmdSdWxlX2dldFRlY2hMYXllckN1dFNwYWNpbmdSdWxlKGlubHksIGRiaWQpOgogICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJDdXRTcGFjaW5nUnVsZV9nZXRUZWNoTGF5ZXJDdXRTcGFjaW5nUnVsZShpbmx5LCBkYmlkKQoKZGVmIGRiVGVjaExheWVyQ3V0U3BhY2luZ1J1bGVfY3JlYXRlKF9sYXllcik6CiAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckN1dFNwYWNpbmdSdWxlX2NyZWF0ZShfbGF5ZXIpCgpkZWYgZGJUZWNoTGF5ZXJDdXRTcGFjaW5nUnVsZV9kZXN0cm95KHJ1bGUpOgogICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJDdXRTcGFjaW5nUnVsZV9kZXN0cm95KHJ1bGUpCgpjbGFzcyBkYlRlY2hMYXllckN1dFNwYWNpbmdUYWJsZURlZlJ1bGUob2JqZWN0KToKICAgIHRoaXNvd24gPSBwcm9wZXJ0eShsYW1iZGEgeDogeC50aGlzLm93bigpLCBsYW1iZGEgeCwgdjogeC50aGlzLm93bih2KSwgZG9jPSdUaGUgbWVtYmVyc2hpcCBmbGFnJykKICAgIF9fcmVwcl9fID0gX3N3aWdfcmVwcgogICAgRklSU1QgPSBfb2RiX3B5LmRiVGVjaExheWVyQ3V0U3BhY2luZ1RhYmxlRGVmUnVsZV9GSVJTVAogICAgU0VDT05EID0gX29kYl9weS5kYlRlY2hMYXllckN1dFNwYWNpbmdUYWJsZURlZlJ1bGVfU0VDT05ECiAgICBNQVggPSBfb2RiX3B5LmRiVGVjaExheWVyQ3V0U3BhY2luZ1RhYmxlRGVmUnVsZV9NQVgKICAgIE1JTiA9IF9vZGJfcHkuZGJUZWNoTGF5ZXJDdXRTcGFjaW5nVGFibGVEZWZSdWxlX01JTgoKICAgIGRlZiBzZXREZWZhdWx0KHNlbGYsIHNwYWNpbmcpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQ3V0U3BhY2luZ1RhYmxlRGVmUnVsZV9zZXREZWZhdWx0KHNlbGYsIHNwYWNpbmcpCgogICAgZGVmIGdldERlZmF1bHQoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJDdXRTcGFjaW5nVGFibGVEZWZSdWxlX2dldERlZmF1bHQoc2VsZikKCiAgICBkZWYgc2V0U2Vjb25kTGF5ZXIoc2VsZiwgc2Vjb25kX2xheWVyKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckN1dFNwYWNpbmdUYWJsZURlZlJ1bGVfc2V0U2Vjb25kTGF5ZXIoc2VsZiwgc2Vjb25kX2xheWVyKQoKICAgIGRlZiBzZXRQcmwoc2VsZiwgcHJsKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckN1dFNwYWNpbmdUYWJsZURlZlJ1bGVfc2V0UHJsKHNlbGYsIHBybCkKCiAgICBkZWYgZ2V0UHJsKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQ3V0U3BhY2luZ1RhYmxlRGVmUnVsZV9nZXRQcmwoc2VsZikKCiAgICBkZWYgc2V0RXh0ZW5zaW9uKHNlbGYsIGV4dGVuc2lvbik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJDdXRTcGFjaW5nVGFibGVEZWZSdWxlX3NldEV4dGVuc2lvbihzZWxmLCBleHRlbnNpb24pCgogICAgZGVmIGdldEV4dGVuc2lvbihzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckN1dFNwYWNpbmdUYWJsZURlZlJ1bGVfZ2V0RXh0ZW5zaW9uKHNlbGYpCgogICAgZGVmIHNldERlZmF1bHRWYWxpZChzZWxmLCBkZWZhdWx0X3ZhbGlkKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckN1dFNwYWNpbmdUYWJsZURlZlJ1bGVfc2V0RGVmYXVsdFZhbGlkKHNlbGYsIGRlZmF1bHRfdmFsaWQpCgogICAgZGVmIGlzRGVmYXVsdFZhbGlkKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQ3V0U3BhY2luZ1RhYmxlRGVmUnVsZV9pc0RlZmF1bHRWYWxpZChzZWxmKQoKICAgIGRlZiBzZXRTYW1lTWFzayhzZWxmLCBzYW1lX21hc2spOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQ3V0U3BhY2luZ1RhYmxlRGVmUnVsZV9zZXRTYW1lTWFzayhzZWxmLCBzYW1lX21hc2spCgogICAgZGVmIGlzU2FtZU1hc2soc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJDdXRTcGFjaW5nVGFibGVEZWZSdWxlX2lzU2FtZU1hc2soc2VsZikKCiAgICBkZWYgc2V0U2FtZU5ldChzZWxmLCBzYW1lX25ldCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJDdXRTcGFjaW5nVGFibGVEZWZSdWxlX3NldFNhbWVOZXQoc2VsZiwgc2FtZV9uZXQpCgogICAgZGVmIGlzU2FtZU5ldChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckN1dFNwYWNpbmdUYWJsZURlZlJ1bGVfaXNTYW1lTmV0KHNlbGYpCgogICAgZGVmIHNldFNhbWVNZXRhbChzZWxmLCBzYW1lX21ldGFsKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckN1dFNwYWNpbmdUYWJsZURlZlJ1bGVfc2V0U2FtZU1ldGFsKHNlbGYsIHNhbWVfbWV0YWwpCgogICAgZGVmIGlzU2FtZU1ldGFsKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQ3V0U3BhY2luZ1RhYmxlRGVmUnVsZV9pc1NhbWVNZXRhbChzZWxmKQoKICAgIGRlZiBzZXRTYW1lVmlhKHNlbGYsIHNhbWVfdmlhKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckN1dFNwYWNpbmdUYWJsZURlZlJ1bGVfc2V0U2FtZVZpYShzZWxmLCBzYW1lX3ZpYSkKCiAgICBkZWYgaXNTYW1lVmlhKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQ3V0U3BhY2luZ1RhYmxlRGVmUnVsZV9pc1NhbWVWaWEoc2VsZikKCiAgICBkZWYgc2V0TGF5ZXJWYWxpZChzZWxmLCBsYXllcl92YWxpZCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJDdXRTcGFjaW5nVGFibGVEZWZSdWxlX3NldExheWVyVmFsaWQoc2VsZiwgbGF5ZXJfdmFsaWQpCgogICAgZGVmIGlzTGF5ZXJWYWxpZChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckN1dFNwYWNpbmdUYWJsZURlZlJ1bGVfaXNMYXllclZhbGlkKHNlbGYpCgogICAgZGVmIHNldE5vU3RhY2soc2VsZiwgbm9fc3RhY2spOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQ3V0U3BhY2luZ1RhYmxlRGVmUnVsZV9zZXROb1N0YWNrKHNlbGYsIG5vX3N0YWNrKQoKICAgIGRlZiBpc05vU3RhY2soc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJDdXRTcGFjaW5nVGFibGVEZWZSdWxlX2lzTm9TdGFjayhzZWxmKQoKICAgIGRlZiBzZXROb25aZXJvRW5jbG9zdXJlKHNlbGYsIG5vbl96ZXJvX2VuY2xvc3VyZSk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJDdXRTcGFjaW5nVGFibGVEZWZSdWxlX3NldE5vblplcm9FbmNsb3N1cmUoc2VsZiwgbm9uX3plcm9fZW5jbG9zdXJlKQoKICAgIGRlZiBpc05vblplcm9FbmNsb3N1cmUoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJDdXRTcGFjaW5nVGFibGVEZWZSdWxlX2lzTm9uWmVyb0VuY2xvc3VyZShzZWxmKQoKICAgIGRlZiBzZXRQcmxGb3JBbGlnbmVkQ3V0KHNlbGYsIHBybF9mb3JfYWxpZ25lZF9jdXQpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQ3V0U3BhY2luZ1RhYmxlRGVmUnVsZV9zZXRQcmxGb3JBbGlnbmVkQ3V0KHNlbGYsIHBybF9mb3JfYWxpZ25lZF9jdXQpCgogICAgZGVmIGlzUHJsRm9yQWxpZ25lZEN1dChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckN1dFNwYWNpbmdUYWJsZURlZlJ1bGVfaXNQcmxGb3JBbGlnbmVkQ3V0KHNlbGYpCgogICAgZGVmIHNldENlbnRlclRvQ2VudGVyVmFsaWQoc2VsZiwgY2VudGVyX3RvX2NlbnRlcl92YWxpZCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJDdXRTcGFjaW5nVGFibGVEZWZSdWxlX3NldENlbnRlclRvQ2VudGVyVmFsaWQoc2VsZiwgY2VudGVyX3RvX2NlbnRlcl92YWxpZCkKCiAgICBkZWYgaXNDZW50ZXJUb0NlbnRlclZhbGlkKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQ3V0U3BhY2luZ1RhYmxlRGVmUnVsZV9pc0NlbnRlclRvQ2VudGVyVmFsaWQoc2VsZikKCiAgICBkZWYgc2V0Q2VudGVyQW5kRWRnZVZhbGlkKHNlbGYsIGNlbnRlcl9hbmRfZWRnZV92YWxpZCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJDdXRTcGFjaW5nVGFibGVEZWZSdWxlX3NldENlbnRlckFuZEVkZ2VWYWxpZChzZWxmLCBjZW50ZXJfYW5kX2VkZ2VfdmFsaWQpCgogICAgZGVmIGlzQ2VudGVyQW5kRWRnZVZhbGlkKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQ3V0U3BhY2luZ1RhYmxlRGVmUnVsZV9pc0NlbnRlckFuZEVkZ2VWYWxpZChzZWxmKQoKICAgIGRlZiBzZXROb1BybChzZWxmLCBub19wcmwpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQ3V0U3BhY2luZ1RhYmxlRGVmUnVsZV9zZXROb1BybChzZWxmLCBub19wcmwpCgogICAgZGVmIGlzTm9Qcmwoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJDdXRTcGFjaW5nVGFibGVEZWZSdWxlX2lzTm9Qcmwoc2VsZikKCiAgICBkZWYgc2V0UHJsVmFsaWQoc2VsZiwgcHJsX3ZhbGlkKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckN1dFNwYWNpbmdUYWJsZURlZlJ1bGVfc2V0UHJsVmFsaWQoc2VsZiwgcHJsX3ZhbGlkKQoKICAgIGRlZiBpc1BybFZhbGlkKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQ3V0U3BhY2luZ1RhYmxlRGVmUnVsZV9pc1BybFZhbGlkKHNlbGYpCgogICAgZGVmIHNldE1heFhZKHNlbGYsIG1heF94X3kpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQ3V0U3BhY2luZ1RhYmxlRGVmUnVsZV9zZXRNYXhYWShzZWxmLCBtYXhfeF95KQoKICAgIGRlZiBpc01heFhZKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQ3V0U3BhY2luZ1RhYmxlRGVmUnVsZV9pc01heFhZKHNlbGYpCgogICAgZGVmIHNldEVuZEV4dGVuc2lvblZhbGlkKHNlbGYsIGVuZF9leHRlbnNpb25fdmFsaWQpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQ3V0U3BhY2luZ1RhYmxlRGVmUnVsZV9zZXRFbmRFeHRlbnNpb25WYWxpZChzZWxmLCBlbmRfZXh0ZW5zaW9uX3ZhbGlkKQoKICAgIGRlZiBpc0VuZEV4dGVuc2lvblZhbGlkKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQ3V0U3BhY2luZ1RhYmxlRGVmUnVsZV9pc0VuZEV4dGVuc2lvblZhbGlkKHNlbGYpCgogICAgZGVmIHNldFNpZGVFeHRlbnNpb25WYWxpZChzZWxmLCBzaWRlX2V4dGVuc2lvbl92YWxpZCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJDdXRTcGFjaW5nVGFibGVEZWZSdWxlX3NldFNpZGVFeHRlbnNpb25WYWxpZChzZWxmLCBzaWRlX2V4dGVuc2lvbl92YWxpZCkKCiAgICBkZWYgaXNTaWRlRXh0ZW5zaW9uVmFsaWQoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJDdXRTcGFjaW5nVGFibGVEZWZSdWxlX2lzU2lkZUV4dGVuc2lvblZhbGlkKHNlbGYpCgogICAgZGVmIHNldEV4YWN0QWxpZ25lZFNwYWNpbmdWYWxpZChzZWxmLCBleGFjdF9hbGlnbmVkX3NwYWNpbmdfdmFsaWQpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQ3V0U3BhY2luZ1RhYmxlRGVmUnVsZV9zZXRFeGFjdEFsaWduZWRTcGFjaW5nVmFsaWQoc2VsZiwgZXhhY3RfYWxpZ25lZF9zcGFjaW5nX3ZhbGlkKQoKICAgIGRlZiBpc0V4YWN0QWxpZ25lZFNwYWNpbmdWYWxpZChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckN1dFNwYWNpbmdUYWJsZURlZlJ1bGVfaXNFeGFjdEFsaWduZWRTcGFjaW5nVmFsaWQoc2VsZikKCiAgICBkZWYgc2V0SG9yaXpvbnRhbChzZWxmLCBob3Jpem9udGFsKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckN1dFNwYWNpbmdUYWJsZURlZlJ1bGVfc2V0SG9yaXpvbnRhbChzZWxmLCBob3Jpem9udGFsKQoKICAgIGRlZiBpc0hvcml6b250YWwoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJDdXRTcGFjaW5nVGFibGVEZWZSdWxlX2lzSG9yaXpvbnRhbChzZWxmKQoKICAgIGRlZiBzZXRQcmxIb3Jpem9udGFsKHNlbGYsIHBybF9ob3Jpem9udGFsKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckN1dFNwYWNpbmdUYWJsZURlZlJ1bGVfc2V0UHJsSG9yaXpvbnRhbChzZWxmLCBwcmxfaG9yaXpvbnRhbCkKCiAgICBkZWYgaXNQcmxIb3Jpem9udGFsKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQ3V0U3BhY2luZ1RhYmxlRGVmUnVsZV9pc1BybEhvcml6b250YWwoc2VsZikKCiAgICBkZWYgc2V0VmVydGljYWwoc2VsZiwgdmVydGljYWwpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQ3V0U3BhY2luZ1RhYmxlRGVmUnVsZV9zZXRWZXJ0aWNhbChzZWxmLCB2ZXJ0aWNhbCkKCiAgICBkZWYgaXNWZXJ0aWNhbChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckN1dFNwYWNpbmdUYWJsZURlZlJ1bGVfaXNWZXJ0aWNhbChzZWxmKQoKICAgIGRlZiBzZXRQcmxWZXJ0aWNhbChzZWxmLCBwcmxfdmVydGljYWwpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQ3V0U3BhY2luZ1RhYmxlRGVmUnVsZV9zZXRQcmxWZXJ0aWNhbChzZWxmLCBwcmxfdmVydGljYWwpCgogICAgZGVmIGlzUHJsVmVydGljYWwoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJDdXRTcGFjaW5nVGFibGVEZWZSdWxlX2lzUHJsVmVydGljYWwoc2VsZikKCiAgICBkZWYgc2V0Tm9uT3Bwb3NpdGVFbmNsb3N1cmVTcGFjaW5nVmFsaWQoc2VsZiwgbm9uX29wcG9zaXRlX2VuY2xvc3VyZV9zcGFjaW5nX3ZhbGlkKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckN1dFNwYWNpbmdUYWJsZURlZlJ1bGVfc2V0Tm9uT3Bwb3NpdGVFbmNsb3N1cmVTcGFjaW5nVmFsaWQoc2VsZiwgbm9uX29wcG9zaXRlX2VuY2xvc3VyZV9zcGFjaW5nX3ZhbGlkKQoKICAgIGRlZiBpc05vbk9wcG9zaXRlRW5jbG9zdXJlU3BhY2luZ1ZhbGlkKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQ3V0U3BhY2luZ1RhYmxlRGVmUnVsZV9pc05vbk9wcG9zaXRlRW5jbG9zdXJlU3BhY2luZ1ZhbGlkKHNlbGYpCgogICAgZGVmIHNldE9wcG9zaXRlRW5jbG9zdXJlUmVzaXplU3BhY2luZ1ZhbGlkKHNlbGYsIG9wcG9zaXRlX2VuY2xvc3VyZV9yZXNpemVfc3BhY2luZ192YWxpZCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJDdXRTcGFjaW5nVGFibGVEZWZSdWxlX3NldE9wcG9zaXRlRW5jbG9zdXJlUmVzaXplU3BhY2luZ1ZhbGlkKHNlbGYsIG9wcG9zaXRlX2VuY2xvc3VyZV9yZXNpemVfc3BhY2luZ192YWxpZCkKCiAgICBkZWYgaXNPcHBvc2l0ZUVuY2xvc3VyZVJlc2l6ZVNwYWNpbmdWYWxpZChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckN1dFNwYWNpbmdUYWJsZURlZlJ1bGVfaXNPcHBvc2l0ZUVuY2xvc3VyZVJlc2l6ZVNwYWNpbmdWYWxpZChzZWxmKQoKICAgIGRlZiBhZGRQcmxGb3JBbGlnbmVkQ3V0RW50cnkoc2VsZiwgX2Zyb20sIHRvKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckN1dFNwYWNpbmdUYWJsZURlZlJ1bGVfYWRkUHJsRm9yQWxpZ25lZEN1dEVudHJ5KHNlbGYsIF9mcm9tLCB0bykKCiAgICBkZWYgYWRkQ2VudGVyVG9DZW50ZXJFbnRyeShzZWxmLCBfZnJvbSwgdG8pOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQ3V0U3BhY2luZ1RhYmxlRGVmUnVsZV9hZGRDZW50ZXJUb0NlbnRlckVudHJ5KHNlbGYsIF9mcm9tLCB0bykKCiAgICBkZWYgYWRkQ2VudGVyQW5kRWRnZUVudHJ5KHNlbGYsIF9mcm9tLCB0byk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJDdXRTcGFjaW5nVGFibGVEZWZSdWxlX2FkZENlbnRlckFuZEVkZ2VFbnRyeShzZWxmLCBfZnJvbSwgdG8pCgogICAgZGVmIGFkZFBybEVudHJ5KHNlbGYsIF9mcm9tLCB0bywgY2NQcmwpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQ3V0U3BhY2luZ1RhYmxlRGVmUnVsZV9hZGRQcmxFbnRyeShzZWxmLCBfZnJvbSwgdG8sIGNjUHJsKQoKICAgIGRlZiBhZGRFbmRFeHRlbnNpb25FbnRyeShzZWxmLCBjbHMsIGV4dCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJDdXRTcGFjaW5nVGFibGVEZWZSdWxlX2FkZEVuZEV4dGVuc2lvbkVudHJ5KHNlbGYsIGNscywgZXh0KQoKICAgIGRlZiBhZGRTaWRlRXh0ZW5zaW9uRW50cnkoc2VsZiwgY2xzLCBleHQpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQ3V0U3BhY2luZ1RhYmxlRGVmUnVsZV9hZGRTaWRlRXh0ZW5zaW9uRW50cnkoc2VsZiwgY2xzLCBleHQpCgogICAgZGVmIGFkZEV4YWN0RWxpZ25lZEVudHJ5KHNlbGYsIGNscywgc3BhY2luZyk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJDdXRTcGFjaW5nVGFibGVEZWZSdWxlX2FkZEV4YWN0RWxpZ25lZEVudHJ5KHNlbGYsIGNscywgc3BhY2luZykKCiAgICBkZWYgYWRkTm9uT3BwRW5jU3BhY2luZ0VudHJ5KHNlbGYsIGNscywgc3BhY2luZyk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJDdXRTcGFjaW5nVGFibGVEZWZSdWxlX2FkZE5vbk9wcEVuY1NwYWNpbmdFbnRyeShzZWxmLCBjbHMsIHNwYWNpbmcpCgogICAgZGVmIGFkZE9wcEVuY1NwYWNpbmdFbnRyeShzZWxmLCBjbHMsIHJzejEsIHJzejIsIHNwYWNpbmcpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQ3V0U3BhY2luZ1RhYmxlRGVmUnVsZV9hZGRPcHBFbmNTcGFjaW5nRW50cnkoc2VsZiwgY2xzLCByc3oxLCByc3oyLCBzcGFjaW5nKQoKICAgIGRlZiBnZXRTZWNvbmRMYXllcihzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckN1dFNwYWNpbmdUYWJsZURlZlJ1bGVfZ2V0U2Vjb25kTGF5ZXIoc2VsZikKCiAgICBkZWYgaXNDZW50ZXJUb0NlbnRlcihzZWxmLCBjdXRDbGFzczEsIGN1dENsYXNzMik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJDdXRTcGFjaW5nVGFibGVEZWZSdWxlX2lzQ2VudGVyVG9DZW50ZXIoc2VsZiwgY3V0Q2xhc3MxLCBjdXRDbGFzczIpCgogICAgZGVmIGlzQ2VudGVyQW5kRWRnZShzZWxmLCBjdXRDbGFzczEsIGN1dENsYXNzMik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJDdXRTcGFjaW5nVGFibGVEZWZSdWxlX2lzQ2VudGVyQW5kRWRnZShzZWxmLCBjdXRDbGFzczEsIGN1dENsYXNzMikKCiAgICBkZWYgaXNQcmxGb3JBbGlnbmVkQ3V0Q2xhc3NlcyhzZWxmLCBjdXRDbGFzczEsIGN1dENsYXNzMik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJDdXRTcGFjaW5nVGFibGVEZWZSdWxlX2lzUHJsRm9yQWxpZ25lZEN1dENsYXNzZXMoc2VsZiwgY3V0Q2xhc3MxLCBjdXRDbGFzczIpCgogICAgZGVmIGdldFBybEVudHJ5KHNlbGYsIGN1dENsYXNzMSwgY3V0Q2xhc3MyKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckN1dFNwYWNpbmdUYWJsZURlZlJ1bGVfZ2V0UHJsRW50cnkoc2VsZiwgY3V0Q2xhc3MxLCBjdXRDbGFzczIpCgogICAgZGVmIHNldFNwYWNpbmdUYWJsZShzZWxmLCB0YWJsZSwgcm93X21hcCwgY29sX21hcCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJDdXRTcGFjaW5nVGFibGVEZWZSdWxlX3NldFNwYWNpbmdUYWJsZShzZWxmLCB0YWJsZSwgcm93X21hcCwgY29sX21hcCkKCiAgICBkZWYgZ2V0U3BhY2luZ1RhYmxlKHNlbGYsIHRhYmxlLCByb3dfbWFwLCBjb2xfbWFwKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckN1dFNwYWNpbmdUYWJsZURlZlJ1bGVfZ2V0U3BhY2luZ1RhYmxlKHNlbGYsIHRhYmxlLCByb3dfbWFwLCBjb2xfbWFwKQoKICAgIGRlZiBnZXRFeGFjdEFsaWduZWRTcGFjaW5nKHNlbGYsIGN1dENsYXNzKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckN1dFNwYWNpbmdUYWJsZURlZlJ1bGVfZ2V0RXhhY3RBbGlnbmVkU3BhY2luZyhzZWxmLCBjdXRDbGFzcykKCiAgICBkZWYgZ2V0TWF4U3BhY2luZyhzZWxmLCAqYXJncyk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJDdXRTcGFjaW5nVGFibGVEZWZSdWxlX2dldE1heFNwYWNpbmcoc2VsZiwgKmFyZ3MpCgogICAgZGVmIGdldFNwYWNpbmcoc2VsZiwgKmFyZ3MpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQ3V0U3BhY2luZ1RhYmxlRGVmUnVsZV9nZXRTcGFjaW5nKHNlbGYsICphcmdzKQoKICAgIGRlZiBnZXRUZWNoTGF5ZXIoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJDdXRTcGFjaW5nVGFibGVEZWZSdWxlX2dldFRlY2hMYXllcihzZWxmKQoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBjcmVhdGUocGFyZW50KToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckN1dFNwYWNpbmdUYWJsZURlZlJ1bGVfY3JlYXRlKHBhcmVudCkKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgZ2V0VGVjaExheWVyQ3V0U3BhY2luZ1RhYmxlRGVmU3ViUnVsZShwYXJlbnQsIGRiaWQpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQ3V0U3BhY2luZ1RhYmxlRGVmUnVsZV9nZXRUZWNoTGF5ZXJDdXRTcGFjaW5nVGFibGVEZWZTdWJSdWxlKHBhcmVudCwgZGJpZCkKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgZGVzdHJveShydWxlKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckN1dFNwYWNpbmdUYWJsZURlZlJ1bGVfZGVzdHJveShydWxlKQoKICAgIGRlZiBfX2luaXRfXyhzZWxmKToKICAgICAgICBfb2RiX3B5LmRiVGVjaExheWVyQ3V0U3BhY2luZ1RhYmxlRGVmUnVsZV9zd2lnaW5pdChzZWxmLCBfb2RiX3B5Lm5ld19kYlRlY2hMYXllckN1dFNwYWNpbmdUYWJsZURlZlJ1bGUoKSkKICAgIF9fc3dpZ19kZXN0cm95X18gPSBfb2RiX3B5LmRlbGV0ZV9kYlRlY2hMYXllckN1dFNwYWNpbmdUYWJsZURlZlJ1bGUKCiMgUmVnaXN0ZXIgZGJUZWNoTGF5ZXJDdXRTcGFjaW5nVGFibGVEZWZSdWxlIGluIF9vZGJfcHk6Cl9vZGJfcHkuZGJUZWNoTGF5ZXJDdXRTcGFjaW5nVGFibGVEZWZSdWxlX3N3aWdyZWdpc3RlcihkYlRlY2hMYXllckN1dFNwYWNpbmdUYWJsZURlZlJ1bGUpCgpkZWYgZGJUZWNoTGF5ZXJDdXRTcGFjaW5nVGFibGVEZWZSdWxlX2NyZWF0ZShwYXJlbnQpOgogICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJDdXRTcGFjaW5nVGFibGVEZWZSdWxlX2NyZWF0ZShwYXJlbnQpCgpkZWYgZGJUZWNoTGF5ZXJDdXRTcGFjaW5nVGFibGVEZWZSdWxlX2dldFRlY2hMYXllckN1dFNwYWNpbmdUYWJsZURlZlN1YlJ1bGUocGFyZW50LCBkYmlkKToKICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQ3V0U3BhY2luZ1RhYmxlRGVmUnVsZV9nZXRUZWNoTGF5ZXJDdXRTcGFjaW5nVGFibGVEZWZTdWJSdWxlKHBhcmVudCwgZGJpZCkKCmRlZiBkYlRlY2hMYXllckN1dFNwYWNpbmdUYWJsZURlZlJ1bGVfZGVzdHJveShydWxlKToKICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQ3V0U3BhY2luZ1RhYmxlRGVmUnVsZV9kZXN0cm95KHJ1bGUpCgpjbGFzcyBkYlRlY2hMYXllckN1dFNwYWNpbmdUYWJsZU9ydGhSdWxlKG9iamVjdCk6CiAgICB0aGlzb3duID0gcHJvcGVydHkobGFtYmRhIHg6IHgudGhpcy5vd24oKSwgbGFtYmRhIHgsIHY6IHgudGhpcy5vd24odiksIGRvYz0nVGhlIG1lbWJlcnNoaXAgZmxhZycpCiAgICBfX3JlcHJfXyA9IF9zd2lnX3JlcHIKCiAgICBkZWYgZ2V0U3BhY2luZ1RhYmxlKHNlbGYsIHRibCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJDdXRTcGFjaW5nVGFibGVPcnRoUnVsZV9nZXRTcGFjaW5nVGFibGUoc2VsZiwgdGJsKQoKICAgIGRlZiBzZXRTcGFjaW5nVGFibGUoc2VsZiwgdGJsKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckN1dFNwYWNpbmdUYWJsZU9ydGhSdWxlX3NldFNwYWNpbmdUYWJsZShzZWxmLCB0YmwpCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIGNyZWF0ZShwYXJlbnQpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyQ3V0U3BhY2luZ1RhYmxlT3J0aFJ1bGVfY3JlYXRlKHBhcmVudCkKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgZ2V0VGVjaExheWVyQ3V0U3BhY2luZ1RhYmxlT3J0aFN1YlJ1bGUocGFyZW50LCBkYmlkKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckN1dFNwYWNpbmdUYWJsZU9ydGhSdWxlX2dldFRlY2hMYXllckN1dFNwYWNpbmdUYWJsZU9ydGhTdWJSdWxlKHBhcmVudCwgZGJpZCkKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgZGVzdHJveShydWxlKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckN1dFNwYWNpbmdUYWJsZU9ydGhSdWxlX2Rlc3Ryb3kocnVsZSkKCiAgICBkZWYgX19pbml0X18oc2VsZik6CiAgICAgICAgX29kYl9weS5kYlRlY2hMYXllckN1dFNwYWNpbmdUYWJsZU9ydGhSdWxlX3N3aWdpbml0KHNlbGYsIF9vZGJfcHkubmV3X2RiVGVjaExheWVyQ3V0U3BhY2luZ1RhYmxlT3J0aFJ1bGUoKSkKICAgIF9fc3dpZ19kZXN0cm95X18gPSBfb2RiX3B5LmRlbGV0ZV9kYlRlY2hMYXllckN1dFNwYWNpbmdUYWJsZU9ydGhSdWxlCgojIFJlZ2lzdGVyIGRiVGVjaExheWVyQ3V0U3BhY2luZ1RhYmxlT3J0aFJ1bGUgaW4gX29kYl9weToKX29kYl9weS5kYlRlY2hMYXllckN1dFNwYWNpbmdUYWJsZU9ydGhSdWxlX3N3aWdyZWdpc3RlcihkYlRlY2hMYXllckN1dFNwYWNpbmdUYWJsZU9ydGhSdWxlKQoKZGVmIGRiVGVjaExheWVyQ3V0U3BhY2luZ1RhYmxlT3J0aFJ1bGVfY3JlYXRlKHBhcmVudCk6CiAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckN1dFNwYWNpbmdUYWJsZU9ydGhSdWxlX2NyZWF0ZShwYXJlbnQpCgpkZWYgZGJUZWNoTGF5ZXJDdXRTcGFjaW5nVGFibGVPcnRoUnVsZV9nZXRUZWNoTGF5ZXJDdXRTcGFjaW5nVGFibGVPcnRoU3ViUnVsZShwYXJlbnQsIGRiaWQpOgogICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJDdXRTcGFjaW5nVGFibGVPcnRoUnVsZV9nZXRUZWNoTGF5ZXJDdXRTcGFjaW5nVGFibGVPcnRoU3ViUnVsZShwYXJlbnQsIGRiaWQpCgpkZWYgZGJUZWNoTGF5ZXJDdXRTcGFjaW5nVGFibGVPcnRoUnVsZV9kZXN0cm95KHJ1bGUpOgogICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJDdXRTcGFjaW5nVGFibGVPcnRoUnVsZV9kZXN0cm95KHJ1bGUpCgpjbGFzcyBkYlRlY2hMYXllckVvbEV4dGVuc2lvblJ1bGUob2JqZWN0KToKICAgIHRoaXNvd24gPSBwcm9wZXJ0eShsYW1iZGEgeDogeC50aGlzLm93bigpLCBsYW1iZGEgeCwgdjogeC50aGlzLm93bih2KSwgZG9jPSdUaGUgbWVtYmVyc2hpcCBmbGFnJykKICAgIF9fcmVwcl9fID0gX3N3aWdfcmVwcgoKICAgIGRlZiBzZXRTcGFjaW5nKHNlbGYsIHNwYWNpbmcpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyRW9sRXh0ZW5zaW9uUnVsZV9zZXRTcGFjaW5nKHNlbGYsIHNwYWNpbmcpCgogICAgZGVmIGdldFNwYWNpbmcoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJFb2xFeHRlbnNpb25SdWxlX2dldFNwYWNpbmcoc2VsZikKCiAgICBkZWYgZ2V0RXh0ZW5zaW9uVGFibGUoc2VsZiwgdGJsKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckVvbEV4dGVuc2lvblJ1bGVfZ2V0RXh0ZW5zaW9uVGFibGUoc2VsZiwgdGJsKQoKICAgIGRlZiBzZXRQYXJhbGxlbE9ubHkoc2VsZiwgcGFyYWxsZWxfb25seSk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJFb2xFeHRlbnNpb25SdWxlX3NldFBhcmFsbGVsT25seShzZWxmLCBwYXJhbGxlbF9vbmx5KQoKICAgIGRlZiBpc1BhcmFsbGVsT25seShzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckVvbEV4dGVuc2lvblJ1bGVfaXNQYXJhbGxlbE9ubHkoc2VsZikKCiAgICBkZWYgYWRkRW50cnkoc2VsZiwgZW9sLCBleHQpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyRW9sRXh0ZW5zaW9uUnVsZV9hZGRFbnRyeShzZWxmLCBlb2wsIGV4dCkKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgY3JlYXRlKGxheWVyKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckVvbEV4dGVuc2lvblJ1bGVfY3JlYXRlKGxheWVyKQoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBnZXRUZWNoTGF5ZXJFb2xFeHRlbnNpb25SdWxlKGlubHksIGRiaWQpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyRW9sRXh0ZW5zaW9uUnVsZV9nZXRUZWNoTGF5ZXJFb2xFeHRlbnNpb25SdWxlKGlubHksIGRiaWQpCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIGRlc3Ryb3kocnVsZSk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJFb2xFeHRlbnNpb25SdWxlX2Rlc3Ryb3kocnVsZSkKCiAgICBkZWYgX19pbml0X18oc2VsZik6CiAgICAgICAgX29kYl9weS5kYlRlY2hMYXllckVvbEV4dGVuc2lvblJ1bGVfc3dpZ2luaXQoc2VsZiwgX29kYl9weS5uZXdfZGJUZWNoTGF5ZXJFb2xFeHRlbnNpb25SdWxlKCkpCiAgICBfX3N3aWdfZGVzdHJveV9fID0gX29kYl9weS5kZWxldGVfZGJUZWNoTGF5ZXJFb2xFeHRlbnNpb25SdWxlCgojIFJlZ2lzdGVyIGRiVGVjaExheWVyRW9sRXh0ZW5zaW9uUnVsZSBpbiBfb2RiX3B5Ogpfb2RiX3B5LmRiVGVjaExheWVyRW9sRXh0ZW5zaW9uUnVsZV9zd2lncmVnaXN0ZXIoZGJUZWNoTGF5ZXJFb2xFeHRlbnNpb25SdWxlKQoKZGVmIGRiVGVjaExheWVyRW9sRXh0ZW5zaW9uUnVsZV9jcmVhdGUobGF5ZXIpOgogICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJFb2xFeHRlbnNpb25SdWxlX2NyZWF0ZShsYXllcikKCmRlZiBkYlRlY2hMYXllckVvbEV4dGVuc2lvblJ1bGVfZ2V0VGVjaExheWVyRW9sRXh0ZW5zaW9uUnVsZShpbmx5LCBkYmlkKToKICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyRW9sRXh0ZW5zaW9uUnVsZV9nZXRUZWNoTGF5ZXJFb2xFeHRlbnNpb25SdWxlKGlubHksIGRiaWQpCgpkZWYgZGJUZWNoTGF5ZXJFb2xFeHRlbnNpb25SdWxlX2Rlc3Ryb3kocnVsZSk6CiAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckVvbEV4dGVuc2lvblJ1bGVfZGVzdHJveShydWxlKQoKY2xhc3MgZGJUZWNoTGF5ZXJFb2xLZWVwT3V0UnVsZShvYmplY3QpOgogICAgdGhpc293biA9IHByb3BlcnR5KGxhbWJkYSB4OiB4LnRoaXMub3duKCksIGxhbWJkYSB4LCB2OiB4LnRoaXMub3duKHYpLCBkb2M9J1RoZSBtZW1iZXJzaGlwIGZsYWcnKQogICAgX19yZXByX18gPSBfc3dpZ19yZXByCgogICAgZGVmIHNldEVvbFdpZHRoKHNlbGYsIGVvbF93aWR0aCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJFb2xLZWVwT3V0UnVsZV9zZXRFb2xXaWR0aChzZWxmLCBlb2xfd2lkdGgpCgogICAgZGVmIGdldEVvbFdpZHRoKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyRW9sS2VlcE91dFJ1bGVfZ2V0RW9sV2lkdGgoc2VsZikKCiAgICBkZWYgc2V0QmFja3dhcmRFeHQoc2VsZiwgYmFja3dhcmRfZXh0KToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckVvbEtlZXBPdXRSdWxlX3NldEJhY2t3YXJkRXh0KHNlbGYsIGJhY2t3YXJkX2V4dCkKCiAgICBkZWYgZ2V0QmFja3dhcmRFeHQoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJFb2xLZWVwT3V0UnVsZV9nZXRCYWNrd2FyZEV4dChzZWxmKQoKICAgIGRlZiBzZXRGb3J3YXJkRXh0KHNlbGYsIGZvcndhcmRfZXh0KToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckVvbEtlZXBPdXRSdWxlX3NldEZvcndhcmRFeHQoc2VsZiwgZm9yd2FyZF9leHQpCgogICAgZGVmIGdldEZvcndhcmRFeHQoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJFb2xLZWVwT3V0UnVsZV9nZXRGb3J3YXJkRXh0KHNlbGYpCgogICAgZGVmIHNldFNpZGVFeHQoc2VsZiwgc2lkZV9leHQpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyRW9sS2VlcE91dFJ1bGVfc2V0U2lkZUV4dChzZWxmLCBzaWRlX2V4dCkKCiAgICBkZWYgZ2V0U2lkZUV4dChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckVvbEtlZXBPdXRSdWxlX2dldFNpZGVFeHQoc2VsZikKCiAgICBkZWYgc2V0V2l0aGluTG93KHNlbGYsIHdpdGhpbl9sb3cpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyRW9sS2VlcE91dFJ1bGVfc2V0V2l0aGluTG93KHNlbGYsIHdpdGhpbl9sb3cpCgogICAgZGVmIGdldFdpdGhpbkxvdyhzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckVvbEtlZXBPdXRSdWxlX2dldFdpdGhpbkxvdyhzZWxmKQoKICAgIGRlZiBzZXRXaXRoaW5IaWdoKHNlbGYsIHdpdGhpbl9oaWdoKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckVvbEtlZXBPdXRSdWxlX3NldFdpdGhpbkhpZ2goc2VsZiwgd2l0aGluX2hpZ2gpCgogICAgZGVmIGdldFdpdGhpbkhpZ2goc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJFb2xLZWVwT3V0UnVsZV9nZXRXaXRoaW5IaWdoKHNlbGYpCgogICAgZGVmIHNldENsYXNzTmFtZShzZWxmLCBjbGFzc19uYW1lKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckVvbEtlZXBPdXRSdWxlX3NldENsYXNzTmFtZShzZWxmLCBjbGFzc19uYW1lKQoKICAgIGRlZiBnZXRDbGFzc05hbWUoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJFb2xLZWVwT3V0UnVsZV9nZXRDbGFzc05hbWUoc2VsZikKCiAgICBkZWYgc2V0Q2xhc3NWYWxpZChzZWxmLCBjbGFzc192YWxpZCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJFb2xLZWVwT3V0UnVsZV9zZXRDbGFzc1ZhbGlkKHNlbGYsIGNsYXNzX3ZhbGlkKQoKICAgIGRlZiBpc0NsYXNzVmFsaWQoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJFb2xLZWVwT3V0UnVsZV9pc0NsYXNzVmFsaWQoc2VsZikKCiAgICBkZWYgc2V0Q29ybmVyT25seShzZWxmLCBjb3JuZXJfb25seSk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJFb2xLZWVwT3V0UnVsZV9zZXRDb3JuZXJPbmx5KHNlbGYsIGNvcm5lcl9vbmx5KQoKICAgIGRlZiBpc0Nvcm5lck9ubHkoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJFb2xLZWVwT3V0UnVsZV9pc0Nvcm5lck9ubHkoc2VsZikKCiAgICBkZWYgc2V0RXhjZXB0V2l0aGluKHNlbGYsIGV4Y2VwdF93aXRoaW4pOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyRW9sS2VlcE91dFJ1bGVfc2V0RXhjZXB0V2l0aGluKHNlbGYsIGV4Y2VwdF93aXRoaW4pCgogICAgZGVmIGlzRXhjZXB0V2l0aGluKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyRW9sS2VlcE91dFJ1bGVfaXNFeGNlcHRXaXRoaW4oc2VsZikKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgY3JlYXRlKGxheWVyKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckVvbEtlZXBPdXRSdWxlX2NyZWF0ZShsYXllcikKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgZ2V0VGVjaExheWVyRW9sS2VlcE91dFJ1bGUoaW5seSwgZGJpZCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJFb2xLZWVwT3V0UnVsZV9nZXRUZWNoTGF5ZXJFb2xLZWVwT3V0UnVsZShpbmx5LCBkYmlkKQoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBkZXN0cm95KHJ1bGUpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyRW9sS2VlcE91dFJ1bGVfZGVzdHJveShydWxlKQoKICAgIGRlZiBfX2luaXRfXyhzZWxmKToKICAgICAgICBfb2RiX3B5LmRiVGVjaExheWVyRW9sS2VlcE91dFJ1bGVfc3dpZ2luaXQoc2VsZiwgX29kYl9weS5uZXdfZGJUZWNoTGF5ZXJFb2xLZWVwT3V0UnVsZSgpKQogICAgX19zd2lnX2Rlc3Ryb3lfXyA9IF9vZGJfcHkuZGVsZXRlX2RiVGVjaExheWVyRW9sS2VlcE91dFJ1bGUKCiMgUmVnaXN0ZXIgZGJUZWNoTGF5ZXJFb2xLZWVwT3V0UnVsZSBpbiBfb2RiX3B5Ogpfb2RiX3B5LmRiVGVjaExheWVyRW9sS2VlcE91dFJ1bGVfc3dpZ3JlZ2lzdGVyKGRiVGVjaExheWVyRW9sS2VlcE91dFJ1bGUpCgpkZWYgZGJUZWNoTGF5ZXJFb2xLZWVwT3V0UnVsZV9jcmVhdGUobGF5ZXIpOgogICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJFb2xLZWVwT3V0UnVsZV9jcmVhdGUobGF5ZXIpCgpkZWYgZGJUZWNoTGF5ZXJFb2xLZWVwT3V0UnVsZV9nZXRUZWNoTGF5ZXJFb2xLZWVwT3V0UnVsZShpbmx5LCBkYmlkKToKICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyRW9sS2VlcE91dFJ1bGVfZ2V0VGVjaExheWVyRW9sS2VlcE91dFJ1bGUoaW5seSwgZGJpZCkKCmRlZiBkYlRlY2hMYXllckVvbEtlZXBPdXRSdWxlX2Rlc3Ryb3kocnVsZSk6CiAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckVvbEtlZXBPdXRSdWxlX2Rlc3Ryb3kocnVsZSkKCmNsYXNzIGRiVGVjaExheWVyRm9yYmlkZGVuU3BhY2luZ1J1bGUob2JqZWN0KToKICAgIHRoaXNvd24gPSBwcm9wZXJ0eShsYW1iZGEgeDogeC50aGlzLm93bigpLCBsYW1iZGEgeCwgdjogeC50aGlzLm93bih2KSwgZG9jPSdUaGUgbWVtYmVyc2hpcCBmbGFnJykKICAgIF9fcmVwcl9fID0gX3N3aWdfcmVwcgoKICAgIGRlZiBzZXRGb3JiaWRkZW5TcGFjaW5nKHNlbGYsIGZvcmJpZGRlbl9zcGFjaW5nKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckZvcmJpZGRlblNwYWNpbmdSdWxlX3NldEZvcmJpZGRlblNwYWNpbmcoc2VsZiwgZm9yYmlkZGVuX3NwYWNpbmcpCgogICAgZGVmIGdldEZvcmJpZGRlblNwYWNpbmcoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJGb3JiaWRkZW5TcGFjaW5nUnVsZV9nZXRGb3JiaWRkZW5TcGFjaW5nKHNlbGYpCgogICAgZGVmIHNldFdpZHRoKHNlbGYsIHdpZHRoKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckZvcmJpZGRlblNwYWNpbmdSdWxlX3NldFdpZHRoKHNlbGYsIHdpZHRoKQoKICAgIGRlZiBnZXRXaWR0aChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckZvcmJpZGRlblNwYWNpbmdSdWxlX2dldFdpZHRoKHNlbGYpCgogICAgZGVmIHNldFdpdGhpbihzZWxmLCB3aXRoaW4pOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyRm9yYmlkZGVuU3BhY2luZ1J1bGVfc2V0V2l0aGluKHNlbGYsIHdpdGhpbikKCiAgICBkZWYgZ2V0V2l0aGluKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyRm9yYmlkZGVuU3BhY2luZ1J1bGVfZ2V0V2l0aGluKHNlbGYpCgogICAgZGVmIHNldFBybChzZWxmLCBwcmwpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyRm9yYmlkZGVuU3BhY2luZ1J1bGVfc2V0UHJsKHNlbGYsIHBybCkKCiAgICBkZWYgZ2V0UHJsKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyRm9yYmlkZGVuU3BhY2luZ1J1bGVfZ2V0UHJsKHNlbGYpCgogICAgZGVmIHNldFR3b0VkZ2VzKHNlbGYsIHR3b19lZGdlcyk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJGb3JiaWRkZW5TcGFjaW5nUnVsZV9zZXRUd29FZGdlcyhzZWxmLCB0d29fZWRnZXMpCgogICAgZGVmIGdldFR3b0VkZ2VzKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyRm9yYmlkZGVuU3BhY2luZ1J1bGVfZ2V0VHdvRWRnZXMoc2VsZikKCiAgICBkZWYgaGFzV2lkdGgoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJGb3JiaWRkZW5TcGFjaW5nUnVsZV9oYXNXaWR0aChzZWxmKQoKICAgIGRlZiBoYXNXaXRoaW4oc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJGb3JiaWRkZW5TcGFjaW5nUnVsZV9oYXNXaXRoaW4oc2VsZikKCiAgICBkZWYgaGFzUHJsKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyRm9yYmlkZGVuU3BhY2luZ1J1bGVfaGFzUHJsKHNlbGYpCgogICAgZGVmIGhhc1R3b0VkZ2VzKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyRm9yYmlkZGVuU3BhY2luZ1J1bGVfaGFzVHdvRWRnZXMoc2VsZikKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgY3JlYXRlKF9sYXllcik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJGb3JiaWRkZW5TcGFjaW5nUnVsZV9jcmVhdGUoX2xheWVyKQoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBkZXN0cm95KHJ1bGUpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyRm9yYmlkZGVuU3BhY2luZ1J1bGVfZGVzdHJveShydWxlKQoKICAgIGRlZiBfX2luaXRfXyhzZWxmKToKICAgICAgICBfb2RiX3B5LmRiVGVjaExheWVyRm9yYmlkZGVuU3BhY2luZ1J1bGVfc3dpZ2luaXQoc2VsZiwgX29kYl9weS5uZXdfZGJUZWNoTGF5ZXJGb3JiaWRkZW5TcGFjaW5nUnVsZSgpKQogICAgX19zd2lnX2Rlc3Ryb3lfXyA9IF9vZGJfcHkuZGVsZXRlX2RiVGVjaExheWVyRm9yYmlkZGVuU3BhY2luZ1J1bGUKCiMgUmVnaXN0ZXIgZGJUZWNoTGF5ZXJGb3JiaWRkZW5TcGFjaW5nUnVsZSBpbiBfb2RiX3B5Ogpfb2RiX3B5LmRiVGVjaExheWVyRm9yYmlkZGVuU3BhY2luZ1J1bGVfc3dpZ3JlZ2lzdGVyKGRiVGVjaExheWVyRm9yYmlkZGVuU3BhY2luZ1J1bGUpCgpkZWYgZGJUZWNoTGF5ZXJGb3JiaWRkZW5TcGFjaW5nUnVsZV9jcmVhdGUoX2xheWVyKToKICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyRm9yYmlkZGVuU3BhY2luZ1J1bGVfY3JlYXRlKF9sYXllcikKCmRlZiBkYlRlY2hMYXllckZvcmJpZGRlblNwYWNpbmdSdWxlX2Rlc3Ryb3kocnVsZSk6CiAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllckZvcmJpZGRlblNwYWNpbmdSdWxlX2Rlc3Ryb3kocnVsZSkKCmNsYXNzIGRiVGVjaExheWVyS2VlcE91dFpvbmVSdWxlKG9iamVjdCk6CiAgICB0aGlzb3duID0gcHJvcGVydHkobGFtYmRhIHg6IHgudGhpcy5vd24oKSwgbGFtYmRhIHgsIHY6IHgudGhpcy5vd24odiksIGRvYz0nVGhlIG1lbWJlcnNoaXAgZmxhZycpCiAgICBfX3JlcHJfXyA9IF9zd2lnX3JlcHIKCiAgICBkZWYgc2V0Rmlyc3RDdXRDbGFzcyhzZWxmLCBmaXJzdF9jdXRfY2xhc3MpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyS2VlcE91dFpvbmVSdWxlX3NldEZpcnN0Q3V0Q2xhc3Moc2VsZiwgZmlyc3RfY3V0X2NsYXNzKQoKICAgIGRlZiBnZXRGaXJzdEN1dENsYXNzKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyS2VlcE91dFpvbmVSdWxlX2dldEZpcnN0Q3V0Q2xhc3Moc2VsZikKCiAgICBkZWYgc2V0U2Vjb25kQ3V0Q2xhc3Moc2VsZiwgc2Vjb25kX2N1dF9jbGFzcyk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJLZWVwT3V0Wm9uZVJ1bGVfc2V0U2Vjb25kQ3V0Q2xhc3Moc2VsZiwgc2Vjb25kX2N1dF9jbGFzcykKCiAgICBkZWYgZ2V0U2Vjb25kQ3V0Q2xhc3Moc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJLZWVwT3V0Wm9uZVJ1bGVfZ2V0U2Vjb25kQ3V0Q2xhc3Moc2VsZikKCiAgICBkZWYgc2V0QWxpZ25lZFNwYWNpbmcoc2VsZiwgYWxpZ25lZF9zcGFjaW5nKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllcktlZXBPdXRab25lUnVsZV9zZXRBbGlnbmVkU3BhY2luZyhzZWxmLCBhbGlnbmVkX3NwYWNpbmcpCgogICAgZGVmIGdldEFsaWduZWRTcGFjaW5nKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyS2VlcE91dFpvbmVSdWxlX2dldEFsaWduZWRTcGFjaW5nKHNlbGYpCgogICAgZGVmIHNldFNpZGVFeHRlbnNpb24oc2VsZiwgc2lkZV9leHRlbnNpb24pOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyS2VlcE91dFpvbmVSdWxlX3NldFNpZGVFeHRlbnNpb24oc2VsZiwgc2lkZV9leHRlbnNpb24pCgogICAgZGVmIGdldFNpZGVFeHRlbnNpb24oc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJLZWVwT3V0Wm9uZVJ1bGVfZ2V0U2lkZUV4dGVuc2lvbihzZWxmKQoKICAgIGRlZiBzZXRGb3J3YXJkRXh0ZW5zaW9uKHNlbGYsIGZvcndhcmRfZXh0ZW5zaW9uKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllcktlZXBPdXRab25lUnVsZV9zZXRGb3J3YXJkRXh0ZW5zaW9uKHNlbGYsIGZvcndhcmRfZXh0ZW5zaW9uKQoKICAgIGRlZiBnZXRGb3J3YXJkRXh0ZW5zaW9uKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyS2VlcE91dFpvbmVSdWxlX2dldEZvcndhcmRFeHRlbnNpb24oc2VsZikKCiAgICBkZWYgc2V0RW5kU2lkZUV4dGVuc2lvbihzZWxmLCBlbmRfc2lkZV9leHRlbnNpb24pOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyS2VlcE91dFpvbmVSdWxlX3NldEVuZFNpZGVFeHRlbnNpb24oc2VsZiwgZW5kX3NpZGVfZXh0ZW5zaW9uKQoKICAgIGRlZiBnZXRFbmRTaWRlRXh0ZW5zaW9uKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyS2VlcE91dFpvbmVSdWxlX2dldEVuZFNpZGVFeHRlbnNpb24oc2VsZikKCiAgICBkZWYgc2V0RW5kRm9yd2FyZEV4dGVuc2lvbihzZWxmLCBlbmRfZm9yd2FyZF9leHRlbnNpb24pOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyS2VlcE91dFpvbmVSdWxlX3NldEVuZEZvcndhcmRFeHRlbnNpb24oc2VsZiwgZW5kX2ZvcndhcmRfZXh0ZW5zaW9uKQoKICAgIGRlZiBnZXRFbmRGb3J3YXJkRXh0ZW5zaW9uKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyS2VlcE91dFpvbmVSdWxlX2dldEVuZEZvcndhcmRFeHRlbnNpb24oc2VsZikKCiAgICBkZWYgc2V0U2lkZVNpZGVFeHRlbnNpb24oc2VsZiwgc2lkZV9zaWRlX2V4dGVuc2lvbik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJLZWVwT3V0Wm9uZVJ1bGVfc2V0U2lkZVNpZGVFeHRlbnNpb24oc2VsZiwgc2lkZV9zaWRlX2V4dGVuc2lvbikKCiAgICBkZWYgZ2V0U2lkZVNpZGVFeHRlbnNpb24oc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJLZWVwT3V0Wm9uZVJ1bGVfZ2V0U2lkZVNpZGVFeHRlbnNpb24oc2VsZikKCiAgICBkZWYgc2V0U2lkZUZvcndhcmRFeHRlbnNpb24oc2VsZiwgc2lkZV9mb3J3YXJkX2V4dGVuc2lvbik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJLZWVwT3V0Wm9uZVJ1bGVfc2V0U2lkZUZvcndhcmRFeHRlbnNpb24oc2VsZiwgc2lkZV9mb3J3YXJkX2V4dGVuc2lvbikKCiAgICBkZWYgZ2V0U2lkZUZvcndhcmRFeHRlbnNpb24oc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJLZWVwT3V0Wm9uZVJ1bGVfZ2V0U2lkZUZvcndhcmRFeHRlbnNpb24oc2VsZikKCiAgICBkZWYgc2V0U3BpcmFsRXh0ZW5zaW9uKHNlbGYsIHNwaXJhbF9leHRlbnNpb24pOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyS2VlcE91dFpvbmVSdWxlX3NldFNwaXJhbEV4dGVuc2lvbihzZWxmLCBzcGlyYWxfZXh0ZW5zaW9uKQoKICAgIGRlZiBnZXRTcGlyYWxFeHRlbnNpb24oc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJLZWVwT3V0Wm9uZVJ1bGVfZ2V0U3BpcmFsRXh0ZW5zaW9uKHNlbGYpCgogICAgZGVmIHNldFNhbWVNYXNrKHNlbGYsIHNhbWVfbWFzayk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJLZWVwT3V0Wm9uZVJ1bGVfc2V0U2FtZU1hc2soc2VsZiwgc2FtZV9tYXNrKQoKICAgIGRlZiBpc1NhbWVNYXNrKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyS2VlcE91dFpvbmVSdWxlX2lzU2FtZU1hc2soc2VsZikKCiAgICBkZWYgc2V0U2FtZU1ldGFsKHNlbGYsIHNhbWVfbWV0YWwpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyS2VlcE91dFpvbmVSdWxlX3NldFNhbWVNZXRhbChzZWxmLCBzYW1lX21ldGFsKQoKICAgIGRlZiBpc1NhbWVNZXRhbChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllcktlZXBPdXRab25lUnVsZV9pc1NhbWVNZXRhbChzZWxmKQoKICAgIGRlZiBzZXREaWZmTWV0YWwoc2VsZiwgZGlmZl9tZXRhbCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJLZWVwT3V0Wm9uZVJ1bGVfc2V0RGlmZk1ldGFsKHNlbGYsIGRpZmZfbWV0YWwpCgogICAgZGVmIGlzRGlmZk1ldGFsKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyS2VlcE91dFpvbmVSdWxlX2lzRGlmZk1ldGFsKHNlbGYpCgogICAgZGVmIHNldEV4Y2VwdEFsaWduZWRTaWRlKHNlbGYsIGV4Y2VwdF9hbGlnbmVkX3NpZGUpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyS2VlcE91dFpvbmVSdWxlX3NldEV4Y2VwdEFsaWduZWRTaWRlKHNlbGYsIGV4Y2VwdF9hbGlnbmVkX3NpZGUpCgogICAgZGVmIGlzRXhjZXB0QWxpZ25lZFNpZGUoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJLZWVwT3V0Wm9uZVJ1bGVfaXNFeGNlcHRBbGlnbmVkU2lkZShzZWxmKQoKICAgIGRlZiBzZXRFeGNlcHRBbGlnbmVkRW5kKHNlbGYsIGV4Y2VwdF9hbGlnbmVkX2VuZCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJLZWVwT3V0Wm9uZVJ1bGVfc2V0RXhjZXB0QWxpZ25lZEVuZChzZWxmLCBleGNlcHRfYWxpZ25lZF9lbmQpCgogICAgZGVmIGlzRXhjZXB0QWxpZ25lZEVuZChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllcktlZXBPdXRab25lUnVsZV9pc0V4Y2VwdEFsaWduZWRFbmQoc2VsZikKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgY3JlYXRlKF9sYXllcik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJLZWVwT3V0Wm9uZVJ1bGVfY3JlYXRlKF9sYXllcikKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgZGVzdHJveShydWxlKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllcktlZXBPdXRab25lUnVsZV9kZXN0cm95KHJ1bGUpCgogICAgZGVmIF9faW5pdF9fKHNlbGYpOgogICAgICAgIF9vZGJfcHkuZGJUZWNoTGF5ZXJLZWVwT3V0Wm9uZVJ1bGVfc3dpZ2luaXQoc2VsZiwgX29kYl9weS5uZXdfZGJUZWNoTGF5ZXJLZWVwT3V0Wm9uZVJ1bGUoKSkKICAgIF9fc3dpZ19kZXN0cm95X18gPSBfb2RiX3B5LmRlbGV0ZV9kYlRlY2hMYXllcktlZXBPdXRab25lUnVsZQoKIyBSZWdpc3RlciBkYlRlY2hMYXllcktlZXBPdXRab25lUnVsZSBpbiBfb2RiX3B5Ogpfb2RiX3B5LmRiVGVjaExheWVyS2VlcE91dFpvbmVSdWxlX3N3aWdyZWdpc3RlcihkYlRlY2hMYXllcktlZXBPdXRab25lUnVsZSkKCmRlZiBkYlRlY2hMYXllcktlZXBPdXRab25lUnVsZV9jcmVhdGUoX2xheWVyKToKICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyS2VlcE91dFpvbmVSdWxlX2NyZWF0ZShfbGF5ZXIpCgpkZWYgZGJUZWNoTGF5ZXJLZWVwT3V0Wm9uZVJ1bGVfZGVzdHJveShydWxlKToKICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyS2VlcE91dFpvbmVSdWxlX2Rlc3Ryb3kocnVsZSkKCmNsYXNzIGRiVGVjaExheWVyTWF4U3BhY2luZ1J1bGUob2JqZWN0KToKICAgIHRoaXNvd24gPSBwcm9wZXJ0eShsYW1iZGEgeDogeC50aGlzLm93bigpLCBsYW1iZGEgeCwgdjogeC50aGlzLm93bih2KSwgZG9jPSdUaGUgbWVtYmVyc2hpcCBmbGFnJykKICAgIF9fcmVwcl9fID0gX3N3aWdfcmVwcgoKICAgIGRlZiBzZXRDdXRDbGFzcyhzZWxmLCBjdXRfY2xhc3MpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyTWF4U3BhY2luZ1J1bGVfc2V0Q3V0Q2xhc3Moc2VsZiwgY3V0X2NsYXNzKQoKICAgIGRlZiBnZXRDdXRDbGFzcyhzZWxmKToKICAgICAgICByZXR1cm4gX29k",
"Yl9weS5kYlRlY2hMYXllck1heFNwYWNpbmdSdWxlX2dldEN1dENsYXNzKHNlbGYpCgogICAgZGVmIHNldE1heFNwYWNpbmcoc2VsZiwgbWF4X3NwYWNpbmcpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyTWF4U3BhY2luZ1J1bGVfc2V0TWF4U3BhY2luZyhzZWxmLCBtYXhfc3BhY2luZykKCiAgICBkZWYgZ2V0TWF4U3BhY2luZyhzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllck1heFNwYWNpbmdSdWxlX2dldE1heFNwYWNpbmcoc2VsZikKCiAgICBkZWYgaGFzQ3V0Q2xhc3Moc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJNYXhTcGFjaW5nUnVsZV9oYXNDdXRDbGFzcyhzZWxmKQoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBjcmVhdGUoX2xheWVyKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllck1heFNwYWNpbmdSdWxlX2NyZWF0ZShfbGF5ZXIpCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIGRlc3Ryb3kocnVsZSk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJNYXhTcGFjaW5nUnVsZV9kZXN0cm95KHJ1bGUpCgogICAgZGVmIF9faW5pdF9fKHNlbGYpOgogICAgICAgIF9vZGJfcHkuZGJUZWNoTGF5ZXJNYXhTcGFjaW5nUnVsZV9zd2lnaW5pdChzZWxmLCBfb2RiX3B5Lm5ld19kYlRlY2hMYXllck1heFNwYWNpbmdSdWxlKCkpCiAgICBfX3N3aWdfZGVzdHJveV9fID0gX29kYl9weS5kZWxldGVfZGJUZWNoTGF5ZXJNYXhTcGFjaW5nUnVsZQoKIyBSZWdpc3RlciBkYlRlY2hMYXllck1heFNwYWNpbmdSdWxlIGluIF9vZGJfcHk6Cl9vZGJfcHkuZGJUZWNoTGF5ZXJNYXhTcGFjaW5nUnVsZV9zd2lncmVnaXN0ZXIoZGJUZWNoTGF5ZXJNYXhTcGFjaW5nUnVsZSkKCmRlZiBkYlRlY2hMYXllck1heFNwYWNpbmdSdWxlX2NyZWF0ZShfbGF5ZXIpOgogICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJNYXhTcGFjaW5nUnVsZV9jcmVhdGUoX2xheWVyKQoKZGVmIGRiVGVjaExheWVyTWF4U3BhY2luZ1J1bGVfZGVzdHJveShydWxlKToKICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyTWF4U3BhY2luZ1J1bGVfZGVzdHJveShydWxlKQoKY2xhc3MgZGJUZWNoTGF5ZXJNaW5DdXRSdWxlKG9iamVjdCk6CiAgICB0aGlzb3duID0gcHJvcGVydHkobGFtYmRhIHg6IHgudGhpcy5vd24oKSwgbGFtYmRhIHgsIHY6IHgudGhpcy5vd24odiksIGRvYz0nVGhlIG1lbWJlcnNoaXAgZmxhZycpCiAgICBfX3JlcHJfXyA9IF9zd2lnX3JlcHIKCiAgICBkZWYgc2V0TnVtQ3V0cyhzZWxmLCBudW1fY3V0cyk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJNaW5DdXRSdWxlX3NldE51bUN1dHMoc2VsZiwgbnVtX2N1dHMpCgogICAgZGVmIGdldE51bUN1dHMoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJNaW5DdXRSdWxlX2dldE51bUN1dHMoc2VsZikKCiAgICBkZWYgZ2V0Q3V0Q2xhc3NDdXRzTWFwKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyTWluQ3V0UnVsZV9nZXRDdXRDbGFzc0N1dHNNYXAoc2VsZikKCiAgICBkZWYgc2V0V2lkdGgoc2VsZiwgd2lkdGgpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyTWluQ3V0UnVsZV9zZXRXaWR0aChzZWxmLCB3aWR0aCkKCiAgICBkZWYgZ2V0V2lkdGgoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJNaW5DdXRSdWxlX2dldFdpZHRoKHNlbGYpCgogICAgZGVmIHNldFdpdGhpbkN1dERpc3Qoc2VsZiwgd2l0aGluX2N1dF9kaXN0KToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllck1pbkN1dFJ1bGVfc2V0V2l0aGluQ3V0RGlzdChzZWxmLCB3aXRoaW5fY3V0X2Rpc3QpCgogICAgZGVmIGdldFdpdGhpbkN1dERpc3Qoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJNaW5DdXRSdWxlX2dldFdpdGhpbkN1dERpc3Qoc2VsZikKCiAgICBkZWYgc2V0TGVuZ3RoKHNlbGYsIGxlbmd0aCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJNaW5DdXRSdWxlX3NldExlbmd0aChzZWxmLCBsZW5ndGgpCgogICAgZGVmIGdldExlbmd0aChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllck1pbkN1dFJ1bGVfZ2V0TGVuZ3RoKHNlbGYpCgogICAgZGVmIHNldExlbmd0aFdpdGhpbkRpc3Qoc2VsZiwgbGVuZ3RoX3dpdGhpbl9kaXN0KToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllck1pbkN1dFJ1bGVfc2V0TGVuZ3RoV2l0aGluRGlzdChzZWxmLCBsZW5ndGhfd2l0aGluX2Rpc3QpCgogICAgZGVmIGdldExlbmd0aFdpdGhpbkRpc3Qoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJNaW5DdXRSdWxlX2dldExlbmd0aFdpdGhpbkRpc3Qoc2VsZikKCiAgICBkZWYgc2V0QXJlYShzZWxmLCBhcmVhKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllck1pbkN1dFJ1bGVfc2V0QXJlYShzZWxmLCBhcmVhKQoKICAgIGRlZiBnZXRBcmVhKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyTWluQ3V0UnVsZV9nZXRBcmVhKHNlbGYpCgogICAgZGVmIHNldEFyZWFXaXRoaW5EaXN0KHNlbGYsIGFyZWFfd2l0aGluX2Rpc3QpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyTWluQ3V0UnVsZV9zZXRBcmVhV2l0aGluRGlzdChzZWxmLCBhcmVhX3dpdGhpbl9kaXN0KQoKICAgIGRlZiBnZXRBcmVhV2l0aGluRGlzdChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllck1pbkN1dFJ1bGVfZ2V0QXJlYVdpdGhpbkRpc3Qoc2VsZikKCiAgICBkZWYgc2V0UGVyQ3V0Q2xhc3Moc2VsZiwgcGVyX2N1dF9jbGFzcyk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJNaW5DdXRSdWxlX3NldFBlckN1dENsYXNzKHNlbGYsIHBlcl9jdXRfY2xhc3MpCgogICAgZGVmIGlzUGVyQ3V0Q2xhc3Moc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJNaW5DdXRSdWxlX2lzUGVyQ3V0Q2xhc3Moc2VsZikKCiAgICBkZWYgc2V0V2l0aGluQ3V0RGlzdFZhbGlkKHNlbGYsIHdpdGhpbl9jdXRfZGlzdF92YWxpZCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJNaW5DdXRSdWxlX3NldFdpdGhpbkN1dERpc3RWYWxpZChzZWxmLCB3aXRoaW5fY3V0X2Rpc3RfdmFsaWQpCgogICAgZGVmIGlzV2l0aGluQ3V0RGlzdFZhbGlkKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyTWluQ3V0UnVsZV9pc1dpdGhpbkN1dERpc3RWYWxpZChzZWxmKQoKICAgIGRlZiBzZXRGcm9tQWJvdmUoc2VsZiwgZnJvbV9hYm92ZSk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJNaW5DdXRSdWxlX3NldEZyb21BYm92ZShzZWxmLCBmcm9tX2Fib3ZlKQoKICAgIGRlZiBpc0Zyb21BYm92ZShzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllck1pbkN1dFJ1bGVfaXNGcm9tQWJvdmUoc2VsZikKCiAgICBkZWYgc2V0RnJvbUJlbG93KHNlbGYsIGZyb21fYmVsb3cpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyTWluQ3V0UnVsZV9zZXRGcm9tQmVsb3coc2VsZiwgZnJvbV9iZWxvdykKCiAgICBkZWYgaXNGcm9tQmVsb3coc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJNaW5DdXRSdWxlX2lzRnJvbUJlbG93KHNlbGYpCgogICAgZGVmIHNldExlbmd0aFZhbGlkKHNlbGYsIGxlbmd0aF92YWxpZCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJNaW5DdXRSdWxlX3NldExlbmd0aFZhbGlkKHNlbGYsIGxlbmd0aF92YWxpZCkKCiAgICBkZWYgaXNMZW5ndGhWYWxpZChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllck1pbkN1dFJ1bGVfaXNMZW5ndGhWYWxpZChzZWxmKQoKICAgIGRlZiBzZXRBcmVhVmFsaWQoc2VsZiwgYXJlYV92YWxpZCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJNaW5DdXRSdWxlX3NldEFyZWFWYWxpZChzZWxmLCBhcmVhX3ZhbGlkKQoKICAgIGRlZiBpc0FyZWFWYWxpZChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllck1pbkN1dFJ1bGVfaXNBcmVhVmFsaWQoc2VsZikKCiAgICBkZWYgc2V0QXJlYVdpdGhpbkRpc3RWYWxpZChzZWxmLCBhcmVhX3dpdGhpbl9kaXN0X3ZhbGlkKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllck1pbkN1dFJ1bGVfc2V0QXJlYVdpdGhpbkRpc3RWYWxpZChzZWxmLCBhcmVhX3dpdGhpbl9kaXN0X3ZhbGlkKQoKICAgIGRlZiBpc0FyZWFXaXRoaW5EaXN0VmFsaWQoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJNaW5DdXRSdWxlX2lzQXJlYVdpdGhpbkRpc3RWYWxpZChzZWxmKQoKICAgIGRlZiBzZXRTYW1lTWV0YWxPdmVybGFwKHNlbGYsIHNhbWVfbWV0YWxfb3ZlcmxhcCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJNaW5DdXRSdWxlX3NldFNhbWVNZXRhbE92ZXJsYXAoc2VsZiwgc2FtZV9tZXRhbF9vdmVybGFwKQoKICAgIGRlZiBpc1NhbWVNZXRhbE92ZXJsYXAoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJNaW5DdXRSdWxlX2lzU2FtZU1ldGFsT3ZlcmxhcChzZWxmKQoKICAgIGRlZiBzZXRGdWxseUVuY2xvc2VkKHNlbGYsIGZ1bGx5X2VuY2xvc2VkKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllck1pbkN1dFJ1bGVfc2V0RnVsbHlFbmNsb3NlZChzZWxmLCBmdWxseV9lbmNsb3NlZCkKCiAgICBkZWYgaXNGdWxseUVuY2xvc2VkKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyTWluQ3V0UnVsZV9pc0Z1bGx5RW5jbG9zZWQoc2VsZikKCiAgICBkZWYgc2V0Q3V0c1BlckN1dENsYXNzKHNlbGYsIGN1dF9jbGFzcywgbnVtX2N1dHMpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyTWluQ3V0UnVsZV9zZXRDdXRzUGVyQ3V0Q2xhc3Moc2VsZiwgY3V0X2NsYXNzLCBudW1fY3V0cykKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgY3JlYXRlKGxheWVyKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllck1pbkN1dFJ1bGVfY3JlYXRlKGxheWVyKQoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBnZXRUZWNoTGF5ZXJNaW5DdXRSdWxlKGlubHksIGRiaWQpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyTWluQ3V0UnVsZV9nZXRUZWNoTGF5ZXJNaW5DdXRSdWxlKGlubHksIGRiaWQpCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIGRlc3Ryb3kocnVsZSk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJNaW5DdXRSdWxlX2Rlc3Ryb3kocnVsZSkKCiAgICBkZWYgX19pbml0X18oc2VsZik6CiAgICAgICAgX29kYl9weS5kYlRlY2hMYXllck1pbkN1dFJ1bGVfc3dpZ2luaXQoc2VsZiwgX29kYl9weS5uZXdfZGJUZWNoTGF5ZXJNaW5DdXRSdWxlKCkpCiAgICBfX3N3aWdfZGVzdHJveV9fID0gX29kYl9weS5kZWxldGVfZGJUZWNoTGF5ZXJNaW5DdXRSdWxlCgojIFJlZ2lzdGVyIGRiVGVjaExheWVyTWluQ3V0UnVsZSBpbiBfb2RiX3B5Ogpfb2RiX3B5LmRiVGVjaExheWVyTWluQ3V0UnVsZV9zd2lncmVnaXN0ZXIoZGJUZWNoTGF5ZXJNaW5DdXRSdWxlKQoKZGVmIGRiVGVjaExheWVyTWluQ3V0UnVsZV9jcmVhdGUobGF5ZXIpOgogICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJNaW5DdXRSdWxlX2NyZWF0ZShsYXllcikKCmRlZiBkYlRlY2hMYXllck1pbkN1dFJ1bGVfZ2V0VGVjaExheWVyTWluQ3V0UnVsZShpbmx5LCBkYmlkKToKICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyTWluQ3V0UnVsZV9nZXRUZWNoTGF5ZXJNaW5DdXRSdWxlKGlubHksIGRiaWQpCgpkZWYgZGJUZWNoTGF5ZXJNaW5DdXRSdWxlX2Rlc3Ryb3kocnVsZSk6CiAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllck1pbkN1dFJ1bGVfZGVzdHJveShydWxlKQoKY2xhc3MgZGJUZWNoTGF5ZXJNaW5TdGVwUnVsZShvYmplY3QpOgogICAgdGhpc293biA9IHByb3BlcnR5KGxhbWJkYSB4OiB4LnRoaXMub3duKCksIGxhbWJkYSB4LCB2OiB4LnRoaXMub3duKHYpLCBkb2M9J1RoZSBtZW1iZXJzaGlwIGZsYWcnKQogICAgX19yZXByX18gPSBfc3dpZ19yZXByCgogICAgZGVmIHNldE1pblN0ZXBMZW5ndGgoc2VsZiwgbWluX3N0ZXBfbGVuZ3RoKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllck1pblN0ZXBSdWxlX3NldE1pblN0ZXBMZW5ndGgoc2VsZiwgbWluX3N0ZXBfbGVuZ3RoKQoKICAgIGRlZiBnZXRNaW5TdGVwTGVuZ3RoKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyTWluU3RlcFJ1bGVfZ2V0TWluU3RlcExlbmd0aChzZWxmKQoKICAgIGRlZiBzZXRNYXhFZGdlcyhzZWxmLCBtYXhfZWRnZXMpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyTWluU3RlcFJ1bGVfc2V0TWF4RWRnZXMoc2VsZiwgbWF4X2VkZ2VzKQoKICAgIGRlZiBnZXRNYXhFZGdlcyhzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllck1pblN0ZXBSdWxlX2dldE1heEVkZ2VzKHNlbGYpCgogICAgZGVmIHNldE1pbkFkakxlbmd0aDEoc2VsZiwgbWluX2Fkal9sZW5ndGgxKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllck1pblN0ZXBSdWxlX3NldE1pbkFkakxlbmd0aDEoc2VsZiwgbWluX2Fkal9sZW5ndGgxKQoKICAgIGRlZiBnZXRNaW5BZGpMZW5ndGgxKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyTWluU3RlcFJ1bGVfZ2V0TWluQWRqTGVuZ3RoMShzZWxmKQoKICAgIGRlZiBzZXRNaW5BZGpMZW5ndGgyKHNlbGYsIG1pbl9hZGpfbGVuZ3RoMik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJNaW5TdGVwUnVsZV9zZXRNaW5BZGpMZW5ndGgyKHNlbGYsIG1pbl9hZGpfbGVuZ3RoMikKCiAgICBkZWYgZ2V0TWluQWRqTGVuZ3RoMihzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllck1pblN0ZXBSdWxlX2dldE1pbkFkakxlbmd0aDIoc2VsZikKCiAgICBkZWYgc2V0RW9sV2lkdGgoc2VsZiwgZW9sX3dpZHRoKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllck1pblN0ZXBSdWxlX3NldEVvbFdpZHRoKHNlbGYsIGVvbF93aWR0aCkKCiAgICBkZWYgZ2V0RW9sV2lkdGgoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJNaW5TdGVwUnVsZV9nZXRFb2xXaWR0aChzZWxmKQoKICAgIGRlZiBzZXRNaW5CZXR3ZWVuTGVuZ3RoKHNlbGYsIG1pbl9iZXR3ZWVuX2xlbmd0aCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJNaW5TdGVwUnVsZV9zZXRNaW5CZXR3ZWVuTGVuZ3RoKHNlbGYsIG1pbl9iZXR3ZWVuX2xlbmd0aCkKCiAgICBkZWYgZ2V0TWluQmV0d2Vlbkxlbmd0aChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllck1pblN0ZXBSdWxlX2dldE1pbkJldHdlZW5MZW5ndGgoc2VsZikKCiAgICBkZWYgc2V0TWF4RWRnZXNWYWxpZChzZWxmLCBtYXhfZWRnZXNfdmFsaWQpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyTWluU3RlcFJ1bGVfc2V0TWF4RWRnZXNWYWxpZChzZWxmLCBtYXhfZWRnZXNfdmFsaWQpCgogICAgZGVmIGlzTWF4RWRnZXNWYWxpZChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllck1pblN0ZXBSdWxlX2lzTWF4RWRnZXNWYWxpZChzZWxmKQoKICAgIGRlZiBzZXRNaW5BZGpMZW5ndGgxVmFsaWQoc2VsZiwgbWluX2Fkal9sZW5ndGgxX3ZhbGlkKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllck1pblN0ZXBSdWxlX3NldE1pbkFkakxlbmd0aDFWYWxpZChzZWxmLCBtaW5fYWRqX2xlbmd0aDFfdmFsaWQpCgogICAgZGVmIGlzTWluQWRqTGVuZ3RoMVZhbGlkKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyTWluU3RlcFJ1bGVfaXNNaW5BZGpMZW5ndGgxVmFsaWQoc2VsZikKCiAgICBkZWYgc2V0Tm9CZXR3ZWVuRW9sKHNlbGYsIG5vX2JldHdlZW5fZW9sKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllck1pblN0ZXBSdWxlX3NldE5vQmV0d2VlbkVvbChzZWxmLCBub19iZXR3ZWVuX2VvbCkKCiAgICBkZWYgaXNOb0JldHdlZW5Fb2woc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJNaW5TdGVwUnVsZV9pc05vQmV0d2VlbkVvbChzZWxmKQoKICAgIGRlZiBzZXRNaW5BZGpMZW5ndGgyVmFsaWQoc2VsZiwgbWluX2Fkal9sZW5ndGgyX3ZhbGlkKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllck1pblN0ZXBSdWxlX3NldE1pbkFkakxlbmd0aDJWYWxpZChzZWxmLCBtaW5fYWRqX2xlbmd0aDJfdmFsaWQpCgogICAgZGVmIGlzTWluQWRqTGVuZ3RoMlZhbGlkKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyTWluU3RlcFJ1bGVfaXNNaW5BZGpMZW5ndGgyVmFsaWQoc2VsZikKCiAgICBkZWYgc2V0Q29udmV4Q29ybmVyKHNlbGYsIGNvbnZleF9jb3JuZXIpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyTWluU3RlcFJ1bGVfc2V0Q29udmV4Q29ybmVyKHNlbGYsIGNvbnZleF9jb3JuZXIpCgogICAgZGVmIGlzQ29udmV4Q29ybmVyKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyTWluU3RlcFJ1bGVfaXNDb252ZXhDb3JuZXIoc2VsZikKCiAgICBkZWYgc2V0TWluQmV0d2Vlbkxlbmd0aFZhbGlkKHNlbGYsIG1pbl9iZXR3ZWVuX2xlbmd0aF92YWxpZCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJNaW5TdGVwUnVsZV9zZXRNaW5CZXR3ZWVuTGVuZ3RoVmFsaWQoc2VsZiwgbWluX2JldHdlZW5fbGVuZ3RoX3ZhbGlkKQoKICAgIGRlZiBpc01pbkJldHdlZW5MZW5ndGhWYWxpZChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllck1pblN0ZXBSdWxlX2lzTWluQmV0d2Vlbkxlbmd0aFZhbGlkKHNlbGYpCgogICAgZGVmIHNldEV4Y2VwdFNhbWVDb3JuZXJzKHNlbGYsIGV4Y2VwdF9zYW1lX2Nvcm5lcnMpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyTWluU3RlcFJ1bGVfc2V0RXhjZXB0U2FtZUNvcm5lcnMoc2VsZiwgZXhjZXB0X3NhbWVfY29ybmVycykKCiAgICBkZWYgaXNFeGNlcHRTYW1lQ29ybmVycyhzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllck1pblN0ZXBSdWxlX2lzRXhjZXB0U2FtZUNvcm5lcnMoc2VsZikKCiAgICBkZWYgc2V0Q29uY2F2ZUNvcm5lcihzZWxmLCBjb25jYXZlX2Nvcm5lcik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJNaW5TdGVwUnVsZV9zZXRDb25jYXZlQ29ybmVyKHNlbGYsIGNvbmNhdmVfY29ybmVyKQoKICAgIGRlZiBpc0NvbmNhdmVDb3JuZXIoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJNaW5TdGVwUnVsZV9pc0NvbmNhdmVDb3JuZXIoc2VsZikKCiAgICBkZWYgc2V0RXhjZXB0UmVjdGFuZ2xlKHNlbGYsIGV4Y2VwdF9yZWN0YW5nbGUpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyTWluU3RlcFJ1bGVfc2V0RXhjZXB0UmVjdGFuZ2xlKHNlbGYsIGV4Y2VwdF9yZWN0YW5nbGUpCgogICAgZGVmIGlzRXhjZXB0UmVjdGFuZ2xlKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyTWluU3RlcFJ1bGVfaXNFeGNlcHRSZWN0YW5nbGUoc2VsZikKCiAgICBkZWYgc2V0Tm9BZGphY2VudEVvbChzZWxmLCBub19hZGphY2VudF9lb2wpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyTWluU3RlcFJ1bGVfc2V0Tm9BZGphY2VudEVvbChzZWxmLCBub19hZGphY2VudF9lb2wpCgogICAgZGVmIGlzTm9BZGphY2VudEVvbChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllck1pblN0ZXBSdWxlX2lzTm9BZGphY2VudEVvbChzZWxmKQoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBjcmVhdGUobGF5ZXIpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyTWluU3RlcFJ1bGVfY3JlYXRlKGxheWVyKQoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBnZXRUZWNoTGF5ZXJNaW5TdGVwUnVsZShpbmx5LCBkYmlkKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllck1pblN0ZXBSdWxlX2dldFRlY2hMYXllck1pblN0ZXBSdWxlKGlubHksIGRiaWQpCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIGRlc3Ryb3kocnVsZSk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJNaW5TdGVwUnVsZV9kZXN0cm95KHJ1bGUpCgogICAgZGVmIF9faW5pdF9fKHNlbGYpOgogICAgICAgIF9vZGJfcHkuZGJUZWNoTGF5ZXJNaW5TdGVwUnVsZV9zd2lnaW5pdChzZWxmLCBfb2RiX3B5Lm5ld19kYlRlY2hMYXllck1pblN0ZXBSdWxlKCkpCiAgICBfX3N3aWdfZGVzdHJveV9fID0gX29kYl9weS5kZWxldGVfZGJUZWNoTGF5ZXJNaW5TdGVwUnVsZQoKIyBSZWdpc3RlciBkYlRlY2hMYXllck1pblN0ZXBSdWxlIGluIF9vZGJfcHk6Cl9vZGJfcHkuZGJUZWNoTGF5ZXJNaW5TdGVwUnVsZV9zd2lncmVnaXN0ZXIoZGJUZWNoTGF5ZXJNaW5TdGVwUnVsZSkKCmRlZiBkYlRlY2hMYXllck1pblN0ZXBSdWxlX2NyZWF0ZShsYXllcik6CiAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllck1pblN0ZXBSdWxlX2NyZWF0ZShsYXllcikKCmRlZiBkYlRlY2hMYXllck1pblN0ZXBSdWxlX2dldFRlY2hMYXllck1pblN0ZXBSdWxlKGlubHksIGRiaWQpOgogICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJNaW5TdGVwUnVsZV9nZXRUZWNoTGF5ZXJNaW5TdGVwUnVsZShpbmx5LCBkYmlkKQoKZGVmIGRiVGVjaExheWVyTWluU3RlcFJ1bGVfZGVzdHJveShydWxlKToKICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyTWluU3RlcFJ1bGVfZGVzdHJveShydWxlKQoKY2xhc3MgZGJUZWNoTGF5ZXJTcGFjaW5nRW9sUnVsZShvYmplY3QpOgogICAgdGhpc293biA9IHByb3BlcnR5KGxhbWJkYSB4OiB4LnRoaXMub3duKCksIGxhbWJkYSB4LCB2OiB4LnRoaXMub3duKHYpLCBkb2M9J1RoZSBtZW1iZXJzaGlwIGZsYWcnKQogICAgX19yZXByX18gPSBfc3dpZ19yZXByCgogICAgZGVmIHNldEVvbFNwYWNlKHNlbGYsIGVvbF9zcGFjZSk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJTcGFjaW5nRW9sUnVsZV9zZXRFb2xTcGFjZShzZWxmLCBlb2xfc3BhY2UpCgogICAgZGVmIGdldEVvbFNwYWNlKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyU3BhY2luZ0VvbFJ1bGVfZ2V0RW9sU3BhY2Uoc2VsZikKCiAgICBkZWYgc2V0RW9sV2lkdGgoc2VsZiwgZW9sX3dpZHRoKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllclNwYWNpbmdFb2xSdWxlX3NldEVvbFdpZHRoKHNlbGYsIGVvbF93aWR0aCkKCiAgICBkZWYgZ2V0RW9sV2lkdGgoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJTcGFjaW5nRW9sUnVsZV9nZXRFb2xXaWR0aChzZWxmKQoKICAgIGRlZiBzZXRXcm9uZ0RpclNwYWNlKHNlbGYsIHdyb25nX2Rpcl9zcGFjZSk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJTcGFjaW5nRW9sUnVsZV9zZXRXcm9uZ0RpclNwYWNlKHNlbGYsIHdyb25nX2Rpcl9zcGFjZSkKCiAgICBkZWYgZ2V0V3JvbmdEaXJTcGFjZShzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllclNwYWNpbmdFb2xSdWxlX2dldFdyb25nRGlyU3BhY2Uoc2VsZikKCiAgICBkZWYgc2V0T3Bwb3NpdGVXaWR0aChzZWxmLCBvcHBvc2l0ZV93aWR0aCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJTcGFjaW5nRW9sUnVsZV9zZXRPcHBvc2l0ZVdpZHRoKHNlbGYsIG9wcG9zaXRlX3dpZHRoKQoKICAgIGRlZiBnZXRPcHBvc2l0ZVdpZHRoKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyU3BhY2luZ0VvbFJ1bGVfZ2V0T3Bwb3NpdGVXaWR0aChzZWxmKQoKICAgIGRlZiBzZXRFb2xXaXRoaW4oc2VsZiwgZW9sX3dpdGhpbik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJTcGFjaW5nRW9sUnVsZV9zZXRFb2xXaXRoaW4oc2VsZiwgZW9sX3dpdGhpbikKCiAgICBkZWYgZ2V0RW9sV2l0aGluKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyU3BhY2luZ0VvbFJ1bGVfZ2V0RW9sV2l0aGluKHNlbGYpCgogICAgZGVmIHNldFdyb25nRGlyV2l0aGluKHNlbGYsIHdyb25nX2Rpcl93aXRoaW4pOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyU3BhY2luZ0VvbFJ1bGVfc2V0V3JvbmdEaXJXaXRoaW4oc2VsZiwgd3JvbmdfZGlyX3dpdGhpbikKCiAgICBkZWYgZ2V0V3JvbmdEaXJXaXRoaW4oc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJTcGFjaW5nRW9sUnVsZV9nZXRXcm9uZ0RpcldpdGhpbihzZWxmKQoKICAgIGRlZiBzZXRFeGFjdFdpZHRoKHNlbGYsIGV4YWN0X3dpZHRoKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllclNwYWNpbmdFb2xSdWxlX3NldEV4YWN0V2lkdGgoc2VsZiwgZXhhY3Rfd2lkdGgpCgogICAgZGVmIGdldEV4YWN0V2lkdGgoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJTcGFjaW5nRW9sUnVsZV9nZXRFeGFjdFdpZHRoKHNlbGYpCgogICAgZGVmIHNldE90aGVyV2lkdGgoc2VsZiwgb3RoZXJfd2lkdGgpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyU3BhY2luZ0VvbFJ1bGVfc2V0T3RoZXJXaWR0aChzZWxmLCBvdGhlcl93aWR0aCkKCiAgICBkZWYgZ2V0T3RoZXJXaWR0aChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllclNwYWNpbmdFb2xSdWxlX2dldE90aGVyV2lkdGgoc2VsZikKCiAgICBkZWYgc2V0RmlsbFRyaWFuZ2xlKHNlbGYsIGZpbGxfdHJpYW5nbGUpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyU3BhY2luZ0VvbFJ1bGVfc2V0RmlsbFRyaWFuZ2xlKHNlbGYsIGZpbGxfdHJpYW5nbGUpCgogICAgZGVmIGdldEZpbGxUcmlhbmdsZShzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllclNwYWNpbmdFb2xSdWxlX2dldEZpbGxUcmlhbmdsZShzZWxmKQoKICAgIGRlZiBzZXRDdXRDbGFzcyhzZWxmLCBjdXRfY2xhc3MpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyU3BhY2luZ0VvbFJ1bGVfc2V0Q3V0Q2xhc3Moc2VsZiwgY3V0X2NsYXNzKQoKICAgIGRlZiBnZXRDdXRDbGFzcyhzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllclNwYWNpbmdFb2xSdWxlX2dldEN1dENsYXNzKHNlbGYpCgogICAgZGVmIHNldFdpdGhDdXRTcGFjZShzZWxmLCB3aXRoX2N1dF9zcGFjZSk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJTcGFjaW5nRW9sUnVsZV9zZXRXaXRoQ3V0U3BhY2Uoc2VsZiwgd2l0aF9jdXRfc3BhY2UpCgogICAgZGVmIGdldFdpdGhDdXRTcGFjZShzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllclNwYWNpbmdFb2xSdWxlX2dldFdpdGhDdXRTcGFjZShzZWxmKQoKICAgIGRlZiBzZXRFbmNsb3N1cmVFbmRXaWR0aChzZWxmLCBlbmNsb3N1cmVfZW5kX3dpZHRoKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllclNwYWNpbmdFb2xSdWxlX3NldEVuY2xvc3VyZUVuZFdpZHRoKHNlbGYsIGVuY2xvc3VyZV9lbmRfd2lkdGgpCgogICAgZGVmIGdldEVuY2xvc3VyZUVuZFdpZHRoKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyU3BhY2luZ0VvbFJ1bGVfZ2V0RW5jbG9zdXJlRW5kV2lkdGgoc2VsZikKCiAgICBkZWYgc2V0RW5jbG9zdXJlRW5kV2l0aGluKHNlbGYsIGVuY2xvc3VyZV9lbmRfd2l0aGluKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllclNwYWNpbmdFb2xSdWxlX3NldEVuY2xvc3VyZUVuZFdpdGhpbihzZWxmLCBlbmNsb3N1cmVfZW5kX3dpdGhpbikKCiAgICBkZWYgZ2V0RW5jbG9zdXJlRW5kV2l0aGluKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyU3BhY2luZ0VvbFJ1bGVfZ2V0RW5jbG9zdXJlRW5kV2l0aGluKHNlbGYpCgogICAgZGVmIHNldEVuZFBybFNwYWNlKHNlbGYsIGVuZF9wcmxfc3BhY2UpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyU3BhY2luZ0VvbFJ1bGVfc2V0RW5kUHJsU3BhY2Uoc2VsZiwgZW5kX3BybF9zcGFjZSkKCiAgICBkZWYgZ2V0RW5kUHJsU3BhY2Uoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJTcGFjaW5nRW9sUnVsZV9nZXRFbmRQcmxTcGFjZShzZWxmKQoKICAgIGRlZiBzZXRFbmRQcmwoc2VsZiwgZW5kX3BybCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJTcGFjaW5nRW9sUnVsZV9zZXRFbmRQcmwoc2VsZiwgZW5kX3BybCkKCiAgICBkZWYgZ2V0RW5kUHJsKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyU3BhY2luZ0VvbFJ1bGVfZ2V0RW5kUHJsKHNlbGYpCgogICAgZGVmIHNldEVuZFRvRW5kU3BhY2Uoc2VsZiwgZW5kX3RvX2VuZF9zcGFjZSk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJTcGFjaW5nRW9sUnVsZV9zZXRFbmRUb0VuZFNwYWNlKHNlbGYsIGVuZF90b19lbmRfc3BhY2UpCgogICAgZGVmIGdldEVuZFRvRW5kU3BhY2Uoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJTcGFjaW5nRW9sUnVsZV9nZXRFbmRUb0VuZFNwYWNlKHNlbGYpCgogICAgZGVmIHNldE9uZUN1dFNwYWNlKHNlbGYsIG9uZV9jdXRfc3BhY2UpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyU3BhY2luZ0VvbFJ1bGVfc2V0T25lQ3V0U3BhY2Uoc2VsZiwgb25lX2N1dF9zcGFjZSkKCiAgICBkZWYgZ2V0T25lQ3V0U3BhY2Uoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJTcGFjaW5nRW9sUnVsZV9nZXRPbmVDdXRTcGFjZShzZWxmKQoKICAgIGRlZiBzZXRUd29DdXRTcGFjZShzZWxmLCB0d29fY3V0X3NwYWNlKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllclNwYWNpbmdFb2xSdWxlX3NldFR3b0N1dFNwYWNlKHNlbGYsIHR3b19jdXRfc3BhY2UpCgogICAgZGVmIGdldFR3b0N1dFNwYWNlKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyU3BhY2luZ0VvbFJ1bGVfZ2V0VHdvQ3V0U3BhY2Uoc2VsZikKCiAgICBkZWYgc2V0RXh0ZW5zaW9uKHNlbGYsIGV4dGVuc2lvbik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJTcGFjaW5nRW9sUnVsZV9zZXRFeHRlbnNpb24oc2VsZiwgZXh0ZW5zaW9uKQoKICAgIGRlZiBnZXRFeHRlbnNpb24oc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJTcGFjaW5nRW9sUnVsZV9nZXRFeHRlbnNpb24oc2VsZikKCiAgICBkZWYgc2V0V3JvbmdEaXJFeHRlbnNpb24oc2VsZiwgd3JvbmdfZGlyX2V4dGVuc2lvbik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJTcGFjaW5nRW9sUnVsZV9zZXRXcm9uZ0RpckV4dGVuc2lvbihzZWxmLCB3cm9uZ19kaXJfZXh0ZW5zaW9uKQoKICAgIGRlZiBnZXRXcm9uZ0RpckV4dGVuc2lvbihzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllclNwYWNpbmdFb2xSdWxlX2dldFdyb25nRGlyRXh0ZW5zaW9uKHNlbGYpCgogICAgZGVmIHNldE90aGVyRW5kV2lkdGgoc2VsZiwgb3RoZXJfZW5kX3dpZHRoKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllclNwYWNpbmdFb2xSdWxlX3NldE90aGVyRW5kV2lkdGgoc2VsZiwgb3RoZXJfZW5kX3dpZHRoKQoKICAgIGRlZiBnZXRPdGhlckVuZFdpZHRoKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyU3BhY2luZ0VvbFJ1bGVfZ2V0T3RoZXJFbmRXaWR0aChzZWxmKQoKICAgIGRlZiBzZXRNYXhMZW5ndGgoc2VsZiwgbWF4X2xlbmd0aCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJTcGFjaW5nRW9sUnVsZV9zZXRNYXhMZW5ndGgoc2VsZiwgbWF4X2xlbmd0aCkKCiAgICBkZWYgZ2V0TWF4TGVuZ3RoKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyU3BhY2luZ0VvbFJ1bGVfZ2V0TWF4TGVuZ3RoKHNlbGYpCgogICAgZGVmIHNldE1pbkxlbmd0aChzZWxmLCBtaW5fbGVuZ3RoKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllclNwYWNpbmdFb2xSdWxlX3NldE1pbkxlbmd0aChzZWxmLCBtaW5fbGVuZ3RoKQoKICAgIGRlZiBnZXRNaW5MZW5ndGgoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJTcGFjaW5nRW9sUnVsZV9nZXRNaW5MZW5ndGgoc2VsZikKCiAgICBkZWYgc2V0UGFyU3BhY2Uoc2VsZiwgcGFyX3NwYWNlKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllclNwYWNpbmdFb2xSdWxlX3NldFBhclNwYWNlKHNlbGYsIHBhcl9zcGFjZSkKCiAgICBkZWYgZ2V0UGFyU3BhY2Uoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJTcGFjaW5nRW9sUnVsZV9nZXRQYXJTcGFjZShzZWxmKQoKICAgIGRlZiBzZXRQYXJXaXRoaW4oc2VsZiwgcGFyX3dpdGhpbik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJTcGFjaW5nRW9sUnVsZV9zZXRQYXJXaXRoaW4oc2VsZiwgcGFyX3dpdGhpbikKCiAgICBkZWYgZ2V0UGFyV2l0aGluKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyU3BhY2luZ0VvbFJ1bGVfZ2V0UGFyV2l0aGluKHNlbGYpCgogICAgZGVmIHNldFBhclBybChzZWxmLCBwYXJfcHJsKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllclNwYWNpbmdFb2xSdWxlX3NldFBhclBybChzZWxmLCBwYXJfcHJsKQoKICAgIGRlZiBnZXRQYXJQcmwoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJTcGFjaW5nRW9sUnVsZV9nZXRQYXJQcmwoc2VsZikKCiAgICBkZWYgc2V0UGFyTWluTGVuZ3RoKHNlbGYsIHBhcl9taW5fbGVuZ3RoKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllclNwYWNpbmdFb2xSdWxlX3NldFBhck1pbkxlbmd0aChzZWxmLCBwYXJfbWluX2xlbmd0aCkKCiAgICBkZWYgZ2V0UGFyTWluTGVuZ3RoKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyU3BhY2luZ0VvbFJ1bGVfZ2V0UGFyTWluTGVuZ3RoKHNlbGYpCgogICAgZGVmIHNldEVuY2xvc2VEaXN0KHNlbGYsIGVuY2xvc2VfZGlzdCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJTcGFjaW5nRW9sUnVsZV9zZXRFbmNsb3NlRGlzdChzZWxmLCBlbmNsb3NlX2Rpc3QpCgogICAgZGVmIGdldEVuY2xvc2VEaXN0KHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyU3BhY2luZ0VvbFJ1bGVfZ2V0RW5jbG9zZURpc3Qoc2VsZikKCiAgICBkZWYgc2V0Q3V0VG9NZXRhbFNwYWNlKHNlbGYsIGN1dF90b19tZXRhbF9zcGFjZSk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJTcGFjaW5nRW9sUnVsZV9zZXRDdXRUb01ldGFsU3BhY2Uoc2VsZiwgY3V0X3RvX21ldGFsX3NwYWNlKQoKICAgIGRlZiBnZXRDdXRUb01ldGFsU3BhY2Uoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJTcGFjaW5nRW9sUnVsZV9nZXRDdXRUb01ldGFsU3BhY2Uoc2VsZikKCiAgICBkZWYgc2V0TWluQWRqTGVuZ3RoKHNlbGYsIG1pbl9hZGpfbGVuZ3RoKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllclNwYWNpbmdFb2xSdWxlX3NldE1pbkFkakxlbmd0aChzZWxmLCBtaW5fYWRqX2xlbmd0aCkKCiAgICBkZWYgZ2V0TWluQWRqTGVuZ3RoKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyU3BhY2luZ0VvbFJ1bGVfZ2V0TWluQWRqTGVuZ3RoKHNlbGYpCgogICAgZGVmIHNldE1pbkFkakxlbmd0aDEoc2VsZiwgbWluX2Fkal9sZW5ndGgxKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllclNwYWNpbmdFb2xSdWxlX3NldE1pbkFkakxlbmd0aDEoc2VsZiwgbWluX2Fkal9sZW5ndGgxKQoKICAgIGRlZiBnZXRNaW5BZGpMZW5ndGgxKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyU3BhY2luZ0VvbFJ1bGVfZ2V0TWluQWRqTGVuZ3RoMShzZWxmKQoKICAgIGRlZiBzZXRNaW5BZGpMZW5ndGgyKHNlbGYsIG1pbl9hZGpfbGVuZ3RoMik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJTcGFjaW5nRW9sUnVsZV9zZXRNaW5BZGpMZW5ndGgyKHNlbGYsIG1pbl9hZGpfbGVuZ3RoMikKCiAgICBkZWYgZ2V0TWluQWRqTGVuZ3RoMihzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllclNwYWNpbmdFb2xSdWxlX2dldE1pbkFkakxlbmd0aDIoc2VsZikKCiAgICBkZWYgc2V0Tm90Y2hMZW5ndGgoc2VsZiwgbm90Y2hfbGVuZ3RoKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllclNwYWNpbmdFb2xSdWxlX3NldE5vdGNoTGVuZ3RoKHNlbGYsIG5vdGNoX2xlbmd0aCkKCiAgICBkZWYgZ2V0Tm90Y2hMZW5ndGgoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJTcGFjaW5nRW9sUnVsZV9nZXROb3RjaExlbmd0aChzZWxmKQoKICAgIGRlZiBzZXRFeGFjdFdpZHRoVmFsaWQoc2VsZiwgZXhhY3Rfd2lkdGhfdmFsaWQpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyU3BhY2luZ0VvbFJ1bGVfc2V0RXhhY3RXaWR0aFZhbGlkKHNlbGYsIGV4YWN0X3dpZHRoX3ZhbGlkKQoKICAgIGRlZiBpc0V4YWN0V2lkdGhWYWxpZChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllclNwYWNpbmdFb2xSdWxlX2lzRXhhY3RXaWR0aFZhbGlkKHNlbGYpCgogICAgZGVmIHNldFdyb25nRGlyU3BhY2luZ1ZhbGlkKHNlbGYsIHdyb25nX2Rpcl9zcGFjaW5nX3ZhbGlkKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllclNwYWNpbmdFb2xSdWxlX3NldFdyb25nRGlyU3BhY2luZ1ZhbGlkKHNlbGYsIHdyb25nX2Rpcl9zcGFjaW5nX3ZhbGlkKQoKICAgIGRlZiBpc1dyb25nRGlyU3BhY2luZ1ZhbGlkKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyU3BhY2luZ0VvbFJ1bGVfaXNXcm9uZ0RpclNwYWNpbmdWYWxpZChzZWxmKQoKICAgIGRlZiBzZXRPcHBvc2l0ZVdpZHRoVmFsaWQoc2VsZiwgb3Bwb3NpdGVfd2lkdGhfdmFsaWQpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyU3BhY2luZ0VvbFJ1bGVfc2V0T3Bwb3NpdGVXaWR0aFZhbGlkKHNlbGYsIG9wcG9zaXRlX3dpZHRoX3ZhbGlkKQoKICAgIGRlZiBpc09wcG9zaXRlV2lkdGhWYWxpZChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllclNwYWNpbmdFb2xSdWxlX2lzT3Bwb3NpdGVXaWR0aFZhbGlkKHNlbGYpCgogICAgZGVmIHNldFdpdGhpblZhbGlkKHNlbGYsIHdpdGhpbl92YWxpZCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJTcGFjaW5nRW9sUnVsZV9zZXRXaXRoaW5WYWxpZChzZWxmLCB3aXRoaW5fdmFsaWQpCgogICAgZGVmIGlzV2l0aGluVmFsaWQoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJTcGFjaW5nRW9sUnVsZV9pc1dpdGhpblZhbGlkKHNlbGYpCgogICAgZGVmIHNldFdyb25nRGlyV2l0aGluVmFsaWQoc2VsZiwgd3JvbmdfZGlyX3dpdGhpbl92YWxpZCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJTcGFjaW5nRW9sUnVsZV9zZXRXcm9uZ0RpcldpdGhpblZhbGlkKHNlbGYsIHdyb25nX2Rpcl93aXRoaW5fdmFsaWQpCgogICAgZGVmIGlzV3JvbmdEaXJXaXRoaW5WYWxpZChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllclNwYWNpbmdFb2xSdWxlX2lzV3JvbmdEaXJXaXRoaW5WYWxpZChzZWxmKQoKICAgIGRlZiBzZXRTYW1lTWFza1ZhbGlkKHNlbGYsIHNhbWVfbWFza192YWxpZCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJTcGFjaW5nRW9sUnVsZV9zZXRTYW1lTWFza1ZhbGlkKHNlbGYsIHNhbWVfbWFza192YWxpZCkKCiAgICBkZWYgaXNTYW1lTWFza1ZhbGlkKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyU3BhY2luZ0VvbFJ1bGVfaXNTYW1lTWFza1ZhbGlkKHNlbGYpCgogICAgZGVmIHNldEV4Y2VwdEV4YWN0V2lkdGhWYWxpZChzZWxmLCBleGNlcHRfZXhhY3Rfd2lkdGhfdmFsaWQpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyU3BhY2luZ0VvbFJ1bGVfc2V0RXhjZXB0RXhhY3RXaWR0aFZhbGlkKHNlbGYsIGV4Y2VwdF9leGFjdF93aWR0aF92YWxpZCkKCiAgICBkZWYgaXNFeGNlcHRFeGFjdFdpZHRoVmFsaWQoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJTcGFjaW5nRW9sUnVsZV9pc0V4Y2VwdEV4YWN0V2lkdGhWYWxpZChzZWxmKQoKICAgIGRlZiBzZXRGaWxsQ29uY2F2ZUNvcm5lclZhbGlkKHNlbGYsIGZpbGxfY29uY2F2ZV9jb3JuZXJfdmFsaWQpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyU3BhY2luZ0VvbFJ1bGVfc2V0RmlsbENvbmNhdmVDb3JuZXJWYWxpZChzZWxmLCBmaWxsX2NvbmNhdmVfY29ybmVyX3ZhbGlkKQoKICAgIGRlZiBpc0ZpbGxDb25jYXZlQ29ybmVyVmFsaWQoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJTcGFjaW5nRW9sUnVsZV9pc0ZpbGxDb25jYXZlQ29ybmVyVmFsaWQoc2VsZikKCiAgICBkZWYgc2V0V2l0aGN1dFZhbGlkKHNlbGYsIHdpdGhjdXRfdmFsaWQpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyU3BhY2luZ0VvbFJ1bGVfc2V0V2l0aGN1dFZhbGlkKHNlbGYsIHdpdGhjdXRfdmFsaWQpCgogICAgZGVmIGlzV2l0aGN1dFZhbGlkKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyU3BhY2luZ0VvbFJ1bGVfaXNXaXRoY3V0VmFsaWQoc2VsZikKCiAgICBkZWYgc2V0Q3V0Q2xhc3NWYWxpZChzZWxmLCBjdXRfY2xhc3NfdmFsaWQpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyU3BhY2luZ0VvbFJ1bGVfc2V0Q3V0Q2xhc3NWYWxpZChzZWxmLCBjdXRfY2xhc3NfdmFsaWQpCgogICAgZGVmIGlzQ3V0Q2xhc3NWYWxpZChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllclNwYWNpbmdFb2xSdWxlX2lzQ3V0Q2xhc3NWYWxpZChzZWxmKQoKICAgIGRlZiBzZXRXaXRoQ3V0QWJvdmVWYWxpZChzZWxmLCB3aXRoX2N1dF9hYm92ZV92YWxpZCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJTcGFjaW5nRW9sUnVsZV9zZXRXaXRoQ3V0QWJvdmVWYWxpZChzZWxmLCB3aXRoX2N1dF9hYm92ZV92YWxpZCkKCiAgICBkZWYgaXNXaXRoQ3V0QWJvdmVWYWxpZChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllclNwYWNpbmdFb2xSdWxlX2lzV2l0aEN1dEFib3ZlVmFsaWQoc2VsZikKCiAgICBkZWYgc2V0RW5jbG9zdXJlRW5kVmFsaWQoc2VsZiwgZW5jbG9zdXJlX2VuZF92YWxpZCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJTcGFjaW5nRW9sUnVsZV9zZXRFbmNsb3N1cmVFbmRWYWxpZChzZWxmLCBlbmNsb3N1cmVfZW5kX3ZhbGlkKQoKICAgIGRlZiBpc0VuY2xvc3VyZUVuZFZhbGlkKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyU3BhY2luZ0VvbFJ1bGVfaXNFbmNsb3N1cmVFbmRWYWxpZChzZWxmKQoKICAgIGRlZiBzZXRFbmNsb3N1cmVFbmRXaXRoaW5WYWxpZChzZWxmLCBlbmNsb3N1cmVfZW5kX3dpdGhpbl92YWxpZCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJTcGFjaW5nRW9sUnVsZV9zZXRFbmNsb3N1cmVFbmRXaXRoaW5WYWxpZChzZWxmLCBlbmNsb3N1cmVfZW5kX3dpdGhpbl92YWxpZCkKCiAgICBkZWYgaXNFbmNsb3N1cmVFbmRXaXRoaW5WYWxpZChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllclNwYWNpbmdFb2xSdWxlX2lzRW5jbG9zdXJlRW5kV2l0aGluVmFsaWQoc2VsZikKCiAgICBkZWYgc2V0RW5kUHJsU3BhY2luZ1ZhbGlkKHNlbGYsIGVuZF9wcmxfc3BhY2luZ192YWxpZCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJTcGFjaW5nRW9sUnVsZV9zZXRFbmRQcmxTcGFjaW5nVmFsaWQoc2VsZiwgZW5kX3BybF9zcGFjaW5nX3ZhbGlkKQoKICAgIGRlZiBpc0VuZFBybFNwYWNpbmdWYWxpZChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllclNwYWNpbmdFb2xSdWxlX2lzRW5kUHJsU3BhY2luZ1ZhbGlkKHNlbGYpCgogICAgZGVmIHNldFBybFZhbGlkKHNlbGYsIHBybF92YWxpZCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJTcGFjaW5nRW9sUnVsZV9zZXRQcmxWYWxpZChzZWxmLCBwcmxfdmFsaWQpCgogICAgZGVmIGlzUHJsVmFsaWQoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJTcGFjaW5nRW9sUnVsZV9pc1BybFZhbGlkKHNlbGYpCgogICAgZGVmIHNldEVuZFRvRW5kVmFsaWQoc2VsZiwgZW5kX3RvX2VuZF92YWxpZCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJTcGFjaW5nRW9sUnVsZV9zZXRFbmRUb0VuZFZhbGlkKHNlbGYsIGVuZF90b19lbmRfdmFsaWQpCgogICAgZGVmIGlzRW5kVG9FbmRWYWxpZChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllclNwYWNpbmdFb2xSdWxlX2lzRW5kVG9FbmRWYWxpZChzZWxmKQoKICAgIGRlZiBzZXRDdXRTcGFjZXNWYWxpZChzZWxmLCBjdXRfc3BhY2VzX3ZhbGlkKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllclNwYWNpbmdFb2xSdWxlX3NldEN1dFNwYWNlc1ZhbGlkKHNlbGYsIGN1dF9zcGFjZXNfdmFsaWQpCgogICAgZGVmIGlzQ3V0U3BhY2VzVmFsaWQoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJTcGFjaW5nRW9sUnVsZV9pc0N1dFNwYWNlc1ZhbGlkKHNlbGYpCgogICAgZGVmIHNldEV4dGVuc2lvblZhbGlkKHNlbGYsIGV4dGVuc2lvbl92YWxpZCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJTcGFjaW5nRW9sUnVsZV9zZXRFeHRlbnNpb25WYWxpZChzZWxmLCBleHRlbnNpb25fdmFsaWQpCgogICAgZGVmIGlzRXh0ZW5zaW9uVmFsaWQoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJTcGFjaW5nRW9sUnVsZV9pc0V4dGVuc2lvblZhbGlkKHNlbGYpCgogICAgZGVmIHNldFdyb25nRGlyRXh0ZW5zaW9uVmFsaWQoc2VsZiwgd3JvbmdfZGlyX2V4dGVuc2lvbl92YWxpZCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJTcGFjaW5nRW9sUnVsZV9zZXRXcm9uZ0RpckV4dGVuc2lvblZhbGlkKHNlbGYsIHdyb25nX2Rpcl9leHRlbnNpb25fdmFsaWQpCgogICAgZGVmIGlzV3JvbmdEaXJFeHRlbnNpb25WYWxpZChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllclNwYWNpbmdFb2xSdWxlX2lzV3JvbmdEaXJFeHRlbnNpb25WYWxpZChzZWxmKQoKICAgIGRlZiBzZXRPdGhlckVuZFdpZHRoVmFsaWQoc2VsZiwgb3RoZXJfZW5kX3dpZHRoX3ZhbGlkKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllclNwYWNpbmdFb2xSdWxlX3NldE90aGVyRW5kV2lkdGhWYWxpZChzZWxmLCBvdGhlcl9lbmRfd2lkdGhfdmFsaWQpCgogICAgZGVmIGlzT3RoZXJFbmRXaWR0aFZhbGlkKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyU3BhY2luZ0VvbFJ1bGVfaXNPdGhlckVuZFdpZHRoVmFsaWQoc2VsZikKCiAgICBkZWYgc2V0TWF4TGVuZ3RoVmFsaWQoc2VsZiwgbWF4X2xlbmd0aF92YWxpZCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJTcGFjaW5nRW9sUnVsZV9zZXRNYXhMZW5ndGhWYWxpZChzZWxmLCBtYXhfbGVuZ3RoX3ZhbGlkKQoKICAgIGRlZiBpc01heExlbmd0aFZhbGlkKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyU3BhY2luZ0VvbFJ1bGVfaXNNYXhMZW5ndGhWYWxpZChzZWxmKQoKICAgIGRlZiBzZXRNaW5MZW5ndGhWYWxpZChzZWxmLCBtaW5fbGVuZ3RoX3ZhbGlkKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllclNwYWNpbmdFb2xSdWxlX3NldE1pbkxlbmd0aFZhbGlkKHNlbGYsIG1pbl9sZW5ndGhfdmFsaWQpCgogICAgZGVmIGlzTWluTGVuZ3RoVmFsaWQoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJTcGFjaW5nRW9sUnVsZV9pc01pbkxlbmd0aFZhbGlkKHNlbGYpCgogICAgZGVmIHNldFR3b1NpZGVzVmFsaWQoc2VsZiwgdHdvX3NpZGVzX3ZhbGlkKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllclNwYWNpbmdFb2xSdWxlX3NldFR3b1NpZGVzVmFsaWQoc2VsZiwgdHdvX3NpZGVzX3ZhbGlkKQoKICAgIGRlZiBpc1R3b1NpZGVzVmFsaWQoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJTcGFjaW5nRW9sUnVsZV9pc1R3b1NpZGVzVmFsaWQoc2VsZikKCiAgICBkZWYgc2V0RXF1YWxSZWN0V2lkdGhWYWxpZChzZWxmLCBlcXVhbF9yZWN0X3dpZHRoX3ZhbGlkKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllclNwYWNpbmdFb2xSdWxlX3NldEVxdWFsUmVjdFdpZHRoVmFsaWQoc2VsZiwgZXF1YWxfcmVjdF93aWR0aF92YWxpZCkKCiAgICBkZWYgaXNFcXVhbFJlY3RXaWR0aFZhbGlkKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyU3BhY2luZ0VvbFJ1bGVfaXNFcXVhbFJlY3RXaWR0aFZhbGlkKHNlbGYpCgogICAgZGVmIHNldFBhcmFsbGVsRWRnZVZhbGlkKHNlbGYsIHBhcmFsbGVsX2VkZ2VfdmFsaWQpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyU3BhY2luZ0VvbFJ1bGVfc2V0UGFyYWxsZWxFZGdlVmFsaWQoc2VsZiwgcGFyYWxsZWxfZWRnZV92YWxpZCkKCiAgICBkZWYgaXNQYXJhbGxlbEVkZ2VWYWxpZChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllclNwYWNpbmdFb2xSdWxlX2lzUGFyYWxsZWxFZGdlVmFsaWQoc2VsZikKCiAgICBkZWYgc2V0U3VidHJhY3RFb2xXaWR0aFZhbGlkKHNlbGYsIHN1YnRyYWN0X2VvbF93aWR0aF92YWxpZCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJTcGFjaW5nRW9sUnVsZV9zZXRTdWJ0cmFjdEVvbFdpZHRoVmFsaWQoc2VsZiwgc3VidHJhY3RfZW9sX3dpZHRoX3ZhbGlkKQoKICAgIGRlZiBpc1N1YnRyYWN0RW9sV2lkdGhWYWxpZChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllclNwYWNpbmdFb2xSdWxlX2lzU3VidHJhY3RFb2xXaWR0aFZhbGlkKHNlbGYpCgogICAgZGVmIHNldFBhclBybFZhbGlkKHNlbGYsIHBhcl9wcmxfdmFsaWQpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyU3BhY2luZ0VvbFJ1bGVfc2V0UGFyUHJsVmFsaWQoc2VsZiwgcGFyX3BybF92YWxpZCkKCiAgICBkZWYgaXNQYXJQcmxWYWxpZChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllclNwYWNpbmdFb2xSdWxlX2lzUGFyUHJsVmFsaWQoc2VsZikKCiAgICBkZWYgc2V0UGFyTWluTGVuZ3RoVmFsaWQoc2VsZiwgcGFyX21pbl9sZW5ndGhfdmFsaWQpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyU3BhY2luZ0VvbFJ1bGVfc2V0UGFyTWluTGVuZ3RoVmFsaWQoc2VsZiwgcGFyX21pbl9sZW5ndGhfdmFsaWQpCgogICAgZGVmIGlzUGFyTWluTGVuZ3RoVmFsaWQoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJTcGFjaW5nRW9sUnVsZV9pc1Bhck1pbkxlbmd0aFZhbGlkKHNlbGYpCgogICAgZGVmIHNldFR3b0VkZ2VzVmFsaWQoc2VsZiwgdHdvX2VkZ2VzX3ZhbGlkKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllclNwYWNpbmdFb2xSdWxlX3NldFR3b0VkZ2VzVmFsaWQoc2VsZiwgdHdvX2VkZ2VzX3ZhbGlkKQoKICAgIGRlZiBpc1R3b0VkZ2VzVmFsaWQoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJTcGFjaW5nRW9sUnVsZV9pc1R3b0VkZ2VzVmFsaWQoc2VsZikKCiAgICBkZWYgc2V0U2FtZU1ldGFsVmFsaWQoc2VsZiwgc2FtZV9tZXRhbF92YWxpZCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJTcGFjaW5nRW9sUnVsZV9zZXRTYW1lTWV0YWxWYWxpZChzZWxmLCBzYW1lX21ldGFsX3ZhbGlkKQoKICAgIGRlZiBpc1NhbWVNZXRhbFZhbGlkKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyU3BhY2luZ0VvbFJ1bGVfaXNTYW1lTWV0YWxWYWxpZChzZWxmKQoKICAgIGRlZiBzZXROb25Fb2xDb3JuZXJPbmx5VmFsaWQoc2VsZiwgbm9uX2VvbF9jb3JuZXJfb25seV92YWxpZCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJTcGFjaW5nRW9sUnVsZV9zZXROb25Fb2xDb3JuZXJPbmx5VmFsaWQoc2VsZiwgbm9uX2VvbF9jb3JuZXJfb25seV92YWxpZCkKCiAgICBkZWYgaXNOb25Fb2xDb3JuZXJPbmx5VmFsaWQoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJTcGFjaW5nRW9sUnVsZV9pc05vbkVvbENvcm5lck9ubHlWYWxpZChzZWxmKQoKICAgIGRlZiBzZXRQYXJhbGxlbFNhbWVNYXNrVmFsaWQoc2VsZiwgcGFyYWxsZWxfc2FtZV9tYXNrX3ZhbGlkKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllclNwYWNpbmdFb2xSdWxlX3NldFBhcmFsbGVsU2FtZU1hc2tWYWxpZChzZWxmLCBwYXJhbGxlbF9zYW1lX21hc2tfdmFsaWQpCgogICAgZGVmIGlzUGFyYWxsZWxTYW1lTWFza1ZhbGlkKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyU3BhY2luZ0VvbFJ1bGVfaXNQYXJhbGxlbFNhbWVNYXNrVmFsaWQoc2VsZikKCiAgICBkZWYgc2V0RW5jbG9zZUN1dFZhbGlkKHNlbGYsIGVuY2xvc2VfY3V0X3ZhbGlkKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllclNwYWNpbmdFb2xSdWxlX3NldEVuY2xvc2VDdXRWYWxpZChzZWxmLCBlbmNsb3NlX2N1dF92YWxpZCkKCiAgICBkZWYgaXNFbmNsb3NlQ3V0VmFsaWQoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJTcGFjaW5nRW9sUnVsZV9pc0VuY2xvc2VDdXRWYWxpZChzZWxmKQoKICAgIGRlZiBzZXRCZWxvd1ZhbGlkKHNlbGYsIGJlbG93X3ZhbGlkKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllclNwYWNpbmdFb2xSdWxlX3NldEJlbG93VmFsaWQoc2VsZiwgYmVsb3dfdmFsaWQpCgogICAgZGVmIGlzQmVsb3dWYWxpZChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllclNwYWNpbmdFb2xSdWxlX2lzQmVsb3dWYWxpZChzZWxmKQoKICAgIGRlZiBzZXRBYm92ZVZhbGlkKHNlbGYsIGFib3ZlX3ZhbGlkKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllclNwYWNpbmdFb2xSdWxlX3NldEFib3ZlVmFsaWQoc2VsZiwgYWJvdmVfdmFsaWQpCgogICAgZGVmIGlzQWJvdmVWYWxpZChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllclNwYWNpbmdFb2xSdWxlX2lzQWJvdmVWYWxpZChzZWxmKQoKICAgIGRlZiBzZXRDdXRTcGFjaW5nVmFsaWQoc2VsZiwgY3V0X3NwYWNpbmdfdmFsaWQpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyU3BhY2luZ0VvbFJ1bGVfc2V0Q3V0U3BhY2luZ1ZhbGlkKHNlbGYsIGN1dF9zcGFjaW5nX3ZhbGlkKQoKICAgIGRlZiBpc0N1dFNwYWNpbmdWYWxpZChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllclNwYWNpbmdFb2xSdWxlX2lzQ3V0U3BhY2luZ1ZhbGlkKHNlbGYpCgogICAgZGVmIHNldEFsbEN1dHNWYWxpZChzZWxmLCBhbGxfY3V0c192YWxpZCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJTcGFjaW5nRW9sUnVsZV9zZXRBbGxDdXRzVmFsaWQoc2VsZiwgYWxsX2N1dHNfdmFsaWQpCgogICAgZGVmIGlzQWxsQ3V0c1ZhbGlkKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyU3BhY2luZ0VvbFJ1bGVfaXNBbGxDdXRzVmFsaWQoc2VsZikKCiAgICBkZWYgc2V0VG9Db25jYXZlQ29ybmVyVmFsaWQoc2VsZiwgdG9fY29uY2F2ZV9jb3JuZXJfdmFsaWQpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyU3BhY2luZ0VvbFJ1bGVfc2V0VG9Db25jYXZlQ29ybmVyVmFsaWQoc2VsZiwgdG9fY29uY2F2ZV9jb3JuZXJfdmFsaWQpCgogICAgZGVmIGlzVG9Db25jYXZlQ29ybmVyVmFsaWQoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJTcGFjaW5nRW9sUnVsZV9pc1RvQ29uY2F2ZUNvcm5lclZhbGlkKHNlbGYpCgogICAgZGVmIHNldE1pbkFkamFjZW50TGVuZ3RoVmFsaWQoc2VsZiwgbWluX2FkamFjZW50X2xlbmd0aF92YWxpZCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJTcGFjaW5nRW9sUnVsZV9zZXRNaW5BZGphY2VudExlbmd0aFZhbGlkKHNlbGYsIG1pbl9hZGphY2VudF9sZW5ndGhfdmFsaWQpCgogICAgZGVmIGlzTWluQWRqYWNlbnRMZW5ndGhWYWxpZChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllclNwYWNpbmdFb2xSdWxlX2lzTWluQWRqYWNlbnRMZW5ndGhWYWxpZChzZWxmKQoKICAgIGRlZiBzZXRUd29NaW5BZGpMZW5ndGhWYWxpZChzZWxmLCB0d29fbWluX2Fkal9sZW5ndGhfdmFsaWQpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyU3BhY2luZ0VvbFJ1bGVfc2V0VHdvTWluQWRqTGVuZ3RoVmFsaWQoc2VsZiwgdHdvX21pbl9hZGpfbGVuZ3RoX3ZhbGlkKQoKICAgIGRlZiBpc1R3b01pbkFkakxlbmd0aFZhbGlkKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyU3BhY2luZ0VvbFJ1bGVfaXNUd29NaW5BZGpMZW5ndGhWYWxpZChzZWxmKQoKICAgIGRlZiBzZXRUb05vdGNoTGVuZ3RoVmFsaWQoc2VsZiwgdG9fbm90Y2hfbGVuZ3RoX3ZhbGlkKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllclNwYWNpbmdFb2xSdWxlX3NldFRvTm90Y2hMZW5ndGhWYWxpZChzZWxmLCB0b19ub3RjaF9sZW5ndGhfdmFsaWQpCgogICAgZGVmIGlzVG9Ob3RjaExlbmd0aFZhbGlkKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyU3BhY2luZ0VvbFJ1bGVfaXNUb05vdGNoTGVuZ3RoVmFsaWQoc2VsZikKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgY3JlYXRlKGxheWVyKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllclNwYWNpbmdFb2xSdWxlX2NyZWF0ZShsYXllcikKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgZ2V0VGVjaExheWVyU3BhY2luZ0VvbFJ1bGUoaW5seSwgZGJpZCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJTcGFjaW5nRW9sUnVsZV9nZXRUZWNoTGF5ZXJTcGFjaW5nRW9sUnVsZShpbmx5LCBkYmlkKQoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBkZXN0cm95KHJ1bGUpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyU3BhY2luZ0VvbFJ1bGVfZGVzdHJveShydWxlKQoKICAgIGRlZiBfX2luaXRfXyhzZWxmKToKICAgICAgICBfb2RiX3B5LmRiVGVjaExheWVyU3BhY2luZ0VvbFJ1bGVfc3dpZ2luaXQoc2VsZiwgX29kYl9weS5uZXdfZGJUZWNoTGF5ZXJTcGFjaW5nRW9sUnVsZSgpKQogICAgX19zd2lnX2Rlc3Ryb3lfXyA9IF9vZGJfcHkuZGVsZXRlX2RiVGVjaExheWVyU3BhY2luZ0VvbFJ1bGUKCiMgUmVnaXN0ZXIgZGJUZWNoTGF5ZXJTcGFjaW5nRW9sUnVsZSBpbiBfb2RiX3B5Ogpfb2RiX3B5LmRiVGVjaExheWVyU3BhY2luZ0VvbFJ1bGVfc3dpZ3JlZ2lzdGVyKGRiVGVjaExheWVyU3BhY2luZ0VvbFJ1bGUpCgpkZWYgZGJUZWNoTGF5ZXJTcGFjaW5nRW9sUnVsZV9jcmVhdGUobGF5ZXIpOgogICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJTcGFjaW5nRW9sUnVsZV9jcmVhdGUobGF5ZXIpCgpkZWYgZGJUZWNoTGF5ZXJTcGFjaW5nRW9sUnVsZV9nZXRUZWNoTGF5ZXJTcGFjaW5nRW9sUnVsZShpbmx5LCBkYmlkKToKICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyU3BhY2luZ0VvbFJ1bGVfZ2V0VGVjaExheWVyU3BhY2luZ0VvbFJ1bGUoaW5seSwgZGJpZCkKCmRlZiBkYlRlY2hMYXllclNwYWNpbmdFb2xSdWxlX2Rlc3Ryb3kocnVsZSk6CiAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllclNwYWNpbmdFb2xSdWxlX2Rlc3Ryb3kocnVsZSkKCmNsYXNzIGRiVGVjaExheWVyU3BhY2luZ1RhYmxlUHJsUnVsZShvYmplY3QpOgogICAgdGhpc293biA9IHByb3BlcnR5KGxhbWJkYSB4OiB4LnRoaXMub3duKCksIGxhbWJkYSB4LCB2OiB4LnRoaXMub3duKHYpLCBkb2M9J1RoZSBtZW1iZXJzaGlwIGZsYWcnKQogICAgX19yZXByX18gPSBfc3dpZ19yZXByCgogICAgZGVmIHNldEVvbFdpZHRoKHNlbGYsIGVvbF93aWR0aCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJTcGFjaW5nVGFibGVQcmxSdWxlX3NldEVvbFdpZHRoKHNlbGYsIGVvbF93aWR0aCkKCiAgICBkZWYgZ2V0RW9sV2lkdGgoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJTcGFjaW5nVGFibGVQcmxSdWxlX2dldEVvbFdpZHRoKHNlbGYpCgogICAgZGVmIHNldFdyb25nRGlyZWN0aW9uKHNlbGYsIHdyb25nX2RpcmVjdGlvbik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJTcGFjaW5nVGFibGVQcmxSdWxlX3NldFdyb25nRGlyZWN0aW9uKHNlbGYsIHdyb25nX2RpcmVjdGlvbikKCiAgICBkZWYgaXNXcm9uZ0RpcmVjdGlvbihzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllclNwYWNpbmdUYWJsZVBybFJ1bGVfaXNXcm9uZ0RpcmVjdGlvbihzZWxmKQoKICAgIGRlZiBzZXRTYW1lTWFzayhzZWxmLCBzYW1lX21hc2spOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyU3BhY2luZ1RhYmxlUHJsUnVsZV9zZXRTYW1lTWFzayhzZWxmLCBzYW1lX21hc2spCgogICAgZGVmIGlzU2FtZU1hc2soc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJTcGFjaW5nVGFibGVQcmxSdWxlX2lzU2FtZU1hc2soc2VsZikKCiAgICBkZWYgc2V0RXhjZWVwdEVvbChzZWxmLCBleGNlZXB0X2VvbCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJTcGFjaW5nVGFibGVQcmxSdWxlX3NldEV4Y2VlcHRFb2woc2VsZiwgZXhjZWVwdF9lb2wpCgogICAgZGVmIGlzRXhjZWVwdEVvbChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllclNwYWNpbmdUYWJsZVBybFJ1bGVfaXNFeGNlZXB0RW9sKHNlbGYpCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIGdldFRlY2hMYXllclNwYWNpbmdUYWJsZVBybFJ1bGUoaW5seSwgZGJpZCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJTcGFjaW5nVGFibGVQcmxSdWxlX2dldFRlY2hMYXllclNwYWNpbmdUYWJsZVBybFJ1bGUoaW5seSwgZGJpZCkKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgY3JlYXRlKF9sYXllcik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJTcGFjaW5nVGFibGVQcmxSdWxlX2NyZWF0ZShfbGF5ZXIpCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIGRlc3Ryb3kocnVsZSk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJTcGFjaW5nVGFibGVQcmxSdWxlX2Rlc3Ryb3kocnVsZSkKCiAgICBkZWYgc2V0VGFibGUoc2VsZiwgd2lkdGhfdGJsLCBsZW5ndGhfdGJsLCBzcGFjaW5nX3RibCwgZXhjbHVkZWRfbWFwKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllclNwYWNpbmdUYWJsZVBybFJ1bGVfc2V0VGFibGUoc2VsZiwgd2lkdGhfdGJsLCBsZW5ndGhfdGJsLCBzcGFjaW5nX3RibCwgZXhjbHVkZWRfbWFwKQoKICAgIGRlZiBnZXRUYWJsZShzZWxmLCB3aWR0aF90YmwsIGxlbmd0aF90YmwsIHNwYWNpbmdfdGJsLCBleGNsdWRlZF9tYXApOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyU3BhY2luZ1RhYmxlUHJsUnVsZV9nZXRUYWJsZShzZWxmLCB3aWR0aF90YmwsIGxlbmd0aF90YmwsIHNwYWNpbmdfdGJsLCBleGNsdWRlZF9tYXApCgogICAgZGVmIHNldFNwYWNpbmdUYWJsZUluZmx1ZW5jZShzZWxmLCBpbmZsdWVuY2VfdGJsKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllclNwYWNpbmdUYWJsZVBybFJ1bGVfc2V0U3BhY2luZ1RhYmxlSW5mbHVlbmNlKHNlbGYsIGluZmx1ZW5jZV90YmwpCgogICAgZGVmIGdldFNwYWNpbmcoc2VsZiwgd2lkdGgsIGxlbmd0aCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJTcGFjaW5nVGFibGVQcmxSdWxlX2dldFNwYWNpbmcoc2VsZiwgd2lkdGgsIGxlbmd0aCkKCiAgICBkZWYgaGFzRXhjZXB0V2l0aGluKHNlbGYsIHdpZHRoKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllclNwYWNpbmdUYWJsZVBybFJ1bGVfaGFzRXhjZXB0V2l0aGluKHNlbGYsIHdpZHRoKQoKICAgIGRlZiBnZXRFeGNlcHRXaXRoaW4oc2VsZiwgd2lkdGgpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyU3BhY2luZ1RhYmxlUHJsUnVsZV9nZXRFeGNlcHRXaXRoaW4oc2VsZiwgd2lkdGgpCgogICAgZGVmIF9faW5pdF9fKHNlbGYpOgogICAgICAgIF9vZGJfcHkuZGJUZWNoTGF5ZXJTcGFjaW5nVGFibGVQcmxSdWxlX3N3aWdpbml0KHNlbGYsIF9vZGJfcHkubmV3X2RiVGVjaExheWVyU3BhY2luZ1RhYmxlUHJsUnVsZSgpKQogICAgX19zd2lnX2Rlc3Ryb3lfXyA9IF9vZGJfcHkuZGVsZXRlX2RiVGVjaExheWVyU3BhY2luZ1RhYmxlUHJsUnVsZQoKIyBSZWdpc3RlciBkYlRlY2hMYXllclNwYWNpbmdUYWJsZVBybFJ1bGUgaW4gX29kYl9weToKX29kYl9weS5kYlRlY2hMYXllclNwYWNpbmdUYWJsZVBybFJ1bGVfc3dpZ3JlZ2lzdGVyKGRiVGVjaExheWVyU3BhY2luZ1RhYmxlUHJsUnVsZSkKCmRlZiBkYlRlY2hMYXllclNwYWNpbmdUYWJsZVBybFJ1bGVfZ2V0VGVjaExheWVyU3BhY2luZ1RhYmxlUHJsUnVsZShpbmx5LCBkYmlkKToKICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyU3BhY2luZ1RhYmxlUHJsUnVsZV9nZXRUZWNoTGF5ZXJTcGFjaW5nVGFibGVQcmxSdWxlKGlubHksIGRiaWQpCgpkZWYgZGJUZWNoTGF5ZXJTcGFjaW5nVGFibGVQcmxSdWxlX2NyZWF0ZShfbGF5ZXIpOgogICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJTcGFjaW5nVGFibGVQcmxSdWxlX2NyZWF0ZShfbGF5ZXIpCgpkZWYgZGJUZWNoTGF5ZXJTcGFjaW5nVGFibGVQcmxSdWxlX2Rlc3Ryb3kocnVsZSk6CiAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllclNwYWNpbmdUYWJsZVBybFJ1bGVfZGVzdHJveShydWxlKQoKY2xhc3MgZGJUZWNoTGF5ZXJUd29XaXJlc0ZvcmJpZGRlblNwY1J1bGUob2JqZWN0KToKICAgIHRoaXNvd24gPSBwcm9wZXJ0eShsYW1iZGEgeDogeC50aGlzLm93bigpLCBsYW1iZGEgeCwgdjogeC50aGlzLm93bih2KSwgZG9jPSdUaGUgbWVtYmVyc2hpcCBmbGFnJykKICAgIF9fcmVwcl9fID0gX3N3aWdfcmVwcgoKICAgIGRlZiBzZXRNaW5TcGFjaW5nKHNlbGYsIG1pbl9zcGFjaW5nKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllclR3b1dpcmVzRm9yYmlkZGVuU3BjUnVsZV9zZXRNaW5TcGFjaW5nKHNlbGYsIG1pbl9zcGFjaW5nKQoKICAgIGRlZiBnZXRNaW5TcGFjaW5nKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyVHdvV2lyZXNGb3JiaWRkZW5TcGNSdWxlX2dldE1pblNwYWNpbmcoc2VsZikKCiAgICBkZWYgc2V0TWF4U3BhY2luZyhzZWxmLCBtYXhfc3BhY2luZyk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJUd29XaXJlc0ZvcmJpZGRlblNwY1J1bGVfc2V0TWF4U3BhY2luZyhzZWxmLCBtYXhfc3BhY2luZykKCiAgICBkZWYgZ2V0TWF4U3BhY2luZyhzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllclR3b1dpcmVzRm9yYmlkZGVuU3BjUnVsZV9nZXRNYXhTcGFjaW5nKHNlbGYpCgogICAgZGVmIHNldE1pblNwYW5MZW5ndGgoc2VsZiwgbWluX3NwYW5fbGVuZ3RoKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllclR3b1dpcmVzRm9yYmlkZGVuU3BjUnVsZV9zZXRNaW5TcGFuTGVuZ3RoKHNlbGYsIG1pbl9zcGFuX2xlbmd0aCkKCiAgICBkZWYgZ2V0TWluU3Bhbkxlbmd0aChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllclR3b1dpcmVzRm9yYmlkZGVuU3BjUnVsZV9nZXRNaW5TcGFuTGVuZ3RoKHNlbGYpCgogICAgZGVmIHNldE1heFNwYW5MZW5ndGgoc2VsZiwgbWF4X3NwYW5fbGVuZ3RoKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllclR3b1dpcmVzRm9yYmlkZGVuU3BjUnVsZV9zZXRNYXhTcGFuTGVuZ3RoKHNlbGYsIG1heF9zcGFuX2xlbmd0aCkKCiAgICBkZWYgZ2V0TWF4U3Bhbkxlbmd0aChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllclR3b1dpcmVzRm9yYmlkZGVuU3BjUnVsZV9nZXRNYXhTcGFuTGVuZ3RoKHNlbGYpCgogICAgZGVmIHNldFBybChzZWxmLCBwcmwpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyVHdvV2lyZXNGb3JiaWRkZW5TcGNSdWxlX3NldFBybChzZWxmLCBwcmwpCgogICAgZGVmIGdldFBybChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllclR3b1dpcmVzRm9yYmlkZGVuU3BjUnVsZV9nZXRQcmwoc2VsZikKCiAgICBkZWYgc2V0TWluRXhhY3RTcGFuTGVuZ3RoKHNlbGYsIG1pbl9leGFjdF9zcGFuX2xlbmd0aCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJUd29XaXJlc0ZvcmJpZGRlblNwY1J1bGVfc2V0TWluRXhhY3RTcGFuTGVuZ3RoKHNlbGYsIG1pbl9leGFjdF9zcGFuX2xlbmd0aCkKCiAgICBkZWYgaXNNaW5FeGFjdFNwYW5MZW5ndGgoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJUd29XaXJlc0ZvcmJpZGRlblNwY1J1bGVfaXNNaW5FeGFjdFNwYW5MZW5ndGgoc2VsZikKCiAgICBkZWYgc2V0TWF4RXhhY3RTcGFuTGVuZ3RoKHNlbGYsIG1heF9leGFjdF9zcGFuX2xlbmd0aCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJUd29XaXJlc0ZvcmJpZGRlblNwY1J1bGVfc2V0TWF4RXhhY3RTcGFuTGVuZ3RoKHNlbGYsIG1heF9leGFjdF9zcGFuX2xlbmd0aCkKCiAgICBkZWYgaXNNYXhFeGFjdFNwYW5MZW5ndGgoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJUd29XaXJlc0ZvcmJpZGRlblNwY1J1bGVfaXNNYXhFeGFjdFNwYW5MZW5ndGgoc2VsZikKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgY3JlYXRlKGxheWVyKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllclR3b1dpcmVzRm9yYmlkZGVuU3BjUnVsZV9jcmVhdGUobGF5ZXIpCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIGRlc3Ryb3kocnVsZSk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJUd29XaXJlc0ZvcmJpZGRlblNwY1J1bGVfZGVzdHJveShydWxlKQoKICAgIGRlZiBfX2luaXRfXyhzZWxmKToKICAgICAgICBfb2RiX3B5LmRiVGVjaExheWVyVHdvV2lyZXNGb3JiaWRkZW5TcGNSdWxlX3N3aWdpbml0KHNlbGYsIF9vZGJfcHkubmV3X2RiVGVjaExheWVyVHdvV2lyZXNGb3JiaWRkZW5TcGNSdWxlKCkpCiAgICBfX3N3aWdfZGVzdHJveV9fID0gX29kYl9weS5kZWxldGVfZGJUZWNoTGF5ZXJUd29XaXJlc0ZvcmJpZGRlblNwY1J1bGUKCiMgUmVnaXN0ZXIgZGJUZWNoTGF5ZXJUd29XaXJlc0ZvcmJpZGRlblNwY1J1bGUgaW4gX29kYl9weToKX29kYl9weS5kYlRlY2hMYXllclR3b1dpcmVzRm9yYmlkZGVuU3BjUnVsZV9zd2lncmVnaXN0ZXIoZGJUZWNoTGF5ZXJUd29XaXJlc0ZvcmJpZGRlblNwY1J1bGUpCgpkZWYgZGJUZWNoTGF5ZXJUd29XaXJlc0ZvcmJpZGRlblNwY1J1bGVfY3JlYXRlKGxheWVyKToKICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyVHdvV2lyZXNGb3JiaWRkZW5TcGNSdWxlX2NyZWF0ZShsYXllcikKCmRlZiBkYlRlY2hMYXllclR3b1dpcmVzRm9yYmlkZGVuU3BjUnVsZV9kZXN0cm95KHJ1bGUpOgogICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJUd29XaXJlc0ZvcmJpZGRlblNwY1J1bGVfZGVzdHJveShydWxlKQoKY2xhc3MgZGJUZWNoTGF5ZXJXaWR0aFRhYmxlUnVsZShvYmplY3QpOgogICAgdGhpc293biA9IHByb3BlcnR5KGxhbWJkYSB4OiB4LnRoaXMub3duKCksIGxhbWJkYSB4LCB2OiB4LnRoaXMub3duKHYpLCBkb2M9J1RoZSBtZW1iZXJzaGlwIGZsYWcnKQogICAgX19yZXByX18gPSBfc3dpZ19yZXByCgogICAgZGVmIHNldFdyb25nRGlyZWN0aW9uKHNlbGYsIHdyb25nX2RpcmVjdGlvbik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJXaWR0aFRhYmxlUnVsZV9zZXRXcm9uZ0RpcmVjdGlvbihzZWxmLCB3cm9uZ19kaXJlY3Rpb24pCgogICAgZGVmIGlzV3JvbmdEaXJlY3Rpb24oc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJXaWR0aFRhYmxlUnVsZV9pc1dyb25nRGlyZWN0aW9uKHNlbGYpCgogICAgZGVmIHNldE9ydGhvZ29uYWwoc2VsZiwgb3J0aG9nb25hbCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJXaWR0aFRhYmxlUnVsZV9zZXRPcnRob2dvbmFsKHNlbGYsIG9ydGhvZ29uYWwpCgogICAgZGVmIGlzT3J0aG9nb25hbChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllcldpZHRoVGFibGVSdWxlX2lzT3J0aG9nb25hbChzZWxmKQoKICAgIGRlZiBhZGRXaWR0aChzZWxmLCB3aWR0aCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJXaWR0aFRhYmxlUnVsZV9hZGRXaWR0aChzZWxmLCB3aWR0aCkKCiAgICBkZWYgZ2V0V2lkdGhUYWJsZShzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllcldpZHRoVGFibGVSdWxlX2dldFdpZHRoVGFibGUoc2VsZikKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgY3JlYXRlKGxheWVyKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllcldpZHRoVGFibGVSdWxlX2NyZWF0ZShsYXllcikKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgZ2V0VGVjaExheWVyV2lkdGhUYWJsZVJ1bGUoaW5seSwgZGJpZCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJXaWR0aFRhYmxlUnVsZV9nZXRUZWNoTGF5ZXJXaWR0aFRhYmxlUnVsZShpbmx5LCBkYmlkKQoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBkZXN0cm95KHJ1bGUpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyV2lkdGhUYWJsZVJ1bGVfZGVzdHJveShydWxlKQoKICAgIGRlZiBfX2luaXRfXyhzZWxmKToKICAgICAgICBfb2RiX3B5LmRiVGVjaExheWVyV2lkdGhUYWJsZVJ1bGVfc3dpZ2luaXQoc2VsZiwgX29kYl9weS5uZXdfZGJUZWNoTGF5ZXJXaWR0aFRhYmxlUnVsZSgpKQogICAgX19zd2lnX2Rlc3Ryb3lfXyA9IF9vZGJfcHkuZGVsZXRlX2RiVGVjaExheWVyV2lkdGhUYWJsZVJ1bGUKCiMgUmVnaXN0ZXIgZGJUZWNoTGF5ZXJXaWR0aFRhYmxlUnVsZSBpbiBfb2RiX3B5Ogpfb2RiX3B5LmRiVGVjaExheWVyV2lkdGhUYWJsZVJ1bGVfc3dpZ3JlZ2lzdGVyKGRiVGVjaExheWVyV2lkdGhUYWJsZVJ1bGUpCgpkZWYgZGJUZWNoTGF5ZXJXaWR0aFRhYmxlUnVsZV9jcmVhdGUobGF5ZXIpOgogICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJXaWR0aFRhYmxlUnVsZV9jcmVhdGUobGF5ZXIpCgpkZWYgZGJUZWNoTGF5ZXJXaWR0aFRhYmxlUnVsZV9nZXRUZWNoTGF5ZXJXaWR0aFRhYmxlUnVsZShpbmx5LCBkYmlkKToKICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyV2lkdGhUYWJsZVJ1bGVfZ2V0VGVjaExheWVyV2lkdGhUYWJsZVJ1bGUoaW5seSwgZGJpZCkKCmRlZiBkYlRlY2hMYXllcldpZHRoVGFibGVSdWxlX2Rlc3Ryb3kocnVsZSk6CiAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllcldpZHRoVGFibGVSdWxlX2Rlc3Ryb3kocnVsZSkKCmNsYXNzIGRiVGVjaExheWVyV3JvbmdEaXJTcGFjaW5nUnVsZShvYmplY3QpOgogICAgdGhpc293biA9IHByb3BlcnR5KGxhbWJkYSB4OiB4LnRoaXMub3duKCksIGxhbWJkYSB4LCB2OiB4LnRoaXMub3duKHYpLCBkb2M9J1RoZSBtZW1iZXJzaGlwIGZsYWcnKQogICAgX19yZXByX18gPSBfc3dpZ19yZXByCgogICAgZGVmIHNldFdyb25nZGlyU3BhY2Uoc2VsZiwgd3JvbmdkaXJfc3BhY2UpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyV3JvbmdEaXJTcGFjaW5nUnVsZV9zZXRXcm9uZ2RpclNwYWNlKHNlbGYsIHdyb25nZGlyX3NwYWNlKQoKICAgIGRlZiBnZXRXcm9uZ2RpclNwYWNlKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyV3JvbmdEaXJTcGFjaW5nUnVsZV9nZXRXcm9uZ2RpclNwYWNlKHNlbGYpCgogICAgZGVmIHNldE5vbmVvbFdpZHRoKHNlbGYsIG5vbmVvbF93aWR0aCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJXcm9uZ0RpclNwYWNpbmdSdWxlX3NldE5vbmVvbFdpZHRoKHNlbGYsIG5vbmVvbF93aWR0aCkKCiAgICBkZWYgZ2V0Tm9uZW9sV2lkdGgoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJXcm9uZ0RpclNwYWNpbmdSdWxlX2dldE5vbmVvbFdpZHRoKHNlbGYpCgogICAgZGVmIHNldExlbmd0aChzZWxmLCBsZW5ndGgpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyV3JvbmdEaXJTcGFjaW5nUnVsZV9zZXRMZW5ndGgoc2VsZiwgbGVuZ3RoKQoKICAgIGRlZiBnZXRMZW5ndGgoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJXcm9uZ0RpclNwYWNpbmdSdWxlX2dldExlbmd0aChzZWxmKQoKICAgIGRlZiBzZXRQcmxMZW5ndGgoc2VsZiwgcHJsX2xlbmd0aCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJXcm9uZ0RpclNwYWNpbmdSdWxlX3NldFBybExlbmd0aChzZWxmLCBwcmxfbGVuZ3RoKQoKICAgIGRlZiBnZXRQcmxMZW5ndGgoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJXcm9uZ0RpclNwYWNpbmdSdWxlX2dldFBybExlbmd0aChzZWxmKQoKICAgIGRlZiBzZXROb25lb2xWYWxpZChzZWxmLCBub25lb2xfdmFsaWQpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyV3JvbmdEaXJTcGFjaW5nUnVsZV9zZXROb25lb2xWYWxpZChzZWxmLCBub25lb2xfdmFsaWQpCgogICAgZGVmIGlzTm9uZW9sVmFsaWQoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJXcm9uZ0RpclNwYWNpbmdSdWxlX2lzTm9uZW9sVmFsaWQoc2VsZikKCiAgICBkZWYgc2V0TGVuZ3RoVmFsaWQoc2VsZiwgbGVuZ3RoX3ZhbGlkKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllcldyb25nRGlyU3BhY2luZ1J1bGVfc2V0TGVuZ3RoVmFsaWQoc2VsZiwgbGVuZ3RoX3ZhbGlkKQoKICAgIGRlZiBpc0xlbmd0aFZhbGlkKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyV3JvbmdEaXJTcGFjaW5nUnVsZV9pc0xlbmd0aFZhbGlkKHNlbGYpCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIGNyZWF0ZShsYXllcik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJXcm9uZ0RpclNwYWNpbmdSdWxlX2NyZWF0ZShsYXllcikKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgZ2V0VGVjaExheWVyV3JvbmdEaXJTcGFjaW5nUnVsZShpbmx5LCBkYmlkKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllcldyb25nRGlyU3BhY2luZ1J1bGVfZ2V0VGVjaExheWVyV3JvbmdEaXJTcGFjaW5nUnVsZShpbmx5LCBkYmlkKQoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBkZXN0cm95KHJ1bGUpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyV3JvbmdEaXJTcGFjaW5nUnVsZV9kZXN0cm95KHJ1bGUpCgogICAgZGVmIF9faW5pdF9fKHNlbGYpOgogICAgICAgIF9vZGJfcHkuZGJUZWNoTGF5ZXJXcm9uZ0RpclNwYWNpbmdSdWxlX3N3aWdpbml0KHNlbGYsIF9vZGJfcHkubmV3X2RiVGVjaExheWVyV3JvbmdEaXJTcGFjaW5nUnVsZSgpKQogICAgX19zd2lnX2Rlc3Ryb3lfXyA9IF9vZGJfcHkuZGVsZXRlX2RiVGVjaExheWVyV3JvbmdEaXJTcGFjaW5nUnVsZQoKIyBSZWdpc3RlciBkYlRlY2hMYXllcldyb25nRGlyU3BhY2luZ1J1bGUgaW4gX29kYl9weToKX29kYl9weS5kYlRlY2hMYXllcldyb25nRGlyU3BhY2luZ1J1bGVfc3dpZ3JlZ2lzdGVyKGRiVGVjaExheWVyV3JvbmdEaXJTcGFjaW5nUnVsZSkKCmRlZiBkYlRlY2hMYXllcldyb25nRGlyU3BhY2luZ1J1bGVfY3JlYXRlKGxheWVyKToKICAgIHJldHVybiBfb2RiX3B5LmRiVGVjaExheWVyV3JvbmdEaXJTcGFjaW5nUnVsZV9jcmVhdGUobGF5ZXIpCgpkZWYgZGJUZWNoTGF5ZXJXcm9uZ0RpclNwYWNpbmdSdWxlX2dldFRlY2hMYXllcldyb25nRGlyU3BhY2luZ1J1bGUoaW5seSwgZGJpZCk6CiAgICByZXR1cm4gX29kYl9weS5kYlRlY2hMYXllcldyb25nRGlyU3BhY2luZ1J1bGVfZ2V0VGVjaExheWVyV3JvbmdEaXJTcGFjaW5nUnVsZShpbmx5LCBkYmlkKQoKZGVmIGRiVGVjaExheWVyV3JvbmdEaXJTcGFjaW5nUnVsZV9kZXN0cm95KHJ1bGUpOgogICAgcmV0dXJuIF9vZGJfcHkuZGJUZWNoTGF5ZXJXcm9uZ0RpclNwYWNpbmdSdWxlX2Rlc3Ryb3kocnVsZSkKCmNsYXNzIGRiQm9vbFByb3BlcnR5KGRiUHJvcGVydHkpOgogICAgdGhpc293biA9IHByb3BlcnR5KGxhbWJkYSB4OiB4LnRoaXMub3duKCksIGxhbWJkYSB4LCB2OiB4LnRoaXMub3duKHYpLCBkb2M9J1RoZSBtZW1iZXJzaGlwIGZsYWcnKQogICAgX19yZXByX18gPSBfc3dpZ19yZXByCgogICAgZGVmIGdldFZhbHVlKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQm9vbFByb3BlcnR5X2dldFZhbHVlKHNlbGYpCgogICAgZGVmIHNldFZhbHVlKHNlbGYsIHZhbHVlKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkJvb2xQcm9wZXJ0eV9zZXRWYWx1ZShzZWxmLCB2YWx1ZSkKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgY3JlYXRlKG9iamVjdCwgbmFtZSwgdmFsdWUpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQm9vbFByb3BlcnR5X2NyZWF0ZShvYmplY3QsIG5hbWUsIHZhbHVlKQoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBmaW5kKG9iamVjdCwgbmFtZSk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJCb29sUHJvcGVydHlfZmluZChvYmplY3QsIG5hbWUpCgogICAgZGVmIF9faW5pdF9fKHNlbGYpOgogICAgICAgIF9vZGJfcHkuZGJCb29sUHJvcGVydHlfc3dpZ2luaXQoc2VsZiwgX29kYl9weS5uZXdfZGJCb29sUHJvcGVydHkoKSkKICAgIF9fc3dpZ19kZXN0cm95X18gPSBfb2RiX3B5LmRlbGV0ZV9kYkJvb2xQcm9wZXJ0eQoKIyBSZWdpc3RlciBkYkJvb2xQcm9wZXJ0eSBpbiBfb2RiX3B5Ogpfb2RiX3B5LmRiQm9vbFByb3BlcnR5X3N3aWdyZWdpc3RlcihkYkJvb2xQcm9wZXJ0eSkKCmRlZiBkYkJvb2xQcm9wZXJ0eV9jcmVhdGUob2JqZWN0LCBuYW1lLCB2YWx1ZSk6CiAgICByZXR1cm4gX29kYl9weS5kYkJvb2xQcm9wZXJ0eV9jcmVhdGUob2JqZWN0LCBuYW1lLCB2YWx1ZSkKCmRlZiBkYkJvb2xQcm9wZXJ0eV9maW5kKG9iamVjdCwgbmFtZSk6CiAgICByZXR1cm4gX29kYl9weS5kYkJvb2xQcm9wZXJ0eV9maW5kKG9iamVjdCwgbmFtZSkKCmNsYXNzIGRiU3RyaW5nUHJvcGVydHkoZGJQcm9wZXJ0eSk6CiAgICB0aGlzb3duID0gcHJvcGVydHkobGFtYmRhIHg6IHgudGhpcy5vd24oKSwgbGFtYmRhIHgsIHY6IHgudGhpcy5vd24odiksIGRvYz0nVGhlIG1lbWJlcnNoaXAgZmxhZycpCiAgICBfX3JlcHJfXyA9IF9zd2lnX3JlcHIKCiAgICBkZWYgZ2V0VmFsdWUoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJTdHJpbmdQcm9wZXJ0eV9nZXRWYWx1ZShzZWxmKQoKICAgIGRlZiBzZXRWYWx1ZShzZWxmLCB2YWx1ZSk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJTdHJpbmdQcm9wZXJ0eV9zZXRWYWx1ZShzZWxmLCB2YWx1ZSkKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgY3JlYXRlKG9iamVjdCwgbmFtZSwgdmFsdWUpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiU3RyaW5nUHJvcGVydHlfY3JlYXRlKG9iamVjdCwgbmFtZSwgdmFsdWUpCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIGZpbmQob2JqZWN0LCBuYW1lKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlN0cmluZ1Byb3BlcnR5X2ZpbmQob2JqZWN0LCBuYW1lKQoKICAgIGRlZiBfX2luaXRfXyhzZWxmKToKICAgICAgICBfb2RiX3B5LmRiU3RyaW5nUHJvcGVydHlfc3dpZ2luaXQoc2VsZiwgX29kYl9weS5uZXdfZGJTdHJpbmdQcm9wZXJ0eSgpKQogICAgX19zd2lnX2Rlc3Ryb3lfXyA9IF9vZGJfcHkuZGVsZXRlX2RiU3RyaW5nUHJvcGVydHkKCiMgUmVnaXN0ZXIgZGJTdHJpbmdQcm9wZXJ0eSBpbiBfb2RiX3B5Ogpfb2RiX3B5LmRiU3RyaW5nUHJvcGVydHlfc3dpZ3JlZ2lzdGVyKGRiU3RyaW5nUHJvcGVydHkpCgpkZWYgZGJTdHJpbmdQcm9wZXJ0eV9jcmVhdGUob2JqZWN0LCBuYW1lLCB2YWx1ZSk6CiAgICByZXR1cm4gX29kYl9weS5kYlN0cmluZ1Byb3BlcnR5X2NyZWF0ZShvYmplY3QsIG5hbWUsIHZhbHVlKQoKZGVmIGRiU3RyaW5nUHJvcGVydHlfZmluZChvYmplY3QsIG5hbWUpOgogICAgcmV0dXJuIF9vZGJfcHkuZGJTdHJpbmdQcm9wZXJ0eV9maW5kKG9iamVjdCwgbmFtZSkKCmNsYXNzIGRiSW50UHJvcGVydHkoZGJQcm9wZXJ0eSk6CiAgICB0aGlzb3duID0gcHJvcGVydHkobGFtYmRhIHg6IHgudGhpcy5vd24oKSwgbGFtYmRhIHgsIHY6IHgudGhpcy5vd24odiksIGRvYz0nVGhlIG1lbWJlcnNoaXAgZmxhZycpCiAgICBfX3JlcHJfXyA9IF9zd2lnX3JlcHIKCiAgICBkZWYgZ2V0VmFsdWUoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJJbnRQcm9wZXJ0eV9nZXRWYWx1ZShzZWxmKQoKICAgIGRlZiBzZXRWYWx1ZShzZWxmLCB2YWx1ZSk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJJbnRQcm9wZXJ0eV9zZXRWYWx1ZShzZWxmLCB2YWx1ZSkKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgY3JlYXRlKG9iamVjdCwgbmFtZSwgdmFsdWUpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiSW50UHJvcGVydHlfY3JlYXRlKG9iamVjdCwgbmFtZSwgdmFsdWUpCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIGZpbmQob2JqZWN0LCBuYW1lKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkludFByb3BlcnR5X2ZpbmQob2JqZWN0LCBuYW1lKQoKICAgIGRlZiBfX2luaXRfXyhzZWxmKToKICAgICAgICBfb2RiX3B5LmRiSW50UHJvcGVydHlfc3dpZ2luaXQoc2VsZiwgX29kYl9weS5uZXdfZGJJbnRQcm9wZXJ0eSgpKQogICAgX19zd2lnX2Rlc3Ryb3lfXyA9IF9vZGJfcHkuZGVsZXRlX2RiSW50UHJvcGVydHkKCiMgUmVnaXN0ZXIgZGJJbnRQcm9wZXJ0eSBpbiBfb2RiX3B5Ogpfb2RiX3B5LmRiSW50UHJvcGVydHlfc3dpZ3JlZ2lzdGVyKGRiSW50UHJvcGVydHkpCgpkZWYgZGJJbnRQcm9wZXJ0eV9jcmVhdGUob2JqZWN0LCBuYW1lLCB2YWx1ZSk6CiAgICByZXR1cm4gX29kYl9weS5kYkludFByb3BlcnR5X2NyZWF0ZShvYmplY3QsIG5hbWUsIHZhbHVlKQoKZGVmIGRiSW50UHJvcGVydHlfZmluZChvYmplY3QsIG5hbWUpOgogICAgcmV0dXJuIF9vZGJfcHkuZGJJbnRQcm9wZXJ0eV9maW5kKG9iamVjdCwgbmFtZSkKCmNsYXNzIGRiRG91YmxlUHJvcGVydHkoZGJQcm9wZXJ0eSk6CiAgICB0aGlzb3duID0gcHJvcGVydHkobGFtYmRhIHg6IHgudGhpcy5vd24oKSwgbGFtYmRhIHgsIHY6IHgudGhpcy5vd24odiksIGRvYz0nVGhlIG1lbWJlcnNoaXAgZmxhZycpCiAgICBfX3JlcHJfXyA9IF9zd2lnX3JlcHIKCiAgICBkZWYgZ2V0VmFsdWUoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJEb3VibGVQcm9wZXJ0eV9nZXRWYWx1ZShzZWxmKQoKICAgIGRlZiBzZXRWYWx1ZShzZWxmLCB2YWx1ZSk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJEb3VibGVQcm9wZXJ0eV9zZXRWYWx1ZShzZWxmLCB2YWx1ZSkKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgY3JlYXRlKG9iamVjdCwgbmFtZSwgdmFsdWUpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiRG91YmxlUHJvcGVydHlfY3JlYXRlKG9iamVjdCwgbmFtZSwgdmFsdWUpCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIGZpbmQob2JqZWN0LCBuYW1lKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkRvdWJsZVByb3BlcnR5X2ZpbmQob2JqZWN0LCBuYW1lKQoKICAgIGRlZiBfX2luaXRfXyhzZWxmKToKICAgICAgICBfb2RiX3B5LmRiRG91YmxlUHJvcGVydHlfc3dpZ2luaXQoc2VsZiwgX29kYl9weS5uZXdfZGJEb3VibGVQcm9wZXJ0eSgpKQogICAgX19zd2lnX2Rlc3Ryb3lfXyA9IF9vZGJfcHkuZGVsZXRlX2RiRG91YmxlUHJvcGVydHkKCiMgUmVnaXN0ZXIgZGJEb3VibGVQcm9wZXJ0eSBpbiBfb2RiX3B5Ogpfb2RiX3B5LmRiRG91YmxlUHJvcGVydHlfc3dpZ3JlZ2lzdGVyKGRiRG91YmxlUHJvcGVydHkpCgpkZWYgZGJEb3VibGVQcm9wZXJ0eV9jcmVhdGUob2JqZWN0LCBuYW1lLCB2YWx1ZSk6CiAgICByZXR1cm4gX29kYl9weS5kYkRvdWJsZVByb3BlcnR5X2NyZWF0ZShvYmplY3QsIG5hbWUsIHZhbHVlKQoKZGVmIGRiRG91YmxlUHJvcGVydHlfZmluZChvYmplY3QsIG5hbWUpOgogICAgcmV0dXJuIF9vZGJfcHkuZGJEb3VibGVQcm9wZXJ0eV9maW5kKG9iamVjdCwgbmFtZSkKCgpkZWYgcmVhZF9sZWYoZGIsIHBhdGgpOgogICAgcmV0dXJuIF9vZGJfcHkucmVhZF9sZWYoZGIsIHBhdGgpCgpkZWYgd3JpdGVfbGVmKGxpYiwgcGF0aCk6CiAgICByZXR1cm4gX29kYl9weS53cml0ZV9sZWYobGliLCBwYXRoKQoKZGVmIHdyaXRlX3RlY2hfbGVmKHRlY2gsIHBhdGgpOgogICAgcmV0dXJuIF9vZGJfcHkud3JpdGVfdGVjaF9sZWYodGVjaCwgcGF0aCkKCmRlZiB3cml0ZV9tYWNyb19sZWYobGliLCBwYXRoKToKICAgIHJldHVybiBfb2RiX3B5LndyaXRlX21hY3JvX2xlZihsaWIsIHBhdGgpCgpkZWYgcmVhZF9kZWYodGVjaCwgcGF0aCk6CiAgICByZXR1cm4gX29kYl9weS5yZWFkX2RlZih0ZWNoLCBwYXRoKQoKZGVmIHdyaXRlX2RlZigqYXJncyk6CiAgICByZXR1cm4gX29kYl9weS53cml0ZV9kZWYoKmFyZ3MpCgpkZWYgcmVhZF9kYihkYiwgZGJfcGF0aCk6CiAgICByZXR1cm4gX29kYl9weS5yZWFkX2RiKGRiLCBkYl9wYXRoKQoKZGVmIHdyaXRlX2RiKGRiLCBkYl9wYXRoKToKICAgIHJldHVybiBfb2RiX3B5LndyaXRlX2RiKGRiLCBkYl9wYXRoKQoKZGVmIGNyZWF0ZVNCb3hlcygqYXJncyk6CiAgICByZXR1cm4gX29kYl9weS5jcmVhdGVTQm94ZXMoKmFyZ3MpCgpkZWYgZHVtcEFQcyhibG9jaywgZmlsZV9uYW1lKToKICAgIHJldHVybiBfb2RiX3B5LmR1bXBBUHMoYmxvY2ssIGZpbGVfbmFtZSkKY2xhc3MgX2RiVmlhUGFyYW1zKG9iamVjdCk6CiAgICB0aGlzb3duID0gcHJvcGVydHkobGFtYmRhIHg6IHgudGhpcy5vd24oKSwgbGFtYmRhIHgsIHY6IHgudGhpcy5vd24odiksIGRvYz0nVGhlIG1lbWJlcnNoaXAgZmxhZycpCiAgICBfX3JlcHJfXyA9IF9zd2lnX3JlcHIKICAgIF94X2N1dF9zaXplID0gcHJvcGVydHkoX29kYl9weS5fZGJWaWFQYXJhbXNfX3hfY3V0X3NpemVfZ2V0LCBfb2RiX3B5Ll9kYlZpYVBhcmFtc19feF9jdXRfc2l6ZV9zZXQpCiAgICBfeV9jdXRfc2l6ZSA9IHByb3BlcnR5KF9vZGJfcHkuX2RiVmlhUGFyYW1zX195X2N1dF9zaXplX2dldCwgX29kYl9weS5fZGJWaWFQYXJhbXNfX3lfY3V0X3NpemVfc2V0KQogICAgX3hfY3V0X3NwYWNpbmcgPSBwcm9wZXJ0eShfb2RiX3B5Ll9kYlZpYVBhcmFtc19feF9jdXRfc3BhY2luZ19nZXQsIF9vZGJfcHkuX2RiVmlhUGFyYW1zX194X2N1dF9zcGFjaW5nX3NldCkKICAgIF95X2N1dF9zcGFjaW5nID0gcHJvcGVydHkoX29kYl9weS5fZGJWaWFQYXJhbXNfX3lfY3V0X3NwYWNpbmdfZ2V0LCBfb2RiX3B5Ll9kYlZpYVBhcmFtc19feV9jdXRfc3BhY2luZ19zZXQpCiAgICBfeF90b3BfZW5jbG9zdXJlID0gcHJvcGVydHkoX29kYl9weS5fZGJWaWFQYXJhbXNfX3hfdG9wX2VuY2xvc3VyZV9nZXQsIF9vZGJfcHkuX2RiVmlhUGFyYW1zX194X3RvcF9lbmNsb3N1cmVfc2V0KQogICAgX3lfdG9wX2VuY2xvc3VyZSA9IHByb3BlcnR5KF9vZGJfcHkuX2RiVmlhUGFyYW1zX195X3RvcF9lbmNsb3N1cmVfZ2V0LCBfb2RiX3B5Ll9kYlZpYVBhcmFtc19feV90b3BfZW5jbG9zdXJlX3NldCkKICAgIF94X2JvdF9lbmNsb3N1cmUgPSBwcm9wZXJ0eShfb2RiX3B5Ll9kYlZpYVBhcmFtc19feF9ib3RfZW5jbG9zdXJlX2dldCwgX29kYl9weS5fZGJWaWFQYXJhbXNfX3hfYm90X2VuY2xvc3VyZV9zZXQpCiAgICBfeV9ib3RfZW5jbG9zdXJlID0gcHJvcGVydHkoX29kYl9weS5fZGJWaWFQYXJhbXNfX3lfYm90X2VuY2xvc3VyZV9nZXQsIF9vZGJfcHkuX2RiVmlhUGFyYW1zX195X2JvdF9lbmNsb3N1cmVfc2V0KQogICAgX251bV9jdXRfcm93cyA9IHByb3BlcnR5KF9vZGJfcHkuX2RiVmlhUGFyYW1zX19udW1fY3V0X3Jvd3NfZ2V0LCBfb2RiX3B5Ll9kYlZpYVBhcmFtc19fbnVtX2N1dF9yb3dzX3NldCkKICAgIF9udW1fY3V0X2NvbHMgPSBwcm9wZXJ0eShfb2RiX3B5Ll9kYlZpYVBhcmFtc19fbnVtX2N1dF9jb2xzX2dldCwgX29kYl9weS5fZGJWaWFQYXJhbXNfX251bV9jdXRfY29sc19zZXQpCiAgICBfeF9vcmlnaW4gPSBwcm9wZXJ0eShfb2RiX3B5Ll9kYlZpYVBhcmFtc19feF9vcmlnaW5fZ2V0LCBfb2RiX3B5Ll9kYlZpYVBhcmFtc19feF9vcmlnaW5fc2V0KQogICAgX3lfb3JpZ2luID0gcHJvcGVydHkoX29kYl9weS5fZGJWaWFQYXJhbXNfX3lfb3JpZ2luX2dldCwgX29kYl9weS5fZGJWaWFQYXJhbXNfX3lfb3JpZ2luX3NldCkKICAgIF94X3RvcF9vZmZzZXQgPSBwcm9wZXJ0eShfb2RiX3B5Ll9kYlZpYVBhcmFtc19feF90b3Bfb2Zmc2V0X2dldCwgX29kYl9weS5fZGJWaWFQYXJhbXNfX3hfdG9wX29mZnNldF9zZXQpCiAgICBfeV90b3Bfb2Zmc2V0ID0gcHJvcGVydHkoX29kYl9weS5fZGJWaWFQYXJhbXNfX3lfdG9wX29mZnNldF9nZXQsIF9vZGJfcHkuX2RiVmlhUGFyYW1zX195X3RvcF9vZmZzZXRfc2V0KQogICAgX3hfYm90X29mZnNldCA9IHByb3BlcnR5KF9vZGJfcHkuX2RiVmlhUGFyYW1zX194X2JvdF9vZmZzZXRfZ2V0LCBfb2RiX3B5Ll9kYlZpYVBhcmFtc19feF9ib3Rfb2Zmc2V0X3NldCkKICAgIF95X2JvdF9vZmZzZXQgPSBwcm9wZXJ0eShfb2RiX3B5Ll9kYlZpYVBhcmFtc19feV9ib3Rfb2Zmc2V0X2dldCwgX29kYl9weS5fZGJWaWFQYXJhbXNfX3lfYm90X29mZnNldF9zZXQpCiAgICBfdG9wX2xheWVyID0gcHJvcGVydHkoX29kYl9weS5fZGJWaWFQYXJhbXNfX3RvcF9sYXllcl9nZXQsIF9vZGJfcHkuX2RiVmlhUGFyYW1zX190b3BfbGF5ZXJfc2V0KQogICAgX2N1dF9sYXllciA9IHByb3BlcnR5KF9vZGJfcHkuX2RiVmlhUGFyYW1zX19jdXRfbGF5ZXJfZ2V0LCBfb2RiX3B5Ll9kYlZpYVBhcmFtc19fY3V0X2xheWVyX3NldCkKICAgIF9ib3RfbGF5ZXIgPSBwcm9wZXJ0eShfb2RiX3B5Ll9kYlZpYVBhcmFtc19fYm90X2xheWVyX2dldCwgX29kYl9weS5fZGJWaWFQYXJhbXNfX2JvdF9sYXllcl9zZXQpCgogICAgZGVmIF9faW5pdF9fKHNlbGYsICphcmdzKToKICAgICAgICBfb2RiX3B5Ll9kYlZpYVBhcmFtc19zd2lnaW5pdChzZWxmLCBfb2RiX3B5Lm5ld19fZGJWaWFQYXJhbXMoKmFyZ3MpKQogICAgX19zd2lnX2Rlc3Ryb3lfXyA9IF9vZGJfcHkuZGVsZXRlX19kYlZpYVBhcmFtcwoKICAgIGRlZiBfX2VxX18oc2VsZiwgcmhzKToKICAgICAgICByZXR1cm4gX29kYl9weS5fZGJWaWFQYXJhbXNfX19lcV9fKHNlbGYsIHJocykKCiAgICBkZWYgX19uZV9fKHNlbGYsIHJocyk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuX2RiVmlhUGFyYW1zX19fbmVfXyhzZWxmLCByaHMpCgojIFJlZ2lzdGVyIF9kYlZpYVBhcmFtcyBpbiBfb2RiX3B5Ogpfb2RiX3B5Ll9kYlZpYVBhcmFtc19zd2lncmVnaXN0ZXIoX2RiVmlhUGFyYW1zKQoKY2xhc3MgZGJXaXJlRW5jb2RlcihvYmplY3QpOgogICAgdGhpc293biA9IHByb3BlcnR5KGxhbWJkYSB4OiB4LnRoaXMub3duKCksIGxhbWJkYSB4LCB2OiB4LnRoaXMub3duKHYpLCBkb2M9J1RoZSBtZW1iZXJzaGlwIGZsYWcnKQogICAgX19yZXByX18gPSBfc3dpZ19yZXByCgogICAgZGVmIF9faW5pdF9fKHNlbGYpOgogICAgICAgIF9vZGJfcHkuZGJXaXJlRW5jb2Rlcl9zd2lnaW5pdChzZWxmLCBfb2RiX3B5Lm5ld19kYldpcmVFbmNvZGVyKCkpCiAgICBfX3N3aWdfZGVzdHJveV9fID0gX29kYl9weS5kZWxldGVfZGJXaXJlRW5jb2RlcgoKICAgIGRlZiBiZWdpbihzZWxmLCB3aXJlKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYldpcmVFbmNvZGVyX2JlZ2luKHNlbGYsIHdpcmUpCgogICAgZGVmIGFwcGVuZChzZWxmLCB3aXJlKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYldpcmVFbmNvZGVyX2FwcGVuZChzZWxm",
"LCB3aXJlKQoKICAgIGRlZiBhZGRQb2ludChzZWxmLCAqYXJncyk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJXaXJlRW5jb2Rlcl9hZGRQb2ludChzZWxmLCAqYXJncykKCiAgICBkZWYgYWRkVmlhKHNlbGYsIHZpYSk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJXaXJlRW5jb2Rlcl9hZGRWaWEoc2VsZiwgdmlhKQoKICAgIGRlZiBhZGRUZWNoVmlhKHNlbGYsIHZpYSk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJXaXJlRW5jb2Rlcl9hZGRUZWNoVmlhKHNlbGYsIHZpYSkKCiAgICBkZWYgYWRkUmVjdChzZWxmLCBkZWx0YVgxLCBkZWx0YVkxLCBkZWx0YVgyLCBkZWx0YVkyKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYldpcmVFbmNvZGVyX2FkZFJlY3Qoc2VsZiwgZGVsdGFYMSwgZGVsdGFZMSwgZGVsdGFYMiwgZGVsdGFZMikKCiAgICBkZWYgc2V0Q29sb3Ioc2VsZiwgbWFza19jb2xvcik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJXaXJlRW5jb2Rlcl9zZXRDb2xvcihzZWxmLCBtYXNrX2NvbG9yKQoKICAgIGRlZiBjbGVhckNvbG9yKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiV2lyZUVuY29kZXJfY2xlYXJDb2xvcihzZWxmKQoKICAgIGRlZiBzZXRWaWFDb2xvcihzZWxmLCBib3R0b21fY29sb3IsIGN1dF9jb2xvciwgdG9wX2NvbG9yKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYldpcmVFbmNvZGVyX3NldFZpYUNvbG9yKHNlbGYsIGJvdHRvbV9jb2xvciwgY3V0X2NvbG9yLCB0b3BfY29sb3IpCgogICAgZGVmIGNsZWFyVmlhQ29sb3Ioc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJXaXJlRW5jb2Rlcl9jbGVhclZpYUNvbG9yKHNlbGYpCgogICAgZGVmIGFkZElUZXJtKHNlbGYsIGl0ZXJtKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYldpcmVFbmNvZGVyX2FkZElUZXJtKHNlbGYsIGl0ZXJtKQoKICAgIGRlZiBhZGRCVGVybShzZWxmLCBidGVybSk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJXaXJlRW5jb2Rlcl9hZGRCVGVybShzZWxmLCBidGVybSkKCiAgICBkZWYgbmV3UGF0aFNob3J0KHNlbGYsICphcmdzKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYldpcmVFbmNvZGVyX25ld1BhdGhTaG9ydChzZWxmLCAqYXJncykKCiAgICBkZWYgbmV3UGF0aFZpcnR1YWxXaXJlKHNlbGYsICphcmdzKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYldpcmVFbmNvZGVyX25ld1BhdGhWaXJ0dWFsV2lyZShzZWxmLCAqYXJncykKCiAgICBkZWYgZW5kKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiV2lyZUVuY29kZXJfZW5kKHNlbGYpCgogICAgZGVmIGNsZWFyKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiV2lyZUVuY29kZXJfY2xlYXIoc2VsZikKCiAgICBkZWYgbmV3UGF0aChzZWxmLCAqYXJncyk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJXaXJlRW5jb2Rlcl9uZXdQYXRoKHNlbGYsICphcmdzKQoKICAgIGRlZiBuZXdQYXRoRXh0KHNlbGYsICphcmdzKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYldpcmVFbmNvZGVyX25ld1BhdGhFeHQoc2VsZiwgKmFyZ3MpCgojIFJlZ2lzdGVyIGRiV2lyZUVuY29kZXIgaW4gX29kYl9weToKX29kYl9weS5kYldpcmVFbmNvZGVyX3N3aWdyZWdpc3RlcihkYldpcmVFbmNvZGVyKQoKY2xhc3MgZGJXaXJlRGVjb2RlcihvYmplY3QpOgogICAgdGhpc293biA9IHByb3BlcnR5KGxhbWJkYSB4OiB4LnRoaXMub3duKCksIGxhbWJkYSB4LCB2OiB4LnRoaXMub3duKHYpLCBkb2M9J1RoZSBtZW1iZXJzaGlwIGZsYWcnKQogICAgX19yZXByX18gPSBfc3dpZ19yZXByCiAgICBQQVRIID0gX29kYl9weS5kYldpcmVEZWNvZGVyX1BBVEgKICAgIEpVTkNUSU9OID0gX29kYl9weS5kYldpcmVEZWNvZGVyX0pVTkNUSU9OCiAgICBTSE9SVCA9IF9vZGJfcHkuZGJXaXJlRGVjb2Rlcl9TSE9SVAogICAgVldJUkUgPSBfb2RiX3B5LmRiV2lyZURlY29kZXJfVldJUkUKICAgIFBPSU5UID0gX29kYl9weS5kYldpcmVEZWNvZGVyX1BPSU5UCiAgICBQT0lOVF9FWFQgPSBfb2RiX3B5LmRiV2lyZURlY29kZXJfUE9JTlRfRVhUCiAgICBWSUEgPSBfb2RiX3B5LmRiV2lyZURlY29kZXJfVklBCiAgICBURUNIX1ZJQSA9IF9vZGJfcHkuZGJXaXJlRGVjb2Rlcl9URUNIX1ZJQQogICAgUkVDVCA9IF9vZGJfcHkuZGJXaXJlRGVjb2Rlcl9SRUNUCiAgICBJVEVSTSA9IF9vZGJfcHkuZGJXaXJlRGVjb2Rlcl9JVEVSTQogICAgQlRFUk0gPSBfb2RiX3B5LmRiV2lyZURlY29kZXJfQlRFUk0KICAgIFJVTEUgPSBfb2RiX3B5LmRiV2lyZURlY29kZXJfUlVMRQogICAgRU5EX0RFQ09ERSA9IF9vZGJfcHkuZGJXaXJlRGVjb2Rlcl9FTkRfREVDT0RFCgogICAgZGVmIF9faW5pdF9fKHNlbGYpOgogICAgICAgIF9vZGJfcHkuZGJXaXJlRGVjb2Rlcl9zd2lnaW5pdChzZWxmLCBfb2RiX3B5Lm5ld19kYldpcmVEZWNvZGVyKCkpCiAgICBfX3N3aWdfZGVzdHJveV9fID0gX29kYl9weS5kZWxldGVfZGJXaXJlRGVjb2RlcgoKICAgIGRlZiBiZWdpbihzZWxmLCB3aXJlKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYldpcmVEZWNvZGVyX2JlZ2luKHNlbGYsIHdpcmUpCgogICAgZGVmIG5leHQoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJXaXJlRGVjb2Rlcl9uZXh0KHNlbGYpCgogICAgZGVmIHBlZWsoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJXaXJlRGVjb2Rlcl9wZWVrKHNlbGYpCgogICAgZGVmIGdldExheWVyKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiV2lyZURlY29kZXJfZ2V0TGF5ZXIoc2VsZikKCiAgICBkZWYgZ2V0UG9pbnQoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJXaXJlRGVjb2Rlcl9nZXRQb2ludChzZWxmKQoKICAgIGRlZiBnZXRQb2ludF9leHQoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJXaXJlRGVjb2Rlcl9nZXRQb2ludF9leHQoc2VsZikKCiAgICBkZWYgZ2V0UHJvcGVydHkoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJXaXJlRGVjb2Rlcl9nZXRQcm9wZXJ0eShzZWxmKQoKICAgIGRlZiBnZXRWaWEoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJXaXJlRGVjb2Rlcl9nZXRWaWEoc2VsZikKCiAgICBkZWYgZ2V0VGVjaFZpYShzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYldpcmVEZWNvZGVyX2dldFRlY2hWaWEoc2VsZikKCiAgICBkZWYgZ2V0UmVjdChzZWxmLCBkZWx0YVgxLCBkZWx0YVkxLCBkZWx0YVgyLCBkZWx0YVkyKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYldpcmVEZWNvZGVyX2dldFJlY3Qoc2VsZiwgZGVsdGFYMSwgZGVsdGFZMSwgZGVsdGFYMiwgZGVsdGFZMikKCiAgICBkZWYgZ2V0SVRlcm0oc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJXaXJlRGVjb2Rlcl9nZXRJVGVybShzZWxmKQoKICAgIGRlZiBnZXRCVGVybShzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYldpcmVEZWNvZGVyX2dldEJUZXJtKHNlbGYpCgogICAgZGVmIGdldFdpcmVUeXBlKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiV2lyZURlY29kZXJfZ2V0V2lyZVR5cGUoc2VsZikKCiAgICBkZWYgZ2V0UnVsZShzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYldpcmVEZWNvZGVyX2dldFJ1bGUoc2VsZikKCiAgICBkZWYgZ2V0SnVuY3Rpb25JZChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYldpcmVEZWNvZGVyX2dldEp1bmN0aW9uSWQoc2VsZikKCiAgICBkZWYgZ2V0SnVuY3Rpb25WYWx1ZShzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYldpcmVEZWNvZGVyX2dldEp1bmN0aW9uVmFsdWUoc2VsZikKCiAgICBkZWYgZ2V0Q29sb3Ioc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJXaXJlRGVjb2Rlcl9nZXRDb2xvcihzZWxmKQoKICAgIGRlZiBnZXRWaWFDb2xvcihzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYldpcmVEZWNvZGVyX2dldFZpYUNvbG9yKHNlbGYpCgojIFJlZ2lzdGVyIGRiV2lyZURlY29kZXIgaW4gX29kYl9weToKX29kYl9weS5kYldpcmVEZWNvZGVyX3N3aWdyZWdpc3RlcihkYldpcmVEZWNvZGVyKQoKCmRlZiBkdW1wRGVjb2RlcihpbmJsaywgbmV0X25hbWVfb3JfaWQpOgogICAgcmV0dXJuIF9vZGJfcHkuZHVtcERlY29kZXIoaW5ibGssIG5ldF9uYW1lX29yX2lkKQoKZGVmIGR1bXBEZWNvZGVyNE5ldChpbm5ldCk6CiAgICByZXR1cm4gX29kYl9weS5kdW1wRGVjb2RlcjROZXQoaW5uZXQpCmNsYXNzIGRiQmxvY2tDYWxsQmFja09iaihvYmplY3QpOgogICAgdGhpc293biA9IHByb3BlcnR5KGxhbWJkYSB4OiB4LnRoaXMub3duKCksIGxhbWJkYSB4LCB2OiB4LnRoaXMub3duKHYpLCBkb2M9J1RoZSBtZW1iZXJzaGlwIGZsYWcnKQogICAgX19yZXByX18gPSBfc3dpZ19yZXByCgogICAgZGVmIGluRGJJbnN0Q3JlYXRlKHNlbGYsICphcmdzKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkJsb2NrQ2FsbEJhY2tPYmpfaW5EYkluc3RDcmVhdGUoc2VsZiwgKmFyZ3MpCgogICAgZGVmIGluRGJJbnN0RGVzdHJveShzZWxmLCBhcmcyKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkJsb2NrQ2FsbEJhY2tPYmpfaW5EYkluc3REZXN0cm95KHNlbGYsIGFyZzIpCgogICAgZGVmIGluRGJJbnN0UGxhY2VtZW50U3RhdHVzQmVmb3JlKHNlbGYsIGFyZzIsIGFyZzMpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQmxvY2tDYWxsQmFja09ial9pbkRiSW5zdFBsYWNlbWVudFN0YXR1c0JlZm9yZShzZWxmLCBhcmcyLCBhcmczKQoKICAgIGRlZiBpbkRiSW5zdFN3YXBNYXN0ZXJCZWZvcmUoc2VsZiwgYXJnMiwgYXJnMyk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJCbG9ja0NhbGxCYWNrT2JqX2luRGJJbnN0U3dhcE1hc3RlckJlZm9yZShzZWxmLCBhcmcyLCBhcmczKQoKICAgIGRlZiBpbkRiSW5zdFN3YXBNYXN0ZXJBZnRlcihzZWxmLCBhcmcyKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkJsb2NrQ2FsbEJhY2tPYmpfaW5EYkluc3RTd2FwTWFzdGVyQWZ0ZXIoc2VsZiwgYXJnMikKCiAgICBkZWYgaW5EYlByZU1vdmVJbnN0KHNlbGYsIGFyZzIpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQmxvY2tDYWxsQmFja09ial9pbkRiUHJlTW92ZUluc3Qoc2VsZiwgYXJnMikKCiAgICBkZWYgaW5EYlBvc3RNb3ZlSW5zdChzZWxmLCBhcmcyKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkJsb2NrQ2FsbEJhY2tPYmpfaW5EYlBvc3RNb3ZlSW5zdChzZWxmLCBhcmcyKQoKICAgIGRlZiBpbkRiTW9kSW5zdENyZWF0ZShzZWxmLCBhcmcyKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkJsb2NrQ2FsbEJhY2tPYmpfaW5EYk1vZEluc3RDcmVhdGUoc2VsZiwgYXJnMikKCiAgICBkZWYgaW5EYk1vZEluc3REZXN0cm95KHNlbGYsIGFyZzIpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQmxvY2tDYWxsQmFja09ial9pbkRiTW9kSW5zdERlc3Ryb3koc2VsZiwgYXJnMikKCiAgICBkZWYgaW5EYk1vZHVsZUNyZWF0ZShzZWxmLCBhcmcyKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkJsb2NrQ2FsbEJhY2tPYmpfaW5EYk1vZHVsZUNyZWF0ZShzZWxmLCBhcmcyKQoKICAgIGRlZiBpbkRiTW9kdWxlRGVzdHJveShzZWxmLCBhcmcyKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkJsb2NrQ2FsbEJhY2tPYmpfaW5EYk1vZHVsZURlc3Ryb3koc2VsZiwgYXJnMikKCiAgICBkZWYgaW5EYk5ldENyZWF0ZShzZWxmLCBhcmcyKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkJsb2NrQ2FsbEJhY2tPYmpfaW5EYk5ldENyZWF0ZShzZWxmLCBhcmcyKQoKICAgIGRlZiBpbkRiTmV0RGVzdHJveShzZWxmLCBhcmcyKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkJsb2NrQ2FsbEJhY2tPYmpfaW5EYk5ldERlc3Ryb3koc2VsZiwgYXJnMikKCiAgICBkZWYgaW5EYk5ldFByZU1lcmdlKHNlbGYsIGFyZzIsIGFyZzMpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQmxvY2tDYWxsQmFja09ial9pbkRiTmV0UHJlTWVyZ2Uoc2VsZiwgYXJnMiwgYXJnMykKCiAgICBkZWYgaW5EYk1vZE5ldENyZWF0ZShzZWxmLCBhcmcyKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkJsb2NrQ2FsbEJhY2tPYmpfaW5EYk1vZE5ldENyZWF0ZShzZWxmLCBhcmcyKQoKICAgIGRlZiBpbkRiTW9kTmV0RGVzdHJveShzZWxmLCBhcmcyKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkJsb2NrQ2FsbEJhY2tPYmpfaW5EYk1vZE5ldERlc3Ryb3koc2VsZiwgYXJnMikKCiAgICBkZWYgaW5EYklUZXJtQ3JlYXRlKHNlbGYsIGFyZzIpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQmxvY2tDYWxsQmFja09ial9pbkRiSVRlcm1DcmVhdGUoc2VsZiwgYXJnMikKCiAgICBkZWYgaW5EYklUZXJtRGVzdHJveShzZWxmLCBhcmcyKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkJsb2NrQ2FsbEJhY2tPYmpfaW5EYklUZXJtRGVzdHJveShzZWxmLCBhcmcyKQoKICAgIGRlZiBpbkRiSVRlcm1QcmVEaXNjb25uZWN0KHNlbGYsIGFyZzIpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQmxvY2tDYWxsQmFja09ial9pbkRiSVRlcm1QcmVEaXNjb25uZWN0KHNlbGYsIGFyZzIpCgogICAgZGVmIGluRGJJVGVybVBvc3REaXNjb25uZWN0KHNlbGYsIGFyZzIsIGFyZzMpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQmxvY2tDYWxsQmFja09ial9pbkRiSVRlcm1Qb3N0RGlzY29ubmVjdChzZWxmLCBhcmcyLCBhcmczKQoKICAgIGRlZiBpbkRiSVRlcm1QcmVDb25uZWN0KHNlbGYsIGFyZzIsIGFyZzMpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQmxvY2tDYWxsQmFja09ial9pbkRiSVRlcm1QcmVDb25uZWN0KHNlbGYsIGFyZzIsIGFyZzMpCgogICAgZGVmIGluRGJJVGVybVBvc3RDb25uZWN0KHNlbGYsIGFyZzIpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQmxvY2tDYWxsQmFja09ial9pbkRiSVRlcm1Qb3N0Q29ubmVjdChzZWxmLCBhcmcyKQoKICAgIGRlZiBpbkRiSVRlcm1Qb3N0U2V0QWNjZXNzUG9pbnRzKHNlbGYsIGFyZzIpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQmxvY2tDYWxsQmFja09ial9pbkRiSVRlcm1Qb3N0U2V0QWNjZXNzUG9pbnRzKHNlbGYsIGFyZzIpCgogICAgZGVmIGluRGJNb2RJVGVybUNyZWF0ZShzZWxmLCBhcmcyKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkJsb2NrQ2FsbEJhY2tPYmpfaW5EYk1vZElUZXJtQ3JlYXRlKHNlbGYsIGFyZzIpCgogICAgZGVmIGluRGJNb2RJVGVybURlc3Ryb3koc2VsZiwgYXJnMik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJCbG9ja0NhbGxCYWNrT2JqX2luRGJNb2RJVGVybURlc3Ryb3koc2VsZiwgYXJnMikKCiAgICBkZWYgaW5EYk1vZElUZXJtUHJlRGlzY29ubmVjdChzZWxmLCBhcmcyKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkJsb2NrQ2FsbEJhY2tPYmpfaW5EYk1vZElUZXJtUHJlRGlzY29ubmVjdChzZWxmLCBhcmcyKQoKICAgIGRlZiBpbkRiTW9kSVRlcm1Qb3N0RGlzY29ubmVjdChzZWxmLCBhcmcyLCBhcmczKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkJsb2NrQ2FsbEJhY2tPYmpfaW5EYk1vZElUZXJtUG9zdERpc2Nvbm5lY3Qoc2VsZiwgYXJnMiwgYXJnMykKCiAgICBkZWYgaW5EYk1vZElUZXJtUHJlQ29ubmVjdChzZWxmLCBhcmcyLCBhcmczKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkJsb2NrQ2FsbEJhY2tPYmpfaW5EYk1vZElUZXJtUHJlQ29ubmVjdChzZWxmLCBhcmcyLCBhcmczKQoKICAgIGRlZiBpbkRiTW9kSVRlcm1Qb3N0Q29ubmVjdChzZWxmLCBhcmcyKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkJsb2NrQ2FsbEJhY2tPYmpfaW5EYk1vZElUZXJtUG9zdENvbm5lY3Qoc2VsZiwgYXJnMikKCiAgICBkZWYgaW5EYkJUZXJtQ3JlYXRlKHNlbGYsIGFyZzIpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQmxvY2tDYWxsQmFja09ial9pbkRiQlRlcm1DcmVhdGUoc2VsZiwgYXJnMikKCiAgICBkZWYgaW5EYkJUZXJtRGVzdHJveShzZWxmLCBhcmcyKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkJsb2NrQ2FsbEJhY2tPYmpfaW5EYkJUZXJtRGVzdHJveShzZWxmLCBhcmcyKQoKICAgIGRlZiBpbkRiQlRlcm1QcmVDb25uZWN0KHNlbGYsIGFyZzIsIGFyZzMpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQmxvY2tDYWxsQmFja09ial9pbkRiQlRlcm1QcmVDb25uZWN0KHNlbGYsIGFyZzIsIGFyZzMpCgogICAgZGVmIGluRGJCVGVybVBvc3RDb25uZWN0KHNlbGYsIGFyZzIpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQmxvY2tDYWxsQmFja09ial9pbkRiQlRlcm1Qb3N0Q29ubmVjdChzZWxmLCBhcmcyKQoKICAgIGRlZiBpbkRiQlRlcm1QcmVEaXNjb25uZWN0KHNlbGYsIGFyZzIpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQmxvY2tDYWxsQmFja09ial9pbkRiQlRlcm1QcmVEaXNjb25uZWN0KHNlbGYsIGFyZzIpCgogICAgZGVmIGluRGJCVGVybVBvc3REaXNDb25uZWN0KHNlbGYsIGFyZzIsIGFyZzMpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQmxvY2tDYWxsQmFja09ial9pbkRiQlRlcm1Qb3N0RGlzQ29ubmVjdChzZWxmLCBhcmcyLCBhcmczKQoKICAgIGRlZiBpbkRiQlRlcm1TZXRJb1R5cGUoc2VsZiwgYXJnMiwgYXJnMyk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJCbG9ja0NhbGxCYWNrT2JqX2luRGJCVGVybVNldElvVHlwZShzZWxmLCBhcmcyLCBhcmczKQoKICAgIGRlZiBpbkRiQlRlcm1TZXRTaWdUeXBlKHNlbGYsIGFyZzIsIGFyZzMpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQmxvY2tDYWxsQmFja09ial9pbkRiQlRlcm1TZXRTaWdUeXBlKHNlbGYsIGFyZzIsIGFyZzMpCgogICAgZGVmIGluRGJNb2RCVGVybUNyZWF0ZShzZWxmLCBhcmcyKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkJsb2NrQ2FsbEJhY2tPYmpfaW5EYk1vZEJUZXJtQ3JlYXRlKHNlbGYsIGFyZzIpCgogICAgZGVmIGluRGJNb2RCVGVybURlc3Ryb3koc2VsZiwgYXJnMik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJCbG9ja0NhbGxCYWNrT2JqX2luRGJNb2RCVGVybURlc3Ryb3koc2VsZiwgYXJnMikKCiAgICBkZWYgaW5EYk1vZEJUZXJtUHJlQ29ubmVjdChzZWxmLCBhcmcyLCBhcmczKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkJsb2NrQ2FsbEJhY2tPYmpfaW5EYk1vZEJUZXJtUHJlQ29ubmVjdChzZWxmLCBhcmcyLCBhcmczKQoKICAgIGRlZiBpbkRiTW9kQlRlcm1Qb3N0Q29ubmVjdChzZWxmLCBhcmcyKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkJsb2NrQ2FsbEJhY2tPYmpfaW5EYk1vZEJUZXJtUG9zdENvbm5lY3Qoc2VsZiwgYXJnMikKCiAgICBkZWYgaW5EYk1vZEJUZXJtUHJlRGlzY29ubmVjdChzZWxmLCBhcmcyKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkJsb2NrQ2FsbEJhY2tPYmpfaW5EYk1vZEJUZXJtUHJlRGlzY29ubmVjdChzZWxmLCBhcmcyKQoKICAgIGRlZiBpbkRiTW9kQlRlcm1Qb3N0RGlzQ29ubmVjdChzZWxmLCBhcmcyLCBhcmczKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkJsb2NrQ2FsbEJhY2tPYmpfaW5EYk1vZEJUZXJtUG9zdERpc0Nvbm5lY3Qoc2VsZiwgYXJnMiwgYXJnMykKCiAgICBkZWYgaW5EYkJQaW5DcmVhdGUoc2VsZiwgYXJnMik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJCbG9ja0NhbGxCYWNrT2JqX2luRGJCUGluQ3JlYXRlKHNlbGYsIGFyZzIpCgogICAgZGVmIGluRGJCUGluRGVzdHJveShzZWxmLCBhcmcyKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkJsb2NrQ2FsbEJhY2tPYmpfaW5EYkJQaW5EZXN0cm95KHNlbGYsIGFyZzIpCgogICAgZGVmIGluRGJCbG9ja2FnZUNyZWF0ZShzZWxmLCBhcmcyKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkJsb2NrQ2FsbEJhY2tPYmpfaW5EYkJsb2NrYWdlQ3JlYXRlKHNlbGYsIGFyZzIpCgogICAgZGVmIGluRGJCbG9ja2FnZURlc3Ryb3koc2VsZiwgYXJnMik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJCbG9ja0NhbGxCYWNrT2JqX2luRGJCbG9ja2FnZURlc3Ryb3koc2VsZiwgYXJnMikKCiAgICBkZWYgaW5EYk9ic3RydWN0aW9uQ3JlYXRlKHNlbGYsIGFyZzIpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQmxvY2tDYWxsQmFja09ial9pbkRiT2JzdHJ1Y3Rpb25DcmVhdGUoc2VsZiwgYXJnMikKCiAgICBkZWYgaW5EYk9ic3RydWN0aW9uRGVzdHJveShzZWxmLCBhcmcyKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkJsb2NrQ2FsbEJhY2tPYmpfaW5EYk9ic3RydWN0aW9uRGVzdHJveShzZWxmLCBhcmcyKQoKICAgIGRlZiBpbkRiUmVnaW9uQ3JlYXRlKHNlbGYsIGFyZzIpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQmxvY2tDYWxsQmFja09ial9pbkRiUmVnaW9uQ3JlYXRlKHNlbGYsIGFyZzIpCgogICAgZGVmIGluRGJSZWdpb25BZGRCb3goc2VsZiwgYXJnMiwgYXJnMyk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJCbG9ja0NhbGxCYWNrT2JqX2luRGJSZWdpb25BZGRCb3goc2VsZiwgYXJnMiwgYXJnMykKCiAgICBkZWYgaW5EYlJlZ2lvbkRlc3Ryb3koc2VsZiwgYXJnMik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJCbG9ja0NhbGxCYWNrT2JqX2luRGJSZWdpb25EZXN0cm95KHNlbGYsIGFyZzIpCgogICAgZGVmIGluRGJSb3dDcmVhdGUoc2VsZiwgYXJnMik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJCbG9ja0NhbGxCYWNrT2JqX2luRGJSb3dDcmVhdGUoc2VsZiwgYXJnMikKCiAgICBkZWYgaW5EYlJvd0Rlc3Ryb3koc2VsZiwgYXJnMik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJCbG9ja0NhbGxCYWNrT2JqX2luRGJSb3dEZXN0cm95KHNlbGYsIGFyZzIpCgogICAgZGVmIGluRGJXaXJlQ3JlYXRlKHNlbGYsIGFyZzIpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQmxvY2tDYWxsQmFja09ial9pbkRiV2lyZUNyZWF0ZShzZWxmLCBhcmcyKQoKICAgIGRlZiBpbkRiV2lyZURlc3Ryb3koc2VsZiwgYXJnMik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJCbG9ja0NhbGxCYWNrT2JqX2luRGJXaXJlRGVzdHJveShzZWxmLCBhcmcyKQoKICAgIGRlZiBpbkRiV2lyZVBvc3RNb2RpZnkoc2VsZiwgYXJnMik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJCbG9ja0NhbGxCYWNrT2JqX2luRGJXaXJlUG9zdE1vZGlmeShzZWxmLCBhcmcyKQoKICAgIGRlZiBpbkRiV2lyZVByZUF0dGFjaChzZWxmLCBhcmcyLCBhcmczKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkJsb2NrQ2FsbEJhY2tPYmpfaW5EYldpcmVQcmVBdHRhY2goc2VsZiwgYXJnMiwgYXJnMykKCiAgICBkZWYgaW5EYldpcmVQb3N0QXR0YWNoKHNlbGYsIGFyZzIpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQmxvY2tDYWxsQmFja09ial9pbkRiV2lyZVBvc3RBdHRhY2goc2VsZiwgYXJnMikKCiAgICBkZWYgaW5EYldpcmVQcmVEZXRhY2goc2VsZiwgYXJnMik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJCbG9ja0NhbGxCYWNrT2JqX2luRGJXaXJlUHJlRGV0YWNoKHNlbGYsIGFyZzIpCgogICAgZGVmIGluRGJXaXJlUG9zdERldGFjaChzZWxmLCBhcmcyLCBhcmczKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkJsb2NrQ2FsbEJhY2tPYmpfaW5EYldpcmVQb3N0RGV0YWNoKHNlbGYsIGFyZzIsIGFyZzMpCgogICAgZGVmIGluRGJXaXJlUHJlQXBwZW5kKHNlbGYsIGFyZzIsIGFyZzMpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQmxvY2tDYWxsQmFja09ial9pbkRiV2lyZVByZUFwcGVuZChzZWxmLCBhcmcyLCBhcmczKQoKICAgIGRlZiBpbkRiV2lyZVBvc3RBcHBlbmQoc2VsZiwgYXJnMiwgYXJnMyk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJCbG9ja0NhbGxCYWNrT2JqX2luRGJXaXJlUG9zdEFwcGVuZChzZWxmLCBhcmcyLCBhcmczKQoKICAgIGRlZiBpbkRiV2lyZVByZUNvcHkoc2VsZiwgYXJnMiwgYXJnMyk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJCbG9ja0NhbGxCYWNrT2JqX2luRGJXaXJlUHJlQ29weShzZWxmLCBhcmcyLCBhcmczKQoKICAgIGRlZiBpbkRiV2lyZVBvc3RDb3B5KHNlbGYsIGFyZzIsIGFyZzMpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQmxvY2tDYWxsQmFja09ial9pbkRiV2lyZVBvc3RDb3B5KHNlbGYsIGFyZzIsIGFyZzMpCgogICAgZGVmIGluRGJTV2lyZUNyZWF0ZShzZWxmLCBhcmcyKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkJsb2NrQ2FsbEJhY2tPYmpfaW5EYlNXaXJlQ3JlYXRlKHNlbGYsIGFyZzIpCgogICAgZGVmIGluRGJTV2lyZURlc3Ryb3koc2VsZiwgYXJnMik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJCbG9ja0NhbGxCYWNrT2JqX2luRGJTV2lyZURlc3Ryb3koc2VsZiwgYXJnMikKCiAgICBkZWYgaW5EYlNXaXJlQWRkU0JveChzZWxmLCBhcmcyKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkJsb2NrQ2FsbEJhY2tPYmpfaW5EYlNXaXJlQWRkU0JveChzZWxmLCBhcmcyKQoKICAgIGRlZiBpbkRiU1dpcmVSZW1vdmVTQm94KHNlbGYsIGFyZzIpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQmxvY2tDYWxsQmFja09ial9pbkRiU1dpcmVSZW1vdmVTQm94KHNlbGYsIGFyZzIpCgogICAgZGVmIGluRGJTV2lyZVByZURlc3Ryb3lTQm94ZXMoc2VsZiwgYXJnMik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJCbG9ja0NhbGxCYWNrT2JqX2luRGJTV2lyZVByZURlc3Ryb3lTQm94ZXMoc2VsZiwgYXJnMikKCiAgICBkZWYgaW5EYlNXaXJlUG9zdERlc3Ryb3lTQm94ZXMoc2VsZiwgYXJnMik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJCbG9ja0NhbGxCYWNrT2JqX2luRGJTV2lyZVBvc3REZXN0cm95U0JveGVzKHNlbGYsIGFyZzIpCgogICAgZGVmIGluRGJGaWxsQ3JlYXRlKHNlbGYsIGFyZzIpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQmxvY2tDYWxsQmFja09ial9pbkRiRmlsbENyZWF0ZShzZWxmLCBhcmcyKQoKICAgIGRlZiBpbkRiTWFya2VyQ2F0ZWdvcnlDcmVhdGUoc2VsZiwgYXJnMik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJCbG9ja0NhbGxCYWNrT2JqX2luRGJNYXJrZXJDYXRlZ29yeUNyZWF0ZShzZWxmLCBhcmcyKQoKICAgIGRlZiBpbkRiTWFya2VyQ2F0ZWdvcnlEZXN0cm95KHNlbGYsIGFyZzIpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQmxvY2tDYWxsQmFja09ial9pbkRiTWFya2VyQ2F0ZWdvcnlEZXN0cm95KHNlbGYsIGFyZzIpCgogICAgZGVmIGluRGJNYXJrZXJDcmVhdGUoc2VsZiwgYXJnMik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJCbG9ja0NhbGxCYWNrT2JqX2luRGJNYXJrZXJDcmVhdGUoc2VsZiwgYXJnMikKCiAgICBkZWYgaW5EYk1hcmtlckRlc3Ryb3koc2VsZiwgYXJnMik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJCbG9ja0NhbGxCYWNrT2JqX2luRGJNYXJrZXJEZXN0cm95KHNlbGYsIGFyZzIpCgogICAgZGVmIGluRGJCbG9ja1N0cmVhbU91dEJlZm9yZShzZWxmLCBhcmcyKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkJsb2NrQ2FsbEJhY2tPYmpfaW5EYkJsb2NrU3RyZWFtT3V0QmVmb3JlKHNlbGYsIGFyZzIpCgogICAgZGVmIGluRGJCbG9ja1N0cmVhbU91dEFmdGVyKHNlbGYsIGFyZzIpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQmxvY2tDYWxsQmFja09ial9pbkRiQmxvY2tTdHJlYW1PdXRBZnRlcihzZWxmLCBhcmcyKQoKICAgIGRlZiBpbkRiQmxvY2tSZWFkTmV0c0JlZm9yZShzZWxmLCBhcmcyKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkJsb2NrQ2FsbEJhY2tPYmpfaW5EYkJsb2NrUmVhZE5ldHNCZWZvcmUoc2VsZiwgYXJnMikKCiAgICBkZWYgaW5EYkJsb2NrU2V0RGllQXJlYShzZWxmLCBhcmcyKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkJsb2NrQ2FsbEJhY2tPYmpfaW5EYkJsb2NrU2V0RGllQXJlYShzZWxmLCBhcmcyKQoKICAgIGRlZiBpbkRiQmxvY2tTZXRDb3JlQXJlYShzZWxmLCBhcmcyKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkJsb2NrQ2FsbEJhY2tPYmpfaW5EYkJsb2NrU2V0Q29yZUFyZWEoc2VsZiwgYXJnMikKCiAgICBkZWYgX19jYWxsX18oc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJCbG9ja0NhbGxCYWNrT2JqX19fY2FsbF9fKHNlbGYpCgogICAgZGVmIGFkZE93bmVyKHNlbGYsIG5ld19vd25lcik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJCbG9ja0NhbGxCYWNrT2JqX2FkZE93bmVyKHNlbGYsIG5ld19vd25lcikKCiAgICBkZWYgaGFzT3duZXIoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJCbG9ja0NhbGxCYWNrT2JqX2hhc093bmVyKHNlbGYpCgogICAgZGVmIHJlbW92ZU93bmVyKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiQmxvY2tDYWxsQmFja09ial9yZW1vdmVPd25lcihzZWxmKQoKICAgIGRlZiBfX2luaXRfXyhzZWxmKToKICAgICAgICBfb2RiX3B5LmRiQmxvY2tDYWxsQmFja09ial9zd2lnaW5pdChzZWxmLCBfb2RiX3B5Lm5ld19kYkJsb2NrQ2FsbEJhY2tPYmooKSkKICAgIF9fc3dpZ19kZXN0cm95X18gPSBfb2RiX3B5LmRlbGV0ZV9kYkJsb2NrQ2FsbEJhY2tPYmoKCiMgUmVnaXN0ZXIgZGJCbG9ja0NhbGxCYWNrT2JqIGluIF9vZGJfcHk6Cl9vZGJfcHkuZGJCbG9ja0NhbGxCYWNrT2JqX3N3aWdyZWdpc3RlcihkYkJsb2NrQ2FsbEJhY2tPYmopCgpjbGFzcyBkYkl0ZXJhdG9yKG9iamVjdCk6CiAgICB0aGlzb3duID0gcHJvcGVydHkobGFtYmRhIHg6IHgudGhpcy5vd24oKSwgbGFtYmRhIHgsIHY6IHgudGhpcy5vd24odiksIGRvYz0nVGhlIG1lbWJlcnNoaXAgZmxhZycpCgogICAgZGVmIF9faW5pdF9fKHNlbGYsICphcmdzLCAqKmt3YXJncyk6CiAgICAgICAgcmFpc2UgQXR0cmlidXRlRXJyb3IoIk5vIGNvbnN0cnVjdG9yIGRlZmluZWQgLSBjbGFzcyBpcyBhYnN0cmFjdCIpCiAgICBfX3JlcHJfXyA9IF9zd2lnX3JlcHIKCiAgICBkZWYgcmV2ZXJzaWJsZShzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkl0ZXJhdG9yX3JldmVyc2libGUoc2VsZikKCiAgICBkZWYgb3JkZXJSZXZlcnNlZChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkl0ZXJhdG9yX29yZGVyUmV2ZXJzZWQoc2VsZikKCiAgICBkZWYgcmV2ZXJzZShzZWxmLCBwYXJlbnQpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiSXRlcmF0b3JfcmV2ZXJzZShzZWxmLCBwYXJlbnQpCgogICAgZGVmIHNlcXVlbnRpYWwoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJJdGVyYXRvcl9zZXF1ZW50aWFsKHNlbGYpCgogICAgZGVmIHNpemUoc2VsZiwgcGFyZW50KToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkl0ZXJhdG9yX3NpemUoc2VsZiwgcGFyZW50KQoKICAgIGRlZiBiZWdpbihzZWxmLCBwYXJlbnQpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiSXRlcmF0b3JfYmVnaW4oc2VsZiwgcGFyZW50KQoKICAgIGRlZiBlbmQoc2VsZiwgcGFyZW50KToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkl0ZXJhdG9yX2VuZChzZWxmLCBwYXJlbnQpCgogICAgZGVmIG5leHQoc2VsZiwgaWQpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiSXRlcmF0b3JfbmV4dChzZWxmLCBpZCkKCiAgICBkZWYgZ2V0T2JqZWN0KHNlbGYsIGlkKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYkl0ZXJhdG9yX2dldE9iamVjdChzZWxmLCBpZCkKICAgIF9fc3dpZ19kZXN0cm95X18gPSBfb2RiX3B5LmRlbGV0ZV9kYkl0ZXJhdG9yCgojIFJlZ2lzdGVyIGRiSXRlcmF0b3IgaW4gX29kYl9weToKX29kYl9weS5kYkl0ZXJhdG9yX3N3aWdyZWdpc3RlcihkYkl0ZXJhdG9yKQoKY2xhc3MgZGJUcmFuc2Zvcm0ob2JqZWN0KToKICAgIHRoaXNvd24gPSBwcm9wZXJ0eShsYW1iZGEgeDogeC50aGlzLm93bigpLCBsYW1iZGEgeCwgdjogeC50aGlzLm93bih2KSwgZG9jPSdUaGUgbWVtYmVyc2hpcCBmbGFnJykKICAgIF9fcmVwcl9fID0gX3N3aWdfcmVwcgoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCAqYXJncyk6CiAgICAgICAgX29kYl9weS5kYlRyYW5zZm9ybV9zd2lnaW5pdChzZWxmLCBfb2RiX3B5Lm5ld19kYlRyYW5zZm9ybSgqYXJncykpCgogICAgZGVmIF9fZXFfXyhzZWxmLCB0KToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRyYW5zZm9ybV9fX2VxX18oc2VsZiwgdCkKCiAgICBkZWYgX19uZV9fKHNlbGYsIHQpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVHJhbnNmb3JtX19fbmVfXyhzZWxmLCB0KQoKICAgIGRlZiBzZXRPcmllbnQoc2VsZiwgb3JpZW50KToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRyYW5zZm9ybV9zZXRPcmllbnQoc2VsZiwgb3JpZW50KQoKICAgIGRlZiBzZXRPZmZzZXQoc2VsZiwgb2Zmc2V0KToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRyYW5zZm9ybV9zZXRPZmZzZXQoc2VsZiwgb2Zmc2V0KQoKICAgIGRlZiBzZXRUcmFuc2Zvcm0oc2VsZiwgb3JpZW50LCBvZmZzZXQpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVHJhbnNmb3JtX3NldFRyYW5zZm9ybShzZWxmLCBvcmllbnQsIG9mZnNldCkKCiAgICBkZWYgYXBwbHkoc2VsZiwgKmFyZ3MpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVHJhbnNmb3JtX2FwcGx5KHNlbGYsICphcmdzKQoKICAgIGRlZiBjb25jYXQoc2VsZiwgKmFyZ3MpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVHJhbnNmb3JtX2NvbmNhdChzZWxmLCAqYXJncykKCiAgICBkZWYgaW52ZXJ0KHNlbGYsICphcmdzKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRyYW5zZm9ybV9pbnZlcnQoc2VsZiwgKmFyZ3MpCgogICAgZGVmIGdldE9yaWVudChzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYlRyYW5zZm9ybV9nZXRPcmllbnQoc2VsZikKCiAgICBkZWYgZ2V0T2Zmc2V0KHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiVHJhbnNmb3JtX2dldE9mZnNldChzZWxmKQogICAgX19zd2lnX2Rlc3Ryb3lfXyA9IF9vZGJfcHkuZGVsZXRlX2RiVHJhbnNmb3JtCgojIFJlZ2lzdGVyIGRiVHJhbnNmb3JtIGluIF9vZGJfcHk6Cl9vZGJfcHkuZGJUcmFuc2Zvcm1fc3dpZ3JlZ2lzdGVyKGRiVHJhbnNmb3JtKQoKCmRlZiBfX2xzaGlmdF9fKCphcmdzKToKICAgIHJldHVybiBfb2RiX3B5Ll9fbHNoaWZ0X18oKmFyZ3MpCgpkZWYgX19yc2hpZnRfXygqYXJncyk6CiAgICByZXR1cm4gX29kYl9weS5fX3JzaGlmdF9fKCphcmdzKQpjbGFzcyBkYldpcmVHcmFwaChvYmplY3QpOgogICAgdGhpc293biA9IHByb3BlcnR5KGxhbWJkYSB4OiB4LnRoaXMub3duKCksIGxhbWJkYSB4LCB2OiB4LnRoaXMub3duKHYpLCBkb2M9J1RoZSBtZW1iZXJzaGlwIGZsYWcnKQogICAgX19yZXByX18gPSBfc3dpZ19yZXByCgogICAgZGVmIF9faW5pdF9fKHNlbGYpOgogICAgICAgIF9vZGJfcHkuZGJXaXJlR3JhcGhfc3dpZ2luaXQoc2VsZiwgX29kYl9weS5uZXdfZGJXaXJlR3JhcGgoKSkKICAgIF9fc3dpZ19kZXN0cm95X18gPSBfb2RiX3B5LmRlbGV0ZV9kYldpcmVHcmFwaAoKICAgIGRlZiBjbGVhcihzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYldpcmVHcmFwaF9jbGVhcihzZWxmKQoKICAgIGRlZiBkZWNvZGUoc2VsZiwgd2lyZSk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJXaXJlR3JhcGhfZGVjb2RlKHNlbGYsIHdpcmUpCgogICAgZGVmIGVuY29kZShzZWxmLCB3aXJlKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYldpcmVHcmFwaF9lbmNvZGUoc2VsZiwgd2lyZSkKCiAgICBkZWYgZ2V0RWRnZShzZWxmLCBzaGFwZV9pZCk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJXaXJlR3JhcGhfZ2V0RWRnZShzZWxmLCBzaGFwZV9pZCkKCiAgICBkZWYgY3JlYXRlTm9kZShzZWxmLCB4LCB5LCBsKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYldpcmVHcmFwaF9jcmVhdGVOb2RlKHNlbGYsIHgsIHksIGwpCgogICAgZGVmIGNyZWF0ZVZpYShzZWxmLCAqYXJncyk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJXaXJlR3JhcGhfY3JlYXRlVmlhKHNlbGYsICphcmdzKQoKICAgIGRlZiBjcmVhdGVUZWNoVmlhKHNlbGYsICphcmdzKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYldpcmVHcmFwaF9jcmVhdGVUZWNoVmlhKHNlbGYsICphcmdzKQoKICAgIGRlZiBjcmVhdGVTZWdtZW50KHNlbGYsICphcmdzKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYldpcmVHcmFwaF9jcmVhdGVTZWdtZW50KHNlbGYsICphcmdzKQoKICAgIGRlZiBjcmVhdGVTaG9ydChzZWxmLCAqYXJncyk6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJXaXJlR3JhcGhfY3JlYXRlU2hvcnQoc2VsZiwgKmFyZ3MpCgogICAgZGVmIGNyZWF0ZVZXaXJlKHNlbGYsICphcmdzKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYldpcmVHcmFwaF9jcmVhdGVWV2lyZShzZWxmLCAqYXJncykKCiAgICBkZWYgYmVnaW5fbm9kZXMoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJXaXJlR3JhcGhfYmVnaW5fbm9kZXMoc2VsZikKCiAgICBkZWYgZW5kX25vZGVzKHNlbGYpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiV2lyZUdyYXBoX2VuZF9ub2RlcyhzZWxmKQoKICAgIGRlZiBiZWdpbl9lZGdlcyhzZWxmKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYldpcmVHcmFwaF9iZWdpbl9lZGdlcyhzZWxmKQoKICAgIGRlZiBlbmRfZWRnZXMoc2VsZik6CiAgICAgICAgcmV0dXJuIF9vZGJfcHkuZGJXaXJlR3JhcGhfZW5kX2VkZ2VzKHNlbGYpCgogICAgZGVmIGRlbGV0ZU5vZGUoc2VsZiwgKmFyZ3MpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiV2lyZUdyYXBoX2RlbGV0ZU5vZGUoc2VsZiwgKmFyZ3MpCgogICAgZGVmIGRlbGV0ZUVkZ2Uoc2VsZiwgKmFyZ3MpOgogICAgICAgIHJldHVybiBfb2RiX3B5LmRiV2lyZUdyYXBoX2RlbGV0ZUVkZ2Uoc2VsZiwgKmFyZ3MpCgogICAgZGVmIGR1bXAoc2VsZiwgbG9nZ2VyKToKICAgICAgICByZXR1cm4gX29kYl9weS5kYldpcmVHcmFwaF9kdW1wKHNlbGYsIGxvZ2dlcikKCiMgUmVnaXN0ZXIgZGJXaXJlR3JhcGggaW4gX29kYl9weToKX29kYl9weS5kYldpcmVHcmFwaF9zd2lncmVnaXN0ZXIoZGJXaXJlR3JhcGgpCgoKZGVmIG9yZGVyV2lyZXMobG9nZ2VyLCBiKToKICAgIHJldHVybiBfb2RiX3B5Lm9yZGVyV2lyZXMobG9nZ2VyLCBiKQoKZGVmIGdlbmVyYXRlTWFjcm9QbGFjZW1lbnRTdHJpbmcoYmxvY2spOgogICAgcmV0dXJuIF9vZGJfcHkuZ2VuZXJhdGVNYWNyb1BsYWNlbWVudFN0cmluZyhibG9jaykKCmRlZiBzZXRfYnRlcm1fdG9wX2xheWVyX2dyaWQoYmxvY2ssIGxheWVyLCB4X3N0ZXAsIHlfc3RlcCwgcmVnaW9uLCB3aWR0aCwgaGVpZ2h0LCBrZWVwb3V0KToKICAgIHJldHVybiBfb2RiX3B5LnNldF9idGVybV90b3BfbGF5ZXJfZ3JpZChibG9jaywgbGF5ZXIsIHhfc3RlcCwgeV9zdGVwLCByZWdpb24sIHdpZHRoLCBoZWlnaHQsIGtlZXBvdXQpCgoK",
nullptr};
} // end namespace odb
