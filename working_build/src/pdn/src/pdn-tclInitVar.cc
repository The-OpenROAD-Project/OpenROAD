namespace pdn {
const char* pdn_tcl_inits[] = {
"IyBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogQlNELTMtQ2xhdXNlCiMgQ29weXJpZ2h0IChjKSAyMDIyLTIwMjUsIFRoZSBPcGVuUk9BRCBBdXRob3JzCgpzdGE6OmRlZmluZV9jbWRfYXJncyAicGRuZ2VuIiB7Wy1za2lwX3RyaW1dIFwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFstZG9udF9hZGRfcGluc10gXAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgWy1yZXNldF0gXAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgWy1yaXB1cF0gXAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgWy1yZXBvcnRfb25seV0gXAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgWy1jaGVja19vbmx5XSBcCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbLWZhaWxlZF92aWFfcmVwb3J0IGZpbGVdIFwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFstdmVyYm9zZV0KfSA7I2NoZWNrZXIgb2ZmCgpwcm9jIHBkbmdlbiB7IGFyZ3MgfSB7CiAgc3RhOjpwYXJzZV9rZXlfYXJncyAicGRuZ2VuIiBhcmdzIFwKICAgIGtleXMgey1mYWlsZWRfdmlhX3JlcG9ydH0gXAogICAgZmxhZ3Mgey1za2lwX3RyaW0gLWRvbnRfYWRkX3BpbnMgLXJlc2V0IC1yaXB1cCAtcmVwb3J0X29ubHkgLXZlcmJvc2UgLWNoZWNrX29ubHl9CgogIHN0YTo6Y2hlY2tfYXJnY19lcTAgInBkbmdlbiIgJGFyZ3MKCiAgaWYgeyBbb3JkOjpnZXRfZGJfYmxvY2tdID09ICJOVUxMIiB9IHsKICAgIHV0bDo6ZXJyb3IgUEROIDIgIk5vIGRlc2lnbiBibG9jayBmb3VuZC4iCiAgfQoKICBwZG46OmRlcHJlY2F0ZWQgZmxhZ3MgLXZlcmJvc2UKCiAgaWYgeyBbaW5mbyBleGlzdHMgZmxhZ3MoLXJlc2V0KV0gfSB7CiAgICBpZiB7IFthcnJheSBzaXplIGZsYWdzXSAhPSAxIH0gewogICAgICB1dGw6OmVycm9yIFBETiAxMDM3ICItcmVzZXQgZmxhZyBpcyBtdXR1YWxseSBleGNsdXNpdmUgdG8gYWxsIG90aGVyIGZsYWdzIgogICAgfQogICAgcGRuOjpyZXNldAogICAgcmV0dXJuCiAgfQogIGlmIHsgW2luZm8gZXhpc3RzIGZsYWdzKC1yaXB1cCldIH0gewogICAgaWYgeyBbYXJyYXkgc2l6ZSBmbGFnc10gIT0gMSB9IHsKICAgICAgdXRsOjplcnJvciBQRE4gMTAzOCAiLXJpcHVwIGZsYWcgaXMgbXV0dWFsbHkgZXhjbHVzaXZlIHRvIGFsbCBvdGhlciBmbGFncyIKICAgIH0KICAgIHBkbjo6cmlwX3VwCiAgICByZXR1cm4KICB9CiAgaWYgeyBbaW5mbyBleGlzdHMgZmxhZ3MoLXJlcG9ydF9vbmx5KV0gfSB7CiAgICBpZiB7IFthcnJheSBzaXplIGZsYWdzXSAhPSAxIH0gewogICAgICB1dGw6OmVycm9yIFBETiAxMDM5ICItcmVwb3J0X29ubHkgZmxhZyBpcyBtdXR1YWxseSBleGNsdXNpdmUgdG8gYWxsIG90aGVyIGZsYWdzIgogICAgfQogICAgcGRuOjpyZXBvcnQKICAgIHJldHVybgogIH0KICBpZiB7IFtpbmZvIGV4aXN0cyBmbGFncygtY2hlY2tfb25seSldIH0gewogICAgaWYgeyBbYXJyYXkgc2l6ZSBmbGFnc10gIT0gMSB9IHsKICAgICAgdXRsOjplcnJvciBQRE4gMTA0MCAiLWNoZWNrX29ubHkgZmxhZyBpcyBtdXR1YWxseSBleGNsdXNpdmUgdG8gYWxsIG90aGVyIGZsYWdzIgogICAgfQogICAgcGRuOjpjaGVja19zZXR1cAogICAgcmV0dXJuCiAgfQoKICBzZXQgdHJpbSBbZXhwciBbaW5mbyBleGlzdHMgZmxhZ3MoLXNraXBfdHJpbSldID09IDBdCiAgc2V0IGFkZF9waW5zIFtleHByIFtpbmZvIGV4aXN0cyBmbGFncygtZG9udF9hZGRfcGlucyldID09IDBdCgogIHNldCBmYWlsZWRfdmlhX3JlcG9ydCAiIgogIGlmIHsgW2luZm8gZXhpc3RzIGtleXMoLWZhaWxlZF92aWFfcmVwb3J0KV0gfSB7CiAgICBzZXQgZmFpbGVkX3ZpYV9yZXBvcnQgJGtleXMoLWZhaWxlZF92aWFfcmVwb3J0KQogIH0KCiAgcGRuOjpjaGVja19zZXR1cAogIHBkbjo6YnVpbGRfZ3JpZHMgJHRyaW0KICBwZG46OndyaXRlX3RvX2RiICRhZGRfcGlucyAkZmFpbGVkX3ZpYV9yZXBvcnQKICBwZG46OnJlc2V0X3NoYXBlcwp9CgpzdGE6OmRlZmluZV9jbWRfYXJncyAic2V0X3ZvbHRhZ2VfZG9tYWluIiB7LW5hbWUgZG9tYWluX25hbWUgXAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLXBvd2VyIHBvd2VyX25ldF9uYW1lIFwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC1ncm91bmQgZ3JvdW5kX25ldF9uYW1lIFwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFstcmVnaW9uIHJlZ2lvbl9uYW1lXSBcCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbLXNlY29uZGFyeV9wb3dlciBzZWNvbmRhcnlfcG93ZXJfbmV0X25hbWVdIFwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFstc3dpdGNoZWRfcG93ZXIgc3dpdGNoZWRfcG93ZXJfbmV0X25hbWVdfQoKcHJvYyBzZXRfdm9sdGFnZV9kb21haW4geyBhcmdzIH0gewogIHN0YTo6cGFyc2Vfa2V5X2FyZ3MgInNldF92b2x0YWdlX2RvbWFpbiIgYXJncyBcCiAgICBrZXlzIHstbmFtZSAtcmVnaW9uIC1wb3dlciAtZ3JvdW5kIC1zZWNvbmRhcnlfcG93ZXIgLXN3aXRjaGVkX3Bvd2VyfSBmbGFncyB7fQoKICBzdGE6OmNoZWNrX2FyZ2NfZXEwICJzZXRfdm9sdGFnZV9kb21haW4iICRhcmdzCgogIHBkbjo6Y2hlY2tfZGVzaWduX3N0YXRlICJzZXRfdm9sdGFnZV9kb21haW4iCgogIGlmIHsgIVtpbmZvIGV4aXN0cyBrZXlzKC1wb3dlcildIH0gewogICAgdXRsOjplcnJvciBQRE4gMTAwMSAiVGhlIC1wb3dlciBhcmd1bWVudCBpcyByZXF1aXJlZC4iCiAgfSBlbHNlIHsKICAgIHNldCBwd3IgW1tvcmQ6OmdldF9kYl9ibG9ja10gZmluZE5ldCAka2V5cygtcG93ZXIpXQogICAgaWYgeyAkcHdyID09ICJOVUxMIiB9IHsKICAgICAgdXRsOjplcnJvciBQRE4gMTAwMiAiVW5hYmxlIHRvIGZpbmQgcG93ZXIgbmV0OiAka2V5cygtcG93ZXIpIgogICAgfQogIH0KCiAgaWYgeyAhW2luZm8gZXhpc3RzIGtleXMoLWdyb3VuZCldIH0gewogICAgdXRsOjplcnJvciBQRE4gMTAwMyAiVGhlIC1ncm91bmQgYXJndW1lbnQgaXMgcmVxdWlyZWQuIgogIH0gZWxzZSB7CiAgICBzZXQgZ25kIFtbb3JkOjpnZXRfZGJfYmxvY2tdIGZpbmROZXQgJGtleXMoLWdyb3VuZCldCiAgICBpZiB7ICRnbmQgPT0gIk5VTEwiIH0gewogICAgICB1dGw6OmVycm9yIFBETiAxMDA0ICJVbmFibGUgdG8gZmluZCBncm91bmQgbmV0OiAka2V5cygtZ3JvdW5kKSIKICAgIH0KICB9CgogIHNldCByZWdpb24gIk5VTEwiCiAgc2V0IG5hbWUgIk5VTEwiCiAgaWYgeyBbaW5mbyBleGlzdHMga2V5cygtcmVnaW9uKV0gfSB7CiAgICBzZXQgcmVnaW9uIFtbb3JkOjpnZXRfZGJfYmxvY2tdIGZpbmRSZWdpb24gJGtleXMoLXJlZ2lvbildCiAgICBpZiB7ICRyZWdpb24gPT0gIk5VTEwiIH0gewogICAgICB1dGw6OmVycm9yIFBETiAxMDA1ICJVbmFibGUgdG8gZmluZCByZWdpb246ICRrZXlzKC1yZWdpb24pIgogICAgfQoKICAgIGlmIHsgW2luZm8gZXhpc3RzIGtleXMoLW5hbWUpXSB9IHsKICAgICAgc2V0IG5hbWUgW3Bkbjo6bW9kaWZ5X3ZvbHRhZ2VfZG9tYWluX25hbWUgJGtleXMoLW5hbWUpXQogICAgfSBlbHNlIHsKICAgICAgc2V0IG5hbWUgWyRyZWdpb24gZ2V0TmFtZV0KICAgIH0KICB9CgogIHNldCBzZWNvbmRhcnkge30KICBpZiB7IFtpbmZvIGV4aXN0cyBrZXlzKC1zZWNvbmRhcnlfcG93ZXIpXSB9IHsKICAgIGZvcmVhY2ggc25ldCAka2V5cygtc2Vjb25kYXJ5X3Bvd2VyKSB7CiAgICAgIHNldCBkYl9uZXQgW1tvcmQ6OmdldF9kYl9ibG9ja10gZmluZE5ldCAkc25ldF0KICAgICAgaWYgeyAkZGJfbmV0ID09ICJOVUxMIiB9IHsKICAgICAgICB1dGw6OmVycm9yIFBETiAxMDA2ICJVbmFibGUgdG8gZmluZCBzZWNvbmRhcnkgcG93ZXIgbmV0OiAkc25ldCIKICAgICAgfSBlbHNlIHsKICAgICAgICBsYXBwZW5kIHNlY29uZGFyeSAkZGJfbmV0CiAgICAgIH0KICAgIH0KICB9CgogIHNldCBzd2l0Y2hlZF9wb3dlciAiTlVMTCIKICBpZiB7IFtpbmZvIGV4aXN0cyBrZXlzKC1zd2l0Y2hlZF9wb3dlcildIH0gewogICAgc2V0IHN3aXRjaGVkX3Bvd2VyX25ldF9uYW1lICRrZXlzKC1zd2l0Y2hlZF9wb3dlcikKICAgIHNldCBzd2l0Y2hlZF9wb3dlciBbW29yZDo6Z2V0X2RiX2Jsb2NrXSBmaW5kTmV0ICRzd2l0Y2hlZF9wb3dlcl9uZXRfbmFtZV0KICAgIGlmIHsgJHN3aXRjaGVkX3Bvd2VyID09ICJOVUxMIiB9IHsKICAgICAgc2V0IHN3aXRjaGVkX3Bvd2VyIFtvZGI6OmRiTmV0X2NyZWF0ZSBbb3JkOjpnZXRfZGJfYmxvY2tdICRzd2l0Y2hlZF9wb3dlcl9uZXRfbmFtZV0KICAgICAgJHN3aXRjaGVkX3Bvd2VyIHNldFNwZWNpYWwKICAgICAgJHN3aXRjaGVkX3Bvd2VyIHNldFNpZ1R5cGUgUE9XRVIKICAgIH0gZWxzZSB7CiAgICAgIHNldCBzaWduYWxfdHlwZSBbJHN3aXRjaGVkX3Bvd2VyIGdldFNpZ1R5cGVdCiAgICAgIGlmIHsgJHNpZ25hbF90eXBlICE9ICJQT1dFUiIgfSB7CiAgICAgICAgdXRsOjplcnJvciBQRE4gMjEyICJOZXQgJHN3aXRjaGVkX3Bvd2VyX25ldF9uYW1lIGFscmVhZHkgZXhpc3RzIGluIHRoZSBkZXNpZ24sXAogICAgICAgICAgYnV0IGlzIG9mIHNpZ25hbCB0eXBlICR7c2lnbmFsX3R5cGV9LiIKICAgICAgfQogICAgfQogIH0KCiAgaWYgeyAkcmVnaW9uID09ICJOVUxMIiB9IHsKICAgIGlmIHsgW2luZm8gZXhpc3RzIGtleXMoLW5hbWUpXSAmJiBbcGRuOjptb2RpZnlfdm9sdGFnZV9kb21haW5fbmFtZSAka2V5cygtbmFtZSldICE9ICJDb3JlIiB9IHsKICAgICAgdXRsOjp3YXJuIFBETiAxMDQyICJDb3JlIHZvbHRhZ2UgZG9tYWluIHdpbGwgYmUgbmFtZWQgXCJDb3JlXCIuIgogICAgfQogICAgcGRuOjpzZXRfY29yZV9kb21haW4gJHB3ciAkc3dpdGNoZWRfcG93ZXIgJGduZCAkc2Vjb25kYXJ5CiAgfSBlbHNlIHsKICAgIHBkbjo6bWFrZV9yZWdpb25fZG9tYWluICRuYW1lICRwd3IgJHN3aXRjaGVkX3Bvd2VyICRnbmQgJHNlY29uZGFyeSAkcmVnaW9uCiAgfQp9CgpzdGE6OmRlZmluZV9jbWRfYXJncyAiZGVmaW5lX3Bkbl9ncmlkIiB7Wy1uYW1lIDxuYW1lPl0gXAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgWy1tYWNyb10gXAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgWy1leGlzdGluZ10gXAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgWy1ncmlkX292ZXJfcGdfcGluc3wtZ3JpZF9vdmVyX2JvdW5kYXJ5XSBcCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbLXZvbHRhZ2VfZG9tYWlucyA8bGlzdF9vZl92b2x0YWdlX2RvbWFpbnM+XSBcCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbLW9yaWVudCA8bGlzdF9vZl92YWxpZF9vcmllbnRhdGlvbnM+XSBcCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbLWluc3RhbmNlcyA8bGlzdF9vZl9pbnN0YW5jZXM+XSBcCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbLWNlbGxzIDxsaXN0X29mX2NlbGxfbmFtZXM+IF0gXAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgWy1kZWZhdWx0XSBcCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbLWhhbG8gPGxpc3Rfb2ZfaGFsb192YWx1ZXM+XSBcCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbLXBpbnMgPGxpc3Rfb2ZfcGluX2xheWVycz5dIFwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFstc3RhcnRzX3dpdGggKFBPV0VSfEdST1VORCldIFwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFstb2JzdHJ1Y3Rpb25zIDxsaXN0X29mX2xheWVycz5dIFwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFstcG93ZXJfc3dpdGNoX2NlbGwgPG5hbWU+XSBcCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbLXBvd2VyX2NvbnRyb2wgPHNpZ25hbF9uYW1lPl0gXAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgWy1wb3dlcl9jb250cm9sX25ldHdvcmsgKFNUQVJ8REFJU1kpXQp9IDsjY2hlY2tlciBvZmYKCnByb2MgZGVmaW5lX3Bkbl9ncmlkIHsgYXJncyB9IHsKICBzZXQgaXNfbWFjcm8gMAogIHNldCBpc19leGlzdGluZyAwCiAgZm9yZWFjaCBhcmcgJGFyZ3MgewogICAgaWYgeyAkYXJnID09ICItbWFjcm8iIH0gewogICAgICBzZXQgaXNfbWFjcm8gMQogICAgfSBlbHNlaWYgeyAkYXJnID09ICItZXhpc3RpbmciIH0gewogICAgICBzZXQgaXNfZXhpc3RpbmcgMQogICAgfQogIH0KICBpZiB7ICRpc19tYWNybyB9IHsKICAgIHBkbjo6ZGVmaW5lX3Bkbl9ncmlkX21hY3JvIHsqfSRhcmdzCiAgfSBlbHNlaWYgeyAkaXNfZXhpc3RpbmcgfSB7CiAgICBwZG46OmRlZmluZV9wZG5fZ3JpZF9leGlzdGluZyB7Kn0kYXJncwogIH0gZWxzZSB7CiAgICBwZG46OmRlZmluZV9wZG5fZ3JpZCB7Kn0kYXJncwogIH0KfQoKc3RhOjpkZWZpbmVfY21kX2FyZ3MgImRlZmluZV9wb3dlcl9zd2l0Y2hfY2VsbCIgey1uYW1lIDxuYW1lPiBcCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAtY29udHJvbCA8Y29udHJvbF9waW4+IFwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFstYWNrbm93bGVkZ2UgPGFja25vd2xlZGdlX3Bpbj5dIFwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC1wb3dlcl9zd2l0Y2hhYmxlIDxwb3dlcl9zd2l0Y2hhYmxlX3Bpbj4gXAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLXBvd2VyIDxwb3dlcl9waW4+IFwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC1ncm91bmQgPGdyb3VuZF9waW4+IH0KCnByb2MgZGVmaW5lX3Bvd2VyX3N3aXRjaF9jZWxsIHsgYXJncyB9IHsKICBzdGE6OnBhcnNlX2tleV9hcmdzICJkZWZpbmVfcG93ZXJfc3dpdGNoX2NlbGwiIGFyZ3MgXAogICAga2V5cyB7LW5hbWUgLWNvbnRyb2wgLWFja25vd2xlZGdlIC1wb3dlcl9zd2l0Y2hhYmxlIC1wb3dlciAtZ3JvdW5kfSBmbGFncyB7fQoKICBzdGE6OmNoZWNrX2FyZ2NfZXEwICJkZWZpbmVfcG93ZXJfc3dpdGNoX2NlbGwiICRhcmdzCgogIHBkbjo6Y2hlY2tfZGVzaWduX3N0YXRlICJkZWZpbmVfcG93ZXJfc3dpdGNoX2NlbGwiCgogIGlmIHsgIVtpbmZvIGV4aXN0cyBrZXlzKC1uYW1lKV0gfSB7CiAgICB1dGw6OmVycm9yIFBETiAxMTgzICJUaGUgLW5hbWUgYXJndW1lbnQgaXMgcmVxdWlyZWQuIgogIH0gZWxzZSB7CiAgICBzZXQgbWFzdGVyIFtbb3JkOjpnZXRfZGJdIGZpbmRNYXN0ZXIgJGtleXMoLW5hbWUpXQogICAgaWYgeyAkbWFzdGVyID09ICJOVUxMIiB9IHsKICAgICAgdXRsOjplcnJvciBQRE4gMTA0NiAiVW5hYmxlIHRvIGZpbmQgcG93ZXIgc3dpdGNoIGNlbGwgbWFzdGVyOiAka2V5cygtbmFtZSkiCiAgICB9CiAgfQoKICBpZiB7ICFbaW5mbyBleGlzdHMga2V5cygtY29udHJvbCldIH0gewogICAgdXRsOjplcnJvciBQRE4gMTE4NCAiVGhlIC1jb250cm9sIGFyZ3VtZW50IGlzIHJlcXVpcmVkLiIKICB9IGVsc2UgewogICAgc2V0IGNvbnRyb2wgW3Bkbjo6Z2V0X210ZXJtICRtYXN0ZXIgJGtleXMoLWNvbnRyb2wpXQogIH0KCiAgc2V0IGFja25vd2xlZGdlICJOVUxMIgogIGlmIHsgW2luZm8gZXhpc3RzIGtleXMoLWFja25vd2xlZGdlKV0gfSB7CiAgICBzZXQgYWNrbm93bGVkZ2UgW3Bkbjo6Z2V0X210ZXJtICRtYXN0ZXIgJGtleXMoLWFja25vd2xlZGdlKV0KICB9CgogIGlmIHsgIVtpbmZvIGV4aXN0cyBrZXlzKC1wb3dlcl9zd2l0Y2hhYmxlKV0gfSB7CiAgICB1dGw6OmVycm9yIFBETiAxMTg2ICJUaGUgLXBvd2VyX3N3aXRjaGFibGUgYXJndW1lbnQgaXMgcmVxdWlyZWQuIgogIH0gZWxzZSB7CiAgICBzZXQgcG93ZXJfc3dpdGNoYWJsZSBbcGRuOjpnZXRfbXRlcm0gJG1hc3RlciAka2V5cygtcG93ZXJfc3dpdGNoYWJsZSldCiAgfQoKICBpZiB7ICFbaW5mbyBleGlzdHMga2V5cygtcG93ZXIpXSB9IHsKICAgIHV0bDo6ZXJyb3IgUEROIDExODcgIlRoZSAtcG93ZXIgYXJndW1lbnQgaXMgcmVxdWlyZWQuIgogIH0gZWxzZSB7CiAgICBzZXQgcG93ZXIgW3Bkbjo6Z2V0X210ZXJtICRtYXN0ZXIgJGtleXMoLXBvd2VyKV0KICB9CgogIGlmIHsgIVtpbmZvIGV4aXN0cyBrZXlzKC1ncm91bmQpXSB9IHsKICAgIHV0bDo6ZXJyb3IgUEROIDExODggIlRoZSAtZ3JvdW5kIGFyZ3VtZW50IGlzIHJlcXVpcmVkLiIKICB9IGVsc2UgewogICAgc2V0IGdyb3VuZCBbcGRuOjpnZXRfbXRlcm0gJG1hc3RlciAka2V5cygtZ3JvdW5kKV0KICB9CgogIHBkbjo6bWFrZV9zd2l0Y2hlZF9wb3dlcl9jZWxsIFwKICAgICRtYXN0ZXIgXAogICAgJGNvbnRyb2wgXAogICAgJGFja25vd2xlZGdlIFwKICAgICRwb3dlcl9zd2l0Y2hhYmxlIFwKICAgICRwb3dlciBcCiAgICAkZ3JvdW5kCn0KCnN0YTo6ZGVmaW5lX2NtZF9hcmdzICJhZGRfcGRuX3N0cmlwZSIge1stZ3JpZCBncmlkX25hbWVdIFwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLWxheWVyIGxheWVyX25hbWUgXAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbLXdpZHRoIHdpZHRoX3ZhbHVlXSBcCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFstZm9sbG93cGluc10gXAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbLWV4dGVuZF90b19jb3JlX3JpbmddIFwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgWy1waXRjaCBwaXRjaF92YWx1ZV0gXAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbLXNwYWNpbmcgc3BhY2luZ192YWx1ZV0gXAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbLW9mZnNldCBvZmZzZXRfdmFsdWVdIFwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgWy1zdGFydHNfd2l0aCAoUE9XRVJ8R1JPVU5EKV0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgWy1leHRlbmRfdG9fYm91bmRhcnldIFwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgWy1zbmFwX3RvX2dyaWRdIFwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgWy1udW1iZXJfb2Zfc3RyYXBzIGNvdW50XSBcCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFstbmV0cyBsaXN0X29mX25ldHNdCn0KCnByb2MgYWRkX3Bkbl9zdHJpcGUgeyBhcmdzIH0gewogIHN0YTo6cGFyc2Vfa2V5X2FyZ3MgImFkZF9wZG5fc3RyaXBlIiBhcmdzIFwKICAgIGtleXMgey1ncmlkIC1sYXllciAtd2lkdGggLXBpdGNoIC1zcGFjaW5nIC1vZmZzZXQgLXN0YXJ0c193aXRoIC1udW1iZXJfb2Zfc3RyYXBzIC1uZXRzfSBcCiAgICBmbGFncyB7LWZvbGxvd3BpbnMgLWV4dGVuZF90b19jb3JlX3JpbmcgLWV4dGVuZF90b19ib3VuZGFyeSAtc25hcF90b19ncmlkfQoKICBzdGE6OmNoZWNrX2FyZ2NfZXEwICJhZGRfcGRuX3N0cmlwZSIgJGFyZ3MKCiAgcGRuOjpjaGVja19kZXNpZ25fc3RhdGUgImFkZF9wZG5fc3RyaXBlIgoKICBpZiB7ICFbaW5mbyBleGlzdHMga2V5cygtbGF5ZXIpXSB9IHsKICAgIHV0bDo6ZXJyb3IgUEROIDEwMDcgIlRoZSAtbGF5ZXIgYXJndW1lbnQgaXMgcmVxdWlyZWQuIgogIH0KCiAgaWYgeyAhW2luZm8gZXhpc3RzIGZsYWdzKC1mb2xsb3dwaW5zKV0gfSB7CiAgICBpZiB7ICFbaW5mbyBleGlzdHMga2V5cygtd2lkdGgpXSB9IHsKICAgICAgdXRsOjplcnJvciBQRE4gMTAwOCAiVGhlIC13aWR0aCBhcmd1bWVudCBpcyByZXF1aXJlZC4iCiAgICB9IGVsc2UgewogICAgICBzZXQgd2lkdGggJGtleXMoLXdpZHRoKQogICAgfQoKICAgIGlmIHsgIVtpbmZvIGV4aXN0cyBrZXlzKC1waXRjaCldIH0gewogICAgICB1dGw6OmVycm9yIFBETiAxMDA5ICJUaGUgLXBpdGNoIGFyZ3VtZW50IGlzIHJlcXVpcmVkLiIKICAgIH0KICB9CgogIHNldCB3aWR0aCAwCiAgaWYgeyBbaW5mbyBleGlzdHMga2V5cygtd2lkdGgpXSB9IHsKICAgIHNldCB3aWR0aCAka2V5cygtd2lkdGgpCiAgfQoKICBzZXQgcGl0Y2ggMAogIGlmIHsgW2luZm8gZXhpc3RzIGtleXMoLXBpdGNoKV0gfSB7CiAgICBzZXQgcGl0Y2ggJGtleXMoLXBpdGNoKQogIH0KCiAgc2V0IHNwYWNpbmcgMAogIGlmIHsgW2luZm8gZXhpc3RzIGtleXMoLXNwYWNpbmcpXSB9IHsKICAgIHNldCBzcGFjaW5nICRrZXlzKC1zcGFjaW5nKQogIH0KCiAgc2V0IG9mZnNldCAwCiAgaWYgeyBbaW5mbyBleGlzdHMga2V5cygtb2Zmc2V0KV0gfSB7CiAgICBzZXQgb2Zmc2V0ICRrZXlzKC1vZmZzZXQpCiAgfQoKICBzZXQgbnVtYmVyX29mX3N0cmFwcyAwCiAgaWYgeyBbaW5mbyBleGlzdHMga2V5cygtbnVtYmVyX29mX3N0cmFwcyldIH0gewogICAgc2V0IG51bWJlcl9vZl9zdHJhcHMgJGtleXMoLW51bWJlcl9vZl9zdHJhcHMpCiAgfQoKICBzZXQgZ3JpZCAiIgogIGlmIHsgW2luZm8gZXhpc3RzIGtleXMoLWdyaWQpXSB9IHsKICAgIHNldCBncmlkICRrZXlzKC1ncmlkKQogIH0KCiAgc2V0IG5ldHMge30KICBpZiB7IFtpbmZvIGV4aXN0cyBrZXlzKC1uZXRzKV0gfSB7CiAgICBmb3JlYWNoIG5ldF9uYW1lICRrZXlzKC1uZXRzKSB7CiAgICAgIHNldCBuZXQgW1tvcmQ6OmdldF9kYl9ibG9ja10gZmluZE5ldCAkbmV0X25hbWVdCiAgICAgIGlmIHsgJG5ldCA9PSAiTlVMTCIgfSB7CiAgICAgICAgdXRsOjplcnJvciBQRE4gMjI1ICJVbmFibGUgdG8gZmluZCBuZXQgJG5ldF9uYW1lLiIKICAgICAgfQogICAgICBsYXBwZW5kIG5ldHMgJG5ldAogICAgfQogIH0KCiAgc2V0IGxheWVyIFtwZG46OmdldF9sYXllciAka2V5cygtbGF5ZXIpXQogIHNldCB3aWR0aCBbb3JkOjptaWNyb25zX3RvX2RidSAkd2lkdGhdCiAgc2V0IHBpdGNoIFtvcmQ6Om1pY3JvbnNfdG9fZGJ1ICRwaXRjaF0KICBzZXQgc3BhY2luZyBbb3JkOjptaWNyb25zX3RvX2RidSAkc3BhY2luZ10KICBzZXQgb2Zmc2V0IFtvcmQ6Om1pY3JvbnNfdG9fZGJ1ICRvZmZzZXRdCgogIHNldCBleHRlbmQgIkNvcmUiCiAgaWYgeyBbaW5mbyBleGlzdHMgZmxhZ3MoLWV4dGVuZF90b19jb3JlX3JpbmcpXSAmJiBbaW5mbyBleGlzdHMgZmxhZ3MoLWV4dGVuZF90b19ib3VuZGFyeSldIH0gewogICAgdXRsOjplcnJvciBQRE4gMTAxMCAiT3B0aW9ucyAtZXh0ZW5kX3RvX2NvcmVfcmluZyBhbmRcCiAgICAgIC1leHRlbmRfdG9fYm91bmRhcnkgYXJlIG11dHVhbGx5IGV4Y2x1c2l2ZS4iCiAgfSBlbHNlaWYgeyBbaW5mbyBleGlzdHMgZmxhZ3MoLWV4dGVuZF90b19jb3JlX3JpbmcpXSB9IHsKICAgIHNldCBleHRlbmQgIlJpbmdzIgogIH0gZWxzZWlmIHsgW2luZm8gZXhpc3RzIGZsYWdzKC1leHRlbmRfdG9fYm91bmRhcnkpXSB9IHsKICAgIHNldCBleHRlbmQgIkJvdW5kYXJ5IgogIH0KCiAgc2V0IHVzZV9ncmlkX3Bvd2VyX29yZGVyIDEKICBzZXQgc3RhcnRfd2l0aF9wb3dlciAwCiAgaWYgeyBbaW5mbyBleGlzdHMga2V5cygtc3RhcnRzX3dpdGgpXSB9IHsKICAgIHNldCB1c2VfZ3JpZF9wb3dlcl9vcmRlciAwCiAgICBzZXQgc3RhcnRfd2l0aF9wb3dlciBbcGRuOjpnZXRfc3RhcnRzX3dpdGggJGtleXMoLXN0YXJ0c193aXRoKV0KICB9CgogIGlmIHsgW2luZm8gZXhpc3RzIGZsYWdzKC1mb2xsb3dwaW5zKV0gfSB7CiAgICBpZiB7IFtpbmZvIGV4aXN0cyBrZXlzKC1zdGFydHNfd2l0aCldIH0gewogICAgICB1dGw6Ondhcm4gUEROIDIxMSAiT3B0aW9uIC1zdGFydHNfd2l0aCBjYW5ub3QgYmUgdXNlZCB3aXRoIC1mb2xsb3dwaW5zIGFuZCB3aWxsIGJlIGlnbm9yZWQuIgogICAgfQogICAgcGRuOjptYWtlX2ZvbGxvd3BpbiAkZ3JpZCAkbGF5ZXIgJHdpZHRoICRleHRlbmQKICB9IGVsc2UgewogICAgcGRuOjptYWtlX3N0cmFwIFwKICAgICAgJGdyaWQgXAogICAgICAkbGF5ZXIgXAogICAgICAkd2lkdGggXAogICAgICAkc3BhY2luZyBcCiAgICAgICRwaXRjaCBcCiAgICAgICRvZmZzZXQgXAogICAgICAkbnVtYmVyX29mX3N0cmFwcyBcCiAgICAgIFtpbmZvIGV4aXN0cyBmbGFncygtc25hcF90b19ncmlkKV0gXAogICAgICAkdXNlX2dyaWRfcG93ZXJfb3JkZXIgXAogICAgICAkc3RhcnRfd2l0aF9wb3dlciBcCiAgICAgICRleHRlbmQgXAogICAgICAkbmV0cwogIH0KfQoKc3RhOjpkZWZpbmVfY21kX2FyZ3MgImFkZF9wZG5fcmluZyIge1stZ3JpZCBncmlkX25hbWVdIFwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFstbGF5ZXJzIGxpc3Rfb2ZfMl9sYXllcl9uYW1lc10gXAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgWy13aWR0aHMgKHdpZHRoX3ZhbHVlfGxpc3Rfb2Zfd2lkdGhfdmFsdWVzKV0gXAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgWy1zcGFjaW5ncyAoc3BhY2luZ192YWx1ZXxsaXN0X29mX3NwYWNpbmdfdmFsdWVzKV0gXAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgWy1jb3JlX29mZnNldHMgKG9mZnNldF92YWx1ZXxsaXN0X29mX29mZnNldF92YWx1ZXMpXSBcCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbLXBhZF9vZmZzZXRzIChvZmZzZXRfdmFsdWV8bGlzdF9vZl9vZmZzZXRfdmFsdWVzKV0gXAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgWy1jb25uZWN0X3RvX3BhZF9sYXllcnMgbGF5ZXJzXSBcCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbLXBvd2VyX3BhZHMgbGlzdF9vZl9wd3JfcGFkc10gXAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgWy1ncm91bmRfcGFkcyBsaXN0X29mX2duZF9wYWRzXSBcCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbLW5ldHMgbGlzdF9vZl9uZXRzXSBcCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbLXN0YXJ0c193aXRoIChQT1dFUnxHUk9VTkQpXSBcCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbLWFkZF9jb25uZWN0XSBcCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbLWV4dGVuZF90b19ib3VuZGFyeV0gXAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgWy1jb25uZWN0X3RvX3BhZHNdXAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgWy1hbGxvd19vdXRfb2ZfZGllXQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSA7I2NoZWNrZXIgb2ZmCgpwcm9jIGFkZF9wZG5fcmluZyB7IGFyZ3MgfSB7CiAgc3RhOjpwYXJzZV9rZXlfYXJncyAiYWRkX3Bkbl9yaW5nIiBhcmdzIFwKICAgIGtleXMgey1ncmlkIC1sYXllcnMgLXdpZHRocyAtc3BhY2luZ3MgLWNvcmVfb2Zmc2V0cyAtcGFkX29mZnNldHMgLWNvbm5lY3RfdG9fcGFkX2xheWVycyBcCiAgICAgIC1wb3dlcl9wYWRzIC1ncm91bmRfcGFkcyAtbmV0cyAtc3RhcnRzX3dpdGh9IFwKICAgIGZsYWdzIHstYWRkX2Nvbm5lY3QgLWV4dGVuZF90b19ib3VuZGFyeSAtY29ubmVjdF90b19wYWRzIC1hbGxvd19vdXRfb2ZfZGllfQoKICBzdGE6OmNoZWNrX2FyZ2NfZXEwICJhZGRfcGRuX3JpbmciICRhcmdzCgogIHBkbjo6Y2hlY2tfZGVzaWduX3N0YXRlICJhZGRfcGRuX3JpbmciCgogIGlmIHsgW3Bkbjo6ZGVwcmVjYXRlZCBrZXlzIC1wb3dlcl9wYWRzICIsIHVzZSAtY29ubmVjdF90b19wYWRzIGluc3RlYWQuIl0gIT0ge30gfSB7CiAgICBzZXQgZmxhZ3MoLWNvbm5lY3RfdG9fcGFkcykgMQogIH0KICBpZiB7IFtwZG46OmRlcHJlY2F0ZWQga2V5cyAtZ3JvdW5kX3BhZHMgIiwgdXNlIC1jb25uZWN0X3RvX3BhZHMgaW5zdGVhZC4iXSAhPSB7fSB9IHsKICAgIHNldCBmbGFncygtY29ubmVjdF90b19wYWRzKSAxCiAgfQoKICBpZiB7ICFbaW5mbyBleGlzdHMga2V5cygtbGF5ZXJzKV0gfSB7CiAgICB1dGw6OmVycm9yIFBETiAxMDExICJUaGUgLWxheWVycyBhcmd1bWVudCBpcyByZXF1aXJlZC4iCiAgfQoKICBzZXQgbGF5ZXJzX2xlbiBbbGxlbmd0aCAka2V5cygtbGF5ZXJzKV0KICBpZiB7ICRsYXllcnNfbGVuID4gMiB9IHsKICAgIHV0bDo6ZXJyb3IgUEROIDEwMTIgIkV4cGVjdGluZyBhIGxpc3Qgb2YgMSBvciAyIGVsZW1lbnRzIGZvciAtbGF5ZXJzIG9wdGlvbiBvZiBhZGRfcGRuX3JpbmdcCiAgICAgIGNvbW1hbmQsIGZvdW5kICR7bGF5ZXJzX2xlbn0uIgogIH0KICBzZXQgbGF5ZXJzICRrZXlzKC1sYXllcnMpCiAgaWYgeyAkbGF5ZXJzX2xlbiA9PSAxIH0gewogICAgc2V0IGxheWVycyAiJGxheWVycyAkbGF5ZXJzIgogIH0KCiAgaWYgeyAhW2luZm8gZXhpc3RzIGtleXMoLXdpZHRocyldIH0gewogICAgdXRsOjplcnJvciBQRE4gMTAxMyAiVGhlIC13aWR0aHMgYXJndW1lbnQgaXMgcmVxdWlyZWQuIgogIH0gZWxzZSB7CiAgICBzZXQgd2lkdGhzIFtwZG46OmdldF9vbmVfdG9fdHdvICItd2lkdGhzIiAka2V5cygtd2lkdGhzKV0KICB9CgogIGlmIHsgIVtpbmZvIGV4aXN0cyBrZXlzKC1zcGFjaW5ncyldIH0gewogICAgdXRsOjplcnJvciBQRE4gMTAxNCAiVGhlIC1zcGFjaW5ncyBhcmd1bWVudCBpcyByZXF1aXJlZC4iCiAgfSBlbHNlIHsKICAgIHNldCBzcGFjaW5ncyBbcGRuOjpnZXRfb25lX3RvX3R3byAiLXNwYWNpbmdzIiAka2V5cygtc3BhY2luZ3MpXQogIH0KCiAgaWYgeyBbaW5mbyBleGlzdHMga2V5cygtY29yZV9vZmZzZXRzKV0gJiYgW2luZm8gZXhpc3RzIGtleXMoLXBhZF9vZmZzZXRzKV0gfSB7CiAgICB1dGw6OmVycm9yIFBETiAxMDE1ICJPbmx5IG9uZSBvZiAtcGFkX29mZnNldHMgb3IgLWNvcmVfb2Zmc2V0cyBjYW4gYmUgc3BlY2lmaWVkLiIKICB9IGVsc2VpZiB7ICFbaW5mbyBleGlzdHMga2V5cygtY29yZV9vZmZzZXRzKV0gJiYgIVtpbmZvIGV4aXN0cyBrZXlzKC1wYWRfb2Zmc2V0cyldIH0gewogICAgdXRsOjplcnJvciBQRE4gMTAxNiAiT25lIG9mIC1wYWRfb2Zmc2V0cyBvciAtY29yZV9vZmZzZXRzIG11c3QgYmUgc3BlY2lmaWVkLiIKICB9CiAgc2V0IGNvcmVfb2Zmc2V0cyAiMCAwIDAgMCIKICBpZiB7IFtpbmZvIGV4aXN0cyBrZXlzKC1jb3JlX29mZnNldHMpXSB9IHsKICAgIHNldCBjb3JlX29mZnNldHMgW3Bkbjo6Z2V0X29uZV90b19mb3VyICItY29yZV9vZmZzZXRzIiAka2V5cygtY29yZV9vZmZzZXRzKV0KICB9CiAgc2V0IHBhZF9vZmZzZXRzICIwIDAgMCAwIgogIGlmIHsgW2luZm8gZXhpc3RzIGtleXMoLXBhZF9vZmZzZXRzKV0gfSB7CiAgICBzZXQgcGFkX29mZnNldHMgW3Bkbjo6Z2V0X29uZV90b19mb3VyICItcGFkX29mZnNldHMiICRrZXlzKC1wYWRfb2Zmc2V0cyldCiAgfQoKICBpZiB7IFtpbmZvIGV4aXN0cyBmbGFncygtZXh0ZW5kX3RvX2JvdW5kYXJ5KV0gJiYgW2luZm8gZXhpc3RzIGZsYWdzKC1jb25uZWN0X3RvX3BhZHMpXSB9IHsKICAgIHV0bDo6ZXJyb3IgUEROIDEwMTcgIk9ubHkgb25lIG9mIC1wYWRfb2Zmc2V0cyBvciAtY29yZV9vZmZzZXRzIGNhbiBiZSBzcGVjaWZpZWQuIgogIH0KCiAgc2V0IGdyaWQgIiIKICBpZiB7IFtpbmZvIGV4aXN0cyBrZXlzKC1ncmlkKV0gfSB7CiAgICBzZXQgZ3JpZCAka2V5cygtZ3JpZCkKICB9CgogIHNldCBuZXRzIHt9CiAgaWYgeyBbaW5mbyBleGlzdHMga2V5cygtbmV0cyldIH0gewogICAgZm9yZWFjaCBuZXRfbmFtZSAka2V5cygtbmV0cykgewogICAgICBzZXQgbmV0IFtbb3JkOjpnZXRfZGJfYmxvY2tdIGZpbmROZXQgJG5ldF9uYW1lXQogICAgICBpZiB7ICRuZXQgPT0gIk5VTEwiIH0gewogICAgICAgIHV0bDo6ZXJyb3IgUEROIDIzMCAiVW5hYmxlIHRvIGZpbmQgbmV0ICRuZXRfbmFtZS4iCiAgICAgIH0KICAgICAgbGFwcGVuZCBuZXRzICRuZXQKICAgIH0KICB9CgogIHNldCB1c2VfZ3JpZF9wb3dlcl9vcmRlciAxCiAgc2V0IHN0YXJ0X3dpdGhfcG93ZXIgMAogIGlmIHsgW2luZm8gZXhpc3RzIGtleXMoLXN0YXJ0c193aXRoKV0gfSB7CiAgICBzZXQgdXNlX2dyaWRfcG93ZXJfb3JkZXIgMAogICAgc2V0IHN0YXJ0X3dpdGhfcG93ZXIgW3Bkbjo6Z2V0X3N0YXJ0c193aXRoICRrZXlzKC1zdGFydHNfd2l0aCldCiAgfQoKICBzZXQgbDAgW3Bkbjo6Z2V0X2xheWVyIFtsaW5kZXggJGxheWVycyAwXV0KICBzZXQgbDEgW3Bkbjo6Z2V0X2xheWVyIFtsaW5kZXggJGxheWVycyAxXV0KICBzZXQgd2lkdGhzIFtsaXN0IFwKICAgIFtvcmQ6Om1pY3JvbnNfdG9fZGJ1IFtsaW5kZXggJHdpZHRocyAwXV0gXAogICAgW29yZDo6bWljcm9uc190b19kYnUgW2xpbmRleCAkd2lkdGhzIDFdXV0KICBzZXQgc3BhY2luZ3MgW2xpc3QgXAogICAgW29yZDo6bWljcm9uc190b19kYnUgW2xpbmRleCAkc3BhY2luZ3MgMF1dIFwKICAgIFtvcmQ6Om1pY3JvbnNfdG9fZGJ1IFtsaW5kZXggJHNwYWNpbmdzIDFdXV0KICBzZXQgY29yZV9vZmZzZXRzIFtsaXN0IFwKICAgIFtvcmQ6Om1pY3JvbnNfdG9fZGJ1IFtsaW5kZXggJGNvcmVfb2Zmc2V0cyAwXV0gXAogICAgW29yZDo6bWljcm9uc190b19kYnUgW2xpbmRleCAkY29yZV9vZmZzZXRzIDFdXSBcCiAgICBbb3JkOjptaWNyb25zX3RvX2RidSBbbGluZGV4ICRjb3JlX29mZnNldHMgMl1dIFwKICAgIFtvcmQ6Om1pY3JvbnNfdG9fZGJ1IFtsaW5kZXggJGNvcmVfb2Zmc2V0cyAzXV1dCiAgc2V0IHBhZF9vZmZzZXRzIFtsaXN0IFwKICAgIFtvcmQ6Om1pY3JvbnNfdG9fZGJ1IFtsaW5kZXggJHBhZF9vZmZzZXRzIDBdXSBcCiAgICBbb3JkOjptaWNyb25zX3RvX2RidSBbbGluZGV4ICRwYWRfb2Zmc2V0cyAxXV0gXAogICAgW29yZDo6bWljcm9uc190b19kYnUgW2xpbmRleCAkcGFkX29mZnNldHMgMl1dIFwKICAgIFtvcmQ6Om1pY3JvbnNfdG9fZGJ1IFtsaW5kZXggJHBhZF9vZmZzZXRzIDNdXV0KICBzZXQgY29ubmVjdF90b19wYWRfbGF5ZXJzIHt9CiAgaWYgeyBbaW5mbyBleGlzdHMgZmxhZ3MoLWNvbm5lY3RfdG9fcGFkcyldIH0gewogICAgaWYgeyAhW2luZm8gZXhpc3RzIGtleXMoLWNvbm5lY3RfdG9fcGFkX2xheWVycyldIH0gewogICAgICBmb3JlYWNoIGxheWVyIFtbb3JkOjpnZXRfZGJfdGVjaF0gZ2V0TGF5ZXJzXSB7CiAgICAgICAgaWYgeyBbJGxheWVyIGdldFR5cGVdID09ICJST1VUSU5HIiB9IHsKICAgICAgICAgIGxhcHBlbmQgY29ubmVjdF90b19wYWRfbGF5ZXJzICRsYXllcgogICAgICAgIH0KICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgZm9yZWFjaCBsYXllciAka2V5cygtY29ubmVjdF90b19wYWRfbGF5ZXJzKSB7CiAgICAgICAgbGFwcGVuZCBjb25uZWN0X3RvX3BhZF9sYXllcnMgW3Bkbjo6Z2V0X2xheWVyICRsYXllcl0KICAgICAgfQogICAgfQogIH0KCiAgc2V0IGFsbG93X291dF9vZl9kaWUgW2luZm8gZXhpc3RzIGZsYWdzKC1hbGxvd19vdXRfb2ZfZGllKV0KCiAgcGRuOjptYWtlX3JpbmcgXAogICAgJGdyaWQgXAogICAgJGwwIFwKICAgIFtsaW5kZXggJHdpZHRocyAwXSBcCiAgICBbbGluZGV4ICRzcGFjaW5ncyAwXSBcCiAgICAkbDEgXAogICAgW2xpbmRleCAkd2lkdGhzIDFdIFwKICAgIFtsaW5kZXggJHNwYWNpbmdzIDFdIFwKICAgICR1c2VfZ3JpZF9wb3dlcl9vcmRlciBcCiAgICAkc3RhcnRfd2l0aF9wb3dlciBcCiAgICB7Kn0kY29yZV9vZmZzZXRzIFwKICAgIHsqfSRwYWRfb2Zmc2V0cyBcCiAgICBbaW5mbyBleGlzdHMgZmxhZ3MoLWV4dGVuZF90b19ib3VuZGFyeSldIFwKICAgICRjb25uZWN0X3RvX3BhZF9sYXllcnMgXAogICAgJG5ldHMgXAogICAgJGFsbG93X291dF9vZl9kaWUKCiAgaWYgeyBbaW5mbyBleGlzdHMgZmxhZ3MoLWFkZF9jb25uZWN0KV0gfSB7CiAgICBhZGRfcGRuX2Nvbm5lY3QgLWdyaWQgJGdyaWQgLWxheWVycyAka2V5cygtbGF5ZXJzKQogIH0KfQoKc3RhOjpkZWZpbmVfY21kX2FyZ3MgImFkZF9wZG5fY29ubmVjdCIge1stZ3JpZCBncmlkX25hbWVdIFwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC1sYXllcnMgbGlzdF9vZl8yX2xheWVycyBcCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbLWN1dF9waXRjaCBwaXRjaF92YWx1ZV0gXAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgWy1maXhlZF92aWFzIGxpc3Rfb2Zfdmlhc10gXAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgWy1kb250X3VzZV92aWFzIGxpc3Rfb2Zfdmlhc10KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFstbWF4X3Jvd3Mgcm93c10gXAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgWy1tYXhfY29sdW1ucyBjb2x1bW5zXSBcCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbLW9uZ3JpZCBvbmdyaWRfbGF5ZXJzXSBcCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbLXNwbGl0X2N1dHMgc3BsaXRfY3V0c19tYXBwaW5nXSBcCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbLXNwbGl0X2N1dHNfc3RhZ2dlcmVkXQp9Cgpwcm9jIGFkZF9wZG5fY29ubmVjdCB7IGFyZ3MgfSB7CiAgc3RhOjpwYXJzZV9rZXlfYXJncyAiYWRkX3Bkbl9jb25uZWN0IiBhcmdzIFwKICAgIGtleXMgey1ncmlkIC1sYXllcnMgLWN1dF9waXRjaCAtZml4ZWRfdmlhcyAtbWF4X3Jvd3MgLW1heF9jb2x1bW5zIC1vbmdyaWQgLXNwbGl0X2N1dHMgXAogICAgICAtZG9udF91c2Vfdmlhc30gXAogICAgZmxhZ3Mgey1zcGxpdF9jdXRzX3N0YWdnZXJlZH0KCiAgc3RhOjpjaGVja19hcmdjX2VxMCAiYWRkX3Bkbl9jb25uZWN0IiAkYXJncwoKICBwZG46OmNoZWNrX2Rlc2lnbl9zdGF0ZSAiYWRkX3Bkbl9jb25uZWN0IgoKICBpZiB7ICFbaW5mbyBleGlzdHMga2V5cygtbGF5ZXJzKV0gfSB7CiAgICB1dGw6OmVycm9yIFBETiAxMDE5ICJUaGUgLWxheWVycyBhcmd1bWVudCBpcyByZXF1aXJlZC4iCiAgfSBlbHNlaWYgeyBbbGxlbmd0aCAka2V5cygtbGF5ZXJzKV0gIT0gMiB9IHsKICAgIHV0bDo6ZXJyb3IgUEROIDEwMjAgIlRoZSAtbGF5ZXJzIG11c3QgY29udGFpbiB0d28gbGF5ZXJzLiIKICB9CgogIHNldCBsMCBbcGRuOjpnZXRfbGF5ZXIgW2xpbmRleCAka2V5cygtbGF5ZXJzKSAwXV0KICBzZXQgbDEgW3Bkbjo6Z2V0X2xheWVyIFtsaW5kZXggJGtleXMoLWxheWVycykgMV1dCgogIHNldCBjdXRfcGl0Y2ggIjAgMCIKICBpZiB7IFtpbmZvIGV4aXN0cyBrZXlzKC1jdXRfcGl0Y2gpXSB9IHsKICAgIHNldCBjdXRfcGl0Y2ggW3Bkbjo6Z2V0X29uZV90b190d28gIi1jdXRfcGl0Y2giICRrZXlzKC1jdXRfcGl0Y2gpXQogIH0KICBzZXQgY3V0X3BpdGNoIFtsaXN0IFwKICAgIFtvcmQ6Om1pY3JvbnNfdG9fZGJ1IFtsaW5kZXggJGN1dF9waXRjaCAwXV0gXAogICAgW29yZDo6bWljcm9uc190b19kYnUgW2xpbmRleCAkY3V0X3BpdGNoIDFdXV0KCiAgc2V0IGdyaWQgIiIKICBpZiB7IFtpbmZvIGV4aXN0cyBrZXlzKC1ncmlkKV0gfSB7CiAgICBzZXQgZ3JpZCAka2V5cygtZ3JpZCkKICB9CgogIHNldCBtYXhfcm93cyAwCiAgaWYgeyBbaW5mbyBleGlzdHMga2V5cygtbWF4X3Jvd3MpXSB9IHsKICAgIHNldCBtYXhfcm93cyAka2V5cygtbWF4X3Jvd3MpCiAgfQogIHNldCBtYXhfY29sdW1ucyAwCiAgaWYgeyBbaW5mbyBleGlzdHMga2V5cygtbWF4X2NvbHVtbnMpXSB9IHsKICAgIHNldCBtYXhfY29sdW1ucyAka2V5cygtbWF4X2NvbHVtbnMpCiAgfQoKICBzZXQgZml4ZWRfZ2VuZXJhdGVfdmlhcyB7fQogIHNldCBmaXhlZF90ZWNoX3ZpYXMge30KICBpZiB7IFtpbmZvIGV4aXN0cyBrZXlzKC1maXhlZF92aWFzKV0gfSB7CiAgICBmb3JlYWNoIHZpYSAka2V5cygtZml4ZWRfdmlhcykgewogICAgICBzZXQgdGVjaF92aWEgW1tvcmQ6OmdldF9kYl90ZWNoXSBmaW5kVmlhICR2aWFdCiAgICAgIHNldCBnZW5lcmF0ZV92aWEgW1tvcmQ6OmdldF9kYl90ZWNoXSBmaW5kVmlhR2VuZXJhdGVSdWxlICR2aWFdCiAgICAgIGlmIHsgJHRlY2hfdmlhID09ICJOVUxMIiAmJiAkZ2VuZXJhdGVfdmlhID09ICJOVUxMIiB9IHsKICAgICAgICB1dGw6OmVycm9yIFBETiAxMDIxICJVbmFibGUgdG8gZmluZCB2aWE6ICR2aWEiCiAgICAgIH0KICAgICAgaWYgeyAkdGVjaF92aWEgIT0gIk5VTEwiIH0gewogICAgICAgIGxhcHBlbmQgZml4ZWRfdGVjaF92aWFzICR0ZWNoX3ZpYQogICAgICB9CiAgICAgIGlmIHsgJGdlbmVyYXRlX3ZpYSAhPSAiTlVMTCIgfSB7CiAgICAgICAgbGFwcGVuZCBmaXhlZF9nZW5lcmF0ZV92aWFzICRnZW5lcmF0ZV92aWEKICAgICAgfQogICAgfQogIH0KCiAgc2V0IG9uZ3JpZCB7fQogIGlmIHsgW2luZm8gZXhpc3RzIGtleXMoLW9uZ3JpZCldIH0gewogICAgZm9yZWFjaCBsICRrZXlzKC1vbmdyaWQpIHsKICAgICAgbGFwcGVuZCBvbmdyaWQgW3Bkbjo6Z2V0X2xheWVyICRsXQogICAgfQogIH0KCiAgc2V0IHNwbGl0X2N1dHNfbGF5ZXJzIHt9CiAgc2V0IHNwbGl0X2N1dHNfcGl0Y2hlcyB7fQogIHNldCBzcGxpdF9jdXRzX3N0YWdnZXJlZCBmYWxzZQogIGlmIHsgW2luZm8gZXhpc3RzIGtleXMoLXNwbGl0X2N1dHMpXSB9IHsKICAgIGZvcmVhY2gge2wgcGl0Y2h9ICRrZXlzKC1zcGxpdF9jdXRzKSB7CiAgICAgIGxhcHBlbmQgc3BsaXRfY3V0c19sYXllcnMgW3Bkbjo6Z2V0X2xheWVyICRsXQogICAgICBsYXBwZW5kIHNwbGl0X2N1dHNfcGl0Y2hlcyBbb3JkOjptaWNyb25zX3RvX2RidSAkcGl0Y2hdCiAgICB9CiAgICBzZXQgc3BsaXRfY3V0c19zdGFnZ2VyZWQgW2luZm8gZXhpc3RzIGZsYWdzKC1zcGxpdF9jdXRzX3N0YWdnZXJlZCldCiAgfQoKICBzZXQgZG9udF91c2UgIiIKICBpZiB7IFtpbmZvIGV4aXN0cyBrZXlzKC1kb250X3VzZV92aWFzKV0gfSB7CiAgICBzZXQgZG9udF91c2UgJGtleXMoLWRvbnRfdXNlX3ZpYXMpCiAgfQoKICBwZG46Om1ha2VfY29ubmVjdCBcCiAgICAkZ3JpZCBcCiAgICAkbDAgXAogICAgJGwxIFwKICAgIHsqfSRjdXRfcGl0Y2ggXAogICAgJGZpeGVkX2dlbmVyYXRlX3ZpYXMgXAogICAgJGZpeGVkX3RlY2hfdmlhcyBcCiAgICAkbWF4X3Jvd3MgXAogICAgJG1heF9jb2x1bW5zIFwKICAgICRvbmdyaWQgXAogICAgJHNwbGl0X2N1dHNfbGF5ZXJzIFwKICAgICRzcGxpdF9jdXRzX3BpdGNoZXMgXAogICAgJHNwbGl0X2N1dHNfc3RhZ2dlcmVkIFwKICAgICRkb250X3VzZQp9CgpzdGE6OmRlZmluZV9jbWRfYXJncyAiYWRkX3Nyb3V0ZV9jb25uZWN0IiB7LW5ldCBuZXQgXAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLWxheWVycyBsaXN0X29mXzJfbGF5ZXJzIFwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC1jdXRfcGl0Y2ggbGlzdF9vZl8yX3BpdGNoX3ZhbHVlcyBcCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbLW91dGVyTmV0IG91dGVyTmV0XSBcCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbLWZpeGVkX3ZpYXMgbGlzdF9vZl92aWFzXSBcCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbLW1heF9yb3dzIHJvd3NdIFwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFstbWF4X2NvbHVtbnMgY29sdW1uc10gXAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgWy1tZXRhbHdpZHRocyBtZXRhbHdpZHRoc10gXAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgWy1tZXRhbHNwYWNlcyBtZXRhbHNwYWNlc10gXAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgWy1vbmdyaWQgb25ncmlkX2xheWVyc10gXAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgWy1pbnN0cyBpbnN0XQp9Cgpwcm9jIGFkZF9zcm91dGVfY29ubmVjdCB7IGFyZ3MgfSB7CiAgc3RhOjpwYXJzZV9rZXlfYXJncyAiYWRkX3Nyb3V0ZV9jb25uZWN0IiBhcmdzIFwKICAgIGtleXMgey1uZXQgLW91dGVyTmV0IC1sYXllcnMgLWN1dF9waXRjaCAtZml4ZWRfdmlhcyAtbWF4X3Jvd3MgLW1heF9jb2x1bW5zIC1tZXRhbHdpZHRocyBcCiAgICAgIC1tZXRhbHNwYWNlcyAtb25ncmlkIC1pbnN0c30gXAogICAgZmxhZ3Mge30KCiAgc2V0IGwwIFtwZG46OmdldF9sYXllciBbbGluZGV4ICRrZXlzKC1sYXllcnMpIDBdXQogIHNldCBsMSBbcGRuOjpnZXRfbGF5ZXIgW2xpbmRleCAka2V5cygtbGF5ZXJzKSAxXV0KCiAgc2V0IGN1dF9waXRjaF94IDAKICBzZXQgY3V0X3BpdGNoX3kgMAogIHNldCBjdXRfcGl0Y2hfeCBbbGluZGV4ICRrZXlzKC1jdXRfcGl0Y2gpIDBdCiAgc2V0IGN1dF9waXRjaF95IFtsaW5kZXggJGtleXMoLWN1dF9waXRjaCkgMV0KCiAgc2V0IG5ldCAiIgogIGlmIHsgW2luZm8gZXhpc3RzIGtleXMoLW5ldCldIH0gewogICAgc2V0IG5ldCAka2V5cygtbmV0KQogIH0KCiAgc2V0IG91dGVyTmV0ICIiCiAgaWYgeyBbaW5mbyBleGlzdHMga2V5cygtb3V0ZXJOZXQpXSB9IHsKICAgIHNldCBvdXRlck5ldCAka2V5cygtb3V0ZXJOZXQpCiAgfQoKICBzZXQgbWF4X3Jvd3MgMTAKICBpZiB7IFtpbmZvIGV4aXN0cyBrZXlzKC1tYXhfcm93cyldIH0gewogICAgc2V0IG1heF9yb3dzICRrZXlzKC1tYXhfcm93cykKICB9CiAgc2V0IG1heF9jb2x1bW5zIDEwCiAgaWYgeyBbaW5mbyBleGlzdHMga2V5cygtbWF4X2NvbHVtbnMpXSB9IHsKICAgIHNldCBtYXhfY29sdW1ucyAka2V5cygtbWF4X2NvbHVtbnMpCiAgfQoKICBzZXQgZml4ZWRfZ2VuZXJhdGVfdmlhcyB7fQogIHNldCBmaXhlZF90ZWNoX3ZpYXMge30KICBpZiB7IFtpbmZvIGV4aXN0cyBrZXlzKC1maXhlZF92aWFzKV0gfSB7CiAgICBmb3JlYWNoIHZpYSAka2V5cygtZml4ZWRfdmlhcykgewogICAgICBzZXQgdGVjaF92aWEgW1tvcmQ6OmdldF9kYl90ZWNoXSBmaW5kVmlhICR2aWFdCiAgICAgIHNldCBnZW5lcmF0ZV92aWEgW1tvcmQ6OmdldF9kYl90ZWNoXSBmaW5kVmlhR2VuZXJhdGVSdWxlICR2aWFdCiAgICAgIGlmIHsgJHRlY2hfdmlhICE9ICJOVUxMIiB9IHsKICAgICAgICBsYXBwZW5kIGZpeGVkX3RlY2hfdmlhcyAkdGVjaF92aWEKICAgICAgfQogICAgICBpZiB7ICRnZW5lcmF0ZV92aWEgIT0gIk5VTEwiIH0gewogICAgICAgIGxhcHBlbmQgZml4ZWRfZ2VuZXJhdGVfdmlhcyAkZ2VuZXJhdGVfdmlhCiAgICAgIH0KICAgIH0KICB9CgogIHNldCBvbmdyaWQge30KICBpZiB7IFtpbmZvIGV4aXN0cyBrZXlzKC1vbmdyaWQpXSB9IHsKICAgIGZvcmVhY2ggbCAka2V5cygtb25ncmlkKSB7CiAgICAgIGxhcHBlbmQgb25ncmlkIFtwZG46OmdldF9sYXllciAkbF0KICAgIH0KICB9CgogIHNldCBpbnN0cyB7fQogIGlmIHsgW2luZm8gZXhpc3RzIGtleXMoLWluc3RzKV0gfSB7CiAgICBmb3JlYWNoIGluc3QgJGtleXMoLWluc3RzKSB7CiAgICAgIHNldCBpbnN0YW5jZSBbW29yZDo6Z2V0X2RiX2Jsb2NrXSBmaW5kSW5zdCAkaW5zdF0KICAgICAgaWYgeyAkaW5zdGFuY2UgIT0gIk5VTEwiIH0gewogICAgICAgIGxhcHBlbmQgaW5zdHMgJGluc3RhbmNlCiAgICAgIH0KICAgIH0KICB9CgogIHNldCBtZXRhbHdpZHRocyB7fQogIGlmIHsgW2luZm8gZXhpc3RzIGtleXMoLW1ldGFsd2lkdGhzKV0gfSB7CiAgICBmb3JlYWNoIGwgJGtleXMoLW1ldGFsd2lkdGhzKSB7CiAgICAgIGxhcHBlbmQgbWV0YWx3aWR0aHMgJGwKICAgIH0KICB9CgogIHNldCBtZXRhbHNwYWNlcyB7fQogIGlmIHsgW2luZm8gZXhpc3RzIGtleXMoLW1ldGFsc3BhY2VzKV0gfSB7CiAgICBmb3JlYWNoIGwgJGtleXMoLW1ldGFsc3BhY2VzKSB7CiAgICAgIGxhcHBlbmQgbWV0YWxzcGFjZXMgJGwKICAgIH0KICB9CgogIHBkbjo6Y3JlYXRlU3JvdXRlV2lyZXMgXAogICAgJG5ldCBcCiAgICAkb3V0ZXJOZXQgXAogICAgJGwwIFwKICAgICRsMSBcCiAgICAkY3V0X3BpdGNoX3ggXAogICAgJGN1dF9waXRjaF95IFwKICAgICRmaXhlZF9nZW5lcmF0ZV92aWFzIFwKICAgICRmaXhlZF90ZWNoX3ZpYXMgXAogICAgJG1heF9yb3dzIFwKICAgICRtYXhfY29sdW1ucyBcCiAgICAkb25ncmlkIFwKICAgICRtZXRhbHdpZHRocyBcCiAgICAkbWV0YWxzcGFjZXMgXAogICAgJGluc3RzCn0KCnN0YTo6ZGVmaW5lX2NtZF9hcmdzICJyZXBhaXJfcGRuX3ZpYXMiIHtbLW5ldCBuZXRfbmFtZV0gXAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLWFsbAp9CnByb2MgcmVwYWlyX3Bkbl92aWFzIHsgYXJncyB9IHsKICBzdGE6OnBhcnNlX2tleV9hcmdzICJyZXBhaXJfcGRuX3ZpYXMiIGFyZ3MgXAogICAga2V5cyB7LW5ldH0gXAogICAgZmxhZ3Mgey1hbGx9CgogIHN0YTo6Y2hlY2tfYXJnY19lcTAgInJlcGFpcl9wZG5fdmlhcyIgJGFyZ3MKICBwZG46OmNoZWNrX2Rlc2lnbl9zdGF0ZSAicmVwYWlyX3Bkbl92aWFzIgoKICBpZiB7IFtpbmZvIGV4aXN0cyBrZXlzKC1uZXQpXSAmJiBbaW5mbyBleGlzdHMgZmxhZ3MoLWFsbCldIH0gewogICAgdXRsOjplcnJvciBQRE4gMTE5MSAiQ2Fubm90IHVzZSBib3RoIC1uZXQgYW5kIC1hbGwgYXJndW1lbnRzLiIKICB9CiAgaWYgeyAhW2luZm8gZXhpc3RzIGtleXMoLW5ldCldICYmICFbaW5mbyBleGlzdHMgZmxhZ3MoLWFsbCldIH0gewogICAgdXRsOjplcnJvciBQRE4gMTE5MiAiTXVzdCB1c2UgZWl0aGVyIC1uZXQgb3IgLWFsbCBhcmd1bWVudHMuIgogIH0KCiAgc2V0IG5ldHMgW10KICBpZiB7IFtpbmZvIGV4aXN0cyBrZXlzKC1uZXQpXSB9IHsKICAgIHNldCBuZXQgW1tvcmQ6OmdldF9kYl9ibG9ja10gZmluZE5ldCAka2V5cygtbmV0KV0KICAgIGlmIHsgJG5ldCA9PSAiTlVMTCIgfSB7CiAgICAgIHV0bDo6ZXJyb3IgUEROIDExOTAgIlVuYWJsZSB0byBmaW5kIG5ldDogJGtleXMoLW5ldCkiCiAgICB9CiAgICBsYXBwZW5kIG5ldHMgJG5ldAogIH0KICBpZiB7IFtpbmZvIGV4aXN0cyBmbGFncygtYWxsKV0gfSB7CiAgICBmb3JlYWNoIG5ldCBbW29yZDo6Z2V0X2RiX2Jsb2NrXSBnZXROZXRzXSB7CiAgICAgIGlmIHsgWyRuZXQgZ2V0U2lnVHlwZV0gPT0gIlBPV0VSIiB8fCBbJG5ldCBnZXRTaWdUeXBlXSA9PSAiR1JPVU5EIiB9IHsKICAgICAgICBsYXBwZW5kIG5ldHMgJG5ldAogICAgICB9CiAgICB9CiAgfQoKICBwZG46OnJlcGFpcl9wZG5fdmlhcyAkbmV0cwp9CgpuYW1lc3BhY2UgZXZhbCBwZG4gewpwcm9jIG5hbWVfY21wIHsgb2JqMSBvYmoyIH0gewogIHNldCBuYW1lMSBbJG9iajEgZ2V0TmFtZV0KICBzZXQgbmFtZTIgWyRvYmoyIGdldE5hbWVdCiAgaWYgeyAkbmFtZTEgPCAkbmFtZTIgfSB7CiAgICByZXR1cm4gLTEKICB9IGVsc2VpZiB7ICRuYW1lMSA9PSAkbmFtZTIgfSB7CiAgICByZXR1cm4gMAogIH0gZWxzZSB7CiAgICByZXR1cm4gMQogIH0KfQoKcHJvYyBjaGVja19kZXNpZ25fc3RhdGUgeyBhcmdzIH0gewogIGlmIHsgW29yZDo6Z2V0X2RiX2Jsb2NrXSA9PSAiTlVMTCIgfSB7CiAgICB1dGw6OmVycm9yIFBETiAxMDIyICJEZXNpZ24gbXVzdCBiZSBsb2FkZWQgYmVmb3JlIGNhbGxpbmcgJGFyZ3MuIgogIH0KfQoKcHJvYyBtb2RpZnlfdm9sdGFnZV9kb21haW5fbmFtZSB7IG5hbWUgfSB7CiAgaWYgeyAkbmFtZSA9PSAiQ09SRSIgfSB7CiAgICByZXR1cm4gIkNvcmUiCiAgfQogIHJldHVybiAkbmFtZQp9Cgpwcm9jIGdldF9sYXllciB7IG5hbWUgfSB7CiAgc2V0IGxheWVyIFtbb3JkOjpnZXRfZGJfdGVjaF0gZmluZExheWVyICRuYW1lXQogIGlmIHsgJGxheWVyID09ICJOVUxMIiB9IHsKICAgIHV0bDo6ZXJyb3IgUEROIDEwMjMgIlVuYWJsZSB0byBmaW5kICRuYW1lIGxheWVyLiIKICB9IGVsc2UgewogICAgcmV0dXJuICRsYXllcgogIH0KfQoKcHJvYyBkZXByZWNhdGVkIHsgYXJnc192YXIga2V5IHsgdXNlICIuIiB9IH0gewogIHVwdmFyIDEgJGFyZ3NfdmFyIGFyZ3MKICBpZiB7IFtpbmZvIGV4aXN0cyBhcmdzKCRrZXkpXSB9IHsKICAgIHV0bDo6d2FybiBQRE4gMTAyNCAiJGtleSBoYXMgYmVlbiBkZXByZWNhdGVkJHVzZSIKICAgIHJldHVybiAkYXJncygka2V5KQogIH0KICByZXR1cm4ge30KfQoKcHJvYyBkZWZpbmVfcGRuX2dyaWQgeyBhcmdzIH0gewogIHN0YTo6cGFyc2Vfa2V5X2FyZ3MgImRlZmluZV9wZG5fZ3JpZCIgYXJncyBcCiAgICBrZXlzIHstbmFtZSAtdm9sdGFnZV9kb21haW5zIC1waW5zIC1zdGFydHNfd2l0aCAtb2JzdHJ1Y3Rpb25zIC1wb3dlcl9zd2l0Y2hfY2VsbCBcCiAgICAgIC1wb3dlcl9jb250cm9sIC1wb3dlcl9jb250cm9sX25ldHdvcmt9IFwKICAgIGZsYWdzIHt9IDsjIGNoZWNrZXIgb2ZmCgogIHN0YTo6Y2hlY2tfYXJnY19lcTAgImRlZmluZV9wZG5fZ3JpZCIgJGFyZ3MKICBwZG46OmNoZWNrX2Rlc2lnbl9zdGF0ZSAiZGVmaW5lX3Bkbl9ncmlkIgoKICBpZiB7IFtpbmZvIGV4aXN0cyBrZXlzKC12b2x0YWdlX2RvbWFpbnMpXSB9IHsKICAgIHNldCBkb21haW5zIFtwZG46OmdldF92b2x0YWdlX2RvbWFpbnMgJGtleXMoLXZvbHRhZ2VfZG9tYWlucyldCiAgfSBlbHNlIHsKICAgIHNldCBkb21haW5zIFtwZG46OmZpbmRfZG9tYWluICJDb3JlIl0KICB9CgogIGlmIHsgIVtpbmZvIGV4aXN0cyBrZXlzKC1uYW1lKV0gfSB7CiAgICB1dGw6OmVycm9yIFBETiAxMDI1ICItbmFtZSBpcyByZXF1aXJlZCIKICB9CgogIGlmIHsgW2hhc19ncmlkICRrZXlzKC1uYW1lKV0gfSB7CiAgICB1dGw6OmVycm9yIFBETiAxMDQzICJHcmlkIG5hbWVkIFwiJGtleXMoLW5hbWUpXCIgYWxyZWFkeSBkZWZpbmVkLiIKICB9CgogIHNldCBzdGFydF93aXRoX3Bvd2VyIDAKICBpZiB7IFtpbmZvIGV4aXN0cyBrZXlzKC1zdGFydHNfd2l0aCldIH0gewogICAgc2V0IHN0YXJ0X3dpdGhfcG93ZXIgW3Bkbjo6Z2V0X3N0YXJ0c193aXRoICRrZXlzKC1zdGFydHNfd2l0aCldCiAgfQoKICBzZXQgcGluX2xheWVycyB7fQogIGlmIHsgW2luZm8gZXhpc3RzIGtleXMoLXBpbnMpXSB9IHsKICAgIGZvcmVhY2ggcGluICRrZXlzKC1waW5zKSB7CiAgICAgIGxhcHBlbmQgcGluX2xheWVycyBbcGRuOjpnZXRfbGF5ZXIgJHBpbl0KICAgIH0KICB9CgogIHNldCBvYnN0cnVjdGlvbnMge30KICBpZiB7IFtpbmZvIGV4aXN0cyBrZXlzKC1vYnN0cnVjdGlvbnMpXSB9IHsKICAgIHNldCBvYnN0cnVjdGlvbnMgW2dldF9vYnN0cnVjdGlvbnMgJGtleXMoLW9ic3RydWN0aW9ucyldCiAgfQoKICBzZXQgcG93ZXJfY2VsbCAiTlVMTCIKICBzZXQgcG93ZXJfY29udHJvbCAiTlVMTCIKICBpZiB7IFtpbmZvIGV4aXN0cyBrZXlzKC1wb3dlcl9zd2l0Y2hfY2VsbCldIH0gewogICAgc2V0IHBvd2VyX2NlbGwgW3Bkbjo6ZmluZF9zd2l0Y2hlZF9wb3dlcl9jZWxsICRrZXlzKC1wb3dlcl9zd2l0Y2hfY2VsbCldCiAgICBpZiB7ICRwb3dlcl9jZWxsID09ICJOVUxMIiB9IHsKICAgICAgdXRsOjplcnJvciBQRE4gMTA0OCAiU3dpdGNoZWQgcG93ZXIgY2VsbCAka2V5cygtcG93ZXJfc3dpdGNoX2NlbGwpIGlzIG5vdCBkZWZpbmVkLiIKICAgIH0KCiAgICBpZiB7ICFbaW5mbyBleGlzdHMga2V5cygtcG93ZXJfY29udHJvbCldIH0gewogICAgICB1dGw6OmVycm9yIFBETiAxMDQ1ICItcG93ZXJfY29udHJvbCBtdXN0IGJlIHNwZWNpZmllZCB3aXRoIC1wb3dlcl9zd2l0Y2hfY2VsbCIKICAgIH0gZWxzZSB7CiAgICAgIHNldCBwb3dlcl9jb250cm9sIFtbb3JkOjpnZXRfZGJfYmxvY2tdIGZpbmROZXQgJGtleXMoLXBvd2VyX2NvbnRyb2wpXQogICAgICBpZiB7ICRwb3dlcl9jb250cm9sID09ICJOVUxMIiB9IHsKICAgICAgICB1dGw6OmVycm9yIFBETiAxMDQ5ICJVbmFibGUgdG8gZmluZCBwb3dlciBjb250cm9sIG5ldDogJGtleXMoLXBvd2VyX2NvbnRyb2wpIgogICAgICB9CiAgICB9CiAgfQoKICBzZXQgcG93ZXJfY29udHJvbF9uZXR3b3JrICJTVEFSIgogIGlmIHsgW2luZm8gZXhpc3RzIGtleXMoLXBvd2VyX2NvbnRyb2xfbmV0d29yayldIH0gewogICAgc2V0IHBvd2VyX2NvbnRyb2xfbmV0d29yayAka2V5cygtcG93ZXJfY29udHJvbF9uZXR3b3JrKQogIH0KCiAgZm9yZWFjaCBkb21haW4gJGRvbWFpbnMgewogICAgcGRuOjptYWtlX2NvcmVfZ3JpZCBcCiAgICAgICRkb21haW4gXAogICAgICAka2V5cygtbmFtZSkgXAogICAgICAkc3RhcnRfd2l0aF9wb3dlciBcCiAgICAgICRwaW5fbGF5ZXJzIFwKICAgICAgJG9ic3RydWN0aW9ucyBcCiAgICAgICRwb3dlcl9jZWxsIFwKICAgICAgJHBvd2VyX2NvbnRyb2wgXAogICAgICAkcG93ZXJfY29udHJvbF9uZXR3b3JrCiAgfQp9Cgpwcm9jIGRlZmluZV9wZG5fZ3JpZF9leGlzdGluZyB7IGFyZ3MgfSB7CiAgc3RhOjpwYXJzZV9rZXlfYXJncyAiZGVmaW5lX3Bkbl9ncmlkIiBhcmdzIFwKICAgIGtleXMgey1uYW1lIC1vYnN0cnVjdGlvbnN9IFwKICAgIGZsYWdzIHstZXhpc3Rpbmd9IDsjIGNoZWNrZXIgb2ZmCgogIHN0YTo6Y2hlY2tfYXJnY19lcTAgImRlZmluZV9wZG5fZ3JpZCIgJGFyZ3MKICBwZG46OmNoZWNrX2Rlc2lnbl9zdGF0ZSAiZGVmaW5lX3Bkbl9ncmlkIgoKICBzZXQgbmFtZSAiZXhpc3RpbmdfZ3JpZCIKICBpZiB7IFtpbmZvIGV4aXN0cyBrZXlzKC1uYW1lKV0gfSB7CiAgICBzZXQgbmFtZSAka2V5cygtbmFtZSkKICB9CgogIHNldCBvYnN0cnVjdGlvbnMge30KICBpZiB7IFtpbmZvIGV4aXN0cyBrZXlzKC1vYnN0cnVjdGlvbnMpXSB9IHsKICAgIHNldCBvYnN0cnVjdGlvbnMgW2dldF9vYnN0cnVjdGlvbnMgJGtleXMoLW9ic3RydWN0aW9ucyldCiAgfQoKICBwZG46Om1ha2VfZXhpc3RpbmdfZ3JpZCAkbmFtZSAkb2JzdHJ1Y3Rpb25zCn0KCnByb2MgZGVmaW5lX3Bkbl9ncmlkX21hY3JvIHsgYXJncyB9IHsKICBzdGE6OnBhcnNlX2tleV9hcmdzICJkZWZpbmVfcGRuX2dyaWQiIGFyZ3MgXAogICAga2V5cyB7LW5hbWUgLXZvbHRhZ2VfZG9tYWlucyAtb3JpZW50IC1pbnN0YW5jZXMgLWNlbGxzIC1oYWxvIC1waW5fZGlyZWN0aW9uIC1zdGFydHNfd2l0aCBcCiAgICAgIC1vYnN0cnVjdGlvbnN9IFwKICAgIGZsYWdzIHstbWFjcm8gLWdyaWRfb3Zlcl9wZ19waW5zIC1ncmlkX292ZXJfYm91bmRhcnkgLWRlZmF1bHQgLWJ1bXB9IDsjIGNoZWNrZXIgb2ZmCgogIHN0YTo6Y2hlY2tfYXJnY19lcTAgImRlZmluZV9wZG5fZ3JpZCIgJGFyZ3MKICBwZG46OmNoZWNrX2Rlc2lnbl9zdGF0ZSAiZGVmaW5lX3Bkbl9ncmlkIgoKICBzZXQgcGdfcGluc190b19ib3VuZGFyeSAxCiAgcGRuOjpkZXByZWNhdGVkIGtleXMgLXBpbl9kaXJlY3Rpb24KICBpZiB7IFtpbmZvIGV4aXN0cyBmbGFncygtZ3JpZF9vdmVyX3BnX3BpbnMpXSAmJiBbaW5mbyBleGlzdHMgZmxhZ3MoLWdyaWRfb3Zlcl9ib3VuZGFyeSldIH0gewogICAgdXRsOjplcnJvciBQRE4gMTAyNiAiT3B0aW9ucyAtZ3JpZF9vdmVyX3BnX3BpbnMgYW5kIC1ncmlkX292ZXJfYm91bmRhcnkgYXJlIG11dHVhbGx5IGV4Y2x1c2l2ZS4iCiAgfSBlbHNlaWYgeyBbaW5mbyBleGlzdHMgZmxhZ3MoLWdyaWRfb3Zlcl9wZ19waW5zKV0gfSB7CiAgICBzZXQgcGdfcGluc190b19ib3VuZGFyeSAwCiAgfQoKICBzZXQgZXhjbHVzaXZlX2tleXMgMAogIGlmIHsgW2luZm8gZXhpc3RzIGtleXMoLWluc3RhbmNlcyldIH0gewogICAgaW5jciBleGNsdXNpdmVfa2V5cwogIH0KICBpZiB7IFtpbmZvIGV4aXN0cyBrZXlzKC1jZWxscyldIH0gewogICAgaW5jciBleGNsdXNpdmVfa2V5cwogIH0KICBpZiB7IFtpbmZvIGV4aXN0cyBmbGFncygtZGVmYXVsdCldIH0gewogICAgaW5jciBleGNsdXNpdmVfa2V5cwogIH0KICBpZiB7ICRleGNsdXNpdmVfa2V5cyA+IDEgfSB7CiAgICB1dGw6OmVycm9yIFBETiAxMDI3ICJPcHRpb25zIC1pbnN0YW5jZXMsIC1jZWxscywgYW5kIC1kZWZhdWx0IGFyZSBtdXR1YWxseSBleGNsdXNpdmUuIgogIH0gZWxzZWlmIHsKICAgICFbaW5mbyBleGlzdHMga2V5cygtaW5zdGFuY2VzKV0gJiYKICAgICFbaW5mbyBleGlzdHMga2V5cygtY2VsbHMpXSAmJgogICAgIVtpbmZvIGV4aXN0cyBmbGFncygtZGVmYXVsdCldCiAgfSB7CiAgICB1dGw6OmVycm9yIFBETiAxMDI4ICJFaXRoZXIgLWluc3RhbmNlcywgLWNlbGxzLCBvciAtZGVmYXVsdCBtdXN0IGJlIHNwZWNpZmllZC4iCiAgfQogIHNldCBkZWZhdWx0X2dyaWQgW2luZm8gZXhpc3RzIGZsYWdzKC1kZWZhdWx0KV0KICBpZiB7ICRkZWZhdWx0X2dyaWQgfSB7CiAgICAjIHNldCBkZWZhdWx0IHBhdHRlcm4gdG8gLioKICAgIHNldCBrZXlzKC1jZWxscykgIi4qIgogIH0KCiAgaWYgeyAhW2luZm8gZXhpc3RzIGtleXMoLW5hbWUpXSB9IHsKICAgIHV0bDo6ZXJyb3IgUEROIDEwMjkgIi1uYW1lIGlzIHJlcXVpcmVkIgogIH0KICBpZiB7IFtoYXNfZ3JpZCAka2V5cygtbmFtZSldIH0gewogICAgdXRsOjplcnJvciBQRE4gMTA0NCAiR3JpZCBuYW1lZCBcIiRrZXlzKC1uYW1lKVwiIGFscmVhZHkgZGVmaW5lZC4iCiAgfQoKICBzZXQgc3RhcnRfd2l0aF9wb3dlciAwCiAgaWYgeyBbaW5mbyBleGlzdHMga2V5cygtc3RhcnRzX3dpdGgpXSB9IHsKICAgIHNldCBzdGFydF93aXRoX3Bvd2VyIFtwZG46OmdldF9zdGFydHNfd2l0aCAka2V5cygtc3RhcnRzX3dpdGgpXQogIH0KCiAgc2V0IGhhbG8gIjAgMCAwIDAiCiAgaWYgeyBbaW5mbyBleGlzdHMga2V5cygtaGFsbyldIH0gewogICAgc2V0IGhhbG8gW3Bkbjo6Z2V0X29uZV90b19mb3VyICItaGFsbyIgJGtleXMoLWhhbG8pXQogIH0KICBzZXQgaGFsbyBbbGlzdCBcCiAgICBbb3JkOjptaWNyb25zX3RvX2RidSBbbGluZGV4ICRoYWxvIDBdXSBcCiAgICBbb3JkOjptaWNyb25zX3RvX2RidSBbbGluZGV4ICRoYWxvIDFdXSBcCiAgICBbb3JkOjptaWNyb25zX3RvX2RidSBbbGluZGV4ICRoYWxvIDJdXSBcCiAgICBbb3JkOjptaWNyb25zX3RvX2RidSBbbGluZGV4ICRoYWxvIDNdXV0KCiAgaWYgeyBbaW5mbyBleGlzdHMga2V5cygtdm9sdGFnZV9kb21haW5zKV0gfSB7CiAgICBzZXQgZG9tYWlucyBbcGRuOjpnZXRfdm9sdGFnZV9kb21haW5zICRrZXlzKC12b2x0YWdlX2RvbWFpbnMpXQogIH0gZWxzZSB7CiAgICBzZXQgZG9tYWlucyBbcGRuOjpmaW5kX2RvbWFpbiAiQ29yZSJdCiAgfQoKICBzZXQgb2JzdHJ1Y3Rpb25zIHt9CiAgaWYgeyBbaW5mbyBleGlzdHMga2V5cygtb2JzdHJ1Y3Rpb25zKV0gfSB7CiAgICBzZXQgb2JzdHJ1Y3Rpb25zIFtnZXRfb2JzdHJ1Y3Rpb25zICRrZXlzKC1vYnN0cnVjdGlvbnMpXQogIH0KCiAgc2V0IG9yaWVudHMge30KICBpZiB7IFtpbmZvIGV4aXN0cyBrZXlzKC1vcmllbnQpXSB9IHsKICAgIHNldCBvcmllbnRzIFtwZG46OmdldF9vcmllbnRhdGlvbnMgJGtleXMoLW9yaWVudCldCiAgfQoKICBzZXQgaXNfYnVtcCBbaW5mbyBleGlzdHMgZmxhZ3MoLWJ1bXApXQoKICBpZiB7IFtpbmZvIGV4aXN0cyBrZXlzKC1pbnN0YW5jZXMpXSB9IHsKICAgIHNldCBpbnN0cyB7fQogICAgZm9yZWFjaCBpbnN0X3BhdHRlcm4gJGtleXMoLWluc3RhbmNlcykgewogICAgICBzZXQgc3ViX2luc3RzIFtnZXRfaW5zdHMgJGluc3RfcGF0dGVybl0KICAgICAgaWYgeyBbbGxlbmd0aCAkc3ViX2luc3RzXSA9PSAwIH0gewogICAgICAgIHV0bDo6ZXJyb3IgUEROIDEwMzAgIlVuYWJsZSB0byBmaW5kIGluc3RhbmNlOiAkaW5zdF9wYXR0ZXJuIgogICAgICB9CiAgICAgIGZvcmVhY2ggaW5zdCAkc3ViX2luc3RzIHsKICAgICAgICBpZiB7ICFbJGluc3QgaXNGaXhlZF0gfSB7CiAgICAgICAgICB1dGw6Ondhcm4gUEROIDEwNTAgXAogICAgICAgICAgICAiSWdub3Jpbmcgbm9uLWZpeGVkIGluc3RhbmNlIGZvciBncmlkICgke2tleXMoLW5hbWUpfSk6IFskaW5zdCBnZXROYW1lXSIKICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgfQogICAgICAgIGxhcHBlbmQgaW5zdHMgJGluc3QKICAgICAgfQogICAgfQoKICAgIHNldCBpbnN0cyBbbHNvcnQgLXVuaXF1ZSAtY29tbWFuZCBuYW1lX2NtcCAkaW5zdHNdCiAgICBmb3JlYWNoIGluc3QgJGluc3RzIHsKICAgICAgIyBtdXN0IG1hdGNoIG9yaWVudGF0aW9uLCBpZiBwcm92aWRlZAogICAgICBpZiB7IFttYXRjaF9vcmllbnRhdGlvbiAkb3JpZW50cyBbJGluc3QgZ2V0T3JpZW50XV0gIT0gMCB9IHsKICAgICAgICBmb3JlYWNoIGRvbWFpbiAkZG9tYWlucyB7CiAgICAgICAgICBwZG46Om1ha2VfaW5zdGFuY2VfZ3JpZCBcCiAgICAgICAgICAgICRkb21haW4gXAogICAgICAgICAgICAka2V5cygtbmFtZSkgXAogICAgICAgICAgICAkc3RhcnRfd2l0aF9wb3dlciBcCiAgICAgICAgICAgICRpbnN0IFwKICAgICAgICAgICAgeyp9JGhhbG8gXAogICAgICAgICAgICAkcGdfcGluc190b19ib3VuZGFyeSBcCiAgICAgICAgICAgICRkZWZhdWx0X2dyaWQgXAogICAgICAgICAgICAkb2JzdHJ1Y3Rpb25zIFwKICAgICAgICAgICAgJGlzX2J1bXAKICAgICAgICB9CiAgICAgIH0KICAgIH0KICB9IGVsc2UgewogICAgc2V0IGNlbGxzIHt9CiAgICBmb3JlYWNoIGNlbGxfcGF0dGVybiAka2V5cygtY2VsbHMpIHsKICAgICAgc2V0IHN1Yl9jZWxscyBbZ2V0X21hc3RlcnMgJGNlbGxfcGF0dGVybl0KICAgICAgaWYgeyBbbGxlbmd0aCAkc3ViX2NlbGxzXSA9PSAwIH0gewogICAgICAgIHV0bDo6d2FybiBQRE4gMTAzMSAiVW5hYmxlIHRvIGZpbmQgY2VsbHM6ICRjZWxsX3BhdHRlcm4iCiAgICAgIH0KICAgICAgZm9yZWFjaCBjZWxsICRzdWJfY2VsbHMgewogICAgICAgICMgb25seSBhZGQgYmxvY2tzCiAgICAgICAgaWYgeyAhWyRjZWxsIGlzQmxvY2tdIH0gewogICAgICAgICAgaWYgeyAhJGRlZmF1bHRfZ3JpZCB9IHsKICAgICAgICAgICAgdXRsOjp3YXJuIFBETiAxMDQxICJJZ25vcmluZyBub24tYmxvY2sgY2VsbCBmb3IgZ3JpZCAoJHtrZXlzKC1uYW1lKX0pOiBbJGNlbGwgZ2V0TmFtZV0iCiAgICAgICAgICB9CiAgICAgICAgICBjb250aW51ZQogICAgICAgIH0KICAgICAgICBsYXBwZW5kIGNlbGxzICRjZWxsCiAgICAgIH0KICAgIH0KCiAgICBzZXQgY2VsbHMgW2xzb3J0IC11bmlxdWUgLWNvbW1hbmQgbmFtZV9jbXAgJGNlbGxzXQogICAgZm9yZWFjaCBjZWxsICRjZWxscyB7CiAgICAgIGZvcmVhY2ggaW5zdCBbW29yZDo6Z2V0X2RiX2Jsb2NrXSBnZXRJbnN0c10gewogICAgICAgICMgaW5zdCBtdXN0IG1hdGNoIGNlbGxzCiAgICAgICAgaWYgeyBbJGluc3QgZ2V0TWFzdGVyXSA9PSAkY2VsbCB9IHsKICAgICAgICAgICMgbXVzdCBtYXRjaCBvcmllbnRhdGlvbiwgaWYgcHJvdmlkZWQKICAgICAgICAgIGlmIHsgW21hdGNoX29yaWVudGF0aW9uICRvcmllbnRzIFskaW5zdCBnZXRPcmllbnRdXSAhPSAwIH0gewogICAgICAgICAgICBmb3JlYWNoIGRvbWFpbiAkZG9tYWlucyB7CiAgICAgICAgICAgICAgcGRuOjptYWtlX2luc3RhbmNlX2dyaWQgXAogICAgICAgICAgICAgICAgJGRvbWFpbiAka2V5cygtbmFtZSkgXAogICAgICAgICAgICAgICAgJHN0YXJ0X3dpdGhfcG93ZXIgXAogICAgICAgICAgICAgICAgJGluc3QgXAogICAgICAgICAgICAgICAgeyp9JGhhbG8gXAogICAgICAgICAgICAgICAgJHBnX3BpbnNfdG9fYm91bmRhcnkgXAogICAgICAgICAgICAgICAgJGRlZmF1bHRfZ3JpZCBcCiAgICAgICAgICAgICAgICAkb2JzdHJ1Y3Rpb25zIFwKICAgICAgICAgICAgICAgICRpc19idW1wCiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0KICB9Cn0KCnByb2MgZ2V0X3ZvbHRhZ2VfZG9tYWlucyB7IG5hbWVzIH0gewogIHNldCBkb21haW5zIHt9CiAgZm9yZWFjaCBuYW1lICRuYW1lcyB7CiAgICBzZXQgZG9tYWluIFtwZG46OmZpbmRfZG9tYWluIFttb2RpZnlfdm9sdGFnZV9kb21haW5fbmFtZSAkbmFtZV1dCgogICAgaWYgeyAkZG9tYWluID09ICJOVUxMIiB9IHsKICAgICAgdXRsOjplcnJvciBQRE4gMTAzMiAiVW5hYmxlIHRvIGZpbmQgJG5hbWUgZG9tYWluLiIKICAgIH0KICAgIGxhcHBlbmQgZG9tYWlucyAkZG9tYWluCiAgfQogIHJldHVybiAkZG9tYWlucwp9Cgpwcm9jIG1hdGNoX29yaWVudGF0aW9uIHsgb3JpZW50cyBvcmllbnQgfSB7CiAgaWYgeyBbbGxlbmd0aCAkb3JpZW50c10gPT0gMCB9IHsKICAgIHJldHVybiAxCiAgfQoKICBpZiB7IFtsc2VhcmNoIC1leGFjdCAkb3JpZW50cyAkb3JpZW50XSAhPSAtMSB9IHsKICAgIHJldHVybiAxCiAgfQoKICByZXR1cm4gMAp9Cgpwcm9jIGdldF9pbnN0cyB7IHBhdHRlcm4gfSB7CiAgc2V0IGluc3RzIHt9CiAgZm9yZWFjaCBpbnN0IFtbb3JkOjpnZXRfZGJfYmxvY2tdIGdldEluc3RzXSB7CiAgICBpZiB7IFtyZWdleHAgJHBhdHRlcm4gWyRpbnN0IGdldE5hbWVdXSAhPSAwIH0gewogICAgICBsYXBwZW5kIGluc3RzICRpbnN0CiAgICB9CiAgfQogIHJldHVybiAkaW5zdHMKfQoKcHJvYyBnZXRfbWFzdGVycyB7IHBhdHRlcm4gfSB7CiAgc2V0IG1hc3RlcnMge30KICBmb3JlYWNoIGxpYiBbW29yZDo6Z2V0X2RiXSBnZXRMaWJzXSB7CiAgICBmb3JlYWNoIG1hc3RlciBbJGxpYiBnZXRNYXN0ZXJzXSB7CiAgICAgIGlmIHsgW3JlZ2V4cCAkcGF0dGVybiBbJG1hc3RlciBnZXROYW1lXV0gIT0gMCB9IHsKICAgICAgICBsYXBwZW5kIG1hc3RlcnMgJG1hc3RlcgogICAgICB9CiAgICB9CiAgfQogIHJldHVybiAkbWFzdGVycwp9Cgpwcm9jIGdldF9vbmVfdG9fdHdvIHsgYXJnIHZhbHVlIH0gewogIGlmIHsgW2xsZW5ndGggJHZhbHVlXSA9PSAxIH0gewogICAgcmV0dXJuIFtsaXN0ICR2YWx1ZSAkdmFsdWVdCiAgfSBlbHNlaWYgeyBbbGxlbmd0aCAkdmFsdWVdID09IDIgfSB7CiAgICByZXR1cm4gJHZhbHVlCiAgfSBlbHNlIHsKICAgIHV0bDo6ZXJyb3IgUEROIDEwMzMgIkFyZ3VtZW50ICRhcmcgbXVzdCBjb25zaXN0IG9mIDEgb3IgMiBlbnRyaWVzLiIKICB9CiAgcmV0dXJuICRsaXN0X3ZhbAp9Cgpwcm9jIGdldF9vbmVfdG9fZm91ciB7IGFyZyB2YWx1ZSB9IHsKICBpZiB7IFtsbGVuZ3RoICR2YWx1ZV0gPT0gMSB9IHsKICAgIHJldHVybiBbbGlzdCAkdmFsdWUgJHZhbHVlICR2YWx1ZSAkdmFsdWVdCiAgfSBlbHNlaWYgeyBbbGxlbmd0aCAkdmFsdWVdID09IDIgfSB7CiAgICByZXR1cm4gW2xpc3Qgeyp9JHZhbHVlIHsqfSR2YWx1ZV0KICB9IGVsc2VpZiB7IFtsbGVuZ3RoICR2YWx1ZV0gPT0gNCB9IHsKICAgIHJldHVybiAkdmFsdWUKICB9IGVsc2UgewogICAgdXRsOjplcnJvciBQRE4gMTAzNCAiQXJndW1lbnQgJGFyZyBtdXN0IGNvbnNpc3Qgb2YgMSwgMiBvciA0IGVudHJpZXMuIgogIH0KICByZXR1cm4gJGxpc3RfdmFsCn0KCnByb2MgZ2V0X29ic3RydWN0aW9ucyB7IG9ic3RydWN0aW9uIH0gewogIHNldCBsYXllcnMge30KICBmb3JlYWNoIGwgJG9ic3RydWN0aW9uIHsKICAgIGxhcHBlbmQgbGF5ZXJzIFtwZG46OmdldF9sYXllciAkbF0KICB9CiAgcmV0dXJuICRsYXllcnMKfQoKcHJvYyBnZXRfc3RhcnRzX3dpdGggeyB2YWx1ZSB9IHsKICBpZiB7ICR2YWx1ZSA9PSAiUE9XRVIiIH0gewogICAgcmV0dXJuIDEKICB9IGVsc2VpZiB7ICR2YWx1ZSA9PSAiR1JPVU5EIiB9IHsKICAgIHJldHVybiAwCiAgfSBlbHNlIHsKICAgIHV0bDo6ZXJyb3IgUEROIDEwMzUgIlVua25vd24gLXN0YXJ0c193aXRoIG9wdGlvbjogJHZhbHVlIgogIH0KfQoKcHJvYyBnZXRfbXRlcm0geyBtYXN0ZXIgdGVybSB9IHsKICBzZXQgbXRlcm0gWyRtYXN0ZXIgZmluZE1UZXJtICR0ZXJtXQogIGlmIHsgJG10ZXJtID09ICJOVUxMIiB9IHsKICAgIHV0bDo6ZXJyb3IgUEROIDEwNDcgIlVuYWJsZSB0byBmaW5kICR0ZXJtIG9uICRtYXN0ZXIiCiAgfQogIHJldHVybiAkbXRlcm0KfQoKcHJvYyBnZXRfb3JpZW50YXRpb25zIHsgb3JpZW50YXRpb25zIH0gewogIHNldCB2YWxpZF9vcmllbnRhdGlvbnMge1IwIFI5MCBSMTgwIFIyNzAgTVggTVkgTVhSOTAgTVlSOTB9CiAgc2V0IGxlZl9vcmllbnRhdGlvbnMge04gUjAgRk4gTVkgUyBSMTgwIEZTIE1YIEUgUjI3MCBGRSBNWVI5MCBXIFI5MCBGVyBNWFI5MH0KCiAgc2V0IGNoZWNrZWRfb3JpZW50YXRpb25zIHt9CiAgZm9yZWFjaCBvcmllbnQgJG9yaWVudGF0aW9ucyB7CiAgICBpZiB7IFtsc2VhcmNoIC1leGFjdCAkdmFsaWRfb3JpZW50YXRpb25zICRvcmllbnRdID4gLTEgfSB7CiAgICAgIGxhcHBlbmQgY2hlY2tlZF9vcmllbnRhdGlvbnMgJG9yaWVudAogICAgfSBlbHNlaWYgeyBbZGljdCBleGlzdHMgJGxlZl9vcmllbnRhdGlvbnMgJG9yaWVudF0gfSB7CiAgICAgIGxhcHBlbmQgY2hlY2tlZF9vcmllbnRhdGlvbnMgW2RpY3QgZ2V0ICRsZWZfb3JpZW50YXRpb25zICRvcmllbnRdCiAgICB9IGVsc2UgewogICAgICBzZXQgdmFsaWRfb3JpZW50cyBbam9pbiAkdmFsaWRfb3JpZW50YXRpb25zIHssIH1dCiAgICAgIHV0bDo6ZXJyb3IgUEROIDEwMzYgIkludmFsaWQgb3JpZW50YXRpb24gJG9yaWVudCBzcGVjaWZpZWQsIG11c3QgYmUgb25lIG9mICR7dmFsaWRfb3JpZW50c30uIgogICAgfQogIH0KICByZXR1cm4gJGNoZWNrZWRfb3JpZW50YXRpb25zCn0KCiMgbmFtZXNwYWNlIHBkbgp9Cg==",
nullptr};
} // end namespace pdn
